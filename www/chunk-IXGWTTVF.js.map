{
  "version": 3,
  "sources": ["src/app/core/services/viewport.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\r\nimport { Platform } from '@ionic/angular';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ViewportService {\r\n\r\n  constructor(private platform: Platform) {\r\n    this.initializeViewport();\r\n  }\r\n\r\n  private initializeViewport() {\r\n    // Configurar el viewport para dispositivos móviles\r\n    this.setupViewport();\r\n    \r\n    // Escuchar cambios de orientación\r\n    window.addEventListener('orientationchange', () => {\r\n      setTimeout(() => {\r\n        this.setupViewport();\r\n      }, 100);\r\n    });\r\n    \r\n    // Escuchar cambios de tamaño de ventana\r\n    window.addEventListener('resize', () => {\r\n      this.setupViewport();\r\n    });\r\n  }\r\n\r\n  private setupViewport() {\r\n    const viewport = document.querySelector('meta[name=\"viewport\"]');\r\n    if (viewport) {\r\n      // Configuración optimizada para PWA\r\n      const content = [\r\n        'viewport-fit=cover',\r\n        'width=device-width',\r\n        'initial-scale=1.0',\r\n        'minimum-scale=1.0',\r\n        'maximum-scale=1.0',\r\n        'user-scalable=no'\r\n      ].join(', ');\r\n      \r\n      viewport.setAttribute('content', content);\r\n    }\r\n  }\r\n\r\n  // Obtener información del viewport\r\n  public getViewportInfo() {\r\n    return {\r\n      width: window.innerWidth,\r\n      height: window.innerHeight,\r\n      devicePixelRatio: window.devicePixelRatio || 1,\r\n      orientation: this.getOrientation(),\r\n      isLandscape: window.innerWidth > window.innerHeight,\r\n      isPortrait: window.innerHeight > window.innerWidth\r\n    };\r\n  }\r\n\r\n  // Obtener orientación del dispositivo\r\n  private getOrientation(): string {\r\n    if (window.innerWidth > window.innerHeight) {\r\n      return 'landscape';\r\n    } else {\r\n      return 'portrait';\r\n    }\r\n  }\r\n\r\n  // Verificar si estamos en un dispositivo móvil\r\n  public isMobile(): boolean {\r\n    return this.platform.is('mobile') || \r\n           /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n  }\r\n\r\n  // Verificar si estamos en modo standalone (PWA instalada)\r\n  public isStandalone(): boolean {\r\n    return (window.navigator as any).standalone === true || \r\n           window.matchMedia('(display-mode: standalone)').matches;\r\n  }\r\n\r\n  // Obtener información de las safe areas\r\n  public getSafeAreaInfo() {\r\n    return {\r\n      top: this.getComputedValue('env(safe-area-inset-top)'),\r\n      bottom: this.getComputedValue('env(safe-area-inset-bottom)'),\r\n      left: this.getComputedValue('env(safe-area-inset-left)'),\r\n      right: this.getComputedValue('env(safe-area-inset-right)')\r\n    };\r\n  }\r\n\r\n  private getComputedValue(property: string): string {\r\n    const testElement = document.createElement('div');\r\n    testElement.style.position = 'absolute';\r\n    testElement.style.visibility = 'hidden';\r\n    testElement.style[property as any] = property;\r\n    document.body.appendChild(testElement);\r\n    \r\n    const computedValue = getComputedStyle(testElement)[property as any];\r\n    document.body.removeChild(testElement);\r\n    \r\n    return computedValue || '0px';\r\n  }\r\n\r\n  // Aplicar estilos de safe area a un elemento\r\n  public applySafeArea(element: HTMLElement, position: 'top' | 'bottom' | 'left' | 'right' | 'all') {\r\n    const safeAreaInfo = this.getSafeAreaInfo();\r\n    \r\n    switch (position) {\r\n      case 'top':\r\n        element.style.paddingTop = safeAreaInfo.top;\r\n        break;\r\n      case 'bottom':\r\n        element.style.paddingBottom = safeAreaInfo.bottom;\r\n        break;\r\n      case 'left':\r\n        element.style.paddingLeft = safeAreaInfo.left;\r\n        break;\r\n      case 'right':\r\n        element.style.paddingRight = safeAreaInfo.right;\r\n        break;\r\n      case 'all':\r\n        element.style.paddingTop = safeAreaInfo.top;\r\n        element.style.paddingBottom = safeAreaInfo.bottom;\r\n        element.style.paddingLeft = safeAreaInfo.left;\r\n        element.style.paddingRight = safeAreaInfo.right;\r\n        break;\r\n    }\r\n  }\r\n\r\n  // Aplicar safe areas a un modal\r\n  public applySafeAreaToModal(modalElement: HTMLElement) {\r\n    if (!this.isStandalone() || !this.isMobile()) {\r\n      return; // Solo aplicar en PWA standalone en móviles\r\n    }\r\n\r\n    const safeAreaInfo = this.getSafeAreaInfo();\r\n    \r\n    // Aplicar al contenedor principal del modal\r\n    modalElement.style.height = `calc(100vh - ${safeAreaInfo.top} - ${safeAreaInfo.bottom})`;\r\n    modalElement.style.maxHeight = `calc(100vh - ${safeAreaInfo.top} - ${safeAreaInfo.bottom})`;\r\n    \r\n    // Buscar y aplicar al header\r\n    const header = modalElement.querySelector('.modal-header') as HTMLElement;\r\n    if (header) {\r\n      header.style.paddingTop = `calc(16px + ${safeAreaInfo.top})`;\r\n    }\r\n    \r\n    // Buscar y aplicar al footer\r\n    const footer = modalElement.querySelector('.modal-footer') as HTMLElement;\r\n    if (footer) {\r\n      footer.style.paddingBottom = `calc(16px + ${safeAreaInfo.bottom})`;\r\n    }\r\n  }\r\n\r\n  // Obtener estilos CSS para safe areas\r\n  public getSafeAreaStyles() {\r\n    const safeAreaInfo = this.getSafeAreaInfo();\r\n    \r\n    return {\r\n      modalContainer: {\r\n        height: `calc(100vh - ${safeAreaInfo.top} - ${safeAreaInfo.bottom})`,\r\n        maxHeight: `calc(100vh - ${safeAreaInfo.top} - ${safeAreaInfo.bottom})`\r\n      },\r\n      modalHeader: {\r\n        paddingTop: `calc(16px + ${safeAreaInfo.top})`\r\n      },\r\n      modalFooter: {\r\n        paddingBottom: `calc(16px + ${safeAreaInfo.bottom})`\r\n      }\r\n    };\r\n  }\r\n\r\n  // Forzar el viewport a un tamaño específico (útil para testing)\r\n  public setViewportSize(width: number, height: number) {\r\n    const viewport = document.querySelector('meta[name=\"viewport\"]');\r\n    if (viewport) {\r\n      const content = [\r\n        'viewport-fit=cover',\r\n        `width=${width}`,\r\n        `height=${height}`,\r\n        'initial-scale=1.0',\r\n        'minimum-scale=1.0',\r\n        'maximum-scale=1.0',\r\n        'user-scalable=no'\r\n      ].join(', ');\r\n      \r\n      viewport.setAttribute('content', content);\r\n    }\r\n  }\r\n\r\n  // Restaurar el viewport a la configuración por defecto\r\n  public resetViewport() {\r\n    this.setupViewport();\r\n  }\r\n} "],
  "mappings": "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",
  "names": []
}
