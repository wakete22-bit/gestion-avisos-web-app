import{B as L,a as D}from"./chunk-QJI27CM7.js";import{a as G}from"./chunk-ZPOZPA6O.js";import{e as N,h as A,j as q}from"./chunk-B7BVV76N.js";import{$b as k,Aa as o,Ba as C,Ca as v,R as M,W as m,X as p,Z as P,_b as y,bc as l,cb as O,cc as E,dc as w,ga as b,ic as S,ka as t,la as e,lc as F,ma as a,mc as j,ra as s,uc as z,wc as I}from"./chunk-EYPZOMIL.js";import{k as h}from"./chunk-CRC5ZNR6.js";var U=(()=>{let d=class d{constructor(r,i,n,c){this.fb=r,this.modalController=i,this.viewportService=n,this.elementRef=c,this.modo="crear",this.clienteForm=this.fb.group({nombreContacto:["",l.required],telefono:["",l.required],correoElectronico:["",[l.required,l.email]],direccionLocal:["",l.required],codigoPostal:["",l.required],localidad:["",l.required],esActivo:[!0,l.required]})}ngOnInit(){D({closeOutline:L}),this.modo==="editar"&&this.cliente&&this.cargarDatosCliente()}ngAfterViewInit(){setTimeout(()=>{let r=this.elementRef.nativeElement.querySelector(".modal-container");r&&this.viewportService.applySafeAreaToModal(r)},100)}cargarDatosCliente(){var x;if(!this.cliente)return;let r=this.cliente.direccion||"",i=r.split(", "),n="",c="",u="";if(i.length>=2){n=i[0];let _=i[i.length-1],f=_.split(" ");f.length>=2?(c=f[0],u=f.slice(1).join(" ")):u=_}else n=r;this.clienteForm.patchValue({nombreContacto:this.cliente.nombre_completo||"",telefono:this.cliente.telefono_contacto||"",email:this.cliente.email||"",direccionLocal:n,codigoPostal:c,localidad:u,esActivo:(x=this.cliente.es_activo)!=null?x:!0})}guardarCliente(){return h(this,null,function*(){var r;if(this.clienteForm.valid){this.clienteForm.disable();let i={nombre_completo:this.clienteForm.value.nombreContacto,telefono_contacto:this.clienteForm.value.telefono,email:this.clienteForm.value.correoElectronico,direccion:`${this.clienteForm.value.direccionLocal}, ${this.clienteForm.value.codigoPostal} ${this.clienteForm.value.localidad}`,nivel_urgencia_habitual:((r=this.cliente)==null?void 0:r.nivel_urgencia_habitual)||"Media",es_activo:this.clienteForm.value.esActivo};yield this.modalController.dismiss(i,"confirm")}})}cerrarModal(){return h(this,null,function*(){yield this.modalController.dismiss(null,"cancel")})}get tituloModal(){return this.modo==="editar"?"Editar cliente":"A\xF1adir nuevo cliente"}get subtituloModal(){return this.modo==="editar"?"Modifica los datos del cliente":"A\xF1ade un nuevo cliente"}get textoBotonGuardar(){return this.modo==="editar"?"Guardar cambios":"Guardar cliente"}get botonDeshabilitado(){return!this.clienteForm.valid||this.clienteForm.disabled}};d.\u0275fac=function(i){return new(i||d)(p(z),p(A),p(G),p(M))},d.\u0275cmp=P({type:d,selectors:[["app-crear-cliente-modal"]],inputs:{modo:"modo",cliente:"cliente"},decls:57,vars:5,consts:[[1,"modal-container"],[1,"modal-header"],[1,"header-content"],[1,"close-button",3,"click"],["name","close-outline"],[1,"subtitle"],[1,"modal-content"],[3,"ngSubmit","formGroup"],[1,"form-section"],[1,"form-group"],["type","text","formControlName","nombreContacto","placeholder","Ej: Luis P\xE9rez",1,"form-control"],[1,"form-row"],[1,"form-group","half"],["type","tel","formControlName","telefono","placeholder","Ej: +34 569 23 56 89",1,"form-control"],["type","email","formControlName","correoElectronico","placeholder","Ej: ejemplo@dominio.es",1,"form-control"],[1,"required"],["type","text","formControlName","direccionLocal","placeholder","Ej: Calle Azorin",1,"form-control"],["type","text","formControlName","codigoPostal","placeholder","28004",1,"form-control"],["type","text","formControlName","localidad","placeholder","Ej: Madrid",1,"form-control"],[1,"checkbox-label"],["type","checkbox","formControlName","esActivo",1,"form-checkbox"],[1,"checkmark"],[1,"form-help"],[1,"modal-footer"],[1,"button-group"],["type","button",1,"btn","btn-outline",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"]],template:function(i,n){i&1&&(t(0,"div",0)(1,"header",1)(2,"div",2)(3,"h2"),o(4),e(),t(5,"button",3),s("click",function(){return n.cerrarModal()}),a(6,"ion-icon",4),e()(),t(7,"p",5),o(8),e()(),t(9,"div",6)(10,"form",7),s("ngSubmit",function(){return n.guardarCliente()}),t(11,"div",8)(12,"div",9)(13,"label"),o(14,"Nombre de contacto"),e(),a(15,"input",10),e(),t(16,"div",11)(17,"div",12)(18,"label"),o(19,"Tel\xE9fono"),e(),a(20,"input",13),e(),t(21,"div",12)(22,"label"),o(23,"Correo electr\xF3nico"),e(),a(24,"input",14),e()(),t(25,"div",9)(26,"label"),o(27,"Direccion local "),t(28,"span",15),o(29,"*"),e()(),a(30,"input",16),e(),t(31,"div",11)(32,"div",12)(33,"label"),o(34,"C\xF3digo Postal "),t(35,"span",15),o(36,"*"),e()(),a(37,"input",17),e(),t(38,"div",12)(39,"label"),o(40,"Localidad "),t(41,"span",15),o(42,"*"),e()(),a(43,"input",18),e()(),t(44,"div",9)(45,"label",19),a(46,"input",20)(47,"span",21),o(48," Cliente activo "),e(),t(49,"small",22),o(50,"Los clientes inactivos no aparecer\xE1n en las b\xFAsquedas principales"),e()()()()(),t(51,"footer",23)(52,"div",24)(53,"button",25),s("click",function(){return n.cerrarModal()}),o(54," Cancelar "),e(),t(55,"button",26),s("click",function(){return n.guardarCliente()}),o(56),e()()()()),i&2&&(m(4),C(n.tituloModal),m(4),C(n.subtituloModal),m(2),b("formGroup",n.clienteForm),m(45),b("disabled",n.botonDeshabilitado),m(),v(" ",n.textoBotonGuardar," "))},dependencies:[q,N,O,I,S,k,y,E,w,F,j],styles:[".modal-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:0;max-height:85vh;background:#fff}.modal-header[_ngcontent-%COMP%]{padding:16px 24px;border-bottom:1px solid #e5e7eb;flex-shrink:0}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600;color:#111827}.modal-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:8px 0 0;color:#6b7280;font-size:14px}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#6b7280;display:flex;align-items:center;justify-content:center}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#111827}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px}.modal-content[_ngcontent-%COMP%]{flex:1;min-height:0;overflow-y:auto}.modal-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{height:100%}.form-section[_ngcontent-%COMP%]{padding:24px;max-height:calc(85vh - 140px)}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:14px;font-weight:500;color:#374151}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#dc2626}.form-control[_ngcontent-%COMP%]{position:relative;width:100%;padding:10px 12px;background-color:#fafafb;border:1px solid transparent;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}.form-control[_ngcontent-%COMP%]::placeholder{color:#9ca3af}textarea.form-control[_ngcontent-%COMP%]{resize:vertical;min-height:80px}.character-count[_ngcontent-%COMP%]{position:absolute;bottom:13px;right:13px;font-size:12px;color:#6b7280}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-size:14px;font-weight:500;color:#374151;margin-bottom:4px}.checkbox-label[_ngcontent-%COMP%]   .form-checkbox[_ngcontent-%COMP%]{width:16px;height:16px;accent-color:#4F46E5;cursor:pointer}.checkbox-label[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{display:none}.form-help[_ngcontent-%COMP%]{display:block;font-size:12px;color:#6b7280;margin-top:4px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px}.form-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:0;flex:1}.modal-footer[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e5e7eb;background-color:#fff;flex-shrink:0}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:6px;font-size:14px;font-weight:500;display:flex;align-items:center;gap:8px;cursor:pointer;transition:all .2s}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{background:none;border:1px solid #d1d5db;color:#374151}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f8fafc;border-color:#9ca3af}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#4f46e5;border:1px solid #4F46E5;color:#fff}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#4338ca;border-color:#4338ca}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:disabled{background-color:#9ca3af;border-color:#9ca3af;cursor:not-allowed;opacity:.6}@media (max-width: 768px){.modal-container[_ngcontent-%COMP%]{max-height:none;height:100vh}.modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-content[_ngcontent-%COMP%]{height:auto;overflow:auto}.form-control[_ngcontent-%COMP%]{font-size:16px;padding:12px}textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{font-size:14px!important;padding:12px}.input-with-button[_ngcontent-%COMP%]{flex-direction:column}.input-with-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]{position:static;margin-top:8px;width:100%;justify-content:center}}@media (display-mode: standalone) and (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px));max-height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px))}.modal-header[_ngcontent-%COMP%]{padding-top:calc(16px + var(--safe-area-top, 0px))}.modal-footer[_ngcontent-%COMP%]{padding-bottom:calc(16px + var(--safe-area-bottom, 0px))}}@supports (-webkit-touch-callout: none){@media (display-mode: standalone) and (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px));max-height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px))}.modal-header[_ngcontent-%COMP%]{padding-top:calc(16px + var(--safe-area-top, 0px))}.modal-footer[_ngcontent-%COMP%]{padding-bottom:calc(16px + var(--safe-area-bottom, 0px))}}}@supports not (padding-top: env(safe-area-inset-top)){@media (display-mode: standalone) and (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:calc(100vh - 40px);max-height:calc(100vh - 40px)}.modal-header[_ngcontent-%COMP%]{padding-top:36px}.modal-footer[_ngcontent-%COMP%]{padding-bottom:36px}}}"]});let g=d;return g})();export{U as a};
