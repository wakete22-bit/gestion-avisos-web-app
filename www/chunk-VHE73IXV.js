import{a as ke}from"./chunk-QA4DYEAW.js";import{a as ue}from"./chunk-5ZJTCSBL.js";import"./chunk-24MOAAV5.js";import{a as ze}from"./chunk-KALFOIVV.js";import"./chunk-5YRB7RVB.js";import{a as me}from"./chunk-VQH6GBOE.js";import{$ as ye,C as he,D as Oe,Ea as Ie,Ga as we,Ha as Se,K as be,Sa as Fe,a as ge,aa as Ee,c as _e,d as fe,f as Ce,h as ve,l as Pe,w as xe,x as Me}from"./chunk-CPCGS7XX.js";import"./chunk-STXSJFLK.js";import{h as le,w as de}from"./chunk-YOFVTXCH.js";import{b as pe}from"./chunk-GDHKTYOW.js";import{H as Q,J as b,K as X,L as Z,P as ee,Q as te,R as oe,U as ne,V as ie,_ as re,ba as ae,ca as se,da as ce}from"./chunk-TWOPYUJN.js";import{A as k,Eb as J,Hb as K,Ia as c,Ja as O,Ka as I,La as L,N as f,Na as z,O as C,Oa as A,Pa as T,Xa as F,Za as G,_ as s,_a as V,ba as E,c as j,da as q,ha as P,kb as U,lb as $,mb as R,na as u,pa as B,pb as W,ra as a,rb as H,sa as r,sb as Y,ta as g,xa as y,ya as v,za as m}from"./chunk-4AY4VQCP.js";import"./chunk-ULLEADC5.js";import"./chunk-2ELISCRH.js";import"./chunk-BV4CTHEE.js";import"./chunk-NBD2MYJO.js";import"./chunk-3SBX7V6R.js";import"./chunk-SQKDQBOS.js";import"./chunk-SWRJZAEI.js";import"./chunk-JCSW2JUV.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-36KMLI7A.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import"./chunk-CRC5ZNR6.js";function Ae(i,p){i&1&&(a(0,"div",8)(1,"div",9),g(2,"ion-icon",10),a(3,"p"),c(4,"Cargando presupuesto..."),r()()())}function Te(i,p){i&1&&(a(0,"div",26),g(1,"ion-icon",10),a(2,"span"),c(3,"Cargando avisos..."),r()())}function Ve(i,p){if(i&1&&(a(0,"div",27),g(1,"ion-icon",28),a(2,"span"),c(3),r()()),i&2){let o=m(3);s(3),O(o.errorAvisos)}}function De(i,p){if(i&1){let o=y();a(0,"div",31),v("click",function(){let t=f(o).$implicit,n=m(4);return C(n.seleccionarAviso(t))}),a(1,"div",32)(2,"div",33)(3,"span",34),c(4),r(),a(5,"span",35),c(6),r()(),a(7,"span",36),c(8),r(),a(9,"div",37)(10,"span",38),c(11),F(12,"date"),r(),a(13,"span",39),c(14),r()()()()}if(i&2){let o=p.$implicit;s(4),I("#",o.id==null?null:o.id.substring(0,8),""),s(),u("ngClass","estado-"+(o.estado==null?null:o.estado.toLowerCase())),s(),I(" ",o.estado," "),s(2),O(o.nombre_cliente_aviso),s(3),O(G(12,6,o.fecha_creacion,"dd/MM/yyyy")),s(3),O(o.descripcion_problema)}}function Ne(i,p){if(i&1&&(a(0,"div",29),P(1,De,15,9,"div",30),r()),i&2){let o=m(3);s(),u("ngForOf",o.avisosFiltrados)}}function je(i,p){i&1&&(a(0,"div",40),g(1,"ion-icon",28),a(2,"p"),c(3,"No se encontraron avisos"),r()())}function qe(i,p){if(i&1){let o=y();a(0,"div",15)(1,"div",16)(2,"h4"),c(3,"Seleccionar Aviso para el Presupuesto"),r(),a(4,"button",17),v("click",function(){f(o);let t=m(2);return C(t.cerrarSelectorAvisos())}),g(5,"ion-icon",18),r()(),a(6,"div",19)(7,"input",20),T("ngModelChange",function(t){f(o);let n=m(2);return A(n.busquedaAviso,t)||(n.busquedaAviso=t),C(t)}),v("input",function(t){f(o);let n=m(2);return C(n.filtrarAvisos(t))}),r(),g(8,"ion-icon",21),r(),P(9,Te,4,0,"div",22)(10,Ve,4,1,"div",23)(11,Ne,2,1,"div",24)(12,je,4,0,"div",25),r()}if(i&2){let o=m(2);s(7),z("ngModel",o.busquedaAviso),s(2),u("ngIf",o.loadingAvisos),s(),u("ngIf",o.errorAvisos),s(),u("ngIf",!o.loadingAvisos&&!o.errorAvisos),s(),u("ngIf",!o.loadingAvisos&&!o.errorAvisos&&o.avisosFiltrados.length===0)}}function Be(i,p){if(i&1){let o=y();a(0,"div",11)(1,"h3"),c(2,"Seleccionar Aviso"),r(),a(3,"p"),c(4,"Para crear un presupuesto, primero debes seleccionar un aviso:"),r(),a(5,"button",12),v("click",function(){f(o);let t=m();return C(t.abrirSelectorAvisos())}),g(6,"ion-icon",13),c(7," Seleccionar Aviso "),r(),P(8,qe,13,5,"div",14),r()}if(i&2){let o=m();s(8),u("ngIf",o.mostrarSelectorAvisos)}}function Le(i,p){if(i&1){let o=y();a(0,"div",32)(1,"div",41)(2,"h2"),c(3),r(),a(4,"button",42),v("click",function(){f(o);let t=m();return C(t.abrirSelectorAvisos())}),g(5,"ion-icon",43),c(6," Cambiar Aviso "),r()(),a(7,"p")(8,"strong"),c(9,"Cliente:"),r(),c(10),r(),a(11,"p")(12,"strong"),c(13,"Descripci\xF3n:"),r(),c(14),r()()}if(i&2){let o=m();s(3),I("Aviso: #",o.aviso.id==null?null:o.aviso.id.substring(0,8),""),s(7),I(" ",o.aviso.nombre_cliente_aviso,""),s(4),I(" ",o.aviso.descripcion_problema,"")}}function Ge(i,p){i&1&&(a(0,"span"),c(1,"Las horas estimadas son requeridas"),r())}function Ue(i,p){i&1&&(a(0,"span"),c(1,"Las horas deben ser mayor o igual a 0"),r())}function $e(i,p){i&1&&(a(0,"span"),c(1,"Las horas no pueden exceder 1000"),r())}function Re(i,p){if(i&1&&(a(0,"div",69),P(1,Ge,2,0,"span",70)(2,Ue,2,0,"span",70)(3,$e,2,0,"span",70),r()),i&2){let o,e,t,n=m(2);s(),u("ngIf",(o=n.presupuestoForm.get("horas_estimadas"))==null||o.errors==null?null:o.errors.required),s(),u("ngIf",(e=n.presupuestoForm.get("horas_estimadas"))==null||e.errors==null?null:e.errors.min),s(),u("ngIf",(t=n.presupuestoForm.get("horas_estimadas"))==null||t.errors==null?null:t.errors.max)}}function We(i,p){i&1&&(a(0,"span"),c(1,"El total estimado es requerido"),r())}function He(i,p){i&1&&(a(0,"span"),c(1,"El total debe ser mayor o igual a 0"),r())}function Ye(i,p){i&1&&(a(0,"span"),c(1,"El total no puede exceder 1,000,000"),r())}function Je(i,p){if(i&1&&(a(0,"div",69),P(1,We,2,0,"span",70)(2,He,2,0,"span",70)(3,Ye,2,0,"span",70),r()),i&2){let o,e,t,n=m(2);s(),u("ngIf",(o=n.presupuestoForm.get("total_estimado"))==null||o.errors==null?null:o.errors.required),s(),u("ngIf",(e=n.presupuestoForm.get("total_estimado"))==null||e.errors==null?null:e.errors.min),s(),u("ngIf",(t=n.presupuestoForm.get("total_estimado"))==null||t.errors==null?null:t.errors.max)}}function Ke(i,p){i&1&&(a(0,"div",77),g(1,"ion-icon",10),a(2,"span"),c(3,"Cargando productos..."),r()())}function Qe(i,p){if(i&1&&(a(0,"div",78),g(1,"ion-icon",28),a(2,"span"),c(3),r()()),i&2){let o=m(3);s(3),O(o.errorProductos)}}function Xe(i,p){if(i&1){let o=y();a(0,"div",81),v("click",function(){let t=f(o).$implicit,n=m(4);return C(n.agregarMaterialDelInventario(t))}),a(1,"div",82)(2,"div",83)(3,"span",84),c(4),r()(),a(5,"span",85),c(6),r(),a(7,"div",86)(8,"span",87),c(9),r(),a(10,"span",88),c(11),r()()(),a(12,"span",89),c(13),F(14,"currency"),r(),g(15,"ion-icon",90),r()}if(i&2){let o=p.$implicit;s(4),O(o.codigo),s(2),O(o.nombre),s(3),L("Stock: ",o.cantidad_disponible," ",o.unidad,""),s(2),O(o.descripcion),s(2),O(V(14,6,o.precio_neto,"EUR","symbol","1.2-2"))}}function Ze(i,p){if(i&1&&(a(0,"div",79),P(1,Xe,16,11,"div",80),r()),i&2){let o=m(3);s(),u("ngForOf",o.productosFiltrados)}}function et(i,p){i&1&&(a(0,"div",91),g(1,"ion-icon",92),a(2,"p"),c(3,"No se encontraron productos"),r()())}function tt(i,p){if(i&1){let o=y();a(0,"div",71)(1,"div",16)(2,"h4"),c(3,"Seleccionar Materiales del Inventario"),r(),a(4,"button",17),v("click",function(){f(o);let t=m(2);return C(t.cerrarSelectorMateriales())}),g(5,"ion-icon",18),r()(),a(6,"div",19)(7,"input",72),T("ngModelChange",function(t){f(o);let n=m(2);return A(n.busquedaProducto,t)||(n.busquedaProducto=t),C(t)}),v("input",function(t){f(o);let n=m(2);return C(n.filtrarProductos(t))}),r(),g(8,"ion-icon",21),r(),P(9,Ke,4,0,"div",73)(10,Qe,4,1,"div",74)(11,Ze,2,1,"div",75)(12,et,4,0,"div",76),r()}if(i&2){let o=m(2);s(7),z("ngModel",o.busquedaProducto),s(2),u("ngIf",o.loadingProductos),s(),u("ngIf",o.errorProductos),s(),u("ngIf",!o.loadingProductos&&!o.errorProductos),s(),u("ngIf",!o.loadingProductos&&!o.errorProductos&&o.productosFiltrados.length===0)}}function ot(i,p){if(i&1){let o=y();a(0,"div",93)(1,"div",94)(2,"h4"),c(3,"Agregar Material"),r(),a(4,"button",17),v("click",function(){f(o);let t=m(2);return C(t.cerrarFormularioManual())}),g(5,"ion-icon",18),r()(),a(6,"div",95)(7,"div",96),g(8,"input",97),r(),a(9,"div",98),g(10,"input",99),r(),a(11,"div",100),g(12,"input",101),r(),a(13,"button",102),v("click",function(){f(o);let t=m(2);return C(t.agregarMaterialDesdeFormulario())}),g(14,"ion-icon",103),r()()()}if(i&2){let o=m(2);s(6),u("formGroup",o.materialManualForm)}}function nt(i,p){if(i&1){let o=y();a(0,"div",107)(1,"span",108),c(2),r(),a(3,"input",109),v("change",function(t){let n=f(o).index,d=m(3);return C(d.actualizarCantidadMaterial(n,t))}),r(),a(4,"input",110),v("input",function(t){let n=f(o).index,d=m(3);return C(d.actualizarPrecioMaterial(n,t))}),r(),a(5,"button",111),v("click",function(){let t=f(o).index,n=m(3);return C(n.eliminarMaterial(t))}),g(6,"ion-icon",112),r()()}if(i&2){let o=p.$implicit,e=m(3);s(2),O(e.getNombreProducto(o.material_id)),s(),u("value",o.cantidad_estimada)("min",1),s(),u("value",o.precio_neto_al_momento)("min",0)}}function it(i,p){if(i&1&&(a(0,"div",104)(1,"h4"),c(2,"Materiales a\xF1adidos"),r(),a(3,"div",105)(4,"strong"),c(5),F(6,"currency"),r()(),P(7,nt,7,5,"div",106),r()),i&2){let o=m(2);s(5),I("Costo total de materiales: ",V(6,2,o.calcularCostoTotalMateriales(),"EUR","symbol","1.2-2"),""),s(2),u("ngForOf",o.materiales)}}function rt(i,p){i&1&&(a(0,"div",113)(1,"p"),c(2,"No se han agregado materiales al presupuesto"),r()())}function at(i,p){if(i&1){let o=y();a(0,"button",114),v("click",function(){f(o);let t=m(2);return C(t.aprobarPresupuesto())}),g(1,"ion-icon",115),c(2," Aprobar Presupuesto "),r()}if(i&2){let o=m(2);u("disabled",o.loading)}}function st(i,p){i&1&&(a(0,"div",116),g(1,"ion-icon",115),c(2," Presupuesto Aprobado "),r())}function ct(i,p){i&1&&(a(0,"div",117),g(1,"ion-icon",118),c(2," Presupuesto Rechazado "),r())}function lt(i,p){i&1&&(a(0,"div",119),g(1,"ion-icon",120),c(2," Presupuesto Cancelado "),r())}function dt(i,p){i&1&&(a(0,"div",121)(1,"p",122),c(2,"Por favor, complete todos los campos requeridos correctamente"),r()())}function pt(i,p){i&1&&(a(0,"div",121)(1,"p",122),c(2,"No se ha seleccionado un aviso"),r()())}function ut(i,p){if(i&1&&(a(0,"div",123)(1,"h4",124),g(2,"ion-icon",125),c(3," Aviso Asociado "),r(),a(4,"p",126),c(5," Este presupuesto est\xE1 asociado al aviso "),a(6,"strong"),c(7),r(),c(8," del cliente "),a(9,"strong"),c(10),r(),c(11,". "),r(),a(12,"p",127),c(13,' Puedes usar el bot\xF3n "Volver al Aviso" para regresar y continuar con el trabajo. '),r()()),i&2){let o=m(2);s(7),I("#",o.aviso.id==null?null:o.aviso.id.substring(0,8),""),s(3),O(o.aviso.nombre_cliente_aviso)}}function mt(i,p){if(i&1){let o=y();a(0,"form",44),v("ngSubmit",function(){f(o);let t=m();return C(t.guardarPresupuesto())}),a(1,"div",45)(2,"h3"),c(3,"Estimaci\xF3n de Trabajo"),r(),a(4,"div",46)(5,"label"),c(6,"Horas estimadas"),r(),a(7,"input",47),v("input",function(){f(o);let t=m();return C(t.calcularTotal())}),r(),P(8,Re,4,3,"div",48),r(),a(9,"div",46)(10,"label"),c(11,"Total estimado (\u20AC)"),r(),g(12,"input",49),P(13,Je,4,3,"div",48),r()(),a(14,"div",45)(15,"div",50)(16,"h3"),c(17,"Materiales Estimados"),r(),a(18,"div",51)(19,"button",52),v("click",function(){f(o);let t=m();return C(t.abrirSelectorMateriales())}),g(20,"ion-icon",13),c(21," Seleccionar del Inventario "),r(),a(22,"button",53),v("click",function(){f(o);let t=m();return C(t.mostrarFormularioManual())}),g(23,"ion-icon",54),c(24," Agregar Manualmente "),r()()(),P(25,tt,13,5,"div",55)(26,ot,15,1,"div",56)(27,it,8,7,"div",57)(28,rt,3,0,"div",58),r(),a(29,"div",59)(30,"button",60),v("click",function(){f(o);let t=m();return C(t.volver())}),g(31,"ion-icon",3),c(32," Volver a Presupuestos "),r(),a(33,"button",61),g(34,"ion-icon",62),c(35),r(),P(36,at,3,1,"button",63)(37,st,3,0,"div",64)(38,ct,3,0,"div",65)(39,lt,3,0,"div",66),r(),P(40,dt,3,0,"div",67)(41,pt,3,0,"div",67)(42,ut,14,2,"div",68),r()}if(i&2){let o,e,t,n,d,_,l=m();u("formGroup",l.presupuestoForm),s(8),u("ngIf",((o=l.presupuestoForm.get("horas_estimadas"))==null?null:o.invalid)&&((o=l.presupuestoForm.get("horas_estimadas"))==null?null:o.touched)),s(5),u("ngIf",((e=l.presupuestoForm.get("total_estimado"))==null?null:e.invalid)&&((e=l.presupuestoForm.get("total_estimado"))==null?null:e.touched)),s(12),u("ngIf",l.mostrarSelectorMateriales),s(),u("ngIf",l.mostrarFormularioMaterial),s(),u("ngIf",l.materiales.length>0),s(),u("ngIf",l.materiales.length===0),s(5),B("btn-disabled",!l.presupuestoForm.valid||l.loading||!l.avisoId),u("disabled",!l.presupuestoForm.valid||l.loading||!l.avisoId),s(2),I(" ",l.loading?"Guardando...":l.modoEdicion?"Actualizar Presupuesto":"Guardar Presupuesto"," "),s(),u("ngIf",l.modoEdicion&&((t=l.presupuestoForm.get("estado"))==null?null:t.value)==="Pendiente"),s(),u("ngIf",l.modoEdicion&&((n=l.presupuestoForm.get("estado"))==null?null:n.value)==="Aprobado"),s(),u("ngIf",l.modoEdicion&&((d=l.presupuestoForm.get("estado"))==null?null:d.value)==="Rechazado"),s(),u("ngIf",l.modoEdicion&&((_=l.presupuestoForm.get("estado"))==null?null:_.value)==="Cancelado"),s(),u("ngIf",!l.presupuestoForm.valid&&l.presupuestoForm.touched),s(),u("ngIf",!l.avisoId),s(),u("ngIf",l.avisoId&&l.aviso)}}var St=(()=>{let p=class p{constructor(e,t,n,d,_,l,M,x){this.fb=e,this.router=t,this.route=n,this.presupuestosService=d,this.avisosService=_,this.inventarioService=l,this.supabaseClientService=M,this.configuracionService=x,this.avisoId=null,this.presupuestoId=null,this.aviso=null,this.presupuesto=null,this.loading=!1,this.materiales=[],this.modoEdicion=!1,this.productosInventario=[],this.productosFiltrados=[],this.loadingProductos=!1,this.errorProductos=null,this.busquedaProducto="",this.mostrarSelectorMateriales=!1,this.mostrarFormularioMaterial=!1,this.avisos=[],this.avisosFiltrados=[],this.loadingAvisos=!1,this.errorAvisos=null,this.busquedaAviso="",this.mostrarSelectorAvisos=!1,this.albaranesAviso=[],this.destroy$=new j,ge({arrowBackOutline:ve,refreshOutline:Ie,listOutline:Ee,close:he,searchOutline:Se,alertCircleOutline:Ce,addCircleOutline:fe,cubeOutline:be,checkmarkOutline:Me,trashOutline:Fe,saveOutline:we,checkmarkCircleOutline:xe,closeCircleOutline:Oe,banOutline:Pe,informationCircleOutline:ye,addCircle:_e}),this.presupuestoForm=this.fb.group({horas_estimadas:[0,[b.required,b.min(0),b.max(1e3)]],total_estimado:[0,[b.required,b.min(0),b.max(1e6)]],estado:["Pendiente",b.required]}),this.materialManualForm=this.fb.group({denominacion:["",b.required],cantidad:[1,[b.required,b.min(1)]],precio:[0,[b.required,b.min(0)]]}),this.formStatusSubscription=this.presupuestoForm.statusChanges.subscribe(h=>{console.log("Estado del formulario:",h),console.log("Formulario v\xE1lido:",this.presupuestoForm.valid),console.log("Errores:",this.presupuestoForm.errors)})}ngOnInit(){console.log("ngOnInit - Iniciando componente crear presupuesto"),this.cargarProductosInventario(),this.cargarAviso(),this.modoEdicion?console.log("ngOnInit - Modo edici\xF3n: no se cargan avisos para selector"):(console.log("ngOnInit - Cargando lista de avisos para selector..."),this.cargarAvisos())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.formStatusSubscription&&this.formStatusSubscription.unsubscribe()}cargarAviso(){this.route.queryParams.subscribe(e=>{this.avisoId=e.avisoId,this.presupuestoId=e.id,this.modoEdicion=e.edit==="true",console.log("Par\xE1metros de ruta:",{avisoId:this.avisoId,presupuestoId:this.presupuestoId,modoEdicion:this.modoEdicion}),this.avisoId?(console.log("Cargando aviso espec\xEDfico:",this.avisoId),this.avisosService.getAviso(this.avisoId).subscribe({next:t=>{this.aviso=t,console.log("Aviso espec\xEDfico cargado:",t)},error:t=>{console.error("Error al cargar aviso espec\xEDfico:",t)}})):this.modoEdicion?console.log("Modo edici\xF3n sin avisoId: se espera que se cargue desde el presupuesto"):console.log("No hay avisoId en la URL y no es edici\xF3n, se mostrar\xE1 el selector de avisos"),this.presupuestoId&&this.modoEdicion&&this.cargarPresupuestoParaEditar()})}verificarPreciosInventario(){console.log("Verificando precios del inventario..."),this.productosInventario.forEach((e,t)=>{console.log(`Producto ${t+1}:`,{id:e.id,nombre:e.nombre,precio_neto:e.precio_neto,tipo_precio:typeof e.precio_neto,es_valido:!isNaN(e.precio_neto)&&isFinite(e.precio_neto)})})}cargarProductosInventario(){this.loadingProductos=!0,this.errorProductos=null,this.inventarioService.getInventario(1,1e3,"","nombre","asc",!1).pipe(k(this.destroy$)).subscribe({next:e=>{this.productosInventario=e.inventario,this.productosFiltrados=[...this.productosInventario],this.loadingProductos=!1,console.log("Productos del inventario cargados:",this.productosInventario.length),this.verificarPreciosInventario(),this.modoEdicion&&this.presupuesto&&this.presupuesto.materiales_estimados&&(console.log("Reprocesando materiales despu\xE9s de cargar inventario"),this.procesarMateriales(this.presupuesto.materiales_estimados))},error:e=>{console.error("Error al cargar productos del inventario:",e),this.errorProductos="Error al cargar productos del inventario",this.loadingProductos=!1}})}filtrarProductos(e){var n;let t=((n=e==null?void 0:e.target)==null?void 0:n.value)||e||"";this.busquedaProducto=t,t.trim()?this.productosFiltrados=this.productosInventario.filter(d=>{var _;return d.nombre.toLowerCase().includes(t.toLowerCase())||d.codigo.toLowerCase().includes(t.toLowerCase())||(((_=d.descripcion)==null?void 0:_.toLowerCase())||"").includes(t.toLowerCase())}):this.productosFiltrados=[...this.productosInventario]}abrirSelectorMateriales(){this.mostrarSelectorMateriales=!0,this.productosFiltrados=[...this.productosInventario],this.busquedaProducto=""}cerrarSelectorMateriales(){this.mostrarSelectorMateriales=!1}agregarMaterialDelInventario(e){console.log("Agregando material del inventario:",e),console.log("Precio del producto:",e.precio_neto);let t=this.materiales.find(n=>n.material_id===e.id);if(t)t.cantidad_estimada=(t.cantidad_estimada||0)+1,console.log("Material existente actualizado:",t);else{let n={material_id:e.id,cantidad_estimada:1,precio_neto_al_momento:e.precio_neto,producto:e};this.materiales.push(n),console.log("Nuevo material agregado:",n)}this.calcularTotal(!0),this.cerrarSelectorMateriales()}getNombreProducto(e){let t=this.productosInventario.find(d=>d.id===e);if(t)return t.nombre;let n=this.materiales.find(d=>d.material_id===e);return n&&n.producto&&n.producto.nombre||"Producto no encontrado"}getPrecioProducto(e){let t=this.productosInventario.find(d=>d.id===e);if(t)return t.precio_neto;let n=this.materiales.find(d=>d.material_id===e);return n&&n.producto&&n.producto.precio_neto||0}cargarPresupuestoParaEditar(){this.presupuestoId&&(this.loading=!0,this.presupuestosService.getPresupuesto(this.presupuestoId).subscribe({next:e=>{console.log("Presupuesto cargado para editar:",e),this.presupuesto=e,e.aviso_id&&(this.avisoId=e.aviso_id,console.log("AvisoId establecido:",this.avisoId),this.avisosService.getAviso(this.avisoId).subscribe({next:t=>{this.aviso=t,console.log("Aviso cargado desde presupuesto:",t)},error:t=>{console.error("Error al cargar aviso desde presupuesto:",t)}})),this.presupuestoForm.patchValue({horas_estimadas:e.horas_estimadas,total_estimado:e.total_estimado,estado:e.estado||"Pendiente"}),e.materiales_estimados&&e.materiales_estimados.length>0?(console.log("Materiales encontrados:",e.materiales_estimados),this.productosInventario.length>0?this.procesarMateriales(e.materiales_estimados):setTimeout(()=>{this.procesarMateriales(e.materiales_estimados)},500)):(console.log("No se encontraron materiales en el presupuesto"),this.materiales=[]),setTimeout(()=>{this.calcularTotal(!0)},100),this.loading=!1},error:e=>{console.error("Error al cargar presupuesto para editar:",e),this.loading=!1}}))}procesarMateriales(e){console.log("Procesando materiales:",e),this.materiales=e.map(t=>{console.log("Procesando material:",t),console.log("Precio del material:",t.precio_neto_al_momento),console.log("Material completo:",t);let n={material_id:t.material_id,cantidad_estimada:t.cantidad_estimada||1,precio_neto_al_momento:t.precio_neto_al_momento||0,producto:t.producto||t.material};return console.log("Material procesado:",n),n}),console.log("Materiales procesados:",this.materiales)}mostrarFormularioManual(){this.mostrarFormularioMaterial=!0,this.materialManualForm.reset({denominacion:"",cantidad:1,precio:0})}cerrarFormularioManual(){this.mostrarFormularioMaterial=!1,this.materialManualForm.reset({denominacion:"",cantidad:1,precio:0})}agregarMaterialDesdeFormulario(){var n,d,_;if(console.log("\u{1F50D} Debug - materialManualForm value:",this.materialManualForm.value),console.log("\u{1F50D} Debug - materialManualForm valid:",this.materialManualForm.valid),this.materialManualForm.invalid){if(this.materialManualForm.markAllAsTouched(),(n=this.materialManualForm.get("denominacion"))!=null&&n.invalid){alert("Por favor, introduce la denominaci\xF3n del material");return}if((d=this.materialManualForm.get("cantidad"))!=null&&d.invalid){alert("La cantidad debe ser mayor a 0");return}if((_=this.materialManualForm.get("precio"))!=null&&_.invalid){alert("El precio debe ser mayor o igual a 0");return}return}let e=this.materialManualForm.value,t={material_id:this.generarUUID(),cantidad_estimada:e.cantidad,precio_neto_al_momento:e.precio||0,producto:{id:this.generarUUID(),nombre:e.denominacion.trim(),precio_neto:e.precio||0,unidad:"unidad"}};console.log("\u{1F50D} agregarMaterialDesdeFormulario - Material manual creado:",t),this.materiales.push(t),this.calcularTotal(!0),this.cerrarFormularioManual()}eliminarMaterial(e){var t;console.log("Eliminando material en \xEDndice:",e),console.log("Material a eliminar:",this.materiales[e]),this.materiales.splice(e,1),console.log("Materiales despu\xE9s de eliminar:",this.materiales),this.calcularTotal(!0),this.presupuestoForm.updateValueAndValidity(),console.log("Total estimado despu\xE9s de eliminar material:",(t=this.presupuestoForm.get("total_estimado"))==null?void 0:t.value),this.verificarEstadoMateriales()}actualizarCantidadMaterial(e,t){var d;let n=((d=t==null?void 0:t.target)==null?void 0:d.value)||t||"1";console.log("Actualizando cantidad del material:",e,"Nueva cantidad:",n),this.materiales[e]&&(this.materiales[e].cantidad_estimada=parseInt(n)||1,console.log("Material actualizado:",this.materiales[e]),this.calcularTotal(!0),this.verificarEstadoMateriales())}actualizarPrecioMaterial(e,t){var d;let n=((d=t==null?void 0:t.target)==null?void 0:d.value)||t||"0";console.log("Actualizando precio del material:",e,"Nuevo precio:",n),this.materiales[e]&&(this.materiales[e].precio_neto_al_momento=parseFloat(n)||0,console.log("Material actualizado:",this.materiales[e]),this.calcularTotal(!0),this.verificarEstadoMateriales())}verificarEstadoMateriales(){var l,M;console.log("=== Verificaci\xF3n de Estado de Materiales ==="),console.log("Cantidad de materiales:",this.materiales.length),console.log("Materiales:",this.materiales),console.log("Total estimado en formulario:",(l=this.presupuestoForm.get("total_estimado"))==null?void 0:l.value),console.log("Costo total calculado:",this.calcularCostoTotalMateriales());let e=((M=this.presupuestoForm.get("horas_estimadas"))==null?void 0:M.value)||0,t=this.configuracionService.getPrecioHoraManoObraSync(),n=e*t,d=this.materiales.reduce((x,h)=>{let w=h.cantidad_estimada||0,S=h.precio_neto_al_momento||0;return x+w*S},0),_=n+d;console.log("Total calculado (mano obra + materiales):",_),console.log("==========================================")}calcularCostoTotalMateriales(){return this.materiales.reduce((e,t)=>e+t.cantidad_estimada*t.precio_neto_al_momento,0)}calcularTotal(e=!1){var M,x;console.log("Calculando total..."),console.log("Materiales actuales:",this.materiales);let t=((M=this.presupuestoForm.get("horas_estimadas"))==null?void 0:M.value)||0,n=this.configuracionService.getPrecioHoraManoObraSync(),d=t*n,_=this.materiales.reduce((h,w)=>{let S=w.cantidad_estimada||0,D=w.precio_neto_al_momento||0,N=S*D;return console.log(`Material: ${w.material_id}, Cantidad: ${S}, Precio: ${D}, Subtotal: ${N}`),h+N},0),l=d+_;console.log("Calculando total:",{horasEstimadas:t,precioPorHora:n,costoManoObra:d,costoMateriales:_,totalEstimado:l}),isNaN(l)||!isFinite(l)?(console.error("Error: Total calculado no es un n\xFAmero v\xE1lido"),this.presupuestoForm.patchValue({total_estimado:0})):this.presupuestoForm.patchValue({total_estimado:l}),this.presupuestoForm.updateValueAndValidity(),console.log("Formulario despu\xE9s de calcular total:",{v\u00E1lido:this.presupuestoForm.valid,errores:this.presupuestoForm.errors,total_estimado:(x=this.presupuestoForm.get("total_estimado"))==null?void 0:x.value}),e||this.verificarEstadoMateriales()}limpiarMaterialesInvalidos(){console.log("Limpiando materiales inv\xE1lidos..."),console.log("Materiales antes de limpiar:",this.materiales),this.materiales=this.materiales.filter(e=>e.material_id&&e.cantidad_estimada>0&&e.precio_neto_al_momento>=0),console.log("Materiales despu\xE9s de limpiar:",this.materiales)}verificarMaterialesAntesDeGuardar(){console.log("=== Verificaci\xF3n de Materiales Antes de Guardar ==="),console.log("Cantidad de materiales:",this.materiales.length),console.log("Materiales:",this.materiales),console.log("Materiales v\xE1lidos:",this.materiales.filter(e=>e.material_id&&e.cantidad_estimada>0)),console.log("Materiales con precio v\xE1lido:",this.materiales.filter(e=>e.precio_neto_al_momento>0)),console.log("==================================================")}verificarFormulario(){var n,d,_,l;if(console.log("Verificando formulario..."),console.log("AvisoId actual:",this.avisoId),console.log("Modo edici\xF3n:",this.modoEdicion),console.log("PresupuestoId:",this.presupuestoId),!this.avisoId)return console.error("No hay avisoId"),!1;if(!this.presupuestoForm.valid)return console.error("Formulario inv\xE1lido"),console.log("Errores del formulario:",this.presupuestoForm.errors),console.log("Errores de horas_estimadas:",(n=this.presupuestoForm.get("horas_estimadas"))==null?void 0:n.errors),console.log("Errores de total_estimado:",(d=this.presupuestoForm.get("total_estimado"))==null?void 0:d.errors),!1;let e=(_=this.presupuestoForm.get("horas_estimadas"))==null?void 0:_.value,t=(l=this.presupuestoForm.get("total_estimado"))==null?void 0:l.value;return e<0||t<0?(console.error("Valores negativos no permitidos"),!1):(console.log("Formulario verificado correctamente"),!0)}guardarPresupuesto(){var e,t,n,d,_,l;if(console.log("Iniciando guardarPresupuesto..."),console.log("Formulario v\xE1lido:",this.presupuestoForm.valid),console.log("Aviso ID:",this.avisoId),console.log("Valores del formulario:",this.presupuestoForm.value),console.log("Materiales:",this.materiales),!this.verificarFormulario()){alert("Por favor, complete todos los campos requeridos correctamente");return}if(this.loading=!0,console.log("Iniciando operaci\xF3n de guardado..."),this.verificarMaterialesAntesDeGuardar(),this.limpiarMaterialesInvalidos(),this.modoEdicion&&this.presupuestoId){console.log("Modo edici\xF3n - actualizando presupuesto:",this.presupuestoId);let M={horas_estimadas:(e=this.presupuestoForm.get("horas_estimadas"))==null?void 0:e.value,total_estimado:(t=this.presupuestoForm.get("total_estimado"))==null?void 0:t.value,estado:(n=this.presupuestoForm.get("estado"))==null?void 0:n.value,materiales:this.materiales};console.log("Datos para actualizar:",M),console.log("Materiales a actualizar:",this.materiales),console.log("Cantidad de materiales:",this.materiales.length),console.log("Materiales detallados:",JSON.stringify(this.materiales,null,2)),this.presupuestosService.actualizarPresupuesto(this.presupuestoId,M).subscribe({next:x=>{console.log("Presupuesto actualizado exitosamente:",x),this.loading=!1,alert("\u2705 Presupuesto actualizado correctamente")},error:x=>{console.error("Error al actualizar presupuesto:",x),this.loading=!1,alert("Error al actualizar el presupuesto: "+(x.message||"Error desconocido"))}})}else{if(console.log("Modo creaci\xF3n - creando nuevo presupuesto"),!this.albaranesAviso||this.albaranesAviso.length===0){alert("Error: No se ha creado un albar\xE1n. Intente seleccionar el aviso nuevamente."),this.loading=!1;return}let M=this.albaranesAviso[0].id;console.log("Usando albar\xE1n ID:",M);let x={aviso_id:this.avisoId||"",albaran_id:M,horas_estimadas:(d=this.presupuestoForm.get("horas_estimadas"))==null?void 0:d.value,total_estimado:(_=this.presupuestoForm.get("total_estimado"))==null?void 0:_.value,estado:(l=this.presupuestoForm.get("estado"))==null?void 0:l.value,materiales:this.materiales};console.log("Datos para crear:",x),this.presupuestosService.crearPresupuesto(x).subscribe({next:h=>{console.log("Presupuesto creado exitosamente:",h),this.loading=!1,alert("\u2705 Presupuesto creado correctamente"),this.modoEdicion=!0,this.presupuestoId=h.id,this.presupuesto=h},error:h=>{console.error("Error al crear presupuesto:",h),this.loading=!1,alert("Error al crear el presupuesto: "+(h.message||"Error desconocido"))}})}}volver(){this.router.navigate(["/presupuestos"])}volverAlAviso(){this.avisoId?(console.log("\u{1F504} Volviendo al aviso:",this.avisoId),this.router.navigate(["/avisos",this.avisoId])):(console.warn("No hay avisoId para volver"),this.volver())}aprobarPresupuesto(){if(!this.modoEdicion||!this.presupuestoId){alert("Primero debes guardar el presupuesto antes de aprobarlo");return}confirm(`\xBFEst\xE1s seguro de que quieres aprobar este presupuesto?

Al aprobarlo:
\u2022 El presupuesto se marcar\xE1 como "Aprobado"
\u2022 El aviso cambiar\xE1 a "Listo para facturar"
\u2022 El albar\xE1n asociado cambiar\xE1 a "Finalizado"
\u2022 Esta acci\xF3n no se puede deshacer`)&&(this.loading=!0,this.presupuestosService.aprobarPresupuesto(this.presupuestoId).subscribe({next:t=>{console.log("Presupuesto aprobado exitosamente:",t),this.loading=!1,this.presupuesto.estado="Aprobado",this.presupuestoForm.patchValue({estado:"Aprobado"}),this.aviso&&(this.aviso.estado="Listo para facturar"),alert("Presupuesto aprobado correctamente. El aviso est\xE1 listo para facturar.")},error:t=>{console.error("Error al aprobar presupuesto:",t),this.loading=!1,alert("Error al aprobar el presupuesto: "+(t.message||"Error desconocido"))}}))}actualizarAlbaranAsociado(e){console.log("Actualizando albar\xE1n asociado:",e),this.supabaseClientService.getClient().from("albaranes").update({estado_cierre:"Finalizado",fecha_actualizacion:new Date().toISOString()}).eq("id",e).select().single().then(({data:t,error:n})=>{n?(console.error("Error al actualizar albar\xE1n:",n),alert("\u26A0\uFE0F Presupuesto aprobado, pero hubo un error al actualizar el albar\xE1n. Contacta al administrador.")):console.log("Albar\xE1n actualizado exitosamente:",t),this.finalizarAprobacion()})}finalizarAprobacion(){this.loading=!1,this.presupuestoForm.patchValue({estado:"Aprobado"}),alert("\u2705 Presupuesto aprobado exitosamente. El albar\xE1n ha sido marcado como finalizado.")}cargarAvisos(){console.log("\u{1F504} Iniciando carga de avisos..."),this.loadingAvisos=!0,this.errorAvisos=null,this.avisosService.getAvisos(1,1e3,"","fecha_creacion","desc","Pendiente").pipe(k(this.destroy$)).subscribe({next:e=>{this.avisos=e.avisos||[],this.avisosFiltrados=[...this.avisos],this.loadingAvisos=!1,console.log("\u2705 Avisos cargados exitosamente:",this.avisos.length),console.log("\u{1F4CB} Primeros 3 avisos:",this.avisos.slice(0,3)),this.avisos.length===0?console.log("\u26A0\uFE0F No se encontraron avisos"):console.log("\u{1F3AF} Selector de avisos listo para mostrar")},error:e=>{console.error("\u274C Error al cargar avisos:",e),this.errorAvisos="Error al cargar avisos: "+(e.message||"Error desconocido"),this.loadingAvisos=!1}})}filtrarAvisos(e){var n;let t=((n=e==null?void 0:e.target)==null?void 0:n.value)||e||"";this.busquedaAviso=t,t.trim()?this.avisosFiltrados=this.avisos.filter(d=>{var _,l;return((_=d.nombre_cliente_aviso)==null?void 0:_.toLowerCase().includes(t.toLowerCase()))||((l=d.descripcion_problema)==null?void 0:l.toLowerCase().includes(t.toLowerCase()))}):this.avisosFiltrados=[...this.avisos]}abrirSelectorAvisos(){if(this.modoEdicion){console.log("No se puede abrir selector de avisos en modo edici\xF3n");return}this.mostrarSelectorAvisos=!0,this.avisosFiltrados=[...this.avisos],this.busquedaAviso=""}cerrarSelectorAvisos(){this.mostrarSelectorAvisos=!1}seleccionarAviso(e){if(this.modoEdicion){console.log("No se puede cambiar el aviso en modo edici\xF3n");return}this.avisoId=e.id,this.aviso=e,this.cerrarSelectorAvisos(),this.materiales=[],this.calcularTotal(!0),console.log("Aviso seleccionado:",e),this.cargarAlbaranesAviso(e.id)}cargarAlbaranesAviso(e){console.log("Cargando albaranes para aviso:",e),this.crearAlbaranParaPresupuesto(e)}crearAlbaranParaPresupuesto(e){if(this.modoEdicion){console.log("No se puede crear albar\xE1n en modo edici\xF3n");return}let t={aviso_id:e,fecha_trabajo:new Date().toISOString().split("T")[0],hora_entrada:"09:00:00",hora_salida:"17:00:00",descripcion_trabajo_realizado:"Presupuesto pendiente - trabajo por realizar",estado_cierre:"Presupuesto pendiente",presupuesto_necesario:0};console.log("Creando albar\xE1n con datos:",t),this.supabaseClientService.getClient().from("albaranes").insert([t]).select().single().then(({data:n,error:d})=>{d?(console.error("Error al crear albar\xE1n:",d),alert("Error al crear albar\xE1n: "+d.message)):(console.log("Albar\xE1n creado exitosamente:",n),this.albaranesAviso=[n])})}generarUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}debugEstado(){var e,t;console.log("=== DEBUG ESTADO COMPONENTE ==="),console.log("avisoId:",this.avisoId),console.log("aviso:",this.aviso),console.log("loading:",this.loading),console.log("loadingAvisos:",this.loadingAvisos),console.log("errorAvisos:",this.errorAvisos),console.log("avisos.length:",(e=this.avisos)==null?void 0:e.length),console.log("avisosFiltrados.length:",(t=this.avisosFiltrados)==null?void 0:t.length),console.log("mostrarSelectorAvisos:",this.mostrarSelectorAvisos),console.log("modoEdicion:",this.modoEdicion),console.log("presupuestoId:",this.presupuestoId),console.log("================================")}};p.\u0275fac=function(t){return new(t||p)(E(ae),E(K),E(J),E(ke),E(me),E(ze),E(pe),E(ue))},p.\u0275cmp=q({type:p,selectors:[["app-crear-presupuesto"]],decls:12,vars:5,consts:[[1,"presupuesto-container"],[1,"page-header"],[1,"btn-back",3,"click"],["name","arrow-back-outline"],["class","loading-state",4,"ngIf"],["class","aviso-selector-section",4,"ngIf"],["class","aviso-info",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"loading-state"],[1,"loading-spinner"],["name","refresh-outline",1,"spinning"],[1,"aviso-selector-section"],["type","button",1,"btn-select-aviso",3,"click"],["name","list-outline"],["class","aviso-selector",4,"ngIf"],[1,"aviso-selector"],[1,"selector-header"],["type","button",1,"btn-close",3,"click"],["name","close"],[1,"search-container"],["type","text","placeholder","Buscar avisos por cliente o descripci\xF3n...",1,"search-input",3,"ngModelChange","input","ngModel"],["name","search-outline"],["class","loading-avisos",4,"ngIf"],["class","error-avisos",4,"ngIf"],["class","avisos-list",4,"ngIf"],["class","no-avisos",4,"ngIf"],[1,"loading-avisos"],[1,"error-avisos"],["name","alert-circle-outline"],[1,"avisos-list"],["class","aviso-item",3,"click",4,"ngFor","ngForOf"],[1,"aviso-item",3,"click"],[1,"aviso-info"],[1,"aviso-header"],[1,"aviso-id"],[1,"aviso-estado",3,"ngClass"],[1,"aviso-cliente"],[1,"aviso-details"],[1,"aviso-fecha"],[1,"aviso-descripcion"],[1,"no-avisos"],[1,"aviso-header-info"],["type","button",1,"btn-change-aviso",3,"click"],["name","refresh-outline"],[3,"ngSubmit","formGroup"],[1,"form-section"],[1,"form-group"],["type","number","formControlName","horas_estimadas","min","0","step","0.5","placeholder","0.0",3,"input"],["class","error-message",4,"ngIf"],["type","number","formControlName","total_estimado","min","0","step","0.01","placeholder","0.00"],[1,"section-header"],[1,"header-actions"],["type","button",1,"btn-select-inventory",3,"click"],["type","button",1,"btn-add",3,"click"],["name","add-circle-outline"],["class","inventory-selector",4,"ngIf"],["class","formulario-material-manual",4,"ngIf"],["class","materiales-list",4,"ngIf"],["class","no-materiales",4,"ngIf"],[1,"form-actions"],["type","button",1,"btn-secondary",3,"click"],["type","submit",1,"btn-primary",3,"disabled"],["name","save-outline"],["type","button","class","btn-success",3,"disabled","click",4,"ngIf"],["class","presupuesto-completado",4,"ngIf"],["class","presupuesto-rechazado",4,"ngIf"],["class","presupuesto-cancelado",4,"ngIf"],["class","form-status",4,"ngIf"],["class","aviso-info-status","style","background: #F0F9FF; border: 1px solid #BAE6FD; border-radius: 8px; padding: 16px; margin-top: 16px;",4,"ngIf"],[1,"error-message"],[4,"ngIf"],[1,"inventory-selector"],["type","text","placeholder","Buscar productos...",1,"search-input",3,"ngModelChange","input","ngModel"],["class","loading-products",4,"ngIf"],["class","error-products",4,"ngIf"],["class","products-list",4,"ngIf"],["class","no-products",4,"ngIf"],[1,"loading-products"],[1,"error-products"],[1,"products-list"],["class","product-item",3,"click",4,"ngFor","ngForOf"],[1,"product-item",3,"click"],[1,"product-info"],[1,"product-header"],[1,"product-code"],[1,"product-name"],[1,"product-details"],[1,"product-stock"],[1,"product-description"],[1,"product-price"],["name","add-circle-outline",1,"add-icon"],[1,"no-products"],["name","cube-outline"],[1,"formulario-material-manual"],[1,"formulario-header"],[1,"formulario-campos",3,"formGroup"],[1,"campo-input"],["type","text","formControlName","denominacion","placeholder","Denominaci\xF3n del material",1,"input-denominacion"],[1,"campo-cantidad"],["type","number","formControlName","cantidad","placeholder","Cantidad","min","1",1,"input-cantidad"],[1,"campo-precio"],["type","number","formControlName","precio","placeholder","Precio \u20AC","min","0","step","0.01",1,"input-precio"],["type","button",1,"btn-agregar",3,"click"],["name","checkmark-outline"],[1,"materiales-list"],[1,"costo-total"],["class","material-item-compacto",4,"ngFor","ngForOf"],[1,"material-item-compacto"],[1,"material-denominacion"],["type","number",1,"cantidad-input-compacto",3,"change","value","min"],["type","number","step","0.01",1,"precio-input-compacto",3,"input","value","min"],["type","button",1,"btn-remove-compacto",3,"click"],["name","trash-outline"],[1,"no-materiales"],["type","button",1,"btn-success",3,"click","disabled"],["name","checkmark-circle-outline"],[1,"presupuesto-completado"],[1,"presupuesto-rechazado"],["name","close-circle-outline"],[1,"presupuesto-cancelado"],["name","ban-outline"],[1,"form-status"],[1,"status-error"],[1,"aviso-info-status",2,"background","#F0F9FF","border","1px solid #BAE6FD","border-radius","8px","padding","16px","margin-top","16px"],[2,"margin","0 0 8px 0","color","#0C4A6E","font-size","14px"],["name","information-circle-outline",2,"margin-right","8px"],[2,"margin","0","color","#0C4A6E","font-size","13px"],[2,"margin","8px 0 0 0","color","#0C4A6E","font-size","13px"]],template:function(t,n){t&1&&(a(0,"ion-content")(1,"div",0)(2,"div",1)(3,"button",2),v("click",function(){return n.volver()}),g(4,"ion-icon",3),c(5," Volver "),r(),a(6,"h1"),c(7),r()(),P(8,Ae,5,0,"div",4)(9,Be,9,1,"div",5)(10,Le,15,3,"div",6)(11,mt,43,18,"form",7),r()()),t&2&&(s(7),O(n.modoEdicion?"Editar Presupuesto":"Crear Presupuesto"),s(),u("ngIf",n.loading&&n.modoEdicion),s(),u("ngIf",!n.aviso&&!n.loading&&!n.modoEdicion),s(),u("ngIf",n.aviso&&!n.loading),s(),u("ngIf",n.aviso))},dependencies:[Y,U,$,R,H,W,ce,te,Q,oe,X,Z,re,ne,ie,se,ee,le,de],styles:['@charset "UTF-8";ion-content[_ngcontent-%COMP%]{--background: #fff}.loading-state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{text-align:center;color:#64748b}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:16px;color:#cbd5e0}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;margin:0}.presupuesto-container[_ngcontent-%COMP%]{margin:0 auto;padding:20px;background-color:#fff}.page-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:24px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#1a202c;margin:0}.btn-back[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:#f7fafc;border:1px solid #e2e8f0;border-radius:8px;color:#4a5568;text-decoration:none;cursor:pointer;transition:all .2s}.btn-back[_ngcontent-%COMP%]:hover{background:#edf2f7;border-color:#cbd5e0}.btn-back[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.aviso-info[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;padding:20px;margin-bottom:15px}.aviso-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#2d3748;margin:0 0 12px}.aviso-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;color:#4a5568}.aviso-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#2d3748}.form-section[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:24px;margin-bottom:20px}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#2d3748;margin:0 0 20px}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:between;align-items:center;margin-bottom:20px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;flex:1}.form-group[_ngcontent-%COMP%]{margin-bottom:16px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#4a5568;margin-bottom:6px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #e2e8f0;border-radius:6px;font-size:14px;color:#2d3748;background:#fff;transition:border-color .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 3px #4f46e51a}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]::placeholder{color:#a0aec0}.form-group[_ngcontent-%COMP%]   input.ng-invalid.ng-touched[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#e53e3e;box-shadow:0 0 0 3px #e53e3e1a}.form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:pointer}.form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{padding:8px}.form-group[_ngcontent-%COMP%]   select[formControlName=estado][_ngcontent-%COMP%]{font-weight:500}.form-group[_ngcontent-%COMP%]   select[formControlName=estado][_ngcontent-%COMP%]   option[value=Pendiente][_ngcontent-%COMP%]{color:#f59e0b}.form-group[_ngcontent-%COMP%]   select[formControlName=estado][_ngcontent-%COMP%]   option[value=Aprobado][_ngcontent-%COMP%]{color:#10b981}.form-group[_ngcontent-%COMP%]   select[formControlName=estado][_ngcontent-%COMP%]   option[value=Rechazado][_ngcontent-%COMP%]{color:#ef4444}.form-group[_ngcontent-%COMP%]   select[formControlName=estado][_ngcontent-%COMP%]   option[value=Cancelado][_ngcontent-%COMP%]{color:#6b7280}.form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{margin-top:4px;font-size:12px;color:#e53e3e}.form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}.btn-add[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:#4f46e5;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:background .2s}.btn-add[_ngcontent-%COMP%]:hover{background:#4338ca}.btn-add[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.materiales-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.material-item[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:flex-start;padding:16px;background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px}.material-fields[_ngcontent-%COMP%]{display:flex;gap:12px;flex:1}.material-fields[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:8px 12px;border:1px solid #e2e8f0;border-radius:6px;font-size:13px}.material-fields[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#4f46e5}.btn-remove[_ngcontent-%COMP%]{padding:8px;background:#fed7d7;color:#e53e3e;border:none;border-radius:6px;cursor:pointer;transition:background .2s}.btn-remove[_ngcontent-%COMP%]:hover{background:#feb2b2}.btn-remove[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.no-materiales[_ngcontent-%COMP%]{text-align:center;color:#a0aec0;font-style:italic;padding:20px}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end;margin-top:24px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px 24px;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:8px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#4a5568;border:1px solid #e2e8f0}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#f7fafc;border-color:#cbd5e0}.btn-primary[_ngcontent-%COMP%]{background:#4f46e5;color:#fff;border:1px solid #4f46e5}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#4338ca;border-color:#4338ca}.btn-primary[_ngcontent-%COMP%]:disabled{background:#a0aec0;border-color:#a0aec0;cursor:not-allowed;opacity:.6}.btn-primary.btn-disabled[_ngcontent-%COMP%]{background:#a0aec0;border-color:#a0aec0;cursor:not-allowed;opacity:.6}.btn-primary[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.btn-success[_ngcontent-%COMP%]{background:#10b981;color:#fff;border:1px solid #10B981;padding:12px 24px;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:8px}.btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background:#059669;border-color:#059669}.btn-success[_ngcontent-%COMP%]:disabled{background:#a0aec0;border-color:#a0aec0;cursor:not-allowed;opacity:.6}.btn-success[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.presupuesto-completado[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 24px;background:#ecfdf5;color:#065f46;border:1px solid #D1FAE5;border-radius:8px;font-size:14px;font-weight:500}.presupuesto-completado[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;color:#10b981}.presupuesto-rechazado[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 24px;background:#fef2f2;color:#991b1b;border:1px solid #FECACA;border-radius:8px;font-size:14px;font-weight:500}.presupuesto-rechazado[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;color:#ef4444}.presupuesto-cancelado[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 24px;background:#f3f4f6;color:#374151;border:1px solid #D1D5DB;border-radius:8px;font-size:14px;font-weight:500}.presupuesto-cancelado[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;color:#6b7280}.form-status[_ngcontent-%COMP%]{margin-top:12px;padding:12px;border-radius:6px}.form-status[_ngcontent-%COMP%]   .status-error[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#e53e3e;background:#fed7d7;padding:8px 12px;border-radius:4px;border-left:4px solid #e53e3e}.inventory-selector[_ngcontent-%COMP%]{background:#fff;padding:0;margin-bottom:15px;max-height:400px;overflow:hidden;display:flex;flex-direction:column}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:5px}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#1f2937;font-size:16px;font-weight:600}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;font-size:20px;cursor:pointer;padding:4px;border-radius:4px;transition:all .2s}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{position:relative;margin-bottom:5px}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:12px 40px 12px 16px;border:1px solid #D1D5DB;border-radius:8px;font-size:14px;background:#f9fafb}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;background:#fff;box-shadow:0 0 0 3px #3b82f61a}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#9ca3af;font-size:18px}.inventory-selector[_ngcontent-%COMP%]   .loading-products[_ngcontent-%COMP%], .inventory-selector[_ngcontent-%COMP%]   .error-products[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:40px 20px;color:#6b7280;font-size:14px}.inventory-selector[_ngcontent-%COMP%]   .loading-products[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .inventory-selector[_ngcontent-%COMP%]   .error-products[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:8px;font-size:20px}.inventory-selector[_ngcontent-%COMP%]   .loading-products.spinning[_ngcontent-%COMP%], .inventory-selector[_ngcontent-%COMP%]   .error-products.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.inventory-selector[_ngcontent-%COMP%]   .error-products[_ngcontent-%COMP%]{color:#dc2626}.inventory-selector[_ngcontent-%COMP%]   .error-products[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#dc2626}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;border:1px solid #E5E7EB;border-radius:8px;background:#f9fafb}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px;border-bottom:1px solid #E5E7EB;cursor:pointer;transition:all .2s}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-price[_ngcontent-%COMP%]{font-weight:600;color:#059669;font-size:13px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]{flex:1}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]   .product-code[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;background:#e5e7eb;padding:2px 6px;border-radius:4px;font-weight:500}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]   .product-price[_ngcontent-%COMP%]{font-weight:600;color:#059669;font-size:13px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;font-size:13px;margin-bottom:4px;display:block}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-stock[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-description[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .add-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:20px;margin-left:12px}.inventory-selector[_ngcontent-%COMP%]   .no-products[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.inventory-selector[_ngcontent-%COMP%]   .no-products[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#d1d5db;margin-bottom:12px}.inventory-selector[_ngcontent-%COMP%]   .no-products[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.header-actions[_ngcontent-%COMP%]   .btn-select-inventory[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;border:none;padding:8px 16px;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;display:flex;align-items:center;gap:6px;transition:all .2s}.header-actions[_ngcontent-%COMP%]   .btn-select-inventory[_ngcontent-%COMP%]:hover{background:#2563eb}.header-actions[_ngcontent-%COMP%]   .btn-select-inventory[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.materiales-list[_ngcontent-%COMP%]{margin-top:20px}.materiales-list[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:#1f2937;font-size:16px;font-weight:600}.materiales-list[_ngcontent-%COMP%]   .costo-total[_ngcontent-%COMP%]{margin-bottom:16px;padding:12px 16px;background:#f0f9ff;border:1px solid #BAE6FD;border-radius:8px;text-align:center}.materiales-list[_ngcontent-%COMP%]   .costo-total[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#0369a1;font-size:16px}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px 12px;background:#f0f9ff;border:1px solid #BAE6FD;border-radius:6px;margin-bottom:6px;width:100%}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]   .material-denominacion[_ngcontent-%COMP%]{flex:1;font-weight:500;color:#0369a1;font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]   .cantidad-input-compacto[_ngcontent-%COMP%]{width:50px;padding:4px 6px;border:1px solid #D1D5DB;border-radius:4px;font-size:12px;text-align:center;background-color:#fafafb;color:#111827}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]   .precio-input-compacto[_ngcontent-%COMP%]{width:70px;padding:4px 6px;border:1px solid #D1D5DB;border-radius:4px;font-size:12px;text-align:center;background-color:#fafafb;color:#111827}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]   .btn-remove-compacto[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626;border:none;padding:4px;border-radius:4px;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;width:28px;height:28px}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]   .btn-remove-compacto[_ngcontent-%COMP%]:hover{background:#fecaca}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]   .btn-remove-compacto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.formulario-material-manual[_ngcontent-%COMP%]{background:#fff;border:1px solid #E2E8F0;border-radius:8px;padding:16px;margin-bottom:16px;box-shadow:0 1px 3px #0000001a}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#1f2937;font-size:14px;font-weight:600}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;font-size:16px;cursor:pointer;padding:2px;border-radius:4px;transition:all .2s}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-input[_ngcontent-%COMP%]{flex:1}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-input[_ngcontent-%COMP%]   .input-denominacion[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #D1D5DB;border-radius:6px;font-size:14px;background-color:#fafafb;color:#111827;transition:border-color .2s}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-input[_ngcontent-%COMP%]   .input-denominacion[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-input[_ngcontent-%COMP%]   .input-denominacion[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-cantidad[_ngcontent-%COMP%]   .input-cantidad[_ngcontent-%COMP%]{width:60px;padding:8px 6px;border:1px solid #D1D5DB;border-radius:6px;font-size:14px;text-align:center;background-color:#fafafb;color:#111827;transition:border-color .2s}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-cantidad[_ngcontent-%COMP%]   .input-cantidad[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-cantidad[_ngcontent-%COMP%]   .input-cantidad[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-precio[_ngcontent-%COMP%]   .input-precio[_ngcontent-%COMP%]{width:70px;padding:8px 6px;border:1px solid #D1D5DB;border-radius:6px;font-size:14px;text-align:center;background-color:#fafafb;color:#111827;transition:border-color .2s}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-precio[_ngcontent-%COMP%]   .input-precio[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-precio[_ngcontent-%COMP%]   .input-precio[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .btn-agregar[_ngcontent-%COMP%]{background:#10b981;color:#fff;border:none;padding:8px;border-radius:6px;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;width:36px;height:36px}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .btn-agregar[_ngcontent-%COMP%]:hover{background:#059669}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .btn-agregar[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.aviso-selector-section[_ngcontent-%COMP%]{padding:0;margin-bottom:24px}.aviso-selector-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#1f2937;font-size:16px;font-weight:600;margin:0 0 8px}.aviso-selector-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin:0 0 20px;font-size:14px}.aviso-selector-section[_ngcontent-%COMP%]   .btn-select-aviso[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;background:#3b82f6;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s}.aviso-selector-section[_ngcontent-%COMP%]   .btn-select-aviso[_ngcontent-%COMP%]:hover{background:#2563eb;transform:translateY(-1px)}.aviso-selector-section[_ngcontent-%COMP%]   .btn-select-aviso[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.aviso-selector[_ngcontent-%COMP%]{margin-top:20px}.aviso-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.aviso-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#1f2937;font-size:16px;font-weight:600}.aviso-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;font-size:20px;cursor:pointer;padding:4px;border-radius:4px;transition:all .2s}.aviso-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.aviso-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.aviso-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:12px 40px 12px 16px;border:1px solid #D1D5DB;border-radius:8px;font-size:14px;background:#f9fafb}.aviso-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;background:#fff;box-shadow:0 0 0 3px #3b82f61a}.aviso-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:#9ca3af;font-size:18px}.aviso-selector[_ngcontent-%COMP%]   .loading-avisos[_ngcontent-%COMP%], .aviso-selector[_ngcontent-%COMP%]   .error-avisos[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:40px 20px;color:#6b7280;font-size:14px}.aviso-selector[_ngcontent-%COMP%]   .loading-avisos[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .aviso-selector[_ngcontent-%COMP%]   .error-avisos[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:8px;font-size:20px}.aviso-selector[_ngcontent-%COMP%]   .loading-avisos.spinning[_ngcontent-%COMP%], .aviso-selector[_ngcontent-%COMP%]   .error-avisos.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.aviso-selector[_ngcontent-%COMP%]   .error-avisos[_ngcontent-%COMP%]{color:#dc2626}.aviso-selector[_ngcontent-%COMP%]   .error-avisos[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#dc2626}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]{overflow-y:auto;border-radius:8px;padding:0;margin:0}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;cursor:pointer;transition:all .2s}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]   .aviso-info[_ngcontent-%COMP%]{flex:1}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]   .aviso-info[_ngcontent-%COMP%]   .aviso-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]   .aviso-info[_ngcontent-%COMP%]   .aviso-header[_ngcontent-%COMP%]   .aviso-id[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;background:#e5e7eb;padding:2px 6px;border-radius:4px;font-weight:500}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]   .aviso-info[_ngcontent-%COMP%]   .aviso-header[_ngcontent-%COMP%]   .aviso-estado[_ngcontent-%COMP%]{font-size:11px;padding:2px 8px;border-radius:12px;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]   .aviso-info[_ngcontent-%COMP%]   .aviso-header[_ngcontent-%COMP%]   .aviso-estado.estado-pendiente[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]   .aviso-info[_ngcontent-%COMP%]   .aviso-header[_ngcontent-%COMP%]   .aviso-estado.estado-en-curso[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]   .aviso-info[_ngcontent-%COMP%]   .aviso-header[_ngcontent-%COMP%]   .aviso-estado.estado-completado[_ngcontent-%COMP%]{background:#d1fae5;color:#059669}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]   .aviso-info[_ngcontent-%COMP%]   .aviso-cliente[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;font-size:14px;margin-bottom:4px;display:block}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]   .aviso-info[_ngcontent-%COMP%]   .aviso-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]   .aviso-info[_ngcontent-%COMP%]   .aviso-details[_ngcontent-%COMP%]   .aviso-fecha[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]   .aviso-info[_ngcontent-%COMP%]   .aviso-details[_ngcontent-%COMP%]   .aviso-descripcion[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:300px}.aviso-selector[_ngcontent-%COMP%]   .avisos-list[_ngcontent-%COMP%]   .aviso-item[_ngcontent-%COMP%]   .select-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:20px;margin-left:12px}.aviso-selector[_ngcontent-%COMP%]   .no-avisos[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.aviso-selector[_ngcontent-%COMP%]   .no-avisos[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#d1d5db;margin-bottom:12px}.aviso-selector[_ngcontent-%COMP%]   .no-avisos[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.aviso-header-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.aviso-header-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:16px!important;font-weight:600;color:#1f2937}.aviso-header-info[_ngcontent-%COMP%]   .btn-change-aviso[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:#f3f4f6;color:#6b7280;border:1px solid #D1D5DB;border-radius:6px;font-size:12px;font-weight:500;cursor:pointer;transition:all .2s}.aviso-header-info[_ngcontent-%COMP%]   .btn-change-aviso[_ngcontent-%COMP%]:hover{background:#e5e7eb;color:#374151}.aviso-header-info[_ngcontent-%COMP%]   .btn-change-aviso[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.presupuesto-container[_ngcontent-%COMP%]{padding:16px}.page-header[_ngcontent-%COMP%]{margin-bottom:16px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:18px!important}.form-section[_ngcontent-%COMP%]{padding:16px}.section-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.material-fields[_ngcontent-%COMP%]{flex-direction:column}.material-fields[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{flex-direction:column}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]{max-height:250px}.materiales-list[_ngcontent-%COMP%]   .material-item[_ngcontent-%COMP%]   .material-fields[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.header-actions[_ngcontent-%COMP%]{flex-direction:column;gap:8px;width:100%}.header-actions[_ngcontent-%COMP%]   .btn-select-inventory[_ngcontent-%COMP%], .header-actions[_ngcontent-%COMP%]   .btn-add[_ngcontent-%COMP%]{width:100%;justify-content:center}.formulario-material-manual[_ngcontent-%COMP%]{padding:12px;margin-bottom:12px}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]{flex-direction:row;gap:8px}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-input[_ngcontent-%COMP%]{width:100%}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-input[_ngcontent-%COMP%]   .input-denominacion[_ngcontent-%COMP%]{font-size:16px;padding:10px 12px}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-cantidad[_ngcontent-%COMP%]{align-self:flex-start}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-cantidad[_ngcontent-%COMP%]   .input-cantidad[_ngcontent-%COMP%]{width:40px;font-size:16px;padding:10px 6px}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-precio[_ngcontent-%COMP%]{align-self:flex-start}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-precio[_ngcontent-%COMP%]   .input-precio[_ngcontent-%COMP%]{width:40px;font-size:16px;padding:10px 6px}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .btn-agregar[_ngcontent-%COMP%]{align-self:flex-end;width:40px;height:43px}.formulario-material-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .btn-agregar[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]{padding:6px 8px;gap:8px}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]   .material-denominacion[_ngcontent-%COMP%]{font-size:13px}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]   .cantidad-input-compacto[_ngcontent-%COMP%]{width:45px;font-size:12px}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]   .precio-input-compacto[_ngcontent-%COMP%]{width:60px;font-size:12px}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]   .btn-remove-compacto[_ngcontent-%COMP%]{width:24px;height:24px}.materiales-list[_ngcontent-%COMP%]   .material-item-compacto[_ngcontent-%COMP%]   .btn-remove-compacto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:10px}}']});let i=p;return i})();export{St as CrearPresupuestoComponent};
