import{$ as H,E as U,Ga as J,a as B}from"./chunk-CPCGS7XX.js";import{a as K}from"./chunk-DKQ7PFJV.js";import{a as V}from"./chunk-ZLE3SS2Y.js";import{h as q,i as L,j as T,r as G,s as R,w as $}from"./chunk-7RXHQH5K.js";import{Ac as D,Ca as n,Da as x,Ea as E,S as v,X as s,Y as m,_ as k,bc as y,c as P,cc as S,ec as c,fb as w,fc as F,gc as I,ha as h,la as e,lc as z,ma as t,na as l,pc as N,qc as j,sa as p,u as O,yc as A,z as C}from"./chunk-QQQKELKR.js";import{k as u}from"./chunk-CRC5ZNR6.js";var le=(()=>{let d=class d{constructor(i,r,o,a,g){this.fb=i,this.modalController=r,this.viewportService=o,this.elementRef=a,this.unifiedReconnectionService=g,this.modo="crear",this.destroy$=new P,this.clienteForm=this.fb.group({nombreContacto:["",c.required],telefono:["",c.required],correoElectronico:["",[c.required,c.email]],cif:["",c.required],direccionLocal:["",c.required],codigoPostal:["",c.required],localidad:["",c.required],esActivo:[!0,c.required]})}ngOnInit(){B({closeOutline:U,saveOutline:J,informationCircleOutline:H}),this.unifiedReconnectionService.appResumed.pipe(C(this.destroy$),O()).subscribe(i=>{i&&(console.log("\u{1F504} CrearClienteModalComponent: App reanudada, recargando datos..."),this.modo==="editar"&&this.cliente&&this.cargarDatosCliente())}),this.unifiedReconnectionService.connectionState.pipe(C(this.destroy$)).subscribe(i=>{console.log("\u{1F504} CrearClienteModalComponent: Estado de conexi\xF3n:",i),i==="connected"&&this.modo==="editar"&&this.cliente&&this.cargarDatosCliente()}),this.modo==="editar"&&this.cliente&&this.cargarDatosCliente()}ngAfterViewInit(){}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarDatosCliente(){var _;if(!this.cliente)return;let i=this.cliente.direccion||"",r=i.split(", "),o="",a="",g="";if(r.length>=2){o=r[0];let M=r[r.length-1],b=M.split(" ");b.length>=2?(a=b[0],g=b.slice(1).join(" ")):g=M}else o=i;this.clienteForm.patchValue({nombreContacto:this.cliente.nombre_completo||"",telefono:this.cliente.telefono_contacto||"",correoElectronico:this.cliente.email||"",cif:this.cliente.cif||"",direccionLocal:o,codigoPostal:a,localidad:g,esActivo:(_=this.cliente.es_activo)!=null?_:!0})}guardarCliente(){return u(this,null,function*(){var i;if(this.clienteForm.valid){this.clienteForm.disable();let r={nombre_completo:this.clienteForm.value.nombreContacto,telefono_contacto:this.clienteForm.value.telefono,email:this.clienteForm.value.correoElectronico,cif:this.clienteForm.value.cif,direccion:`${this.clienteForm.value.direccionLocal}, ${this.clienteForm.value.codigoPostal} ${this.clienteForm.value.localidad}`,nivel_urgencia_habitual:((i=this.cliente)==null?void 0:i.nivel_urgencia_habitual)||"Media",es_activo:this.clienteForm.value.esActivo};yield this.modalController.dismiss(r,"confirm")}})}cerrarModal(){return u(this,null,function*(){yield this.modalController.dismiss(null,"cancel")})}get tituloModal(){return this.modo==="editar"?"Editar cliente":"A\xF1adir nuevo cliente"}get subtituloModal(){return this.modo==="editar"?"Modifica los datos del cliente":"A\xF1ade un nuevo cliente"}get textoBotonGuardar(){return this.modo==="editar"?"Guardar cambios":"Guardar cliente"}get botonDeshabilitado(){return!this.clienteForm.valid||this.clienteForm.disabled}};d.\u0275fac=function(r){return new(r||d)(m(A),m(R),m(K),m(v),m(V))},d.\u0275cmp=k({type:d,selectors:[["app-crear-cliente-modal"]],inputs:{modo:"modo",cliente:"cliente"},decls:113,vars:5,consts:[[1,"header-content"],[1,"close-button",3,"click"],["name","close-outline"],[1,"subtitle"],[1,"modal-body"],[1,"modal-content",3,"ngSubmit","formGroup"],[1,"modal-grid"],[1,"form-section"],[1,"form-group"],[1,"required"],["type","text","formControlName","nombreContacto","placeholder","Ej: Luis P\xE9rez",1,"form-control"],[1,"form-row"],[1,"form-group","half"],["type","tel","formControlName","telefono","placeholder","Ej: +34 569 23 56 89",1,"form-control"],["type","email","formControlName","correoElectronico","placeholder","Ej: ejemplo@dominio.es",1,"form-control"],["type","text","formControlName","cif","placeholder","Ej: 12345678A o B12345678",1,"form-control"],["type","text","formControlName","direccionLocal","placeholder","Ej: Calle Azorin",1,"form-control"],["type","text","formControlName","codigoPostal","placeholder","28004",1,"form-control"],["type","text","formControlName","localidad","placeholder","Ej: Madrid",1,"form-control"],[1,"form-group","checkbox-group"],[1,"checkbox-container"],["type","checkbox","formControlName","esActivo"],[1,"checkbox-label"],[1,"helper-text"],[1,"info-section"],[1,"info-card"],["name","information-circle-outline"],[1,"info-details"],[1,"info-item"],[1,"info-label"],[1,"info-value"],[1,"button-group"],["type","button",1,"btn","btn-outline",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["name","save-outline"]],template:function(r,o){r&1&&(e(0,"ion-header")(1,"ion-toolbar")(2,"div",0)(3,"h2"),n(4),t(),e(5,"button",1),p("click",function(){return o.cerrarModal()}),l(6,"ion-icon",2),t()(),e(7,"p",3),n(8),t()()(),e(9,"ion-content",4)(10,"form",5),p("ngSubmit",function(){return o.guardarCliente()}),e(11,"div",6)(12,"div",7)(13,"div",8)(14,"label"),n(15,"Nombre de contacto "),e(16,"span",9),n(17,"*"),t()(),l(18,"input",10),t(),e(19,"div",11)(20,"div",12)(21,"label"),n(22,"Tel\xE9fono "),e(23,"span",9),n(24,"*"),t()(),l(25,"input",13),t(),e(26,"div",12)(27,"label"),n(28,"Correo electr\xF3nico "),e(29,"span",9),n(30,"*"),t()(),l(31,"input",14),t()(),e(32,"div",8)(33,"label"),n(34,"CIF/NIF "),e(35,"span",9),n(36,"*"),t()(),l(37,"input",15),t(),e(38,"div",8)(39,"label"),n(40,"Direcci\xF3n local "),e(41,"span",9),n(42,"*"),t()(),l(43,"input",16),t(),e(44,"div",11)(45,"div",12)(46,"label"),n(47,"C\xF3digo Postal "),e(48,"span",9),n(49,"*"),t()(),l(50,"input",17),t(),e(51,"div",12)(52,"label"),n(53,"Localidad "),e(54,"span",9),n(55,"*"),t()(),l(56,"input",18),t()(),e(57,"div",19)(58,"label",20),l(59,"input",21),e(60,"span",22),n(61,"Cliente activo"),t()(),e(62,"span",23),n(63,"Los clientes inactivos no aparecer\xE1n en las b\xFAsquedas principales"),t()()(),e(64,"div",24)(65,"div",25),l(66,"ion-icon",26),e(67,"h4"),n(68,"Informaci\xF3n del cliente"),t(),e(69,"p"),n(70,"Completa todos los campos obligatorios marcados con "),e(71,"span",9),n(72,"*"),t(),n(73," para crear el cliente."),t(),e(74,"div",27)(75,"div",28)(76,"span",29),n(77,"Nombre:"),t(),e(78,"span",30),n(79,"Nombre completo del contacto"),t()(),e(80,"div",28)(81,"span",29),n(82,"Tel\xE9fono:"),t(),e(83,"span",30),n(84,"N\xFAmero de contacto principal"),t()(),e(85,"div",28)(86,"span",29),n(87,"Email:"),t(),e(88,"span",30),n(89,"Correo electr\xF3nico v\xE1lido"),t()(),e(90,"div",28)(91,"span",29),n(92,"CIF/NIF:"),t(),e(93,"span",30),n(94,"Identificaci\xF3n fiscal"),t()(),e(95,"div",28)(96,"span",29),n(97,"Direcci\xF3n:"),t(),e(98,"span",30),n(99,"Calle, c\xF3digo postal y localidad"),t()(),e(100,"div",28)(101,"span",29),n(102,"Estado:"),t(),e(103,"span",30),n(104,"Cliente activo o inactivo"),t()()()()()()()(),e(105,"ion-footer")(106,"ion-toolbar")(107,"div",31)(108,"button",32),p("click",function(){return o.cerrarModal()}),n(109," Cancelar "),t(),e(110,"button",33),p("click",function(){return o.guardarCliente()}),n(111),l(112,"ion-icon",34),t()()()()),r&2&&(s(4),x(o.tituloModal),s(4),x(o.subtituloModal),s(2),h("formGroup",o.clienteForm),s(100),h("disabled",o.botonDeshabilitado),s(),E(" ",o.textoBotonGuardar," "))},dependencies:[$,w,D,z,S,y,F,I,N,j,T,G,q,L],styles:['@charset "UTF-8";ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #fff;--border-color: #e5e7eb;--color: #111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600;color:#111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#6b7280;margin-top:0;font-size:14px}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#6b7280;display:flex;align-items:center;justify-content:center}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px}ion-content[_ngcontent-%COMP%]{--background: #fff;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}ion-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex;flex-direction:column;min-height:0}ion-content[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{flex:1;overflow:auto;position:relative;min-height:0;height:100%}ion-content[_ngcontent-%COMP%]   .modal-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:0;height:100%;overflow:hidden}@media (max-width: 768px){ion-content[_ngcontent-%COMP%]   .modal-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto auto;height:auto;overflow:visible}}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #fff;--border-color: #e5e7eb}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:6px;font-size:14px;font-weight:500;display:flex;align-items:center;gap:8px;cursor:pointer;transition:all .2s}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{background:none;border:1px solid #d1d5db;color:#374151}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f8fafc;border-color:#9ca3af}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#2563eb;border:1px solid #2563eb;color:#fff}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#1d4ed8;border-color:#1d4ed8}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:disabled{background-color:#9ca3af;border-color:#9ca3af;cursor:not-allowed;opacity:.6}.form-section[_ngcontent-%COMP%]{padding:24px;border-right:1px solid #e5e7eb;overflow-y:auto;height:100%;max-height:100%}@media (max-width: 768px){.form-section[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e5e7eb;height:auto;max-height:none;overflow:visible;padding-bottom:30px}}.form-section[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#d1d5db #f3f4f6}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f3f4f6;border-radius:3px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:3px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}.info-section[_ngcontent-%COMP%]{padding:24px;background-color:#f9fafb;overflow-y:auto;height:100%;max-height:100%}@media (max-width: 768px){.info-section[_ngcontent-%COMP%]{height:auto;max-height:none;overflow:visible;min-height:300px;padding-bottom:80px}}.info-section[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#d1d5db #f3f4f6}.info-section[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.info-section[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f3f4f6;border-radius:3px}.info-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:3px}.info-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:14px;font-weight:500;color:#374151}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#dc2626}.form-control[_ngcontent-%COMP%]{position:relative;width:100%;padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px;color:#111827;background-color:#fff;transition:border-color .2s}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 2px #2563eb1a}.form-control[_ngcontent-%COMP%]:disabled{background-color:#f9fafb;color:#6b7280;cursor:not-allowed}.form-control[_ngcontent-%COMP%]::placeholder{color:#9ca3af}input.form-control[_ngcontent-%COMP%]{padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s}input.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}textarea.form-control[_ngcontent-%COMP%]{position:relative;padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s;resize:vertical;min-height:80px}textarea.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}.character-count[_ngcontent-%COMP%]{margin-top:4px;text-align:right;font-size:12px;color:#6b7280;position:absolute;bottom:13px;right:13px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px}.form-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:0;flex:1}.checkbox-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.checkbox-group[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer}.checkbox-group[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:16px;height:16px;margin:0;accent-color:#4F46E5;cursor:pointer}.checkbox-group[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]{font-size:14px;color:#374151}.checkbox-group[_ngcontent-%COMP%]   .helper-text[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin-left:24px}.info-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;padding:24px;border:1px solid #e5e7eb;text-align:center}.info-card[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#6b7280;margin-bottom:16px}.info-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:18px;color:#374151;font-weight:600}.info-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 24px;font-size:14px;color:#6b7280;line-height:1.5}.info-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#dc2626}.info-details[_ngcontent-%COMP%]{text-align:left}.info-details[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #f3f4f6}.info-details[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.info-details[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#374151}.info-details[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;text-align:right;max-width:60%}@media (max-width: 768px){.modal-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto;height:auto;overflow:visible}.form-section[_ngcontent-%COMP%]{border-right:none;border-bottom:none;height:auto;max-height:none;overflow:visible;padding-bottom:30px}.info-section[_ngcontent-%COMP%]{display:none}.form-control[_ngcontent-%COMP%]{font-size:16px;padding:12px}textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{font-size:14px!important;padding:12px}}']});let f=d;return f})();export{le as a};
