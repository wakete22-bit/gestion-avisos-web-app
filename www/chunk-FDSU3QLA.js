import{a as $n}from"./chunk-T6PGVI32.js";import{a as je}from"./chunk-RP6VPHKN.js";import"./chunk-FK6H3RFT.js";import{a as Nn}from"./chunk-NYHYW7MJ.js";import"./chunk-UG5ATQHO.js";import{a as Te}from"./chunk-XEVZMQZH.js";import"./chunk-5JOXGAFT.js";import{a as at}from"./chunk-SFQ52NF6.js";import{a as Rn}from"./chunk-SWPOI2FM.js";import"./chunk-CEBXDJYS.js";import"./chunk-5YRB7RVB.js";import{a as An}from"./chunk-4XNYWQEP.js";import{$ as Dn,A as Ue,B as qe,Ba as Ke,C as q,Da as nt,E as Ge,Ea as N,Ga as et,H as Ye,Ha as tt,J as cn,K as Tn,N as nn,P as Pn,Qa as ln,R as We,S as Xe,Sa as on,U as Vn,Va as dn,X as Ze,_ as Qe,a as V,aa as Je,b as Ve,c as De,d as Ne,f as Re,ga as ne,h as Jn,ia as ee,j as $e,la as te,m as He,o as Fn,q as jn,r as Kn,ra as On,ta as oe,va as sn,w as K,x as Be,y as Le}from"./chunk-CPCGS7XX.js";import{a as ot}from"./chunk-73QYT6MQ.js";import"./chunk-WLL4S5XO.js";import"./chunk-STXSJFLK.js";import{h as kn,i as zn,j as Sn,r as In,s as J,w as U,x as Ae}from"./chunk-YOFVTXCH.js";import"./chunk-LKFRID77.js";import{b as Fe}from"./chunk-A72QMOGB.js";import{H as be,J as T,K as Ce,L as Me,P as Pe,Q as Oe,R as xe,U as he,V as ve,W as ye,X as we,Y as Ee,_ as ke,ba as ze,ca as Se,da as Ie}from"./chunk-TWOPYUJN.js";import{A as D,Ca as Gn,Ea as fn,Eb as fe,F as yn,Fa as bn,Ga as Cn,Hb as rn,I as _n,Ia as s,Ja as M,Ka as F,La as tn,N as P,Na as Yn,O,Oa as Wn,Pa as Xn,S as de,Sa as pe,Ta as Zn,Xa as A,Y as $,Ya as Qn,Za as Mn,_ as l,_a as Z,ba as z,c as vn,da as H,f as I,ha as h,i as le,j as W,kb as an,lb as Q,m as qn,mb as B,na as g,oa as wn,ob as me,pa as ge,pb as ue,qb as _e,ra as o,rb as En,s as X,sa as a,sb as L,ta as p,xa as v,ya as _,z as en,za as m}from"./chunk-4AY4VQCP.js";import"./chunk-3SUPCH3T.js";import"./chunk-QUJFQN2Y.js";import"./chunk-OGR5ZLHR.js";import"./chunk-CUT3BV6K.js";import"./chunk-73IMGLZG.js";import"./chunk-G2E2NLL6.js";import"./chunk-ILJSYHS4.js";import"./chunk-OAP23YNX.js";import"./chunk-YYM7CL2V.js";import"./chunk-5LR2YXX6.js";import"./chunk-WDU4QEMV.js";import"./chunk-CKP3SGE2.js";import"./chunk-ULLEADC5.js";import"./chunk-2ELISCRH.js";import"./chunk-BV4CTHEE.js";import"./chunk-JILLMCFB.js";import"./chunk-WWN5RJW3.js";import"./chunk-H3LYBNOM.js";import"./chunk-LBMIQEU6.js";import"./chunk-WI5MSH4N.js";import"./chunk-NBD2MYJO.js";import"./chunk-3SBX7V6R.js";import"./chunk-SQKDQBOS.js";import"./chunk-SWRJZAEI.js";import"./chunk-JCSW2JUV.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-36KMLI7A.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as xn,b as hn,d as se,k as R}from"./chunk-CRC5ZNR6.js";var it=[{valor:"Finalizado",label:"Finalizado",descripcion:"Trabajo completado, listo para facturar"},{valor:"Presupuesto pendiente",label:"Presupuesto pendiente",descripcion:"Se requiere presupuesto adicional"},{valor:"Otra visita",label:"Otra visita",descripcion:"Se necesita realizar otra visita"}];var Hn=(()=>{let d=class d{constructor(n,e){this.supabaseClientService=n,this.inventarioService=e,this.supabase=this.supabaseClientService.getClient()}crearAlbaran(n){console.log("\u{1F4CB} Creando albar\xE1n con datos:",n);let c=n,{repuestos_utilizados:e}=c,t=se(c,["repuestos_utilizados"]);return I(this.supabase.from("albaranes").insert([t]).select().single()).pipe(en(({data:u,error:f})=>{if(f)throw f;if(console.log("\u2705 Albar\xE1n b\xE1sico creado:",u.id),!e||e.length===0)return console.log("\u{1F4CB} Sin repuestos que procesar"),I([u]);let x=e.map(b=>({albaran_id:u.id,nombre:b.nombre,cantidad:b.cantidad,precio_neto:b.precio_neto||0,precio_pvp:b.precio_pvp||0,unidad:b.unidad||"unidad",codigo:b.codigo||""}));return console.log("\u{1F4CB} Insertando repuestos en tabla repuestos_albaran:",x),I(this.supabase.from("repuestos_albaran").insert(x).select()).pipe(en(({data:b,error:C})=>{if(C)throw console.error("\u274C Error al insertar repuestos:",C),C;if(console.log("\u2705 Repuestos insertados correctamente:",(b==null?void 0:b.length)||0,"repuestos"),b&&b.length>0){console.log("\u{1F4E6} Actualizando stock del inventario...");let j=b.map(pn=>this.actualizarStockInventario(pn));return qn(j).pipe(W(()=>(console.log("\u2705 Stock del inventario actualizado correctamente"),hn(xn({},u),{repuestos:b||[]}))))}return I([hn(xn({},u),{repuestos:b||[]})])}))}),X(u=>{throw console.error("\u274C Error al crear albar\xE1n:",u),u}))}getAlbaran(n){return I(this.supabase.from("albaranes").select(`
          *,
          aviso:avisos(*),
          repuestos:repuestos_albaran(*)
        `).eq("id",n).single()).pipe(W(({data:e,error:t})=>{if(t)throw t;return console.log("\u{1F4CB} Albar\xE1n obtenido con repuestos:",e),e}),X(e=>{throw console.error("Error al obtener albar\xE1n:",e),e}))}actualizarStockInventario(n){console.log("\u{1F4E6} Actualizando stock para repuesto:",n);let e=this.supabase.from("inventario").select("*");return n.codigo?e=e.eq("codigo",n.codigo):e=e.eq("nombre",n.nombre),I(e.single()).pipe(en(({data:t,error:c})=>{if(c)return console.warn("\u26A0\uFE0F Producto no encontrado en inventario:",n.nombre||n.codigo),I([void 0]);let u=t,f=u.cantidad_disponible||0,x=n.cantidad||1,b=Math.max(0,f-x);return console.log(`\u{1F4E6} Stock actual: ${f}, Cantidad usada: ${x}, Nueva cantidad: ${b}`),I(this.supabase.from("inventario").update({cantidad_disponible:b,fecha_actualizacion:new Date().toISOString()}).eq("id",u.id)).pipe(W(({error:C})=>{if(C)throw console.error("\u274C Error al actualizar stock:",C),C;console.log(`\u2705 Stock actualizado: ${u.nombre} - ${f} \u2192 ${b}`),this.inventarioService.getInventario().subscribe()}))}),X(t=>(console.error("\u274C Error en actualizarStockInventario:",t),I([void 0]))))}getAlbaranesAviso(n){return I(this.supabase.from("albaranes").select(`
          *,
          repuestos:repuestos_albaran(*)
        `).eq("aviso_id",n).order("fecha_trabajo",{ascending:!1})).pipe(W(({data:e,error:t})=>{if(t)throw t;return console.log("\u{1F4CB} Albaranes obtenidos con repuestos:",(e==null?void 0:e.length)||0,"albaranes"),e}),X(e=>{throw console.error("Error al obtener albaranes del aviso:",e),e}))}actualizarAlbaran(n,e){return I(this.supabase.from("albaranes").update(hn(xn({},e),{fecha_actualizacion:new Date})).eq("id",n).select().single()).pipe(W(({data:t,error:c})=>{if(c)throw c;return t}),X(t=>{throw console.error("Error al actualizar albar\xE1n:",t),t}))}eliminarAlbaran(n){return console.log("\u{1F50D} eliminarAlbaran llamado con ID:",n),this.getAlbaran(n).pipe(en(e=>{if(console.log("\u{1F4CB} Albar\xE1n obtenido para eliminaci\xF3n:",e),e.repuestos&&e.repuestos.length>0){console.log("\u{1F4E6} Devolviendo repuestos al inventario:",e.repuestos.length,"repuestos");let t=e.repuestos.map(c=>this.restaurarStockInventario(c));return qn(t).pipe(en(()=>(console.log("\u2705 Stock del inventario restaurado correctamente"),this.eliminarAlbaranDeBD(n))))}else return console.log("\u{1F4CB} Sin repuestos que devolver al inventario"),this.eliminarAlbaranDeBD(n)}),X(e=>{throw console.error("\u274C Error en eliminarAlbaran:",e),e}))}eliminarAlbaranDeBD(n){return I(this.supabase.from("albaranes").delete().eq("id",n)).pipe(W(({data:e,error:t})=>{if(console.log("\u{1F50D} Respuesta de Supabase:",{data:e,error:t}),t)throw console.error("\u274C Error de Supabase:",t),t;console.log("\u2705 Albar\xE1n eliminado exitosamente de la BD")}))}restaurarStockInventario(n){console.log("\u{1F4E6} Restaurando stock para repuesto:",n);let e=this.supabase.from("inventario").select("*");return n.codigo?e=e.eq("codigo",n.codigo):e=e.eq("nombre",n.nombre),I(e.single()).pipe(en(({data:t,error:c})=>{if(c)return console.warn("\u26A0\uFE0F Producto no encontrado en inventario para restaurar:",n.nombre||n.codigo),I([void 0]);let u=t,f=u.cantidad_disponible||0,x=n.cantidad||1,b=f+x;return console.log(`\u{1F4E6} Stock actual: ${f}, Cantidad a restaurar: ${x}, Nueva cantidad: ${b}`),I(this.supabase.from("inventario").update({cantidad_disponible:b,fecha_actualizacion:new Date().toISOString()}).eq("id",u.id)).pipe(W(({error:C})=>{if(C)throw console.error("\u274C Error al restaurar stock:",C),C;console.log(`\u2705 Stock restaurado: ${u.nombre} - ${f} \u2192 ${b}`),this.inventarioService.getInventario().subscribe()}))}),X(t=>(console.error("\u274C Error en restaurarStockInventario:",t),I([void 0]))))}getEstadisticasAlbaranes(n){return I(this.supabase.from("albaranes").select("estado_cierre").eq("aviso_id",n)).pipe(W(({data:e,error:t})=>{if(t)throw t;let c=e;return{total:c.length,finalizados:c.filter(f=>f.estado_cierre==="Finalizado").length,presupuestoPendiente:c.filter(f=>f.estado_cierre==="Presupuesto pendiente").length,otraVisita:c.filter(f=>f.estado_cierre==="Otra visita").length}}),X(e=>{throw console.error("Error al obtener estad\xEDsticas de albaranes:",e),e}))}};d.\u0275fac=function(e){return new(e||d)(_n(Fe),_n(Rn))},d.\u0275prov=yn({token:d,factory:d.\u0275fac,providedIn:"root"});let r=d;return r})();var bt=["signaturePad"],Ct=(r,d)=>({"stock-bajo":r,"stock-critico":d});function Mt(r,d){if(r&1){let i=v();o(0,"div",51)(1,"div",52)(2,"h4"),s(3,"Agregar Repuesto"),a(),o(4,"button",53),_("click",function(){P(i);let e=m();return O(e.cerrarFormularioManual())}),p(5,"ion-icon",54),a()(),o(6,"div",55)(7,"div",56),p(8,"input",57),a(),o(9,"div",58),p(10,"input",59),a(),o(11,"div",60),p(12,"input",61),a(),o(13,"button",62),_("click",function(){P(i);let e=m();return O(e.agregarRepuestoDesdeFormulario())}),p(14,"ion-icon",63),a()()()}if(r&2){let i=m();l(6),g("formGroup",i.repuestoManualForm)}}function Pt(r,d){if(r&1&&(o(0,"span",78),s(1),a()),r&2){let i=m().$implicit;l(),F(" ",i.cantidad_disponible===0?" (Sin stock)":" (Stock bajo)"," ")}}function Ot(r,d){if(r&1){let i=v();o(0,"div",71),_("click",function(){let e=P(i).$implicit,t=m(2);return O(t.agregarRepuesto(e))}),o(1,"div",72)(2,"span",73),s(3),a(),o(4,"div",74)(5,"span",75),s(6),h(7,Pt,2,1,"span",76),a()()(),p(8,"ion-icon",77),a()}if(r&2){let i=d.$implicit;l(3),M(i.nombre),l(2),g("ngClass",pe(5,Ct,i.cantidad_disponible<=2,i.cantidad_disponible===0)),l(),tn(" Stock: ",i.cantidad_disponible," ",i.unidad," "),l(),g("ngIf",i.cantidad_disponible<=2)}}function xt(r,d){if(r&1){let i=v();o(0,"div",64)(1,"div",65)(2,"h4"),s(3,"Seleccionar Repuestos"),a(),o(4,"button",53),_("click",function(){P(i);let e=m();return O(e.cerrarSelectorRepuestos())}),p(5,"ion-icon",54),a()(),o(6,"div",66)(7,"ion-input",67),Xn("ngModelChange",function(e){P(i);let t=m();return Wn(t.busquedaRepuesto,e)||(t.busquedaRepuesto=e),O(e)}),_("ionInput",function(e){P(i);let t=m();return O(t.filtrarProductos(e))}),a(),p(8,"ion-icon",68),a(),o(9,"div",69),h(10,Ot,9,8,"div",70),a()()}if(r&2){let i=m();l(7),Yn("ngModel",i.busquedaRepuesto),l(3),g("ngForOf",i.productosFiltrados)}}function ht(r,d){if(r&1){let i=v();o(0,"div",81)(1,"span",82),s(2),a(),o(3,"input",83),_("change",function(e){let t=P(i).$implicit,c=m(2);return O(c.actualizarCantidadRepuesto(t,e.target.value))}),a(),o(4,"button",84),_("click",function(){let e=P(i).$implicit,t=m(2);return O(t.eliminarRepuesto(e))}),p(5,"ion-icon",85),a()()}if(r&2){let i=d.$implicit;l(2),M(i.nombre),l(),g("value",i.cantidad)("min",1)}}function vt(r,d){if(r&1&&(o(0,"div",79)(1,"h4"),s(2,"Repuestos Seleccionados:"),a(),h(3,ht,6,3,"div",80),a()),r&2){let i=m();l(3),g("ngForOf",i.repuestosSeleccionados)}}function yt(r,d){r&1&&(o(0,"div",86),p(1,"ion-icon",25),o(2,"p"),s(3,"No hay repuestos seleccionados"),a(),o(4,"small"),s(5,"Selecciona repuestos del inventario o agrega manualmente"),a()())}function wt(r,d){if(r&1&&(o(0,"option",87),s(1),a()),r&2){let i=d.$implicit;g("value",i.valor),l(),tn(" ",i.label," - ",i.descripcion," ")}}function Et(r,d){r&1&&(o(0,"div",88)(1,"h3"),s(2,"Presupuesto Pendiente"),a(),o(3,"div",89),p(4,"ion-icon",90),o(5,"div",91)(6,"p"),s(7,"Se crear\xE1 autom\xE1ticamente un presupuesto para este trabajo."),a(),o(8,"small"),s(9,"Podr\xE1s editarlo despu\xE9s desde la secci\xF3n de presupuestos."),a()()()())}function kt(r,d){if(r&1){let i=v();o(0,"div",92),p(1,"ion-icon",93),o(2,"span"),s(3,"\xC1rea de firma digital"),a(),o(4,"small"),s(5,"Haz clic para comenzar a firmar"),a(),o(6,"button",94),_("click",function(){P(i);let e=m();return O(e.iniciarFirma())}),p(7,"ion-icon",93),s(8," Comenzar Firma "),a()()}}function zt(r,d){if(r&1){let i=v();o(0,"div",95),p(1,"canvas",96,0),o(3,"div",97)(4,"button",98),_("click",function(){P(i);let e=m();return O(e.limpiarFirma())}),p(5,"ion-icon",85),s(6," Limpiar "),a(),o(7,"button",99),_("click",function(){P(i);let e=m();return O(e.guardarFirma())}),p(8,"ion-icon",63),s(9," Guardar Firma "),a()()()}}function St(r,d){if(r&1){let i=v();o(0,"div",100),p(1,"img",101),o(2,"div",102)(3,"button",103),_("click",function(){P(i);let e=m();return O(e.editarFirma())}),p(4,"ion-icon",93),s(5," Editar "),a(),o(6,"button",104),_("click",function(){P(i);let e=m();return O(e.eliminarFirma())}),p(7,"ion-icon",85),s(8," Eliminar "),a()()()}if(r&2){let i=m();l(),g("src",i.firmaDataUrl,$)}}function It(r,d){if(r&1){let i=v();o(0,"div",51)(1,"div",52)(2,"h4"),s(3,"Agregar Repuesto"),a(),o(4,"button",53),_("click",function(){P(i);let e=m();return O(e.cerrarFormularioManual())}),p(5,"ion-icon",54),a()(),o(6,"div",55)(7,"div",56),p(8,"input",57),a(),o(9,"div",58),p(10,"input",105),a(),o(11,"div",60),p(12,"input",61),a(),o(13,"button",62),_("click",function(){P(i);let e=m();return O(e.agregarRepuestoDesdeFormulario())}),p(14,"ion-icon",63),a()()()}if(r&2){let i=m();l(6),g("formGroup",i.repuestoManualForm)}}function At(r,d){if(r&1){let i=v();o(0,"div",71),_("click",function(){let e=P(i).$implicit,t=m(2);return O(t.agregarRepuesto(e))}),o(1,"div",72)(2,"div",106)(3,"span",107),s(4),A(5,"currency"),a()(),o(6,"span",73),s(7),a(),o(8,"div",74)(9,"span",108),s(10),a()()(),p(11,"ion-icon",77),a()}if(r&2){let i=d.$implicit;l(4),M(Z(5,4,i.precio_neto,"EUR","symbol","1.2-2")),l(3),M(i.nombre),l(3),tn("Stock: ",i.cantidad_disponible," ",i.unidad,"")}}function Ft(r,d){if(r&1){let i=v();o(0,"div",64)(1,"div",65)(2,"h4"),s(3,"Seleccionar Repuestos"),a(),o(4,"button",53),_("click",function(){P(i);let e=m();return O(e.cerrarSelectorRepuestos())}),p(5,"ion-icon",54),a()(),o(6,"div",66)(7,"ion-input",67),Xn("ngModelChange",function(e){P(i);let t=m();return Wn(t.busquedaRepuesto,e)||(t.busquedaRepuesto=e),O(e)}),_("ionInput",function(e){P(i);let t=m();return O(t.filtrarProductos(e))}),a(),p(8,"ion-icon",68),a(),o(9,"div",69),h(10,At,12,9,"div",70),a()()}if(r&2){let i=m();l(7),Yn("ngModel",i.busquedaRepuesto),l(3),g("ngForOf",i.productosFiltrados)}}function jt(r,d){if(r&1&&(o(0,"div",110)(1,"strong"),s(2),A(3,"currency"),a()()),r&2){let i=m(2);l(2),F("Precio Total: ",Z(3,1,i.calcularPrecioTotalRepuestos(),"EUR","symbol","1.2-2"),"")}}function Tt(r,d){if(r&1){let i=v();o(0,"div",81)(1,"span",82),s(2),a(),o(3,"input",83),_("change",function(e){let t=P(i).$implicit,c=m(2);return O(c.actualizarCantidadRepuesto(t,e.target.value))}),a(),o(4,"button",84),_("click",function(){let e=P(i).$implicit,t=m(2);return O(t.eliminarRepuesto(e))}),p(5,"ion-icon",85),a()()}if(r&2){let i=d.$implicit;l(2),M(i.nombre),l(),g("value",i.cantidad)("min",1)}}function Vt(r,d){if(r&1&&(o(0,"div",79)(1,"h4"),s(2,"Repuestos Seleccionados:"),a(),h(3,jt,4,6,"div",109)(4,Tt,6,3,"div",80),a()),r&2){let i=m();l(3),g("ngIf",i.repuestosSeleccionados.length>0),l(),g("ngForOf",i.repuestosSeleccionados)}}function Dt(r,d){r&1&&(o(0,"div",86),p(1,"ion-icon",25),o(2,"p"),s(3,"No hay repuestos seleccionados"),a(),o(4,"small"),s(5,"Selecciona repuestos del inventario o agrega manualmente"),a()())}function Nt(r,d){if(r&1){let i=v();o(0,"button",114),_("click",function(){P(i);let e=m(2);return O(e.reintentarOperacion())}),p(1,"ion-icon",115),s(2," Reintentar "),a()}}function Rt(r,d){if(r&1&&(o(0,"div",111),p(1,"ion-icon",112),o(2,"span"),s(3),a(),h(4,Nt,3,0,"button",113),a()),r&2){let i=m();l(3),M(i.error),l(),g("ngIf",i.error.includes("conexi\xF3n")||i.error.includes("Sesi\xF3n expirada"))}}function $t(r,d){r&1&&p(0,"ion-icon",116)}function Ht(r,d){r&1&&p(0,"ion-icon",117)}var st=(()=>{let d=class d{constructor(n,e,t,c,u,f,x,b){this.fb=n,this.modalController=e,this.inventarioService=t,this.albaranesService=c,this.avisosService=u,this.presupuestosService=f,this.router=x,this.reconnectionService=b,this.loading=!1,this.error=null,this.productosInventario=[],this.productosFiltrados=[],this.busquedaRepuesto="",this.mostrarSelectorRepuestos=!1,this.repuestosSeleccionados=[],this.mostrarFormularioRepuesto=!1,this.firmaCapturada=!1,this.firmaDataUrl="",this.mostrarCanvas=!1,this.fechaActualFormateada="",this.estadosCierre=it,this.isComponentActive=!0,console.log("HacerAlbaranComponent constructor called"),V({closeOutline:Ge,timeOutline:ln,cubeOutline:Tn,addCircleOutline:Ne,close:q,searchOutline:tt,trashOutline:on,informationCircleOutline:Dn,createOutline:cn,checkmarkOutline:Be,warningOutline:dn,saveOutline:et,refreshOutline:N,checkmarkCircleOutline:K,calendarOutline:jn,personOutline:sn,pencilOutline:On,documentTextOutline:nn}),this.albaranForm=this.fb.group({fecha_trabajo:["",T.required],fecha_cierre:["",T.required],hora_entrada:["",T.required],hora_salida:["",T.required],descripcion_trabajo_realizado:["",T.required],repuestos_utilizados:[[]],estado_cierre:["",T.required],dni_cliente:[""],nombre_firma:[""],firma_cliente:[""],observaciones:[""]}),this.repuestoManualForm=this.fb.group({denominacion:["",T.required],cantidad:["",[T.required,T.min(1)]],precio:["",[T.required,T.min(0)]]})}ngOnInit(){return R(this,null,function*(){console.log("\u{1F3AF} HacerAlbaranComponent ngOnInit - Aviso:",this.aviso),console.log("\u{1F3AF} Formulario inicializado:",this.albaranForm),this.setupReconnectionHandling(),this.establecerFechaActual(),this.establecerFechaTrabajo();try{yield this.cargarProductosInventario(),this.inicializarFormulario()}catch(n){console.error("Error al inicializar componente:",n)}})}ngAfterViewInit(){setTimeout(()=>{var n,e;(n=this.albaranForm.get("fecha_cierre"))!=null&&n.value||this.establecerFechaActual(),(e=this.albaranForm.get("fecha_trabajo"))!=null&&e.value||this.establecerFechaTrabajo()},100)}ngOnDestroy(){console.log("\u{1F9F9} HacerAlbaranComponent ngOnDestroy - Limpiando suscripciones"),this.isComponentActive=!1,this.reconnectionSubscription&&this.reconnectionSubscription.unsubscribe()}inicializarFormulario(){let n=this.generarHoraActual();this.albaranForm.patchValue({hora_entrada:n,hora_salida:n,repuestos_utilizados:[]}),this.repuestosSeleccionados=[],console.log("\u{1F50D} Formulario inicializado con valores por defecto")}cargarProductosInventario(){return new Promise((n,e)=>{this.inventarioService.getInventario(1,1e3,"","nombre","asc",!1).subscribe({next:t=>{this.productosInventario=t.inventario,this.productosFiltrados=[...this.productosInventario],console.log(" Inventario cargado:",this.productosInventario.length,"productos"),n()},error:t=>{console.error("Error al cargar productos del inventario:",t),e(t)}})})}filtrarProductos(n){var t;let e=((t=n==null?void 0:n.target)==null?void 0:t.value)||n||"";this.busquedaRepuesto=e,e.trim()?this.productosFiltrados=this.productosInventario.filter(c=>{var u;return c.nombre.toLowerCase().includes(e.toLowerCase())||c.codigo.toLowerCase().includes(e.toLowerCase())||(((u=c.descripcion)==null?void 0:u.toLowerCase())||"").includes(e.toLowerCase())}):this.productosFiltrados=[...this.productosInventario]}abrirSelectorRepuestos(){this.mostrarSelectorRepuestos=!0,this.productosFiltrados=[...this.productosInventario],this.busquedaRepuesto=""}cerrarSelectorRepuestos(){this.mostrarSelectorRepuestos=!1}agregarRepuesto(n){console.log("\u{1F50D} agregarRepuesto - Producto recibido:",n);let e=n.cantidad_disponible||0;if(e<=0){alert(`\u26A0\uFE0F No hay stock disponible para ${n.nombre}`);return}let t=this.repuestosSeleccionados.find(c=>c.nombre===n.nombre);if(t){let c=t.cantidad+1;if(c>e){alert(`\u26A0\uFE0F No hay suficiente stock. Disponible: ${e} ${n.unidad}, Solicitado: ${c} ${n.unidad}`);return}t.cantidad+=1,console.log("\u{1F50D} agregarRepuesto - Repuesto existente, cantidad aumentada a:",t.cantidad)}else{let c={nombre:n.nombre,cantidad:1,precio_neto:n.precio_neto||0,precio_pvp:n.pvp||n.precio_neto||0,unidad:n.unidad||"unidad",codigo:n.codigo||""};console.log("\u{1F50D} agregarRepuesto - Nuevo repuesto creado:",c),this.repuestosSeleccionados.push(c)}this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados}),console.log("\u{1F50D} agregarRepuesto - Repuestos seleccionados actualizados:",this.repuestosSeleccionados),this.cerrarSelectorRepuestos()}eliminarRepuesto(n){this.repuestosSeleccionados=this.repuestosSeleccionados.filter(e=>e!==n),this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados})}actualizarCantidadRepuesto(n,e){e>0&&(n.cantidad=e,this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados}))}mostrarFormularioManual(){this.mostrarFormularioRepuesto=!0,this.repuestoManualForm.reset({denominacion:"",cantidad:1,precio:0})}cerrarFormularioManual(){this.mostrarFormularioRepuesto=!1,this.repuestoManualForm.reset({denominacion:"",cantidad:1,precio:0})}agregarRepuestoDesdeFormulario(){var t,c,u;if(console.log("\u{1F50D} Debug - repuestoManualForm value:",this.repuestoManualForm.value),console.log("\u{1F50D} Debug - repuestoManualForm valid:",this.repuestoManualForm.valid),this.repuestoManualForm.invalid){if(this.repuestoManualForm.markAllAsTouched(),(t=this.repuestoManualForm.get("denominacion"))!=null&&t.invalid){alert("Por favor, introduce la denominaci\xF3n del repuesto");return}if((c=this.repuestoManualForm.get("cantidad"))!=null&&c.invalid){alert("La cantidad debe ser mayor a 0");return}if((u=this.repuestoManualForm.get("precio"))!=null&&u.invalid){alert("El precio debe ser mayor o igual a 0");return}return}let n=this.repuestoManualForm.value,e={nombre:n.denominacion.trim(),cantidad:n.cantidad,precio_neto:n.precio||0,precio_pvp:n.precio||0,unidad:"unidad",codigo:""};console.log("\u{1F50D} agregarRepuestoDesdeFormulario - Repuesto manual creado:",e),this.repuestosSeleccionados.push(e),this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados}),this.cerrarFormularioManual()}generarHoraActual(){let n=new Date;return`${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`}establecerHoraActual(){let n=this.generarHoraActual();this.albaranForm.patchValue({hora_salida:n})}formatearFechaParaInput(n){let e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),c=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${c}`}establecerFechaActual(){let n=new Date,e=this.formatearFechaParaInput(n);this.albaranForm.patchValue({fecha_cierre:e}),this.fechaActualFormateada=e,console.log("\u{1F4C5} Fecha de cierre establecida:",e)}establecerFechaTrabajo(){let n=new Date,e=this.formatearFechaParaInput(n);this.albaranForm.patchValue({fecha_trabajo:e}),console.log("\u{1F4C5} Fecha de trabajo establecida:",e)}guardarAlbaran(){if(this.albaranForm.valid){this.loading=!0,this.error=null;let n={aviso_id:this.aviso.id,fecha_trabajo:this.albaranForm.value.fecha_trabajo,fecha_cierre:this.albaranForm.value.fecha_cierre,hora_entrada:this.albaranForm.value.hora_entrada,hora_salida:this.albaranForm.value.hora_salida,descripcion_trabajo_realizado:this.albaranForm.value.descripcion_trabajo_realizado,repuestos_utilizados:this.albaranForm.value.repuestos_utilizados,estado_cierre:this.albaranForm.value.estado_cierre,presupuesto_necesario:0,dni_cliente:this.albaranForm.value.dni_cliente,nombre_firma:this.albaranForm.value.nombre_firma,firma_cliente:this.albaranForm.value.firma_cliente,observaciones:this.albaranForm.value.observaciones};console.log("Datos del albar\xE1n:",n),this.albaranesService.crearAlbaran(n).subscribe({next:e=>{console.log("Albar\xE1n guardado exitosamente:",e),n.estado_cierre==="Presupuesto pendiente"?this.manejarPresupuestoPendiente(e):this.finalizarGuardadoAlbaran(e)},error:e=>{this.loading=!1,e.status===0||e.status===408||e.name==="TimeoutError"?(this.error="Error de conexi\xF3n. Verifica tu conexi\xF3n a internet e intenta de nuevo.",console.error("Error de conexi\xF3n al guardar albar\xE1n:",e)):e.status===401?(this.error="Sesi\xF3n expirada. Por favor, recarga la p\xE1gina e intenta de nuevo.",console.error("Error de autenticaci\xF3n al guardar albar\xE1n:",e)):(this.error="Error al guardar el albar\xE1n: "+(e.message||"Error desconocido"),console.error("Error al guardar albar\xE1n:",e))}})}else this.error="Por favor, complete todos los campos requeridos",this.marcarCamposComoTocados()}marcarCamposComoTocados(){Object.keys(this.albaranForm.controls).forEach(n=>{let e=this.albaranForm.get(n);e==null||e.markAsTouched()})}cancelar(){this.modalController.dismiss()}reintentarOperacion(){console.log("\u{1F504} Reintentando operaci\xF3n..."),this.error=null,this.albaranForm.valid?this.guardarAlbaran():this.error="Por favor, complete todos los campos requeridos antes de reintentar"}requierePresupuesto(){var n;return((n=this.albaranForm.get("estado_cierre"))==null?void 0:n.value)==="Presupuesto pendiente"}requiereOtraVisita(){var n;return((n=this.albaranForm.get("estado_cierre"))==null?void 0:n.value)==="Otra visita"}calcularPrecioTotalRepuestos(){return this.repuestosSeleccionados.reduce((n,e)=>n+e.precio_pvp*e.cantidad,0)}debugAlbaran(){console.log("Albar\xE1n en progreso:",this.albaranForm.value),console.log("Repuestos seleccionados:",this.repuestosSeleccionados),console.log("Precio total repuestos:",this.calcularPrecioTotalRepuestos())}iniciarFirma(){this.mostrarCanvas=!0,this.firmaCapturada=!1,this.firmaDataUrl="",setTimeout(()=>{this.inicializarSignaturePad()},100)}inicializarSignaturePad(){var e;if(!((e=this.signaturePadElement)!=null&&e.nativeElement)){console.warn("Canvas no encontrado");return}let n=this.signaturePadElement.nativeElement;import("./chunk-PGY3UNFJ.js").then(({default:t})=>{this.signaturePad=new t(n,{backgroundColor:"white",penColor:"black",minWidth:1,maxWidth:2.5,throttle:16,velocityFilterWeight:.7,dotSize:1}),this.ajustarCanvas(),window.addEventListener("resize",()=>this.ajustarCanvas())})}ajustarCanvas(){var f;if(!((f=this.signaturePadElement)!=null&&f.nativeElement)||!this.signaturePad)return;let n=this.signaturePadElement.nativeElement,e=n.parentElement;if(!e)return;let t=e.getBoundingClientRect(),c=Math.max(t.width-40,300),u=200;n.width=c,n.height=u,this.signaturePad.resizeCanvas()}limpiarFirma(){this.signaturePad&&this.signaturePad.clear()}guardarFirma(){this.signaturePad&&!this.signaturePad.isEmpty()?(this.firmaDataUrl=this.signaturePad.toDataURL(),this.firmaCapturada=!0,this.mostrarCanvas=!1,this.albaranForm.patchValue({firma_cliente:this.firmaDataUrl}),console.log("Firma guardada exitosamente")):console.warn("No hay firma para guardar")}editarFirma(){this.mostrarCanvas=!0,this.firmaCapturada=!1,setTimeout(()=>{this.signaturePad?this.signaturePad.clear():this.inicializarSignaturePad()},100)}eliminarFirma(){this.firmaCapturada=!1,this.firmaDataUrl="",this.mostrarCanvas=!1,this.signaturePad&&this.signaturePad.clear(),this.albaranForm.patchValue({firma_cliente:""}),console.log("Firma eliminada")}manejarPresupuestoPendiente(n){console.log("\u{1F504} Manejando albar\xE1n con presupuesto pendiente:",n),this.crearPresupuestoDesdeAlbaran(n)}crearPresupuestoDesdeAlbaran(n){console.log("\u{1F3AF} Creando presupuesto desde albar\xE1n:",n);let e=this.prepararMaterialesParaPresupuesto(),t={aviso_id:this.aviso.id,albaran_id:n.id,horas_estimadas:this.calcularHorasEstimadas(),total_estimado:this.calcularTotalEstimado(),materiales:e};console.log("\u{1F4CB} Datos para el presupuesto:",t),this.presupuestosService.crearPresupuesto(t).subscribe({next:c=>{console.log("\u2705 Presupuesto creado exitosamente:",c),this.loading=!1,this.modalController.dismiss({success:!0,albaran:n,presupuesto:c,mensaje:"Albar\xE1n guardado y presupuesto creado exitosamente",accion_realizada:"presupuesto_creado"},"confirm")},error:c=>{console.error("\u274C Error al crear presupuesto:",c),alert(`\u26A0\uFE0F El albar\xE1n se guard\xF3 correctamente, pero hubo un error al crear el presupuesto autom\xE1ticamente.

Puedes crear el presupuesto manualmente desde la secci\xF3n de presupuestos.`),this.finalizarGuardadoAlbaran(n)}})}prepararMaterialesParaPresupuesto(){return this.repuestosSeleccionados.map(n=>({material_id:n.codigo||this.generarIdTemporal(),cantidad_estimada:n.cantidad,precio_neto_al_momento:n.precio_neto,producto:{id:n.codigo||this.generarIdTemporal(),nombre:n.nombre,precio_neto:n.precio_neto,unidad:n.unidad}}))}calcularHorasEstimadas(){let n=this.albaranForm.value.hora_entrada,e=this.albaranForm.value.hora_salida;if(n&&e){let[t,c]=n.split(":").map(Number),[u,f]=e.split(":").map(Number),x=t*60+c,j=(u*60+f-x)/60;return Math.max(j,1)}return 2}calcularTotalEstimado(){let n=this.calcularPrecioTotalRepuestos(),c=this.calcularHorasEstimadas()*50;return n+c}generarIdTemporal(){return"temp_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}finalizarGuardadoAlbaran(n){this.avisosService.actualizarEstadoAutomatico(this.aviso.id).subscribe({next:e=>{this.loading=!1,console.log("Estado del aviso actualizado autom\xE1ticamente:",e),this.modalController.dismiss({success:!0,albaran:n,aviso:e,mensaje:"Albar\xE1n guardado exitosamente"},"confirm")},error:e=>{console.error("Error al actualizar estado del aviso:",e),this.loading=!1,this.modalController.dismiss({success:!0,albaran:n,mensaje:"Albar\xE1n guardado exitosamente"},"confirm")}})}setupReconnectionHandling(){console.log("\u{1F504} Configurando manejo de reconexi\xF3n en HacerAlbaranComponent"),this.reconnectionSubscription=this.reconnectionService.appResumed.subscribe({next:n=>{n&&this.isComponentActive&&(console.log("\u{1F504} App reanudada - verificando estado del componente"),this.handleAppResume())},error:n=>{console.error("\u274C Error en suscripci\xF3n de reconexi\xF3n:",n)}})}handleAppResume(){return R(this,null,function*(){if(!this.isComponentActive){console.log("\u{1F504} Componente no activo, saltando manejo de reconexi\xF3n");return}try{console.log("\u{1F504} HacerAlbaranComponent: App reanudada, verificando conexi\xF3n...");let n=this.albaranForm.value;Object.values(n).some(t=>t!=null&&t!==""&&(Array.isArray(t)?t.length>0:!0))&&(console.log("\u{1F504} Formulario tiene datos, evitando navegaci\xF3n autom\xE1tica"),this.loading&&(this.loading=!1,this.error="Conexi\xF3n restablecida. Puedes continuar con el albar\xE1n.",setTimeout(()=>{this.isComponentActive&&(this.error=null)},3e3)))}catch(n){console.error("\u274C Error en handleAppResume:",n)}})}shouldKeepComponentActive(){var t;let n=this.albaranForm.value;return n.descripcion_trabajo_realizado||((t=n.repuestos_utilizados)==null?void 0:t.length)>0||n.firma_cliente||n.observaciones}};d.\u0275fac=function(e){return new(e||d)(z(ze),z(J),z(Rn),z(Hn),z(An),z(Nn),z(rn),z(ot))},d.\u0275cmp=H({type:d,selectors:[["app-hacer-albaran"]],viewQuery:function(e,t){if(e&1&&fn(bt,5),e&2){let c;bn(c=Cn())&&(t.signaturePadElement=c.first)}},inputs:{aviso:"aviso"},decls:133,vars:19,consts:[["signaturePad",""],[1,"header-content"],[1,"close-button",3,"click"],["name","close-outline"],[1,"subtitle"],[1,"modal-body",2,"--padding-top","0","--padding-bottom","0"],[1,"modal-content",3,"ngSubmit","formGroup"],[1,"modal-grid"],[1,"form-section"],[1,"form-group"],[1,"required"],["type","date","formControlName","fecha_trabajo",1,"form-control",3,"click"],[1,"help-text"],["type","date","formControlName","fecha_cierre",1,"form-control",3,"click"],[1,"form-row"],[1,"form-group","half"],["type","time","formControlName","hora_entrada",1,"form-control"],[1,"input-with-button"],["type","time","formControlName","hora_salida",1,"form-control",3,"click"],["type","button",1,"add-button",3,"click"],["name","time-outline"],["formControlName","descripcion_trabajo_realizado","placeholder","Describe detalladamente el trabajo realizado...","rows","3",1,"form-control"],[1,"repuestos-section","mobile-only"],[1,"repuestos-actions"],["type","button",1,"btn-select-inventory",3,"click"],["name","cube-outline"],["type","button",1,"btn-add-manual",3,"click"],["name","add-circle-outline"],["class","formulario-repuesto-manual",4,"ngIf"],["class","inventory-selector",4,"ngIf"],["class","repuestos-list",4,"ngIf"],["class","repuestos-empty",4,"ngIf"],["formControlName","estado_cierre",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","presupuesto-info",4,"ngIf"],["formControlName","observaciones","placeholder","Observaciones adicionales...","rows","2",1,"form-control"],["type","text","formControlName","dni_cliente","placeholder","DNI del cliente",1,"form-control"],["type","text","formControlName","nombre_firma","placeholder","Nombre de la persona que firma",1,"form-control"],[1,"signature-area"],["class","signature-placeholder",4,"ngIf"],["class","signature-canvas-container",4,"ngIf"],["class","signature-preview",4,"ngIf"],[1,"images-section"],[1,"repuestos-container","desktop-only"],["class","error-message",4,"ngIf"],[1,"button-group"],["type","button",1,"btn","btn-outline",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["name","save-outline",4,"ngIf"],["name","refresh-outline","class","spinning",4,"ngIf"],[1,"formulario-repuesto-manual"],[1,"formulario-header"],["type","button",1,"btn-close",3,"click"],["name","close"],[1,"formulario-campos",3,"formGroup"],[1,"campo-input"],["type","text","formControlName","denominacion","placeholder","Denominaci\xF3n del repuesto",1,"input-denominacion"],[1,"campo-cantidad"],["type","number","formControlName","cantidad","placeholder","Cantidad","min","1",1,"input-cantidad"],[1,"campo-precio"],["type","number","formControlName","precio","placeholder","Precio \u20AC","min","0","step","0.01",1,"input-precio"],["type","button",1,"btn-agregar",3,"click"],["name","checkmark-outline"],[1,"inventory-selector"],[1,"selector-header"],[1,"search-container"],["type","text","placeholder","Buscar repuestos...",1,"search-input",3,"ngModelChange","ionInput","ngModel"],["name","search-outline"],[1,"products-list"],["class","product-item",3,"click",4,"ngFor","ngForOf"],[1,"product-item",3,"click"],[1,"product-info"],[1,"product-name"],[1,"product-details"],[1,"product-stock",3,"ngClass"],["class","stock-indicador",4,"ngIf"],["name","add-circle-outline",1,"add-icon"],[1,"stock-indicador"],[1,"repuestos-list"],["class","repuesto-item-compacto",4,"ngFor","ngForOf"],[1,"repuesto-item-compacto"],[1,"repuesto-denominacion"],["type","number",1,"cantidad-input-compacto",3,"change","value","min"],["type","button",1,"btn-remove-compacto",3,"click"],["name","trash-outline"],[1,"repuestos-empty"],[3,"value"],[1,"presupuesto-info"],[1,"info-box"],["name","information-circle-outline"],[1,"info-content"],[1,"signature-placeholder"],["name","create-outline"],["type","button",1,"btn-start-signature",3,"click"],[1,"signature-canvas-container"],[1,"signature-canvas"],[1,"signature-controls"],["type","button",1,"btn-clear",3,"click"],["type","button",1,"btn-save",3,"click"],[1,"signature-preview"],["alt","Firma del cliente",1,"firma-image",3,"src"],[1,"signature-actions"],["type","button",1,"btn-edit",3,"click"],["type","button",1,"btn-remove",3,"click"],["type","number","formControlName","cantidad","placeholder","Cantidad","min","0",1,"input-cantidad"],[1,"product-header"],[1,"product-price"],[1,"product-stock"],["class","precio-total",4,"ngIf"],[1,"precio-total"],[1,"error-message"],["name","warning-outline"],["type","button","class","btn-retry",3,"click",4,"ngIf"],["type","button",1,"btn-retry",3,"click"],["name","refresh-outline"],["name","save-outline"],["name","refresh-outline",1,"spinning"]],template:function(e,t){e&1&&(o(0,"ion-header")(1,"ion-toolbar")(2,"div",1)(3,"h2"),s(4,"Crear Albar\xE1n"),a(),o(5,"button",2),_("click",function(){return t.cancelar()}),p(6,"ion-icon",3),a()(),o(7,"p",4),s(8,"Crear albar\xE1n para el trabajo realizado"),a()()(),o(9,"ion-content",5)(10,"form",6),_("ngSubmit",function(){return t.guardarAlbaran()}),o(11,"div",7)(12,"div",8)(13,"h3"),s(14,"Fecha y Horarios"),a(),o(15,"div",9)(16,"label"),s(17,"Fecha del Trabajo "),o(18,"span",10),s(19,"*"),a()(),o(20,"input",11),_("click",function(){return t.establecerFechaTrabajo()}),a(),o(21,"small",12),s(22,"Fecha en que se realiz\xF3 el trabajo"),a()(),o(23,"div",9)(24,"label"),s(25,"Fecha de Cierre "),o(26,"span",10),s(27,"*"),a()(),o(28,"input",13),_("click",function(){return t.establecerFechaActual()}),a(),o(29,"small",12),s(30,"Fecha de cierre del albar\xE1n (autom\xE1tica)"),a()(),o(31,"div",14)(32,"div",15)(33,"label"),s(34,"Hora Entrada "),o(35,"span",10),s(36,"*"),a()(),p(37,"input",16),a(),o(38,"div",15)(39,"label"),s(40,"Hora Salida "),o(41,"span",10),s(42,"*"),a()(),o(43,"div",17)(44,"input",18),_("click",function(){return t.establecerHoraActual()}),a(),o(45,"button",19),_("click",function(){return t.establecerHoraActual()}),p(46,"ion-icon",20),s(47," Ahora "),a()()()(),o(48,"h3"),s(49,"Descripci\xF3n del Trabajo Realizado"),a(),o(50,"div",9)(51,"label"),s(52,"Descripci\xF3n "),o(53,"span",10),s(54,"*"),a()(),o(55,"textarea",21),s(56,"            "),a()(),o(57,"div",22)(58,"h3"),s(59,"Repuestos Utilizados"),a(),o(60,"div",23)(61,"button",24),_("click",function(){return t.abrirSelectorRepuestos()}),p(62,"ion-icon",25),s(63," Seleccionar del Inventario "),a(),o(64,"button",26),_("click",function(){return t.mostrarFormularioManual()}),p(65,"ion-icon",27),s(66," Agregar Manualmente "),a()(),h(67,Mt,15,1,"div",28)(68,xt,11,2,"div",29)(69,vt,4,1,"div",30)(70,yt,6,0,"div",31),a(),o(71,"h3"),s(72,"Estado de Cierre"),a(),o(73,"div",9)(74,"label"),s(75,"Estado "),o(76,"span",10),s(77,"*"),a()(),o(78,"select",32)(79,"option",33),s(80,"Selecciona el estado"),a(),h(81,wt,2,3,"option",34),a()(),h(82,Et,10,0,"div",35),o(83,"h3"),s(84,"Observaciones Adicionales"),a(),o(85,"div",9)(86,"label"),s(87,"Observaciones"),a(),o(88,"textarea",36),s(89,"            "),a()(),o(90,"h3"),s(91,"Identificaci\xF3n y Firma"),a(),o(92,"div",14)(93,"div",15)(94,"label"),s(95,"DNI Cliente"),a(),p(96,"input",37),a(),o(97,"div",15)(98,"label"),s(99,"Nombre Firma"),a(),p(100,"input",38),a()(),o(101,"div",9)(102,"label"),s(103,"Firma Digital"),a(),o(104,"div",39),h(105,kt,9,0,"div",40)(106,zt,10,0,"div",41)(107,St,9,1,"div",42),a()()()(),o(108,"div",43)(109,"div",44)(110,"h3"),s(111,"Repuestos Utilizados"),a(),o(112,"div",23)(113,"button",24),_("click",function(){return t.abrirSelectorRepuestos()}),p(114,"ion-icon",25),s(115," Seleccionar del Inventario "),a(),o(116,"button",26),_("click",function(){return t.mostrarFormularioManual()}),p(117,"ion-icon",27),s(118," Agregar Manualmente "),a()(),h(119,It,15,1,"div",28)(120,Ft,11,2,"div",29)(121,Vt,5,2,"div",30)(122,Dt,6,0,"div",31),a()()()(),o(123,"ion-footer")(124,"ion-toolbar"),h(125,Rt,5,2,"div",45),o(126,"div",46)(127,"button",47),_("click",function(){return t.cancelar()}),s(128," Cancelar "),a(),o(129,"button",48),_("click",function(){return t.guardarAlbaran()}),h(130,$t,1,0,"ion-icon",49)(131,Ht,1,0,"ion-icon",50),s(132),a()()()()),e&2&&(l(10),g("formGroup",t.albaranForm),l(57),g("ngIf",t.mostrarFormularioRepuesto),l(),g("ngIf",t.mostrarSelectorRepuestos),l(),g("ngIf",t.repuestosSeleccionados.length>0),l(),g("ngIf",t.repuestosSeleccionados.length===0&&!t.mostrarSelectorRepuestos),l(11),g("ngForOf",t.estadosCierre),l(),g("ngIf",t.requierePresupuesto()),l(23),g("ngIf",!t.firmaCapturada&&!t.mostrarCanvas),l(),g("ngIf",t.mostrarCanvas&&!t.firmaCapturada),l(),g("ngIf",t.firmaCapturada),l(12),g("ngIf",t.mostrarFormularioRepuesto),l(),g("ngIf",t.mostrarSelectorRepuestos),l(),g("ngIf",t.repuestosSeleccionados.length>0),l(),g("ngIf",t.repuestosSeleccionados.length===0&&!t.mostrarSelectorRepuestos),l(3),g("ngIf",t.error),l(4),g("disabled",!t.albaranForm.valid||t.loading),l(),g("ngIf",!t.loading),l(),g("ngIf",t.loading),l(),F(" ",t.loading?"Guardando...":"Guardar Albar\xE1n"," "))},dependencies:[L,an,Q,B,En,Ie,Oe,we,Ee,be,xe,ye,Ce,Me,ke,he,ve,Se,Pe,U,Ae,kn,Sn,In,zn],styles:[`@charset "UTF-8";ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #fff;--border-color: #e5e7eb;--color: #111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600;color:#111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#6b7280;margin-top:0;font-size:14px}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#6b7280;display:flex;align-items:center;justify-content:center}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px}ion-content[_ngcontent-%COMP%]{--background: #fff;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0;overflow-x:hidden}ion-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex;flex-direction:column;min-height:0;overflow-x:hidden}ion-content[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{flex:1;overflow:auto;overflow-x:hidden;position:relative;min-height:0;height:100%}ion-content[_ngcontent-%COMP%]   .modal-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:0;height:100%;overflow:hidden;overflow-x:hidden}@media (max-width: 768px){ion-content[_ngcontent-%COMP%]   .modal-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto auto;height:auto;overflow:visible}}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #fff;--border-color: #e5e7eb}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#fef2f2;border:1px solid #FECACA;border-radius:6px;color:#dc2626;margin-bottom:20px;font-size:14px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;color:#dc2626;flex-shrink:0}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500;flex:1}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:6px 12px;background:#dc2626;color:#fff;border:none;border-radius:4px;font-size:12px;font-weight:500;cursor:pointer;transition:all .2s;margin-left:8px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]:hover{background:#b91c1c}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px;color:#fff}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:6px;font-size:14px;font-weight:500;display:flex;align-items:center;gap:8px;cursor:pointer;transition:all .2s}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{background:none;border:1px solid #d1d5db;color:#374151}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f8fafc;border-color:#9ca3af}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#2563eb;border:1px solid #2563eb;color:#fff}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#1d4ed8;border-color:#1d4ed8}.form-section[_ngcontent-%COMP%]{padding:24px;border-right:1px solid #e5e7eb;overflow-y:auto;height:100%;max-height:100%}@media (max-width: 768px){.form-section[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e5e7eb;height:auto;max-height:none;overflow:visible;padding-bottom:30px}}.form-section[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#d1d5db #f3f4f6}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f3f4f6;border-radius:3px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:3px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}.images-section[_ngcontent-%COMP%]{padding:24px;background-color:#f9fafb;overflow-y:auto;height:100%;max-height:100%}@media (max-width: 768px){.images-section[_ngcontent-%COMP%]{height:auto;max-height:none;overflow:visible;min-height:300px;padding-bottom:80px}}.images-section[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#d1d5db #f3f4f6}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f3f4f6;border-radius:3px}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:3px}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}.images-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;font-size:16px;color:#374151;font-weight:600}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:14px;font-weight:500;color:#374151}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#dc2626}.form-group.half[_ngcontent-%COMP%]{flex:1}.form-control[_ngcontent-%COMP%]{position:relative;width:100%;padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px;color:#111827;background-color:#fff;transition:border-color .2s}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 2px #2563eb1a}.form-control[_ngcontent-%COMP%]:disabled{background-color:#f9fafb;color:#6b7280;cursor:not-allowed}select.form-control[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;background-size:16px;padding-right:40px}select.form-control[_ngcontent-%COMP%]:disabled{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")}select.form-control[_ngcontent-%COMP%]::placeholder{color:#9ca3af}select.form-control[_ngcontent-%COMP%]   option[value=""][_ngcontent-%COMP%]{color:#9ca3af}select.form-control[_ngcontent-%COMP%]{padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s}select.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}input.form-control[_ngcontent-%COMP%]{padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s}input.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}textarea.form-control[_ngcontent-%COMP%]{position:relative;padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s;resize:vertical;min-height:80px}textarea.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}.character-count[_ngcontent-%COMP%]{margin-top:4px;text-align:right;font-size:12px;color:#6b7280;position:absolute;bottom:13px;right:13px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px}.form-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:0;flex:1}.input-with-button[_ngcontent-%COMP%]{position:relative;display:flex;gap:8px}.input-with-button[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1}.input-with-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:6px 10px;background:none;border:none;color:#4f46e5;font-size:14px;cursor:pointer;white-space:nowrap;border:1px solid #d2d2d2;position:absolute;right:8px;top:6px;border-radius:8px;font-weight:500}.input-with-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:hover{color:#1d4ed8}.input-with-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.help-text[_ngcontent-%COMP%]{display:block;font-size:11px;color:#6b7280;margin-top:4px;font-style:italic;line-height:1.4}.checkbox-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.checkbox-group[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer}.checkbox-group[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:16px;height:16px;margin:0}.checkbox-group[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]{font-size:14px;color:#374151}.checkbox-group[_ngcontent-%COMP%]   .helper-text[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin-left:24px}.imagen-upload-container[_ngcontent-%COMP%]{margin-bottom:24px}.imagen-upload-container[_ngcontent-%COMP%]   .drop-zone[_ngcontent-%COMP%]{border:2px dashed #d1d5db;border-radius:8px;padding:32px;text-align:center;cursor:pointer;transition:all .2s;background-color:#fff}.imagen-upload-container[_ngcontent-%COMP%]   .drop-zone[_ngcontent-%COMP%]:hover{border-color:#2563eb;background-color:#f8fafc}.imagen-upload-container[_ngcontent-%COMP%]   .drop-zone[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#6b7280}.imagen-upload-container[_ngcontent-%COMP%]   .drop-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:16px 0 8px;font-size:16px;color:#374151}.imagen-upload-container[_ngcontent-%COMP%]   .drop-zone[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#6b7280}.uploaded-files[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;color:#374151}.file-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.file-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px;background-color:#fff;border-radius:6px;border:1px solid #e5e7eb}.file-item[_ngcontent-%COMP%]   .file-preview[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:4px;overflow:hidden;background-color:#f3f4f6}.file-item[_ngcontent-%COMP%]   .file-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]{flex:1;min-width:0}.file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{display:block;font-size:14px;color:#374151;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-size[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.file-item[_ngcontent-%COMP%]   .remove-file[_ngcontent-%COMP%]{background:none;border:none;padding:8px;color:#dc2626;cursor:pointer;display:flex;align-items:center;justify-content:center}.file-item[_ngcontent-%COMP%]   .remove-file[_ngcontent-%COMP%]:hover{color:#b91c1c}.file-item[_ngcontent-%COMP%]   .remove-file[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}@media (max-width: 768px){.modal-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto auto;height:auto;overflow:visible}.form-section[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e5e7eb;height:auto;max-height:none;overflow:visible;padding-bottom:30px}.images-section[_ngcontent-%COMP%]{display:none;height:auto;max-height:none;overflow:visible;min-height:300px;padding-bottom:80px}.form-control[_ngcontent-%COMP%]{font-size:16px;padding:12px}textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{font-size:14px!important;padding:12px}.input-with-button[_ngcontent-%COMP%]{flex-direction:column}.input-with-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]{position:static;margin-top:8px;width:100%;justify-content:center}}.loading-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:8px;font-size:12px;color:#6b7280}.loading-indicator[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%]{margin-top:8px;font-size:12px;color:#dc2626;display:flex;align-items:center;gap:4px}.error-message[_ngcontent-%COMP%]:before{content:"\\26a0";font-size:14px}.repuestos-section[_ngcontent-%COMP%], .repuestos-container[_ngcontent-%COMP%]{position:sticky;top:20px}.repuestos-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .repuestos-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{border-bottom:2px solid #10B981;padding-bottom:8px}@media (max-width: 1199px){.repuestos-section[_ngcontent-%COMP%]{position:static;top:auto}}.repuestos-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:24px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;padding:10px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;width:100%}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.repuestos-actions[_ngcontent-%COMP%]   .btn-select-inventory[_ngcontent-%COMP%]{background:#2563eb;color:#fff}.repuestos-actions[_ngcontent-%COMP%]   .btn-select-inventory[_ngcontent-%COMP%]:hover{background:#1d4ed8}.repuestos-actions[_ngcontent-%COMP%]   .btn-add-manual[_ngcontent-%COMP%]{background:#10b981;color:#fff}.repuestos-actions[_ngcontent-%COMP%]   .btn-add-manual[_ngcontent-%COMP%]:hover{background:#059669}.repuestos-empty[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#9ca3af}.repuestos-empty[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:16px;opacity:.5}.repuestos-empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;font-weight:500;color:#6b7280}.repuestos-empty[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:13px;color:#9ca3af;line-height:1.4}.inventory-selector[_ngcontent-%COMP%]{background:#fff;padding:0;margin-bottom:15px;max-height:400px;overflow:hidden;display:flex;flex-direction:column}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:5px}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#1f2937;font-size:16px;font-weight:600}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;font-size:20px;cursor:pointer;padding:4px;border-radius:4px;transition:all .2s}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{position:relative;margin-bottom:5px}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{--background: #FAFAFB;--border-radius: 6px;--border-width: 1px;--border-color: transparent;--padding-start: 40px 12px 12px;--padding-end: 12px;--padding-top: 10px;--padding-left: 12px;--padding-bottom: 10px;--color: #111827;--placeholder-color: #9CA3AF;font-size:14px;transition:border-color .2s}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus-within{--border-color: #2563eb;--background: #fff;box-shadow:0 0 0 2px #2563eb1a}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#9ca3af;font-size:18px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]{flex:1;max-height:250px;overflow-y:auto;border:1px solid #E5E7EB;border-radius:6px;background:#f9fafb}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid #E5E7EB;cursor:pointer;transition:all .2s}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-price[_ngcontent-%COMP%]{font-weight:600;color:#059669;font-size:13px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]{flex:1}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]   .product-code[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;background:#e5e7eb;padding:2px 6px;border-radius:4px;font-weight:500}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]   .product-price[_ngcontent-%COMP%]{font-weight:600;color:#059669;font-size:13px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;font-size:13px;margin-bottom:4px;display:block}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-stock[_ngcontent-%COMP%]{font-size:11px;color:#6b7280}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-stock.stock-bajo[_ngcontent-%COMP%]{color:#f59e0b;font-weight:600}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-stock.stock-critico[_ngcontent-%COMP%]{color:#ef4444;font-weight:700}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-stock[_ngcontent-%COMP%]   .stock-indicador[_ngcontent-%COMP%]{font-size:10px;font-style:italic;margin-left:4px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-description[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .add-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:18px;margin-left:8px}.repuestos-list[_ngcontent-%COMP%]{margin-top:20px}.repuestos-list[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:#1f2937;font-size:16px;font-weight:600}.repuestos-list[_ngcontent-%COMP%]   .precio-total[_ngcontent-%COMP%]{background:#f0fdf4;border:1px solid #BBF7D0;border-radius:6px;padding:12px 16px;margin-bottom:16px;text-align:center}.repuestos-list[_ngcontent-%COMP%]   .precio-total[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#059669;font-size:16px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item-compacto[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px 12px;background:#f0f9ff;border:1px solid #BAE6FD;border-radius:6px;margin-bottom:6px;width:100%}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item-compacto[_ngcontent-%COMP%]   .repuesto-denominacion[_ngcontent-%COMP%]{flex:1;font-weight:500;color:#0369a1;font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item-compacto[_ngcontent-%COMP%]   .cantidad-input-compacto[_ngcontent-%COMP%]{width:50px;padding:4px 6px;border:1px solid #D1D5DB;border-radius:4px;font-size:12px;text-align:center;background-color:#fafafb;color:#111827}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item-compacto[_ngcontent-%COMP%]   .btn-remove-compacto[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626;border:none;padding:4px;border-radius:4px;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;width:28px;height:28px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item-compacto[_ngcontent-%COMP%]   .btn-remove-compacto[_ngcontent-%COMP%]:hover{background:#fecaca}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item-compacto[_ngcontent-%COMP%]   .btn-remove-compacto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.formulario-repuesto-manual[_ngcontent-%COMP%]{background:#fff;border:1px solid #E2E8F0;border-radius:8px;padding:16px;margin-bottom:16px;box-shadow:0 1px 3px #0000001a}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#1f2937;font-size:14px;font-weight:600}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;font-size:16px;cursor:pointer;padding:2px;border-radius:4px;transition:all .2s}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-input[_ngcontent-%COMP%]{flex:1}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-input[_ngcontent-%COMP%]   .input-denominacion[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #D1D5DB;border-radius:6px;font-size:14px;background-color:#fafafb;color:#111827;transition:border-color .2s}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-input[_ngcontent-%COMP%]   .input-denominacion[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-input[_ngcontent-%COMP%]   .input-denominacion[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-cantidad[_ngcontent-%COMP%]   .input-cantidad[_ngcontent-%COMP%]{width:60px;padding:8px 6px;border:1px solid #D1D5DB;border-radius:6px;font-size:14px;text-align:center;background-color:#fafafb;color:#111827;transition:border-color .2s}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-cantidad[_ngcontent-%COMP%]   .input-cantidad[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-cantidad[_ngcontent-%COMP%]   .input-cantidad[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-precio[_ngcontent-%COMP%]   .input-precio[_ngcontent-%COMP%]{width:70px;padding:8px 6px;border:1px solid #D1D5DB;border-radius:6px;font-size:14px;text-align:center;background-color:#fafafb;color:#111827;transition:border-color .2s}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-precio[_ngcontent-%COMP%]   .input-precio[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-precio[_ngcontent-%COMP%]   .input-precio[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .btn-agregar[_ngcontent-%COMP%]{background:#10b981;color:#fff;border:none;padding:8px;border-radius:6px;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;width:36px;height:36px}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .btn-agregar[_ngcontent-%COMP%]:hover{background:#059669}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .btn-agregar[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.estados-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}@media (min-width: 1200px){.estados-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr);gap:20px}}.estado-option[_ngcontent-%COMP%]{border:2px solid #E5E7EB;border-radius:8px;padding:20px;cursor:pointer;transition:all .2s ease;position:relative;background:#fff}.estado-option[_ngcontent-%COMP%]:hover{border-color:#2563eb;transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.estado-option.selected[_ngcontent-%COMP%]{border-color:#2563eb;background:#eff6ff}.estado-option.selected[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#2563eb}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;font-weight:600;color:#111827}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:13px;color:#6b7280;line-height:1.4}.estado-option[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px;font-size:20px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]{border:2px dashed #D1D5DB;border-radius:8px;padding:20px;text-align:center;background:#f9fafb;transition:all .2s ease;min-height:200px;display:flex;align-items:center;justify-content:center;position:relative}.signature-area[_ngcontent-%COMP%]:hover{border-color:#2563eb;background:#eff6ff}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;gap:16px}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-canvas[_ngcontent-%COMP%]{border:1px solid #E5E7EB;border-radius:6px;background:#fff;cursor:crosshair;touch-action:none}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-clear[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-clear[_ngcontent-%COMP%]:hover{background:#fecaca}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]{background:#10b981;color:#fff}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]:hover{background:#059669}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;gap:16px}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .firma-image[_ngcontent-%COMP%]{max-width:100%;max-height:120px;border:1px solid #E5E7EB;border-radius:6px;background:#fff}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]{background:#dbeafe;color:#1d4ed8}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]:hover{background:#bfdbfe}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]:hover{background:#fecaca}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;color:#6b7280;margin-top:15px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;font-weight:500}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 20px;background:#2563eb;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s;margin-top:8px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]:hover{background:#1d4ed8}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.mobile-only[_ngcontent-%COMP%]{display:block}.desktop-only[_ngcontent-%COMP%]{display:none}@media (min-width: 1200px){.mobile-only[_ngcontent-%COMP%]{display:none}.desktop-only[_ngcontent-%COMP%]{display:block}}@media (max-width: 768px){.modal-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto auto;height:auto;overflow:visible}.form-section[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e5e7eb;height:auto;max-height:none;overflow:visible;padding-bottom:30px}.images-section[_ngcontent-%COMP%]{height:auto;max-height:none;overflow:visible;min-height:300px;padding-bottom:80px}.form-control[_ngcontent-%COMP%]{font-size:16px;padding:12px}textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{font-size:14px!important;padding:12px}.input-with-button[_ngcontent-%COMP%]{flex-direction:column}.input-with-button[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]{position:static;margin-top:8px;width:100%;justify-content:center}.estados-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.estado-option[_ngcontent-%COMP%]{padding:16px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:15px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}.estado-option[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;top:12px;right:12px}.repuestos-actions[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.repuestos-list[_ngcontent-%COMP%]{width:100%;overflow:hidden}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item-compacto[_ngcontent-%COMP%]{padding:6px 8px;gap:8px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item-compacto[_ngcontent-%COMP%]   .repuesto-denominacion[_ngcontent-%COMP%]{font-size:13px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item-compacto[_ngcontent-%COMP%]   .cantidad-input-compacto[_ngcontent-%COMP%]{width:45px;font-size:12px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item-compacto[_ngcontent-%COMP%]   .btn-remove-compacto[_ngcontent-%COMP%]{width:24px;height:24px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item-compacto[_ngcontent-%COMP%]   .btn-remove-compacto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:10px}.formulario-repuesto-manual[_ngcontent-%COMP%]{padding:12px;margin-bottom:12px}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]{flex-direction:row;gap:8px}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-input[_ngcontent-%COMP%]{width:100%}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-input[_ngcontent-%COMP%]   .input-denominacion[_ngcontent-%COMP%]{font-size:16px;padding:10px 12px}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-cantidad[_ngcontent-%COMP%]{align-self:flex-start}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-cantidad[_ngcontent-%COMP%]   .input-cantidad[_ngcontent-%COMP%]{width:60px;font-size:16px;padding:10px 6px}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-precio[_ngcontent-%COMP%]{align-self:flex-start}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .campo-precio[_ngcontent-%COMP%]   .input-precio[_ngcontent-%COMP%]{width:60px;font-size:16px;padding:10px 6px}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .btn-agregar[_ngcontent-%COMP%]{align-self:flex-end;width:40px;height:43px}.formulario-repuesto-manual[_ngcontent-%COMP%]   .formulario-campos[_ngcontent-%COMP%]   .btn-agregar[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.signature-area[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px 10px;min-height:200px;border:2px dashed #D1D5DB;border-radius:8px;background:#f9fafb;transition:all .2s ease}.signature-area[_ngcontent-%COMP%]:hover{border-color:#2563eb;background:#eff6ff}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;color:#6b7280;text-align:center}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;font-weight:500}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 20px;background:#2563eb;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s;margin-top:8px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]:hover{background:#1d4ed8}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;gap:16px}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-canvas[_ngcontent-%COMP%]{border:1px solid #E5E7EB;border-radius:6px;background:#fff;cursor:crosshair;touch-action:none;width:100%;max-width:400px;height:200px}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-clear[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-clear[_ngcontent-%COMP%]:hover{background:#fecaca}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]{background:#10b981;color:#fff}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]:hover{background:#059669}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;gap:16px}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .firma-image[_ngcontent-%COMP%]{max-width:100%;max-height:120px;border:1px solid #E5E7EB;border-radius:6px;background:#fff}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]{background:#dbeafe;color:#1d4ed8}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]:hover{background:#bfdbfe}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]:hover{background:#fecaca}}@media all and (display-mode: standalone){ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding-top:calc(16px + var(--ion-safe-area-top, 0px))}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding-bottom:calc(16px + var(--ion-safe-area-bottom, 0px))}}@supports (-webkit-touch-callout: none){@media all and (display-mode: standalone){ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding-top:calc(16px + var(--ion-safe-area-top, 0px))}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding-bottom:calc(16px + var(--ion-safe-area-bottom, 0px))}}}@supports not (-webkit-touch-callout: none){ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding-bottom:calc(16px + var(--ion-safe-area-bottom, 16px))}}.presupuesto-info[_ngcontent-%COMP%]{margin-bottom:20px}.presupuesto-info[_ngcontent-%COMP%]   .info-box[_ngcontent-%COMP%]{background:#f0f9ff;border:1px solid #BAE6FD;border-radius:8px;padding:16px;display:flex;align-items:flex-start;gap:12px;width:100%;box-sizing:border-box;overflow:hidden;word-wrap:break-word}.presupuesto-info[_ngcontent-%COMP%]   .info-box[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#0ea5e9;font-size:20px;margin-top:1px;flex-shrink:0}.presupuesto-info[_ngcontent-%COMP%]   .info-box[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]{flex:1;min-width:0;overflow:hidden}.presupuesto-info[_ngcontent-%COMP%]   .info-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px;color:#0c4a6e;font-size:14px;font-weight:500;line-height:1.4;word-wrap:break-word;overflow-wrap:break-word}.presupuesto-info[_ngcontent-%COMP%]   .info-box[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#0369a1;font-size:12px;margin:0;display:block;line-height:1.3;word-wrap:break-word;overflow-wrap:break-word}`]});let r=d;return r})();function Lt(r,d){r&1&&(o(0,"div",4),p(1,"ion-icon",5),o(2,"span",6),s(3,"Cargando estado del flujo..."),a(),o(4,"span",7),s(5,"Cargando..."),a()())}function Ut(r,d){if(r&1){let i=v();o(0,"div",8),p(1,"ion-icon",9),o(2,"span",10),s(3),a(),o(4,"button",11),_("click",function(){P(i);let e=m();return O(e.recargar())}),p(5,"ion-icon",12),o(6,"span",6),s(7,"Reintentar"),a(),o(8,"span",7),s(9,"Reintentar"),a()()()}if(r&2){let i=m();l(3),M(i.error)}}function qt(r,d){if(r&1){let i=v();o(0,"div",19)(1,"div",20),p(2,"ion-icon",21),o(3,"span",22),s(4),a()(),o(5,"button",23),_("click",function(){P(i);let e=m(2);return O(e.recargar())}),p(6,"ion-icon",12),a()()}if(r&2){let i=m(2);l(),g("ngClass",i.getEstadoClass()),l(),g("name",i.getEstadoIcon()),l(2),M(i.estadoFlujo.estadoActual)}}function Gt(r,d){if(r&1){let i=v();o(0,"button",28),_("click",function(){let e=P(i).$implicit,t=m(3);return O(t.ejecutarAccion(e))}),p(1,"ion-icon",21),o(2,"span",29),s(3),a()()}if(r&2){let i=d.$implicit,n=m(3);g("disabled",n.loading)("title",n.getAccionTexto(i)),l(),g("name",n.getAccionIcon(i)),l(2),M(n.getAccionTexto(i))}}function Yt(r,d){if(r&1&&(o(0,"div",24)(1,"h4",25),s(2,"Acciones disponibles:"),a(),o(3,"div",26),h(4,Gt,4,4,"button",27),a()()),r&2){let i=m(2);l(4),g("ngForOf",i.accionesDisponibles)}}function Wt(r,d){r&1&&(o(0,"div",30),p(1,"ion-icon",31),o(2,"span",32),s(3,"Aviso completado"),a()())}function Xt(r,d){r&1&&(o(0,"div",35),p(1,"ion-icon",36),o(2,"span",37),s(3,"Esperando cierre de albaranes o facturaci\xF3n"),a()())}function Zt(r,d){if(r&1&&(o(0,"div",33),h(1,Xt,4,0,"div",34),a()),r&2){let i=m(2);l(),g("ngIf",i.accionesDisponibles.length===0&&!i.estadoFlujo.puedeCrearPresupuesto&&i.estadoFlujo.estadoActual!=="Completado")}}function Qt(r,d){if(r&1&&(o(0,"div",13)(1,"div",14),h(2,qt,7,3,"div",15),a(),h(3,Yt,5,1,"div",16)(4,Wt,4,0,"div",17)(5,Zt,2,1,"div",18),a()),r&2){let i=m();l(2),g("ngIf",i.estadoFlujo.estadoActual!=="Completado"),l(),g("ngIf",i.accionesDisponibles.length>0&&i.estadoFlujo.estadoActual!=="Completado"),l(),g("ngIf",i.estadoFlujo.estadoActual==="Completado"),l(),g("ngIf",i.estadoFlujo.estadoActual==="No visitado"||i.estadoFlujo.estadoActual==="Visitado pendiente")}}var ie=(()=>{let d=class d{constructor(n){this.flujoService=n,this.accionEjecutada=new de,this.estadoFlujo=null,this.accionesDisponibles=[],this.loading=!1,this.error=null,this.destroy$=new vn,V({documentTextOutline:nn,checkmarkCircleOutline:K,timeOutline:ln,receiptOutline:nt,createOutline:cn,eyeOutline:Vn,arrowForwardOutline:$e,warningOutline:dn,refreshOutline:N})}ngOnInit(){this.avisoId&&this.cargarEstadoFlujo()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarEstadoFlujo(){this.loading=!0,this.error=null,this.flujoService.obtenerEstadoFlujo(this.avisoId).pipe(D(this.destroy$)).subscribe({next:n=>{this.estadoFlujo=n,this.cargarAccionesDisponibles(),this.loading=!1},error:n=>{console.error("Error al cargar estado del flujo:",n),this.error="Error al cargar el estado del flujo",this.loading=!1}})}cargarAccionesDisponibles(){this.flujoService.obtenerAccionesDisponibles(this.avisoId).pipe(D(this.destroy$)).subscribe({next:n=>{this.accionesDisponibles=n},error:n=>{console.error("Error al cargar acciones:",n)}})}recargarFlujo(){console.log("\u{1F504} Recargando flujo desde componente padre..."),this.cargarEstadoFlujo()}ejecutarAccion(n){var t,c,u,f,x,b;this.loading=!0,this.error=null;let e;switch(n){case"crear_presupuesto":e=this.flujoService.ejecutarFlujoCompleto(this.avisoId,!0);break;case"aprobar_presupuesto":let C=(u=(c=(t=this.estadoFlujo)==null?void 0:t.resumen)==null?void 0:c.presupuesto)==null?void 0:u.id;C&&(e=this.flujoService.aprobarPresupuesto(C));break;case"facturar_presupuesto":let j=(b=(x=(f=this.estadoFlujo)==null?void 0:f.resumen)==null?void 0:x.presupuesto)==null?void 0:b.id;j&&(e=this.flujoService.facturarPresupuesto(j));break;case"facturar_trabajos":e=this.flujoService.facturarTrabajos(this.avisoId);break;case"completar_aviso":this.completarAviso();break;default:this.loading=!1;return}e&&e.pipe(D(this.destroy$)).subscribe({next:C=>{console.log("Acci\xF3n ejecutada:",C),this.accionEjecutada.emit(C),this.cargarEstadoFlujo(),this.cargarAccionesDisponibles(),this.loading=!1},error:C=>{console.error("Error al ejecutar acci\xF3n:",C),this.error=`Error al ejecutar ${n}: ${C.message}`,this.loading=!1}})}iniciarFlujoDirecto(){this.loading=!0,this.flujoService.ejecutarFlujoCompleto(this.avisoId,!1).pipe(D(this.destroy$)).subscribe({next:n=>{console.log("Flujo directo iniciado:",n),this.accionEjecutada.emit(n),this.cargarEstadoFlujo(),this.cargarAccionesDisponibles(),this.loading=!1},error:n=>{console.error("Error al iniciar flujo directo:",n),this.error=`Error al iniciar flujo directo: ${n.message}`,this.loading=!1}})}completarAviso(){if(!this.avisoId){console.error("No hay aviso seleccionado para completar");return}console.log("\u{1F504} Completando aviso:",this.avisoId),this.loading=!0,this.flujoService.completarAviso(this.avisoId).subscribe({next:n=>{console.log("\u2705 Aviso completado exitosamente:",n),this.loading=!1,this.mostrarMensaje("Aviso completado exitosamente","success"),this.cargarEstadoFlujo(),this.cargarAccionesDisponibles(),this.accionEjecutada.emit(n)},error:n=>{console.error("\u274C Error al completar aviso:",n),this.loading=!1,this.mostrarMensaje(n.message||"Error al completar el aviso. Verifica que haya trabajos realizados y facturas generadas.","error")}})}mostrarMensaje(n,e="info"){console.log(`[${e.toUpperCase()}] ${n}`)}getEstadoIcon(){if(!this.estadoFlujo)return"time-outline";switch(this.estadoFlujo.estadoActual){case"No visitado":return"time-outline";case"Visitado pendiente":return"eye-outline";case"Pendiente de presupuesto":return"document-text-outline";case"En curso":return"create-outline";case"Completado":return"checkmark-circle-outline";default:return"time-outline"}}getEstadoClass(){if(!this.estadoFlujo)return"pendiente";switch(this.estadoFlujo.estadoActual){case"Pendiente":return"pendiente";case"Pendiente de presupuesto":return"presupuesto";case"En curso":return"en-curso";case"Listo para facturar":return"listo-facturar";case"Completado":return"completado";case"Cancelado":return"cancelado";default:return"pendiente"}}getAccionTexto(n){switch(n){case"crear_presupuesto":return"Crear Presupuesto";case"aprobar_presupuesto":return"Aprobar Presupuesto";case"facturar_presupuesto":return"Generar Factura desde Presupuesto";case"facturar_trabajos":return"Facturar Trabajos Realizados";case"completar_aviso":return"Completar Aviso";default:return n}}getAccionIcon(n){switch(n){case"crear_presupuesto":return"document-text-outline";case"aprobar_presupuesto":return"checkmark-circle-outline";case"facturar_presupuesto":case"facturar_trabajos":return"receipt-outline";case"completar_aviso":return"checkmark-circle-outline";default:return"arrow-forward-outline"}}recargar(){this.cargarEstadoFlujo()}};d.\u0275fac=function(e){return new(e||d)(z($n))},d.\u0275cmp=H({type:d,selectors:[["app-flujo-estado"]],inputs:{avisoId:"avisoId"},outputs:{accionEjecutada:"accionEjecutada"},decls:4,vars:3,consts:[[1,"flujo-estado-container"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","flujo-content",4,"ngIf"],[1,"loading-state"],["name","refresh-outline",1,"spinning"],[1,"desktop-only"],[1,"mobile-only"],[1,"error-state"],["name","warning-outline"],[1,"error-text"],[1,"btn-retry",3,"click"],["name","refresh-outline"],[1,"flujo-content"],[1,"estado-actual"],["class","estado-header",4,"ngIf"],["class","acciones-disponibles",4,"ngIf"],["class","aviso-completado",4,"ngIf"],["class","flujo-inicial",4,"ngIf"],[1,"estado-header"],[1,"estado-badge",3,"ngClass"],[3,"name"],[1,"estado-text"],["title","Actualizar estado",1,"btn-refresh",3,"click"],[1,"acciones-disponibles"],[1,"section-title"],[1,"acciones-grid"],["class","btn-accion",3,"disabled","title","click",4,"ngFor","ngForOf"],[1,"btn-accion",3,"click","disabled","title"],[1,"accion-text"],[1,"aviso-completado"],["name","checkmark-circle-outline",1,"complete-icon"],[1,"complete-text"],[1,"flujo-inicial"],["class","sin-acciones",4,"ngIf"],[1,"sin-acciones"],["name","time-outline",1,"waiting-icon"],[1,"waiting-text"]],template:function(e,t){e&1&&(o(0,"div",0),h(1,Lt,6,0,"div",1)(2,Ut,10,1,"div",2)(3,Qt,6,4,"div",3),a()),e&2&&(l(),g("ngIf",t.loading),l(),g("ngIf",t.error&&!t.loading),l(),g("ngIf",t.estadoFlujo&&!t.loading&&!t.error))},dependencies:[L,an,Q,B,U],styles:[".flujo-estado-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;border:1px solid #E2E8F0;overflow:hidden;box-shadow:0 1px 3px #0000001a}.desktop-only[_ngcontent-%COMP%]{display:inline}.mobile-only[_ngcontent-%COMP%]{display:none}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;padding:24px;text-align:center;color:#64748b;font-size:14px}.loading-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#4f46e5}.loading-state.error-state[_ngcontent-%COMP%], .error-state.error-state[_ngcontent-%COMP%]{color:#dc2626}.loading-state.error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state.error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#dc2626}.error-text[_ngcontent-%COMP%]{word-break:break-word;line-height:1.4}.btn-retry[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:#f1f5f9;border:1px solid #CBD5E1;border-radius:8px;font-size:12px;color:#475569;cursor:pointer;transition:all .2s ease}.btn-retry[_ngcontent-%COMP%]:hover{background:#e2e8f0;border-color:#94a3b8}.btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.flujo-content[_ngcontent-%COMP%]{padding:20px}.estado-actual[_ngcontent-%COMP%]   .estado-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;border-radius:20px;font-size:14px;font-weight:500}.estado-actual[_ngcontent-%COMP%]   .estado-badge.pendiente[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.estado-actual[_ngcontent-%COMP%]   .estado-badge.pendiente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#d97706}.estado-actual[_ngcontent-%COMP%]   .estado-badge.presupuesto[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.estado-actual[_ngcontent-%COMP%]   .estado-badge.presupuesto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#3b82f6}.estado-actual[_ngcontent-%COMP%]   .estado-badge.en-curso[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.estado-actual[_ngcontent-%COMP%]   .estado-badge.en-curso[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#22c55e}.estado-actual[_ngcontent-%COMP%]   .estado-badge.completado[_ngcontent-%COMP%]{background:#ecfdf5;color:#14532d}.estado-actual[_ngcontent-%COMP%]   .estado-badge.completado[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#10b981}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.estado-actual[_ngcontent-%COMP%]   .estado-text[_ngcontent-%COMP%]{font-weight:500}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;background:#f8fafc;border:1px solid #E2E8F0;border-radius:8px;cursor:pointer;transition:all .2s ease}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;color:#64748b}.resumen-info[_ngcontent-%COMP%]{background:#f8fafc;border-radius:8px;padding:16px}.resumen-info[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:13px;color:#64748b;font-weight:500}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:13px;color:#1e293b;font-weight:600}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value.si[_ngcontent-%COMP%]{color:#059669}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value.no[_ngcontent-%COMP%]{color:#dc2626}.acciones-disponibles[_ngcontent-%COMP%]{margin-bottom:24px}.acciones-disponibles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0 0 12px;font-size:16px;color:#1e293b;font-weight:600}.acciones-disponibles[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:12px 16px;background:#4f46e5;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;text-align:left}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]:hover:not(:disabled){background:#4338ca;transform:translateY(-1px);box-shadow:0 4px 8px #4f46e54d}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;flex-shrink:0}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   .accion-text[_ngcontent-%COMP%]{flex:1}.flujo-inicial[_ngcontent-%COMP%]{margin-bottom:24px}.flujo-inicial[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;color:#1e293b;font-weight:600}.flujo-inicial[_ngcontent-%COMP%]   .flujo-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:20px;background:#f8fafc;border:1px solid #E2E8F0;border-radius:12px;transition:all .2s ease}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]:hover{background:#f0f9ff;border-color:#4f46e5;transform:translateY(-1px);box-shadow:0 4px 12px #0000001a}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:28px;color:#4f46e5;flex-shrink:0;background:#eef2ff;padding:12px;border-radius:50%}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;flex:1}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1e293b}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-description[_ngcontent-%COMP%]{font-size:14px;color:#64748b;line-height:1.4}.sin-acciones[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;padding:20px;color:#64748b;font-size:14px;text-align:center}.sin-acciones[_ngcontent-%COMP%]   .waiting-icon[_ngcontent-%COMP%]{font-size:20px;color:#f59e0b}.sin-acciones[_ngcontent-%COMP%]   .waiting-text[_ngcontent-%COMP%]{font-weight:500}.aviso-completado[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;padding:15px;color:#10b981;background:#ecfdf5;font-size:14px;text-align:center;border-radius:12px;border:1px solid #D1FAE5}.aviso-completado[_ngcontent-%COMP%]   .complete-icon[_ngcontent-%COMP%]{font-size:20px;color:#10b981}.aviso-completado[_ngcontent-%COMP%]   .complete-text[_ngcontent-%COMP%]{font-weight:500}@media (max-width: 768px){.desktop-only[_ngcontent-%COMP%]{display:none}.mobile-only[_ngcontent-%COMP%]{display:inline}.flujo-content[_ngcontent-%COMP%]{padding:16px}.estado-actual[_ngcontent-%COMP%]   .estado-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;margin-bottom:12px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{width:28px;height:28px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.resumen-info[_ngcontent-%COMP%]{padding:12px}.resumen-info[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:12px}.acciones-disponibles[_ngcontent-%COMP%]{margin-bottom:20px}.acciones-disponibles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:15px;margin-bottom:10px}.acciones-disponibles[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{padding:10px 12px;font-size:13px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.flujo-inicial[_ngcontent-%COMP%]{margin-bottom:20px}.flujo-inicial[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:15px;margin-bottom:10px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-info[_ngcontent-%COMP%]{gap:12px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]{padding:16px;gap:12px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;padding:10px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:14px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-description[_ngcontent-%COMP%]{font-size:12px}.sin-acciones[_ngcontent-%COMP%]{padding:16px}.sin-acciones[_ngcontent-%COMP%]   .complete-icon[_ngcontent-%COMP%]{font-size:18px}.sin-acciones[_ngcontent-%COMP%]   .complete-text[_ngcontent-%COMP%]{font-size:13px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{padding:20px;font-size:13px}.loading-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.btn-retry[_ngcontent-%COMP%]{padding:6px 12px;font-size:11px}.btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}}@media (max-width: 480px){.flujo-content[_ngcontent-%COMP%]{padding:12px}.estado-actual[_ngcontent-%COMP%]   .estado-header[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between;gap:8px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{justify-content:center;padding:4px 10px;font-size:12px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{align-self:center;width:26px;height:26px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.resumen-info[_ngcontent-%COMP%]{padding:10px}.resumen-info[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{gap:6px}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:11px}.acciones-disponibles[_ngcontent-%COMP%]{margin-bottom:16px}.acciones-disponibles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:14px;margin-bottom:8px}.acciones-disponibles[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{gap:6px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{padding:8px 10px;font-size:12px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.flujo-inicial[_ngcontent-%COMP%]{margin-bottom:16px}.flujo-inicial[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:14px;margin-bottom:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-info[_ngcontent-%COMP%]{gap:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]{padding:12px;gap:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;padding:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:13px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-description[_ngcontent-%COMP%]{font-size:11px}.sin-acciones[_ngcontent-%COMP%]{padding:12px;gap:8px}.sin-acciones[_ngcontent-%COMP%]   .complete-icon[_ngcontent-%COMP%]{font-size:16px}.sin-acciones[_ngcontent-%COMP%]   .complete-text[_ngcontent-%COMP%]{font-size:12px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{padding:16px;font-size:12px;gap:8px}.loading-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.btn-retry[_ngcontent-%COMP%]{padding:4px 8px;font-size:10px}.btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:10px}}"]});let r=d;return r})();var lt=(()=>{let d=class d{constructor(n){this.configuracionService=n}generarPdfAlbaran(n,e="albaran.pdf"){var re;let t=new je,c=20,u=[0,0,0],f=[64,64,64],x=[32,32,32],b=[128,128,128],C=(y,w,k,S={})=>{if(typeof w!="number"||isNaN(w)||typeof k!="number"||isNaN(k)){console.warn("Coordenadas inv\xE1lidas para addText:",{x:w,y:k,text:y});return}t.setFontSize(S.fontSize||10);let E=S.color||x;Array.isArray(E)&&E.length===3&&typeof E[0]=="number"&&typeof E[1]=="number"&&typeof E[2]=="number"?t.setTextColor(E[0],E[1],E[2]):t.setTextColor(x[0],x[1],x[2]),t.setFont(S.font||"helvetica",S.style||"normal"),t.text(y,w,k)},j=(y,w,k,S,E=[229,231,235])=>{if(typeof y!="number"||isNaN(y)||typeof w!="number"||isNaN(w)||typeof k!="number"||isNaN(k)||typeof S!="number"||isNaN(S)){console.warn("Coordenadas inv\xE1lidas para drawLine:",{x1:y,y1:w,x2:k,y2:S});return}t.setDrawColor(E[0],E[1],E[2]),t.setLineWidth(.5),t.line(y,w,k,S)},pn=(y,w,k,S,E)=>{if(typeof y!="number"||isNaN(y)||typeof w!="number"||isNaN(w)||typeof k!="number"||isNaN(k)||typeof S!="number"||isNaN(S)){console.warn("Coordenadas inv\xE1lidas para drawRect:",{x:y,y:w,w:k,h:S});return}E&&Array.isArray(E)&&E.length===3?(t.setFillColor(E[0],E[1],E[2]),t.rect(y,w,k,S,"F")):t.rect(y,w,k,S)},Ln=(y=10)=>c+y>250?(t.addPage(),c=20,!0):!1,G=(y,w,k=50)=>{c+k>250&&(t.addPage(),c=20),C(y,20,c,{fontSize:14,style:"bold",color:f}),c+=8,j(20,c,190,c,b),c+=10,w(),c+=15};(typeof c!="number"||isNaN(c))&&(c=20),C("ALBAR\xC1N DE TRABAJO",20,c,{fontSize:18,style:"bold",color:u}),c+=8,j(20,c,190,c,b),c+=10,C(`N\xBA ${((re=n.id)==null?void 0:re.substring(0,8))||"N/A"}`,20,c,{fontSize:12,color:b}),C(`Fecha: ${this.formatearFecha(new Date)}`,120,c,{fontSize:12,color:b}),c+=15,n.aviso&&G("INFORMACI\xD3N DEL AVISO",()=>{C(`Cliente: ${n.aviso.nombre_cliente_aviso||"No especificado"}`,20,c),c+=6,C(`Direcci\xF3n: ${n.aviso.direccion_cliente_aviso||"No especificada"}`,20,c),c+=6,C(`Estado: ${n.aviso.estado||"No especificado"}`,20,c),c+=6,C(`Fecha de creaci\xF3n: ${this.formatearFecha(n.aviso.fecha_creacion)}`,20,c),c+=6},30),G("FECHAS Y HORARIOS",()=>{C(`Fecha de cierre: ${this.formatearFecha(n.fecha_cierre)}`,20,c),c+=6,C(`Hora de entrada: ${n.hora_entrada||"No especificada"}`,20,c),c+=6,C(`Hora de salida: ${n.hora_salida||"No especificada"}`,20,c),c+=6},25),n.descripcion_trabajo_realizado&&G("DESCRIPCI\xD3N DEL TRABAJO REALIZADO",()=>{let y=n.descripcion_trabajo_realizado,w=170,k=6;t.splitTextToSize(y,w).forEach(E=>{Ln(k),C(E,20,c),c+=k})},40),n.materialesUtilizados&&n.materialesUtilizados.length>0&&G("MATERIALES UTILIZADOS",()=>{let y=[["C\xF3digo","Material","Cantidad","Unidad","Precio Unit.","Total"]],w=0;n.materialesUtilizados.forEach(Y=>{let mn=Y.precio_pvp*Y.cantidad;w+=mn,y.push([Y.codigo||"-",Y.nombre,Y.cantidad.toString(),Y.unidad,this.formatearMoneda(Y.precio_pvp),this.formatearMoneda(mn)])}),y.push(["","","","","TOTAL:",this.formatearMoneda(w)]);let k=20,S=[25,60,20,20,30,30],E=8;y.forEach((Y,mn)=>{Ln(E);let un=k;Y.forEach((Un,ce)=>{let pt=mn===0,mt=mn===y.length-1;pt?(pn(un,c-5,S[ce],E,[243,244,246]),C(Un,un+2,c,{fontSize:8,style:"bold",color:[55,65,81]})):mt?C(Un,un+2,c,{fontSize:9,style:"bold",color:f}):C(Un,un+2,c,{fontSize:8}),un+=S[ce]}),c+=E})},60),n.estado_cierre==="Presupuesto pendiente"&&G("INFORMACI\xD3N DE PRESUPUESTO",()=>{pn(15,c-5,180,25),C("Este albar\xE1n requiere presupuesto",20,c,{style:"bold"}),c+=6,n.presupuesto_necesario>0&&(C(`Monto estimado: ${this.formatearMoneda(n.presupuesto_necesario)}`,20,c,{style:"bold"}),c+=6)},35),G("INFORMACI\xD3N DEL CLIENTE",()=>{n.dni_cliente&&(C(`DNI: ${n.dni_cliente}`,20,c),c+=6),n.nombre_firma&&(C(`Firmado por: ${n.nombre_firma}`,20,c),c+=6)},20),G("FIRMA DEL CLIENTE",()=>{pn(20,c,170,40),C("Firma:",25,c+8,{fontSize:10,color:b}),n.firma_url?C("\u2713 Firma digital registrada",25,c+20,{fontSize:10,style:"bold"}):n.nombre_firma?C(`Firmado por: ${n.nombre_firma}`,25,c+20,{fontSize:10}):C("_________________________",25,c+20,{fontSize:10}),c+=50},60),n.observaciones&&G("OBSERVACIONES",()=>{let y=n.observaciones,w=170,k=6;t.splitTextToSize(y,w).forEach(E=>{Ln(k),C(E,20,c,{style:"italic"}),c+=k})},30),G("INFORMACI\xD3N ADICIONAL",()=>{var y,w;C(`ID del trabajo: ${((y=n.trabajo_id)==null?void 0:y.substring(0,8))||"N/A"}`,20,c),c+=6,C(`ID del aviso: ${((w=n.aviso_id)==null?void 0:w.substring(0,8))||"N/A"}`,20,c),c+=6,n.fecha_creacion&&(C(`Fecha de creaci\xF3n: ${this.formatearFecha(n.fecha_creacion)}`,20,c),c+=6)},25),c>200&&(t.addPage(),c=20),j(20,c,190,c,b),c+=10,C("EMPRESA DE SERVICIOS T\xC9CNICOS",20,c,{fontSize:10,style:"bold",color:f}),c+=6,C("CIF: 12345678A | Tel: 900 123 456 | Email: info@empresa.com",20,c,{fontSize:8,color:b}),c+=6,C("Direcci\xF3n: Calle Principal 123, 28001 Madrid",20,c,{fontSize:8,color:b}),c+=10,C("Este albar\xE1n ha sido generado autom\xE1ticamente por el sistema de gesti\xF3n",20,c,{fontSize:8,color:b}),c+=4,C(`Generado el: ${this.formatearFecha(new Date)} | P\xE1gina ${t.getCurrentPageInfo().pageNumber} de ${t.getNumberOfPages()}`,20,c,{fontSize:8,color:b}),t.save(e)}generarPdfHtml(n,e="albaran.pdf"){var f;let t=this.generarHtmlAlbaran(n),c=this.obtenerEstilosCss(),u=window.open("","_blank");u&&(u.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="utf-8">
          <title>Albar\xE1n ${((f=n.id)==null?void 0:f.substring(0,8))||"N/A"}</title>
          <style>${c}</style>
        </head>
        <body>
          ${t}
        </body>
        </html>
      `),u.document.close(),u.focus(),setTimeout(()=>{u.print()},500))}generarHtmlAlbaran(n){var c,u,f;let e=n.materialesUtilizados||[],t=e.reduce((x,b)=>x+b.precio_pvp*b.cantidad,0);return`
      <div class="albaran-container">
        <!-- Header -->
        <div class="albaran-header">
          <h1>ALBAR\xC1N DE TRABAJO</h1>
          <div class="albaran-info">
            <span class="albaran-numero">N\xBA ${((c=n.id)==null?void 0:c.substring(0,8))||"N/A"}</span>
            <span class="fecha-emision">${this.formatearFecha(new Date)}</span>
          </div>
        </div>

        <!-- Informaci\xF3n del aviso -->
        ${n.aviso?`
        <div class="section">
          <h2>INFORMACI\xD3N DEL AVISO</h2>
          <div class="info-grid">
            <div class="info-item">
              <label>Cliente:</label>
              <span>${n.aviso.nombre_cliente_aviso||"No especificado"}</span>
            </div>
            <div class="info-item">
              <label>Direcci\xF3n:</label>
              <span>${n.aviso.direccion_cliente_aviso||"No especificada"}</span>
            </div>
            <div class="info-item">
              <label>Estado:</label>
              <span>${n.aviso.estado||"No especificado"}</span>
            </div>
            <div class="info-item">
              <label>Fecha de creaci\xF3n:</label>
              <span>${this.formatearFecha(n.aviso.fecha_creacion)}</span>
            </div>
          </div>
        </div>
        `:""}

        <!-- Fechas y horarios -->
        <div class="section">
          <h2>FECHAS Y HORARIOS</h2>
          <div class="info-grid">
            <div class="info-item">
              <label>Fecha de cierre:</label>
              <span>${this.formatearFecha(n.fecha_cierre)}</span>
            </div>
            <div class="info-item">
              <label>Hora de entrada:</label>
              <span>${n.hora_entrada||"No especificada"}</span>
            </div>
            <div class="info-item">
              <label>Hora de salida:</label>
              <span>${n.hora_salida||"No especificada"}</span>
            </div>
          </div>
        </div>

        <!-- Descripci\xF3n del trabajo -->
        ${n.descripcion_trabajo_realizado?`
        <div class="section">
          <h2>DESCRIPCI\xD3N DEL TRABAJO REALIZADO</h2>
          <div class="descripcion">
            <p>${n.descripcion_trabajo_realizado}</p>
          </div>
        </div>
        `:""}

        <!-- Materiales utilizados -->
        ${e.length>0?`
        <div class="section">
          <h2>MATERIALES UTILIZADOS</h2>
          <table class="materiales-table">
            <thead>
              <tr>
                <th>C\xF3digo</th>
                <th>Material</th>
                <th>Cantidad</th>
                <th>Unidad</th>
                <th>Precio Unit.</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              ${e.map(x=>`
                <tr>
                  <td>${x.codigo||"-"}</td>
                  <td>${x.nombre}</td>
                  <td>${x.cantidad}</td>
                  <td>${x.unidad}</td>
                  <td>${this.formatearMoneda(x.precio_pvp)}</td>
                  <td>${this.formatearMoneda(x.precio_pvp*x.cantidad)}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr class="total-row">
                <td colspan="5"><strong>TOTAL MATERIALES:</strong></td>
                <td><strong>${this.formatearMoneda(t)}</strong></td>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}

        <!-- Presupuesto -->
        ${n.estado_cierre==="Presupuesto pendiente"?`
        <div class="section presupuesto-section">
          <h2>INFORMACI\xD3N DE PRESUPUESTO</h2>
          <div class="presupuesto-warning">
            <p>Este albar\xE1n requiere presupuesto</p>
            ${n.presupuesto_necesario>0?`
              <p><strong>Monto estimado: ${this.formatearMoneda(n.presupuesto_necesario)}</strong></p>
            `:""}
          </div>
        </div>
        `:""}

        <!-- Informaci\xF3n del cliente -->
        <div class="section">
          <h2>INFORMACI\xD3N DEL CLIENTE</h2>
          <div class="info-grid">
            ${n.dni_cliente?`
              <div class="info-item">
                <label>DNI:</label>
                <span>${n.dni_cliente}</span>
              </div>
            `:""}
            ${n.nombre_firma?`
              <div class="info-item">
                <label>Firmado por:</label>
                <span>${n.nombre_firma}</span>
              </div>
            `:""}
          </div>
        </div>

        <!-- Secci\xF3n de firma -->
        <div class="section">
          <h2>FIRMA DEL CLIENTE</h2>
          <div class="firma-section">
            <div class="firma-box">
              <label>Firma:</label>
              ${n.firma_url?`
                <div class="firma-digital">
                  <p>\u2713 Firma digital registrada</p>
                  <img src="${n.firma_url}" alt="Firma del cliente" class="firma-imagen" />
                </div>
              `:n.nombre_firma?`
                <div class="firma-texto">
                  <p>Firmado por: ${n.nombre_firma}</p>
                </div>
              `:`
                <div class="firma-lugar">
                  <p>_________________________</p>
                </div>
              `}
            </div>
          </div>
        </div>

        <!-- Observaciones -->
        ${n.observaciones?`
        <div class="section">
          <h2>OBSERVACIONES</h2>
          <div class="observaciones">
            <p>${n.observaciones}</p>
          </div>
        </div>
        `:""}

        <!-- Informaci\xF3n adicional -->
        <div class="section">
          <h2>INFORMACI\xD3N ADICIONAL</h2>
          <div class="info-grid">
            <div class="info-item">
              <label>ID del trabajo:</label>
              <span>${((u=n.trabajo_id)==null?void 0:u.substring(0,8))||"N/A"}</span>
            </div>
            <div class="info-item">
              <label>ID del aviso:</label>
              <span>${((f=n.aviso_id)==null?void 0:f.substring(0,8))||"N/A"}</span>
            </div>
            ${n.fecha_creacion?`
              <div class="info-item">
                <label>Fecha de creaci\xF3n:</label>
                <span>${this.formatearFecha(n.fecha_creacion)}</span>
              </div>
            `:""}
          </div>
        </div>

        <!-- Footer -->
        <div class="albaran-footer">
          <p>Este albar\xE1n ha sido generado autom\xE1ticamente por el sistema de gesti\xF3n de avisos</p>
          <p>Generado el: ${this.formatearFecha(new Date)}</p>
        </div>
      </div>
    `}obtenerEstilosCss(){return`
      @media print {
        body { margin: 0; padding: 0; }
        .no-print { display: none !important; }
      }

      .albaran-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        font-family: 'Arial', sans-serif;
        color: #111827;
        background: white;
      }

      .albaran-header {
        text-align: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid #000;
      }

      .albaran-header h1 {
        font-size: 24px;
        font-weight: bold;
        color: #000;
        margin: 0 0 10px 0;
      }

      .albaran-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 10px;
      }

      .albaran-numero {
        font-size: 16px;
        font-weight: bold;
        color: #000;
      }

      .fecha-emision {
        font-size: 14px;
        color: #6B7280;
      }

      .section {
        margin-bottom: 25px;
        padding: 20px;
        background: #f9fafb;
        border-radius: 8px;
        border: 1px solid #e5e7eb;
      }

      .section h2 {
        font-size: 16px;
        font-weight: bold;
        color: #000;
        margin: 0 0 15px 0;
        padding-bottom: 8px;
        border-bottom: 1px solid #666;
      }

      .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
      }

      .info-item {
        display: flex;
        flex-direction: column;
        gap: 4px;
        padding: 12px;
        background: white;
        border-radius: 6px;
        border: 1px solid #e5e7eb;
      }

      .info-item label {
        font-size: 12px;
        font-weight: bold;
        color: #6B7280;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .info-item span {
        font-size: 14px;
        color: #1F2937;
        font-weight: 500;
      }

      .descripcion, .observaciones {
        background: white;
        padding: 15px;
        border-radius: 6px;
        border: 1px solid #e5e7eb;
      }

      .descripcion p, .observaciones p {
        margin: 0;
        line-height: 1.6;
        color: #374151;
      }

      .observaciones p {
        font-style: italic;
      }

      .materiales-table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        border-radius: 6px;
        overflow: hidden;
        border: 1px solid #e5e7eb;
      }

      .materiales-table th,
      .materiales-table td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid #e5e7eb;
      }

      .materiales-table th {
        background: #f3f4f6;
        font-weight: bold;
        color: #374151;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .materiales-table td {
        font-size: 13px;
        color: #1F2937;
      }

      .materiales-table .total-row {
        background: #f0f9ff;
        font-weight: bold;
      }

      .materiales-table .total-row td {
        color: #1e40af;
        font-size: 14px;
      }

      .presupuesto-section {
        background: #fef3c7;
        border: 1px solid #f59e0b;
      }

      .presupuesto-warning {
        background: white;
        padding: 15px;
        border-radius: 6px;
        border: 1px solid #e5e7eb;
      }

      .presupuesto-warning p {
        margin: 0 0 8px 0;
        color: #92400e;
        font-weight: 500;
      }

      .albaran-footer {
        margin-top: 30px;
        padding-top: 20px;
        border-top: 2px solid #10B981;
        text-align: center;
        color: #6B7280;
        font-size: 12px;
      }

      .albaran-footer p {
        margin: 5px 0;
      }

      .firma-section {
        margin-top: 20px;
      }

      .firma-box {
        border: 2px solid #000;
        padding: 20px;
        min-height: 100px;
        background: white;
      }

      .firma-box label {
        font-weight: bold;
        color: #000;
        margin-bottom: 10px;
        display: block;
      }

      .firma-digital p {
        color: #000;
        font-weight: bold;
        margin: 10px 0;
      }

      .firma-imagen {
        max-width: 200px;
        max-height: 80px;
        border: 1px solid #ccc;
        margin-top: 10px;
      }

      .firma-texto p {
        color: #000;
        font-style: italic;
        margin: 20px 0;
      }

      .firma-lugar p {
        color: #000;
        font-size: 16px;
        margin: 20px 0;
      }
    `}formatearFecha(n){return n?new Date(n).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"No especificada"}formatearMoneda(n){return new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(n)}};d.\u0275fac=function(e){return new(e||d)(_n(Te))},d.\u0275prov=yn({token:d,factory:d.\u0275fac,providedIn:"root"});let r=d;return r})();function Kt(r,d){if(r&1&&(o(0,"tr")(1,"td"),s(2),a(),o(3,"td"),s(4),a(),o(5,"td"),s(6),a(),o(7,"td"),s(8),a(),o(9,"td"),s(10),A(11,"currency"),a(),o(12,"td"),s(13),A(14,"currency"),a()()),r&2){let i=d.$implicit;l(2),M(i.codigo||"-"),l(2),M(i.nombre),l(2),M(i.cantidad),l(2),M(i.unidad),l(2),M(Z(11,6,i.precio_pvp,"EUR","symbol","1.2-2")),l(3),M(Z(14,11,i.precio_pvp*i.cantidad,"EUR","symbol","1.2-2"))}}function no(r,d){if(r&1&&(o(0,"div",26)(1,"table",27)(2,"thead")(3,"tr")(4,"th"),s(5,"C\xF3digo"),a(),o(6,"th"),s(7,"Material"),a(),o(8,"th"),s(9,"Cantidad"),a(),o(10,"th"),s(11,"Unidad"),a(),o(12,"th"),s(13,"Precio Unit."),a(),o(14,"th"),s(15,"Total"),a()()(),o(16,"tbody"),h(17,Kt,15,16,"tr",28),a(),o(18,"tfoot")(19,"tr",29)(20,"td",30)(21,"strong"),s(22,"Total Materiales:"),a()(),o(23,"td")(24,"strong"),s(25),A(26,"currency"),a()()()()()()),r&2){let i=m();l(17),g("ngForOf",i.materialesUtilizados),l(8),M(Z(26,2,i.calcularTotalMateriales(),"EUR","symbol","1.2-2"))}}function eo(r,d){if(r&1&&(o(0,"li"),s(1),a()),r&2){let i=d.$implicit;l(),M(i.nombre)}}function to(r,d){if(r&1&&(o(0,"div",31)(1,"ul",32),h(2,eo,2,1,"li",28),a()()),r&2){let i=m();l(2),g("ngForOf",i.materialesUtilizados)}}function oo(r,d){r&1&&(o(0,"div",33)(1,"p"),s(2,"No se utilizaron materiales en este trabajo"),a()())}function ao(r,d){if(r&1&&(o(0,"div",40)(1,"span",41),s(2,"Monto estimado:"),a(),o(3,"span",42),s(4),A(5,"currency"),a()()),r&2){let i=m(2);l(4),M(Z(5,1,i.albaran.presupuesto_necesario,"EUR","symbol","1.2-2"))}}function io(r,d){if(r&1){let i=v();o(0,"div",43)(1,"p",44),s(2," Puedes crear un presupuesto basado en este albar\xE1n con los materiales y tiempo ya registrados. "),a(),o(3,"button",45),_("click",function(){P(i);let e=m(2);return O(e.crearPresupuestoDesdeAlbaran())}),p(4,"ion-icon",46),s(5," Crear Presupuesto "),a()()}}function ro(r,d){if(r&1&&(o(0,"div",11)(1,"h3"),s(2,"Presupuesto"),a(),o(3,"div",34)(4,"div",35),p(5,"ion-icon",36),o(6,"span",37),s(7,"Este albar\xE1n requiere presupuesto"),a()(),h(8,ao,6,6,"div",38)(9,io,6,0,"div",39),a()()),r&2){let i=m();l(8),g("ngIf",i.albaran.presupuesto_necesario>0),l(),g("ngIf",i.puedeCrearPresupuesto())}}function co(r,d){if(r&1&&(o(0,"div",13)(1,"label"),s(2,"DNI:"),a(),o(3,"span"),s(4),a()()),r&2){let i=m(2);l(4),M(i.albaran.dni_cliente)}}function so(r,d){if(r&1&&(o(0,"div",13)(1,"label"),s(2,"Firmado por:"),a(),o(3,"span"),s(4),a()()),r&2){let i=m(2);l(4),M(i.albaran.nombre_firma)}}function lo(r,d){if(r&1&&(o(0,"div",11)(1,"h3"),s(2,"Informaci\xF3n del Cliente"),a(),o(3,"div",12),h(4,co,5,1,"div",22)(5,so,5,1,"div",22),a()()),r&2){let i=m();l(4),g("ngIf",i.albaran.dni_cliente),l(),g("ngIf",i.albaran.nombre_firma)}}function go(r,d){if(r&1&&(o(0,"div",50),p(1,"img",51),o(2,"p",52),s(3,"Firma digital del cliente"),a()()),r&2){let i=m(2);l(),g("src",i.albaran.firma_url,$)}}function po(r,d){if(r&1&&(o(0,"div",53)(1,"p"),s(2,"El cliente ha firmado este albar\xE1n"),a(),o(3,"div",54),p(4,"ion-icon",55),o(5,"span"),s(6),a()()()),r&2){let i=m(2);l(6),M(i.albaran.nombre_firma)}}function mo(r,d){if(r&1&&(o(0,"div",11)(1,"h3"),s(2,"Firma del Cliente"),a(),o(3,"div",47),h(4,go,4,1,"div",48)(5,po,7,1,"div",49),a()()),r&2){let i=m();l(4),g("ngIf",i.albaran.firma_url),l(),g("ngIf",!i.albaran.firma_url&&i.albaran.nombre_firma)}}function uo(r,d){if(r&1&&(o(0,"div",11)(1,"h3"),s(2,"Observaciones"),a(),o(3,"div",56)(4,"p"),s(5),a()()()),r&2){let i=m();l(5),M(i.albaran.observaciones)}}function _o(r,d){if(r&1&&(o(0,"div",13)(1,"label"),s(2,"Fecha de creaci\xF3n:"),a(),o(3,"span"),s(4),a()()),r&2){let i=m();l(4),M(i.formatearFecha(i.albaran.fecha_creacion))}}var dt=(()=>{let d=class d{constructor(n,e,t,c){this.modalController=n,this.router=e,this.presupuestosService=t,this.albaranPdfService=c,V({close:q,documentTextOutline:nn,personOutline:sn,timeOutline:ln,calendarOutline:jn,cubeOutline:Tn,checkmarkCircleOutline:K,warningOutline:dn,refreshOutline:N,downloadOutline:Pn,printOutline:Ke,createOutline:cn,calculator:Fn})}ngOnInit(){console.log("Modal de albar\xE1n cargado:",this.albaran)}cerrarModal(){this.modalController.dismiss()}descargarPDF(){var n;if(!this.albaran){console.error("No hay albar\xE1n para descargar");return}try{console.log("\u{1F527} Iniciando descarga de albar\xE1n...");let t=`albaran_${((n=this.albaran.id)==null?void 0:n.substring(0,8))||"albaran"}.pdf`,c={id:this.albaran.id,trabajo_id:this.albaran.trabajo_id,aviso_id:this.albaran.aviso_id,fecha_cierre:this.albaran.fecha_cierre,hora_entrada:this.albaran.hora_entrada,hora_salida:this.albaran.hora_salida,descripcion_trabajo_realizado:this.albaran.descripcion_trabajo_realizado,materialesUtilizados:this.materialesUtilizados,estado_cierre:this.albaran.estado_cierre,presupuesto_necesario:this.albaran.presupuesto_necesario,dni_cliente:this.albaran.dni_cliente,nombre_firma:this.albaran.nombre_firma,firma_url:this.albaran.firma_url,observaciones:this.albaran.observaciones,fecha_creacion:this.albaran.fecha_creacion,aviso:this.aviso};this.albaranPdfService.generarPdfAlbaran(c,t),console.log("\u2705 Albar\xE1n descargado exitosamente")}catch(e){console.error("\u274C Error al descargar albar\xE1n:",e),alert("Error al generar el PDF del albar\xE1n: "+e.message)}}imprimirAlbaran(){if(!this.albaran){console.error("No hay albar\xE1n para imprimir");return}try{console.log("\u{1F5A8}\uFE0F Iniciando impresi\xF3n de albar\xE1n...");let n={id:this.albaran.id,trabajo_id:this.albaran.trabajo_id,aviso_id:this.albaran.aviso_id,fecha_cierre:this.albaran.fecha_cierre,hora_entrada:this.albaran.hora_entrada,hora_salida:this.albaran.hora_salida,descripcion_trabajo_realizado:this.albaran.descripcion_trabajo_realizado,materialesUtilizados:this.materialesUtilizados,estado_cierre:this.albaran.estado_cierre,presupuesto_necesario:this.albaran.presupuesto_necesario,dni_cliente:this.albaran.dni_cliente,nombre_firma:this.albaran.nombre_firma,firma_url:this.albaran.firma_url,observaciones:this.albaran.observaciones,fecha_creacion:this.albaran.fecha_creacion,aviso:this.aviso};this.albaranPdfService.generarPdfHtml(n,"albaran_imprimir.pdf"),console.log("\u2705 Albar\xE1n enviado a impresi\xF3n")}catch(n){console.error("\u274C Error al imprimir albar\xE1n:",n),window.print()}}tieneFirma(){return!!(this.albaran.firma_url||this.albaran.nombre_firma)}getEstadoClass(n){return"badge-"+n.toLowerCase().replace(/ /g,"-")}get materialesUtilizados(){return this.albaran.repuestos&&this.albaran.repuestos.length>0?(console.log("\u{1F4CB} Usando repuestos de tabla repuestos_albaran:",this.albaran.repuestos),this.albaran.repuestos):this.albaran.repuestos_utilizados&&this.albaran.repuestos_utilizados.length>0?(console.log("\u{1F4CB} Usando repuestos_utilizados legacy:",this.albaran.repuestos_utilizados),typeof this.albaran.repuestos_utilizados[0]=="object"?this.albaran.repuestos_utilizados:this.albaran.repuestos_utilizados.map(n=>{if(typeof n=="string")try{let e=JSON.parse(n);return{nombre:e.nombre||n,cantidad:Number(e.cantidad)||1,precio_neto:Number(e.precio_neto)||0,precio_pvp:Number(e.precio_pvp)||0,unidad:e.unidad||"unidad",codigo:e.codigo||""}}catch{return{nombre:n,cantidad:1,precio_neto:0,precio_pvp:0,unidad:"unidad",codigo:""}}return n})):[]}repuestosCompletos(){let n=this.materialesUtilizados;return n.length>0&&n[0].precio_pvp!==void 0}calcularTotalMateriales(){return this.materialesUtilizados.reduce((n,e)=>n+e.precio_pvp*e.cantidad,0)}formatearFecha(n){return n?new Date(n).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"No especificada"}formatearHora(n){return n||"No especificada"}getEstadoColor(n){switch(n){case"Finalizado":return"#10B981";case"Presupuesto pendiente":return"#F59E0B";case"Otra visita":return"#EF4444";default:return"#6B7280"}}getEstadoAvisoColor(n){if(!n)return"#6B7280";switch(n.toLowerCase()){case"pendiente":return"#F59E0B";case"en_progreso":case"en progreso":return"#3B82F6";case"completado":case"finalizado":return"#10B981";case"cancelado":return"#EF4444";case"pausado":return"#8B5CF6";case"reagendado":return"#F97316";default:return"#6B7280"}}puedeCrearPresupuesto(){var n;return this.albaran.estado_cierre==="Presupuesto pendiente"&&((n=this.aviso)==null?void 0:n.id)}crearPresupuestoDesdeAlbaran(){if(!this.puedeCrearPresupuesto()){console.warn("No se puede crear presupuesto desde este albar\xE1n");return}console.log("\u{1F3AF} Creando presupuesto desde albar\xE1n:",this.albaran);let n=this.prepararMaterialesParaPresupuesto(),e={aviso_id:this.aviso.id,albaran_id:this.albaran.id,horas_estimadas:this.calcularHorasEstimadas(),total_estimado:this.calcularTotalEstimado(),materiales:n};console.log("\u{1F4CB} Datos para el presupuesto:",e),this.presupuestosService.crearPresupuesto(e).subscribe({next:t=>{console.log("\u2705 Presupuesto creado exitosamente:",t),confirm(`\u2705 Presupuesto creado exitosamente.

\xBFDeseas ir a editarlo ahora para ajustar detalles?`)?(this.modalController.dismiss({accion_realizada:"presupuesto_creado",presupuesto:t},"confirm"),this.router.navigate(["/presupuestos/crear"],{queryParams:{id:t.id,edit:"true"}})):this.modalController.dismiss({accion_realizada:"presupuesto_creado",presupuesto:t,mensaje:"Presupuesto creado exitosamente"},"confirm")},error:t=>{console.error("\u274C Error al crear presupuesto:",t),alert("Error al crear el presupuesto: "+(t.message||"Error desconocido"))}})}prepararMaterialesParaPresupuesto(){return this.materialesUtilizados.map(e=>({material_id:e.codigo||this.generarIdTemporal(),cantidad_estimada:e.cantidad,precio_neto_al_momento:e.precio_neto||e.precio_pvp,producto:{id:e.codigo||this.generarIdTemporal(),nombre:e.nombre,precio_neto:e.precio_neto||e.precio_pvp,unidad:e.unidad||"unidad"}}))}calcularHorasEstimadas(){let n=this.albaran.hora_entrada,e=this.albaran.hora_salida;if(n&&e){let[t,c]=n.split(":").map(Number),[u,f]=e.split(":").map(Number),x=t*60+c,j=(u*60+f-x)/60;return Math.max(j,1)}return 2}calcularTotalEstimado(){let n=this.calcularTotalMateriales(),c=this.calcularHorasEstimadas()*50;return n+c}generarIdTemporal(){return"temp_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}};d.\u0275fac=function(e){return new(e||d)(z(J),z(rn),z(Nn),z(lt))},d.\u0275cmp=H({type:d,selectors:[["app-ver-albaran-modal"]],inputs:{albaran:"albaran",aviso:"aviso"},decls:102,vars:21,consts:[[1,"header-content"],[1,"header-actions"],["title","Descargar PDF",1,"btn-secondary",3,"click"],["name","download-outline"],[1,"desktop-only"],["title","Imprimir",1,"btn-secondary",3,"click"],["name","print-outline"],["title","Cerrar",1,"btn-cerrar",3,"click"],["name","close"],[1,"modal-body"],[1,"modal-content"],[1,"info-section"],[1,"info-grid"],[1,"info-item"],[1,"estado-aviso"],["name","checkmark-circle-outline"],[1,"descripcion-content"],[1,"materiales-content"],["class","materiales-tabla",4,"ngIf"],["class","materiales-lista",4,"ngIf"],["class","no-materiales",4,"ngIf"],["class","info-section",4,"ngIf"],["class","info-item",4,"ngIf"],[1,"button-group"],["type","button",1,"btn","btn-outline",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"materiales-tabla"],[1,"materiales-table"],[4,"ngFor","ngForOf"],[1,"total-row"],["colspan","5"],[1,"materiales-lista"],[1,"repuestos-list"],[1,"no-materiales"],[1,"presupuesto-content"],[1,"presupuesto-status"],["name","warning-outline",1,"warning-icon"],[1,"status-text"],["class","presupuesto-amount",4,"ngIf"],["class","presupuesto-actions",4,"ngIf"],[1,"presupuesto-amount"],[1,"amount-label"],[1,"amount-value"],[1,"presupuesto-actions"],[1,"action-description"],[1,"btn-crear-presupuesto",3,"click"],["name","calculator"],[1,"firma-content"],["class","firma-imagen",4,"ngIf"],["class","firma-texto",4,"ngIf"],[1,"firma-imagen"],["alt","Firma del cliente",1,"firma-img",3,"src"],[1,"firma-caption"],[1,"firma-texto"],[1,"firma-nombre"],["name","person-outline"],[1,"observaciones-content"]],template:function(e,t){e&1&&(o(0,"ion-header")(1,"ion-toolbar")(2,"div",0)(3,"h2"),s(4),a(),o(5,"div",1)(6,"button",2),_("click",function(){return t.descargarPDF()}),p(7,"ion-icon",3),o(8,"span",4),s(9,"PDF"),a()(),o(10,"button",5),_("click",function(){return t.imprimirAlbaran()}),p(11,"ion-icon",6),o(12,"span",4),s(13,"Imprimir"),a()(),o(14,"button",7),_("click",function(){return t.cerrarModal()}),p(15,"ion-icon",8),a()()()()(),o(16,"ion-content",9)(17,"div",10)(18,"div",11)(19,"h3"),s(20,"Informaci\xF3n del Aviso"),a(),o(21,"div",12)(22,"div",13)(23,"label"),s(24,"Cliente:"),a(),o(25,"span"),s(26),a()(),o(27,"div",13)(28,"label"),s(29,"Direcci\xF3n:"),a(),o(30,"span"),s(31),a()(),o(32,"div",13)(33,"label"),s(34,"Estado:"),a(),o(35,"span",14),p(36,"ion-icon",15),s(37),a()(),o(38,"div",13)(39,"label"),s(40,"Fecha de creaci\xF3n:"),a(),o(41,"span"),s(42),a()()()(),o(43,"div",11)(44,"h3"),s(45,"Fechas y Horarios"),a(),o(46,"div",12)(47,"div",13)(48,"label"),s(49,"Fecha de cierre:"),a(),o(50,"span"),s(51),a()(),o(52,"div",13)(53,"label"),s(54,"Hora de entrada:"),a(),o(55,"span"),s(56),a()(),o(57,"div",13)(58,"label"),s(59,"Hora de salida:"),a(),o(60,"span"),s(61),a()()()(),o(62,"div",11)(63,"h3"),s(64,"Descripci\xF3n del Trabajo Realizado"),a(),o(65,"div",16)(66,"p"),s(67),a()()(),o(68,"div",11)(69,"h3"),s(70,"Materiales Utilizados"),a(),o(71,"div",17),h(72,no,27,7,"div",18)(73,to,3,1,"div",19)(74,oo,3,0,"div",20),a()(),h(75,ro,10,2,"div",21)(76,lo,6,2,"div",21)(77,mo,6,2,"div",21)(78,uo,6,1,"div",21),o(79,"div",11)(80,"h3"),s(81,"Informaci\xF3n Adicional"),a(),o(82,"div",12)(83,"div",13)(84,"label"),s(85,"ID del trabajo:"),a(),o(86,"span"),s(87),a()(),o(88,"div",13)(89,"label"),s(90,"ID del aviso:"),a(),o(91,"span"),s(92),a()(),h(93,_o,5,1,"div",22),a()()(),o(94,"ion-footer")(95,"ion-toolbar")(96,"div",23)(97,"button",24),_("click",function(){return t.cerrarModal()}),s(98," Cerrar "),a(),o(99,"button",25),_("click",function(){return t.imprimirAlbaran()}),p(100,"ion-icon",6),s(101," Imprimir Albar\xE1n "),a()()()()()),e&2&&(l(4),F(" Albar\xE1n #",t.albaran.id==null?null:t.albaran.id.substring(0,8)," "),l(22),M((t.aviso==null?null:t.aviso.nombre_cliente_aviso)||"No especificado"),l(5),M((t.aviso==null?null:t.aviso.direccion_cliente_aviso)||"No especificada"),l(4),wn("color",t.getEstadoAvisoColor(t.aviso==null?null:t.aviso.estado)),l(2),F(" ",(t.aviso==null?null:t.aviso.estado)||"No especificado"," "),l(5),M(t.formatearFecha(t.aviso==null?null:t.aviso.fecha_creacion)),l(9),M(t.formatearFecha(t.albaran.fecha_cierre)),l(5),M(t.formatearHora(t.albaran.hora_entrada)),l(5),M(t.formatearHora(t.albaran.hora_salida)),l(6),M(t.albaran.descripcion_trabajo_realizado),l(5),g("ngIf",t.repuestosCompletos()&&t.materialesUtilizados.length>0),l(),g("ngIf",!t.repuestosCompletos()&&t.materialesUtilizados.length>0),l(),g("ngIf",t.materialesUtilizados.length===0),l(),g("ngIf",t.albaran.estado_cierre==="Presupuesto pendiente"),l(),g("ngIf",t.albaran.dni_cliente||t.albaran.nombre_firma),l(),g("ngIf",t.tieneFirma()),l(),g("ngIf",t.albaran.observaciones),l(9),M(t.albaran.trabajo_id==null?null:t.albaran.trabajo_id.substring(0,8)),l(5),M(t.albaran.aviso_id==null?null:t.albaran.aviso_id.substring(0,8)),l(),g("ngIf",t.albaran.fecha_creacion))},dependencies:[L,Q,B,En,U,Sn,In,kn,zn],styles:['@charset "UTF-8";ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #fff;--border-color: #e5e7eb;--color: #111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:16px!important;font-weight:600;color:#111827;display:flex;align-items:center;gap:12px}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;color:#10b981}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#6b7280;margin-top:0;font-size:14px}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:#2563eb1a;color:#2563eb;border:1px solid rgba(37,99,235,.2);padding:8px 16px;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s ease;display:flex;align-items:center;gap:8px}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{background:#2563eb26;border-color:#2563eb4d;transform:translateY(-1px)}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}@media (max-width: 768px){ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]   .desktop-only[_ngcontent-%COMP%]{display:none}}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-cerrar[_ngcontent-%COMP%]{width:36px;height:36px;border:none;background:#f8fafc;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;border:1px solid #E2E8F0}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-cerrar[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#6b7280}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-cerrar[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1;transform:scale(1.05)}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-cerrar[_ngcontent-%COMP%]:hover   ion-icon[_ngcontent-%COMP%]{color:#374151}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-cerrar[_ngcontent-%COMP%]:active{transform:scale(.95)}ion-content[_ngcontent-%COMP%]{--background: #fff;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}ion-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex;flex-direction:column;min-height:0}ion-content[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{flex:1;overflow:auto;position:relative;min-height:0;height:100%;padding:24px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #fff;--border-color: #e5e7eb}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:6px;font-size:14px;font-weight:500;display:flex;align-items:center;gap:8px;cursor:pointer;transition:all .2s}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{background:none;border:1px solid #d1d5db;color:#374151}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f8fafc;border-color:#9ca3af}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#2563eb;border:1px solid #2563eb;color:#fff}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#1d4ed8;border-color:#1d4ed8}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:disabled{background-color:#9ca3af;border-color:#9ca3af;cursor:not-allowed;opacity:.6}.estado-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px}.estado-section[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border-radius:50px;color:#fff;font-size:16px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;box-shadow:0 4px 12px #00000026}.estado-section[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.info-section[_ngcontent-%COMP%]{margin-bottom:24px;padding:24px;background-color:#f9fafb;border-radius:8px;border:1px solid #e5e7eb}@media (max-width: 768px){.info-section[_ngcontent-%COMP%]{padding:20px;margin-bottom:20px}}@media (max-width: 480px){.info-section[_ngcontent-%COMP%]{padding:16px;margin-bottom:16px}}.info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;font-size:16px;color:#374151;font-weight:600;border-bottom:2px solid #10B981;padding-bottom:8px}@media (max-width: 768px){.info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px;margin-bottom:16px}}@media (max-width: 480px){.info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:14px}}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px}@media (max-width: 768px){.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;padding:16px;background:#fff;border-radius:6px;border:1px solid #e5e7eb;transition:all .2s ease}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]:hover{border-color:#10b981;box-shadow:0 2px 8px #10b9811a}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.5px}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;color:#1f2937;font-weight:500}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   span.estado-aviso[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-weight:600;text-transform:capitalize}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   span.estado-aviso[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.info-section[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;line-height:1.6;color:#374151;background:#fff;padding:16px;border-radius:6px;border:1px solid #e5e7eb}.info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]{overflow-x:auto;background:#fff;border-radius:6px;border:1px solid #e5e7eb}.info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:#fff;border-radius:6px;overflow:hidden}.info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:left;border-bottom:1px solid #e5e7eb}@media (max-width: 768px){.info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px}}.info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f3f4f6;font-weight:600;color:#374151;font-size:12px;text-transform:uppercase;letter-spacing:.5px}.info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:14px;color:#1f2937;font-weight:500}@media (max-width: 768px){.info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}}.info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{background:#f0f9ff;font-weight:600}.info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#1e40af;font-size:14px}.info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-lista[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;display:flex;flex-wrap:wrap;gap:8px}.info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-lista[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background:#e0f2fe;color:#0c4a6e;padding:8px 16px;border-radius:20px;font-size:12px;font-weight:500;border:1px solid #bae6fd}.info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .no-materiales[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#6b7280;font-style:italic;background:#fff;border-radius:6px;border:2px dashed #e5e7eb}.info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px;background:#fef3c7;border:1px solid #f59e0b;border-radius:6px;margin-bottom:16px}.info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-status[_ngcontent-%COMP%]   .warning-icon[_ngcontent-%COMP%]{font-size:20px;color:#f59e0b}.info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-status[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{font-weight:600;color:#92400e;font-size:14px}.info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-amount[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;background:#f0f9ff;padding:16px;border-radius:6px;border:1px solid #bae6fd;margin-bottom:16px}.info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-amount[_ngcontent-%COMP%]   .amount-label[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#0369a1}.info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-amount[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#0369a1}.info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-actions[_ngcontent-%COMP%]   .action-description[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin:0 0 16px;line-height:1.5;padding:12px;background:#fff;border-radius:6px;border:1px solid #e5e7eb}.info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-actions[_ngcontent-%COMP%]   .btn-crear-presupuesto[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#10b981;color:#fff;border:none;border-radius:6px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s ease;width:100%;justify-content:center}.info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-actions[_ngcontent-%COMP%]   .btn-crear-presupuesto[_ngcontent-%COMP%]:hover{background:#059669;transform:translateY(-1px)}.info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-actions[_ngcontent-%COMP%]   .btn-crear-presupuesto[_ngcontent-%COMP%]:active{transform:translateY(0)}.info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-actions[_ngcontent-%COMP%]   .btn-crear-presupuesto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-imagen[_ngcontent-%COMP%]{text-align:center}.info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-imagen[_ngcontent-%COMP%]   .firma-img[_ngcontent-%COMP%]{max-width:100%;max-height:200px;border:1px solid #e5e7eb;border-radius:6px;box-shadow:0 2px 8px #0000001a}.info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-imagen[_ngcontent-%COMP%]   .firma-caption[_ngcontent-%COMP%]{margin-top:12px;font-size:12px;color:#6b7280;font-style:italic}.info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-texto[_ngcontent-%COMP%]{text-align:center;padding:16px;background:#fff;border-radius:6px;border:1px solid #e5e7eb}.info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-texto[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;color:#374151;font-weight:500}.info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-texto[_ngcontent-%COMP%]   .firma-nombre[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;font-size:16px;font-weight:600;color:#059669}.info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-texto[_ngcontent-%COMP%]   .firma-nombre[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.info-section[_ngcontent-%COMP%]   .observaciones-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;line-height:1.6;color:#374151;background:#fff;padding:16px;border-radius:6px;border:1px solid #e5e7eb;font-style:italic}@media (max-width: 768px){.modal-content[_ngcontent-%COMP%]{padding:10px}.info-section[_ngcontent-%COMP%]{padding:16px;margin-bottom:16px}.info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:14px;margin-bottom:12px}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{gap:12px}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{padding:12px}}@media (max-width: 480px){.modal-content[_ngcontent-%COMP%]{padding:12px!important}.info-section[_ngcontent-%COMP%]{padding:12px;margin-bottom:12px}.info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:13px;margin-bottom:10px}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{gap:10px}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{padding:10px}}@media print{ion-header[_ngcontent-%COMP%], ion-footer[_ngcontent-%COMP%]{display:none}ion-content[_ngcontent-%COMP%]{--background: white}ion-content[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{padding:0;max-height:none;overflow:visible}.info-section[_ngcontent-%COMP%]{background:#fff!important;border:1px solid #e5e7eb!important;margin-bottom:20px!important;page-break-inside:avoid}.info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#4f46e5!important;border-bottom:2px solid #10B981!important}.materiales-table[_ngcontent-%COMP%]{width:100%!important;border-collapse:collapse!important}.materiales-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .materiales-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #e5e7eb!important;padding:8px!important}.materiales-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f3f4f6!important;font-weight:700!important}.presupuesto-content[_ngcontent-%COMP%]{background:#fef3c7!important;border:1px solid #f59e0b!important}.firma-content[_ngcontent-%COMP%]   .firma-img[_ngcontent-%COMP%]{max-width:200px!important;max-height:150px!important}.btn-crear-presupuesto[_ngcontent-%COMP%], .header-actions[_ngcontent-%COMP%], .button-group[_ngcontent-%COMP%]{display:none!important}.modal-content[_ngcontent-%COMP%]{font-size:12px!important;line-height:1.4!important}.info-item[_ngcontent-%COMP%]{padding:8px!important;margin-bottom:8px!important}.descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .observaciones-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px!important;line-height:1.4!important}}']});let r=d;return r})();function fo(r,d){if(r&1&&(o(0,"div",17)(1,"p",18),s(2),a()()),r&2){let i=m(2);l(2),M(i.imagen.descripcion)}}function bo(r,d){if(r&1){let i=v();o(0,"div",14)(1,"img",15),_("mousedown",function(e){P(i);let t=m();return O(t.onMouseDown(e))}),a(),h(2,fo,3,1,"div",16),a()}if(r&2){let i=m();l(),wn("transform",i.getImageTransform())("cursor",i.zoomLevel>1?i.isDragging?"grabbing":"grab":"zoom-in"),g("src",i.imagen.url,$)("alt",i.imagen.descripcion||"Imagen del aviso"),l(),g("ngIf",i.imagen.descripcion)}}V({close:q,downloadOutline:Pn,trashOutline:on,chevronBackOutline:Le,chevronForwardOutline:qe,refreshOutline:N});var gt=(()=>{let d=class d{constructor(n){this.modalController=n,this.imagen=null,this.zoomLevel=1,this.minZoom=.5,this.maxZoom=3,this.isDragging=!1,this.startX=0,this.startY=0,this.translateX=0,this.translateY=0,this.lastDistance=0,V({refreshOutline:N,downloadOutline:Pn,trashOutline:on,close:q})}cerrarModal(){this.modalController.dismiss()}descargarImagen(){var e;if(!((e=this.imagen)!=null&&e.url))return;let n=document.createElement("a");n.href=this.imagen.url,n.download=this.imagen.descripcion||`imagen-${this.imagen.id}`,n.target="_blank",document.body.appendChild(n),n.click(),document.body.removeChild(n)}eliminarImagen(){confirm("\xBFEst\xE1s seguro de que quieres eliminar esta imagen?")&&this.modalController.dismiss({accion:"eliminar",imagen:this.imagen})}onWheel(n){n.preventDefault();let e=n.deltaY>0?-.1:.1,t=Math.max(this.minZoom,Math.min(this.maxZoom,this.zoomLevel+e));t!==this.zoomLevel&&(this.zoomLevel=t,this.zoomLevel===1&&(this.translateX=0,this.translateY=0))}onMouseDown(n){this.zoomLevel>1&&(this.isDragging=!0,this.startX=n.clientX-this.translateX,this.startY=n.clientY-this.translateY,n.preventDefault())}onMouseMove(n){this.isDragging&&this.zoomLevel>1&&(this.translateX=n.clientX-this.startX,this.translateY=n.clientY-this.startY)}onMouseUp(){this.isDragging=!1}onTouchStart(n){n.touches.length===2&&n.preventDefault()}onTouchMove(n){if(n.touches.length===2){n.preventDefault();let e=n.touches[0],t=n.touches[1],c=Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2));if(this.lastDistance&&c!==this.lastDistance){let u=c/this.lastDistance,f=Math.max(this.minZoom,Math.min(this.maxZoom,this.zoomLevel*u));this.zoomLevel=f}this.lastDistance=c}}onTouchEnd(){this.lastDistance=0}resetZoom(){this.zoomLevel=1,this.translateX=0,this.translateY=0}getImageTransform(){return`scale(${this.zoomLevel}) translate(${this.translateX/this.zoomLevel}px, ${this.translateY/this.zoomLevel}px)`}};d.\u0275fac=function(e){return new(e||d)(z(J))},d.\u0275cmp=H({type:d,selectors:[["app-ver-imagen-modal"]],inputs:{imagen:"imagen"},decls:15,vars:2,consts:[[1,"modal-header"],[1,"zoom-controls"],[1,"zoom-level"],["title","Resetear zoom",1,"btn-action",3,"click"],["name","refresh-outline"],[1,"header-actions"],["title","Descargar imagen",1,"btn-action",3,"click"],["name","download-outline"],["title","Eliminar imagen",1,"btn-action",3,"click"],["name","trash-outline"],["title","Cerrar",1,"btn-close",3,"click"],["name","close"],[1,"modal-content",3,"wheel","mousemove","mouseup","touchstart","touchmove","touchend"],["class","image-container",4,"ngIf"],[1,"image-container"],[1,"full-image",3,"mousedown","src","alt"],["class","image-info",4,"ngIf"],[1,"image-info"],[1,"image-description"]],template:function(e,t){e&1&&(o(0,"div",0)(1,"div",1)(2,"span",2),s(3),a(),o(4,"button",3),_("click",function(){return t.resetZoom()}),p(5,"ion-icon",4),a()(),o(6,"div",5)(7,"button",6),_("click",function(){return t.descargarImagen()}),p(8,"ion-icon",7),a(),o(9,"button",8),_("click",function(){return t.eliminarImagen()}),p(10,"ion-icon",9),a(),o(11,"button",10),_("click",function(){return t.cerrarModal()}),p(12,"ion-icon",11),a()()(),o(13,"div",12),_("wheel",function(u){return t.onWheel(u)})("mousemove",function(u){return t.onMouseMove(u)})("mouseup",function(){return t.onMouseUp()})("touchstart",function(u){return t.onTouchStart(u)})("touchmove",function(u){return t.onTouchMove(u)})("touchend",function(){return t.onTouchEnd()}),h(14,bo,3,7,"div",13),a()),e&2&&(l(3),F("",(t.zoomLevel*100).toFixed(0),"%"),l(11),g("ngIf",t.imagen))},dependencies:[L,B,U],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100vh;background:#000;color:#fff}.modal-header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;z-index:1000;background:#000c;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:16px 20px;display:flex;justify-content:space-between;align-items:center}.zoom-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.zoom-controls[_ngcontent-%COMP%]   .zoom-level[_ngcontent-%COMP%]{color:#fff;font-size:14px;font-weight:500;background:#ffffff1a;padding:4px 8px;border-radius:6px;min-width:50px;text-align:center}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.btn-action[_ngcontent-%COMP%], .btn-close[_ngcontent-%COMP%], .btn-zoom[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:44px;height:44px;border:none;border-radius:50%;background:#ffffff1a;color:#fff;cursor:pointer;transition:all .2s ease;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.btn-action[_ngcontent-%COMP%]:hover, .btn-close[_ngcontent-%COMP%]:hover, .btn-zoom[_ngcontent-%COMP%]:hover{background:#fff3;transform:scale(1.05)}.btn-action[_ngcontent-%COMP%]:active, .btn-close[_ngcontent-%COMP%]:active, .btn-zoom[_ngcontent-%COMP%]:active{transform:scale(.95)}.btn-action[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .btn-close[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .btn-zoom[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.btn-close[_ngcontent-%COMP%]{background:#ef4444cc}.btn-close[_ngcontent-%COMP%]:hover{background:#ef4444}.modal-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:80px 20px 20px;overflow:hidden}.image-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;max-width:100vw;max-height:100vh}.full-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;width:auto;height:auto;object-fit:contain;border-radius:8px;box-shadow:0 8px 32px #0000004d;cursor:zoom-in;transition:transform .1s ease;transform-origin:center center;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.full-image[_ngcontent-%COMP%]:hover:not([style*=scale]){transform:scale(1.02)}.image-info[_ngcontent-%COMP%]{margin-top:20px;text-align:center;max-width:600px;padding:16px 20px;background:#ffffff1a;border-radius:12px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.1)}.image-description[_ngcontent-%COMP%]{margin:0;font-size:16px;line-height:1.5;color:#ffffffe6;font-weight:400}@media (max-width: 768px){.modal-header[_ngcontent-%COMP%]{padding:12px 16px}.zoom-controls[_ngcontent-%COMP%]   .zoom-level[_ngcontent-%COMP%]{font-size:12px;padding:3px 6px;min-width:40px}.btn-action[_ngcontent-%COMP%], .btn-close[_ngcontent-%COMP%], .btn-zoom[_ngcontent-%COMP%]{width:40px;height:40px}.btn-action[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .btn-close[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .btn-zoom[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.modal-content[_ngcontent-%COMP%]{padding:70px 16px 16px}.image-info[_ngcontent-%COMP%]{margin-top:16px;padding:12px 16px}.image-info[_ngcontent-%COMP%]   .image-description[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 480px){.modal-header[_ngcontent-%COMP%]{padding:50px 12px 10px}.btn-action[_ngcontent-%COMP%], .btn-close[_ngcontent-%COMP%]{width:36px;height:36px}.btn-action[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .btn-close[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.modal-content[_ngcontent-%COMP%]{padding:60px 12px 12px}.image-info[_ngcontent-%COMP%]{margin-top:12px;padding:10px 12px}.image-info[_ngcontent-%COMP%]   .image-description[_ngcontent-%COMP%]{font-size:13px}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}.full-image[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.image-container[_ngcontent-%COMP%]{overflow:auto;scroll-behavior:smooth}.full-image[_ngcontent-%COMP%]{cursor:grab}.full-image[_ngcontent-%COMP%]:active{cursor:grabbing}"]});let r=d;return r})();var Co=["fileInput"],Mo=(r,d,i)=>({finalizado:r,"presupuesto-pendiente":d,"otra-visita":i}),Po=(r,d,i)=>({green:r,yellow:d,blue:i});function Oo(r,d){r&1&&(o(0,"div",25)(1,"div",26),p(2,"ion-icon",27),o(3,"p"),s(4,"Cargando aviso..."),a()()())}function xo(r,d){if(r&1){let i=v();o(0,"div",28)(1,"div",29),p(2,"ion-icon",30),o(3,"p"),s(4),a(),o(5,"button",31),_("click",function(){P(i);let e=m();return O(e.cargarAviso())}),p(6,"ion-icon",32),s(7," Reintentar "),a()()()}if(r&2){let i=m();l(4),M(i.error)}}function ho(r,d){if(r&1){let i=v();o(0,"button",65),_("click",function(){P(i);let e=m(2);return O(e.completarAviso())}),p(1,"ion-icon",66),o(2,"span",18),s(3,"Completar Aviso"),a(),o(4,"span",19),s(5,"Completar"),a()()}}function vo(r,d){if(r&1){let i=v();o(0,"button",67),_("click",function(){P(i);let e=m(2);return O(e.editarAviso())}),p(1,"ion-icon",68),o(2,"span",18),s(3,"Editar aviso"),a(),o(4,"span",19),s(5,"Editar"),a()()}}function yo(r,d){r&1&&(o(0,"div",69),p(1,"ion-icon",70),o(2,"span"),s(3,"Aviso completado"),a()())}function wo(r,d){r&1&&(o(0,"div",71),p(1,"ion-icon",72),o(2,"span"),s(3,"Factura generada autom\xE1ticamente"),a()())}function Eo(r,d){if(r&1&&(o(0,"div",73),p(1,"ion-icon",74),o(2,"span"),s(3),a()()),r&2){let i=m(2);l(3),M(i.aviso.nombre_contacto)}}function ko(r,d){if(r&1&&(o(0,"div",75),p(1,"ion-icon",76),o(2,"a",77),s(3),a()()),r&2){let i=m(2);l(2),Gn("href","tel:",i.aviso.telefono_cliente_aviso,"",$),l(),M(i.aviso.telefono_cliente_aviso)}}function zo(r,d){if(r&1&&(o(0,"div",75),p(1,"ion-icon",78),o(2,"a",77),s(3),a()()),r&2){let i=m(2);l(2),Gn("href","mailto:",i.aviso.cliente==null?null:i.aviso.cliente.email,"",$),l(),M(i.aviso.cliente==null?null:i.aviso.cliente.email)}}function So(r,d){if(r&1){let i=v();o(0,"div",4)(1,"div",5)(2,"div",33)(3,"div",34)(4,"button",35),_("click",function(){P(i);let e=m();return O(e.volverALista())}),p(5,"ion-icon",36),o(6,"span",18),s(7,"Volver"),a(),o(8,"span",19),s(9,"Volver"),a()()()(),o(10,"div",37)(11,"button",38),_("click",function(){P(i);let e=m();return O(e.forzarRecargaDatos())}),p(12,"ion-icon",32),o(13,"span",18),s(14,"Recargar"),a(),o(15,"span",19),s(16,"Recargar"),a()(),h(17,ho,6,0,"button",39)(18,vo,6,0,"button",40)(19,yo,4,0,"div",41)(20,wo,4,0,"div",42),a(),o(21,"span",43),s(22),A(23,"titlecase"),a()(),o(24,"h2",44)(25,"span",18),s(26),A(27,"titlecase"),a()(),o(28,"div",45)(29,"div",46)(30,"div",47)(31,"label"),s(32,"Estado"),a(),o(33,"span",48),s(34),a()(),o(35,"div",47)(36,"label"),s(37,"Urgente"),a(),o(38,"span",49),s(39),a()(),o(40,"div",47)(41,"label"),s(42,"Fecha de creaci\xF3n"),a(),o(43,"span"),s(44),A(45,"date"),a()()(),o(46,"div",50)(47,"div",47)(48,"label"),s(49,"Descripci\xF3n Detallada del Problema/Petici\xF3n"),a(),o(50,"p",51),s(51),a()()(),o(52,"div",52)(53,"label"),s(54,"Cliente"),a(),o(55,"div",53)(56,"span",54),s(57),a(),o(58,"a",55),_("click",function(){P(i);let e=m();return O(e.verCliente())}),o(59,"span",18),s(60,"Ver cliente"),a()()()(),o(61,"div",56)(62,"label"),s(63,"Direcci\xF3n"),a(),o(64,"div",57)(65,"span",58),s(66),a(),o(67,"button",59),_("click",function(){P(i);let e=m();return O(e.verMapa())}),p(68,"ion-icon",60),a()()(),o(69,"div",61)(70,"label"),s(71,"Contacto Cliente"),a(),o(72,"div",62),h(73,Eo,4,1,"div",63)(74,ko,4,3,"div",64)(75,zo,4,3,"div",64),a()()()()}if(r&2){let i=m();l(17),g("ngIf",(i.aviso==null?null:i.aviso.estado)!=="Completado"),l(),g("ngIf",(i.aviso==null?null:i.aviso.estado)!=="Completado"),l(),g("ngIf",(i.aviso==null?null:i.aviso.estado)==="Completado"),l(),g("ngIf",(i.aviso==null?null:i.aviso.estado)==="Listo para facturar"&&(i.aviso==null?null:i.aviso.facturas)&&(i.aviso==null?null:i.aviso.facturas.length)>0),l(2),tn("Aviso ",i.aviso.numero_secuencial||i.aviso.id," - ",Qn(23,20,(i.aviso==null?null:i.aviso.tipo)||"No especificado"),""),l(4),tn("Aviso ",i.aviso.numero_secuencial||i.aviso.id," - ",Qn(27,22,(i.aviso==null?null:i.aviso.tipo)||"No especificado"),""),l(7),g("ngClass",i.getEstadoClass(i.aviso.estado)),l(),M(i.aviso.estado),l(4),ge("urgent",i.aviso.urgencia==="Alta"||i.aviso.es_urgente),l(),F(" ",i.aviso.urgencia==="Alta"||i.aviso.es_urgente?"S\xED":"No"," "),l(5),M(Mn(45,24,i.aviso.fecha_creacion,"dd/MM/yyyy")),l(7),M(i.aviso==null?null:i.aviso.descripcion_problema),l(6),M(i.aviso.nombre_cliente_aviso),l(9),M(i.aviso.direccion_cliente_aviso),l(7),g("ngIf",i.aviso.nombre_contacto),l(),g("ngIf",i.aviso.telefono_cliente_aviso),l(),g("ngIf",i.aviso.cliente==null?null:i.aviso.cliente.email)}}function Io(r,d){if(r&1){let i=v();o(0,"div",79)(1,"button",67),_("click",function(){P(i);let e=m();return O(e.crearAlbaran())}),p(2,"ion-icon",17),o(3,"span",18),s(4,"Crear Albar\xE1n"),a(),o(5,"span",19),s(6,"Crear Albar\xE1n"),a()()()}}function Ao(r,d){if(r&1){let i=v();o(0,"div",80)(1,"div",81)(2,"app-flujo-estado",82),_("accionEjecutada",function(e){P(i);let t=m();return O(t.onAccionFlujoEjecutada(e))}),a()()()}if(r&2){let i=m();l(2),g("avisoId",(i.aviso==null?null:i.aviso.id)||"")}}function Fo(r,d){r&1&&(o(0,"div",83),p(1,"ion-icon",72),o(2,"p"),s(3,"No hay albaranes cerrados para este aviso"),a(),o(4,"p",84),s(5,"Los albaranes aparecer\xE1n aqu\xED una vez que se cierren los trabajos realizados"),a()())}function jo(r,d){r&1&&(o(0,"span",108),p(1,"ion-icon",109),a())}function To(r,d){if(r&1&&(o(0,"div",110)(1,"span",111),s(2),a(),o(3,"span",112),s(4,"repuestos"),a()()),r&2){let i=m().$implicit;l(2),F(" ",i.repuestos&&i.repuestos.length>0?i.repuestos.length:i.repuestos_utilizados.length," ")}}function Vo(r,d){r&1&&(o(0,"div",113),s(1," Sin repuestos "),a())}function Do(r,d){if(r&1&&(o(0,"div",114)(1,"span",115),s(2),A(3,"number"),a()()),r&2){let i=m().$implicit;l(2),F(" \u20AC",Mn(3,1,i.presupuesto_necesario,"1.2-2")," ")}}function No(r,d){if(r&1){let i=v();o(0,"div",92)(1,"div",93),s(2),a(),o(3,"div",94)(4,"div",95)(5,"span",96),s(6),a(),h(7,jo,2,0,"span",97),a()(),o(8,"div",98),s(9),A(10,"date"),a(),o(11,"div",99),h(12,To,5,1,"div",100)(13,Vo,2,0,"div",101),a(),o(14,"div",102)(15,"button",103),_("click",function(){let e=P(i).$implicit,t=m(2);return O(t.verAlbaran(e))}),p(16,"ion-icon",104),a(),o(17,"button",105),_("click",function(){let e=P(i).$implicit,t=m(2);return O(t.eliminarAlbaran(e))}),p(18,"ion-icon",106),a(),h(19,Do,4,4,"div",107),a()()}if(r&2){let i=d.$implicit,n=d.index,e=m(2);g("ngClass",Zn(12,Mo,i.estado_cierre==="Finalizado",i.estado_cierre==="Presupuesto pendiente",i.estado_cierre==="Otra visita")),l(2),M(n+1),l(3),g("ngClass",Zn(16,Po,i.estado_cierre==="Finalizado",i.estado_cierre==="Presupuesto pendiente",i.estado_cierre==="Otra visita")),l(),F(" ",i.estado_cierre," "),l(),g("ngIf",e.tienePresupuestoAsociado(i)),l(2),M(Mn(10,9,i.fecha_cierre,"dd/MM/yyyy")),l(3),g("ngIf",i.repuestos&&i.repuestos.length>0||i.repuestos_utilizados&&i.repuestos_utilizados.length>0),l(),g("ngIf",(!i.repuestos||i.repuestos.length===0)&&(!i.repuestos_utilizados||i.repuestos_utilizados.length===0)),l(6),g("ngIf",i.presupuesto_necesario>0)}}function Ro(r,d){if(r&1&&(o(0,"div",85)(1,"div",86)(2,"div",87)(3,"div",88)(4,"div",89),s(5,"N\xFAmero"),a(),o(6,"div",89),s(7,"Estado"),a(),o(8,"div",89),s(9,"Fecha"),a(),o(10,"div",89),s(11,"Repuestos"),a(),o(12,"div",89),s(13,"Acciones"),a()()(),o(14,"div",90),h(15,No,20,20,"div",91),a()()()),r&2){let i=m();l(15),g("ngForOf",i.aviso==null?null:i.aviso.albaranes)}}function $o(r,d){r&1&&(o(0,"div",116),p(1,"ion-icon",27),o(2,"p"),s(3,"Subiendo im\xE1genes..."),a()())}function Ho(r,d){r&1&&(o(0,"div",117),p(1,"ion-icon",118),o(2,"p"),s(3,"No hay im\xE1genes disponibles para este aviso"),a()())}function Bo(r,d){if(r&1){let i=v();o(0,"div",119)(1,"img",120),_("click",function(){let e=P(i).$implicit,t=m();return O(t.verImagenCompleta(e))}),a(),o(2,"div",121)(3,"span",122),s(4),a(),o(5,"span",123),s(6),A(7,"date"),a()(),o(8,"button",124),_("click",function(){let e=P(i).$implicit,t=m();return O(t.eliminarFoto(e))}),p(9,"ion-icon",106),a()()}if(r&2){let i=d.$implicit;l(),g("src",i.url,$)("alt",i.descripcion||"Imagen del aviso"),l(3),M(i.descripcion||"Imagen del aviso"),l(2),M(Mn(7,4,i.fecha_subida,"dd/MM/yyyy HH:mm"))}}V({close:q,pencilOutline:On,navigate:te,person:oe,call:Kn,mail:ne,mapOutline:ee,arrowBackOutline:Jn});var Va=(()=>{let d=class d{constructor(n,e,t,c,u,f){this.route=n,this.router=e,this.avisosService=t,this.albaranesService=c,this.modalController=u,this.flujoAvisosService=f,this.vistaGaleria="grid",this.aviso=null,this.loading=!1,this.error=null,this.subiendoImagenes=!1,this.estadoClassCache="estado-pendiente",this.ultimoEstado=void 0,this.destroy$=new vn,V({refreshOutline:N,alertCircleOutline:Re,arrowBackOutline:Jn,close:q,pencilOutline:On,checkmarkCircleOutline:K,navigate:te,person:oe,call:Kn,mail:ne,addCircle:De,documentTextOutline:nn,calculator:Fn,eyeOutline:Vn,imagesOutline:Qe,trashOutline:on,informationCircleOutline:Dn,constructOutline:Ye,bugOutline:He,personOutline:sn,gridOutline:Ze,listOutline:Je,chevronDownOutline:Ue,ellipsisVerticalOutline:Xe,ellipsisVertical:We,add:Ve,mapOutline:ee})}ngOnInit(){this.cargarAviso()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarAviso(){console.log("\u{1F504} cargarAviso() ejecut\xE1ndose..."),this.loading=!0,this.error=null,this.route.params.pipe(D(this.destroy$)).subscribe(n=>{let e=n["id-aviso"];console.log("\u{1F50D} ID de aviso obtenido de la URL:",e),e?this.avisosService.getResumenCompletoAviso(e).pipe(D(this.destroy$)).subscribe({next:t=>{var c,u;console.log("\u2705 Aviso cargado exitosamente:",t.id,"Estado:",t.estado),console.log("\u{1F4CA} Albaranes cargados:",((c=t.albaranes)==null?void 0:c.length)||0),console.log("\u{1F4CA} Facturas cargadas:",((u=t.facturas)==null?void 0:u.length)||0),this.aviso=t,this.loading=!1,this.getEstadoClass(t.estado),this.verificarEstadoRealAviso(t),setTimeout(()=>{this.flujoComponent&&this.flujoComponent.recargarFlujo()},100)},error:t=>{console.error("\u274C Error al cargar el aviso:",t),this.error="Error al cargar el aviso. Por favor, int\xE9ntalo de nuevo.",this.loading=!1}}):(this.error="ID de aviso no v\xE1lido",this.loading=!1)})}cambiarVistaGaleria(n){this.vistaGaleria=n.detail.value}verificarGeneracionFacturaAutomatica(n){console.log("\u{1F50D} Verificando generaci\xF3n autom\xE1tica de factura para aviso:",n),this.flujoAvisosService.actualizarEstadoConFacturaAutomatica(n).subscribe({next:e=>{console.log("\u{1F50D} Resultado de verificaci\xF3n autom\xE1tica:",e),e.facturaGenerada?(console.log("\u{1F4B0} Factura generada autom\xE1ticamente al cargar aviso:",e.facturaGenerada),this.mostrarMensaje("Factura generada autom\xE1ticamente para el aviso.","success"),this.cargarAviso()):console.log("\u2139\uFE0F No se gener\xF3 factura autom\xE1tica - condiciones no cumplidas")},error:e=>{console.error("\u274C Error al verificar generaci\xF3n autom\xE1tica:",e)}})}verificarEstadoRealAviso(n){var e,t,c,u,f;if(console.log("\u{1F50D} Verificando estado real del aviso bas\xE1ndose en facturas:",{avisoId:n.id,estadoActual:n.estado,facturas:((e=n.facturas)==null?void 0:e.length)||0,albaranes:((t=n.albaranes)==null?void 0:t.length)||0,albaranesDetalle:((c=n.albaranes)==null?void 0:c.map(x=>({id:x.id,estado:x.estado_cierre})))||[]}),n.estado==="Listo para facturar"&&n.facturas&&n.facturas.length>0)console.log('\u26A0\uFE0F Aviso en estado "Listo para facturar" pero tiene facturas - actualizando a "En curso"'),this.avisosService.actualizarAviso(n.id,{estado:"En curso"}).subscribe({next:x=>{console.log('\u2705 Estado del aviso actualizado a "En curso"'),this.aviso=x},error:x=>{console.error("\u274C Error al actualizar estado del aviso:",x)}});else if(n.estado==="Listo para facturar"&&(!n.facturas||n.facturas.length===0)){console.log('\u{1F4B0} Aviso en estado "Listo para facturar" sin facturas - verificando generaci\xF3n autom\xE1tica');let x=((u=n.albaranes)==null?void 0:u.filter(b=>b.estado_cierre==="Finalizado"))||[];console.log("\u{1F50D} Albaranes finalizados encontrados:",x.length),x.length>0?(console.log("\u2705 Aviso tiene albaranes finalizados sin facturas - generando factura autom\xE1ticamente"),this.verificarGeneracionFacturaAutomatica(n.id)):console.log('\u26A0\uFE0F Aviso en "Listo para facturar" pero no tiene albaranes finalizados')}else n.estado==="En curso"&&(!n.facturas||n.facturas.length===0)&&(console.log('\u{1F50D} Aviso en estado "En curso" sin facturas - verificando si deber\xEDa estar "Listo para facturar"'),(((f=n.albaranes)==null?void 0:f.filter(b=>b.estado_cierre==="Finalizado"))||[]).length>0&&(console.log('\u{1F4B0} Aviso tiene albaranes finalizados sin facturas - actualizando a "Listo para facturar"'),this.avisosService.actualizarAviso(n.id,{estado:"Listo para facturar"}).subscribe({next:b=>{console.log('\u2705 Estado del aviso actualizado a "Listo para facturar"'),this.aviso=b,this.verificarGeneracionFacturaAutomatica(n.id)},error:b=>{console.error("\u274C Error al actualizar estado del aviso:",b)}})))}forzarRecargaDatos(){this.error=null,this.cargarAviso(),setTimeout(()=>{this.flujoComponent&&this.flujoComponent.recargarFlujo()},200)}recargarAlbaranes(){var n;(n=this.aviso)!=null&&n.id&&(console.log("\u{1F504} Recargando albaranes del aviso:",this.aviso.id),this.avisosService.getResumenCompletoAviso(this.aviso.id).pipe(D(this.destroy$)).subscribe({next:e=>{var t;console.log("\u2705 Albaranes recargados:",((t=e.albaranes)==null?void 0:t.length)||0),this.aviso=e},error:e=>{console.error("\u274C Error al recargar albaranes:",e)}}))}volverALista(){let n=document.referrer;n&&n.includes("/historial")?this.router.navigate(["/historial"]):this.router.navigate(["/avisos"])}verCliente(){var n,e;(e=(n=this.aviso)==null?void 0:n.cliente)!=null&&e.id&&console.log("Navegar al cliente:",this.aviso.cliente.id)}verMapa(){var n;if((n=this.aviso)!=null&&n.direccion_cliente_aviso){let e=encodeURIComponent(this.aviso.direccion_cliente_aviso);window.open(`https://www.google.com/maps/search/?api=1&query=${e}`,"_blank")}}editarAviso(){var n;(n=this.aviso)!=null&&n.id&&this.abrirModalEditarAviso()}abrirModalEditarAviso(){return R(this,null,function*(){var c;if(!((c=this.aviso)!=null&&c.id))return;let n=yield this.modalController.create({component:at,cssClass:"modal-crear-aviso",componentProps:{modoEdicion:!0,avisoExistente:this.aviso}});yield n.present();let{data:e,role:t}=yield n.onWillDismiss();if(t==="confirm"&&e)try{console.log("Datos del formulario de edici\xF3n:",e);let u={tipo:e.tipo,nombre_cliente_aviso:e.nombreContacto,direccion_cliente_aviso:e.direccionLocal,telefono_cliente_aviso:e.telefono,nombre_contacto:e.nombreContacto,descripcion_problema:e.descripcion,es_urgente:e.esUrgente,urgencia:e.esUrgente?"Alta":"Normal"};this.loading=!0,this.avisosService.actualizarAviso(this.aviso.id,u).pipe(D(this.destroy$)).subscribe({next:f=>{console.log("Aviso actualizado exitosamente:",f),this.loading=!1,this.mostrarMensaje("Aviso actualizado exitosamente","success"),this.cargarAviso()},error:f=>{console.error("Error al actualizar aviso:",f),this.loading=!1,this.mostrarMensaje(f.message||"Error al actualizar el aviso. Por favor, int\xE9ntalo de nuevo.","error")}})}catch(u){console.error("Error al procesar la edici\xF3n:",u),this.mostrarMensaje("Error al procesar la edici\xF3n. Por favor, int\xE9ntalo de nuevo.","error")}})}cerrarAlbaran(){var n;(n=this.aviso)!=null&&n.id&&console.log("Cerrar albar\xE1n para aviso:",this.aviso.id)}seleccionarImagenes(){this.fileInput&&this.fileInput.nativeElement.click()}onFileSelected(n){var t;let e=n.target.files;e.length>0&&((t=this.aviso)!=null&&t.id)&&this.subirImagenes(Array.from(e)),n.target.value=""}subirImagenes(n){return R(this,null,function*(){var e;if(!((e=this.aviso)!=null&&e.id)){console.error("No se puede subir im\xE1genes: aviso no v\xE1lido");return}this.subiendoImagenes=!0,this.error=null;try{yield new Promise(c=>{let u=0,f=n.length;n.forEach(x=>{this.avisosService.subirFoto(this.aviso.id,x).pipe(D(this.destroy$)).subscribe({next:b=>{console.log("Foto subida:",b),u++,u===f&&c()},error:b=>{console.error("Error al subir foto:",b),u++,u===f&&c()}})})}),this.cargarAviso()}catch(t){console.error("Error al subir im\xE1genes:",t),this.error="Error al subir las im\xE1genes. Por favor, int\xE9ntalo de nuevo."}finally{this.subiendoImagenes=!1}})}crearAlbaran(){return R(this,null,function*(){var c;if(!((c=this.aviso)!=null&&c.id))return;let n=yield this.modalController.create({component:st,componentProps:{aviso:this.aviso},backdropDismiss:!1,showBackdrop:!0});yield n.present();let{data:e,role:t}=yield n.onWillDismiss();if(t==="confirm"&&(e!=null&&e.success))try{console.log("\u2705 Albar\xE1n creado exitosamente:",e.albaran),e.presupuesto&&e.accion==="presupuesto_creado"&&(console.log("\u2705 Presupuesto creado junto con el albar\xE1n:",e.presupuesto),alert(e.mensaje||"Albar\xE1n y presupuesto creados exitosamente. Puedes editarlo desde la secci\xF3n de presupuestos.")),alert(e.mensaje||"Albar\xE1n creado exitosamente"),this.cargarAviso()}catch(u){console.error("Error al procesar albar\xE1n:",u),alert("Error al procesar el albar\xE1n. Por favor, int\xE9ntalo de nuevo.")}})}verImagenCompleta(n){return R(this,null,function*(){if(!(n!=null&&n.url)){console.error("No se puede mostrar la imagen: URL no v\xE1lida");return}let e=yield this.modalController.create({component:gt,componentProps:{imagen:n},cssClass:"modal-imagen-completa",backdropDismiss:!0,showBackdrop:!0});yield e.present();let{data:t,role:c}=yield e.onWillDismiss();c==="confirm"&&(t==null?void 0:t.accion)==="eliminar"&&(console.log("Imagen eliminada desde el modal"),this.cargarAviso())})}eliminarFoto(n){return R(this,null,function*(){var t;if(!((t=this.aviso)!=null&&t.id)||!(n!=null&&n.id)){console.error("No se puede eliminar la foto: faltan datos");return}if(confirm(`\xBFEst\xE1s seguro de que quieres eliminar esta imagen?

Esta acci\xF3n no se puede deshacer.`))try{yield le(this.avisosService.eliminarFoto(n.id)),console.log("Foto eliminada exitosamente"),this.cargarAviso()}catch(c){console.error("Error al eliminar la foto:",c),alert("Error al eliminar la imagen. Por favor, int\xE9ntalo de nuevo.")}})}getEstadoClass(n){if(!n)return this.ultimoEstado!==void 0&&(this.ultimoEstado=void 0,this.estadoClassCache="estado-pendiente"),this.estadoClassCache;if(this.ultimoEstado!==n){this.ultimoEstado=n;let e=n.toLowerCase().replace(/ /g,"-");this.estadoClassCache=`estado-${e}`}return this.estadoClassCache}onAccionFlujoEjecutada(n){var e;console.log("Acci\xF3n de flujo ejecutada:",n),this.cargarAviso(),(e=this.aviso)!=null&&e.id&&this.flujoAvisosService.actualizarEstadoConFacturaAutomatica(this.aviso.id).subscribe({next:t=>{console.log("Estado del aviso actualizado autom\xE1ticamente:",t.aviso.estado),t.facturaGenerada?(console.log("\u{1F4B0} Factura generada autom\xE1ticamente:",t.facturaGenerada),this.mostrarMensaje("Factura generada autom\xE1ticamente para el aviso.","success")):t.aviso.estado==="Listo para facturar"&&(console.log("\u{1F4B0} Aviso listo para facturar - verificando si se gener\xF3 factura autom\xE1ticamente..."),setTimeout(()=>{this.mostrarMensaje("El aviso est\xE1 listo para facturar. Se generar\xE1 la factura autom\xE1ticamente si hay albaranes finalizados.","info")},1e3)),this.cargarAviso()},error:t=>{console.error("Error al actualizar estado autom\xE1tico:",t)}}),n.mensaje&&(console.log("Mensaje de \xE9xito:",n.mensaje),alert(n.mensaje)),n.facturaId&&confirm("Se ha generado una factura. \xBFDeseas ver la factura creada?")&&this.router.navigate(["/facturas",n.facturaId])}completarAviso(){var n;(n=this.aviso)!=null&&n.id?(console.log("\u{1F504} Completando aviso:",this.aviso.id),confirm("\xBFEst\xE1s seguro de que quieres marcar este aviso como completado? Esta acci\xF3n no se puede deshacer.")&&(this.loading=!0,this.error=null,this.flujoAvisosService.completarAviso(this.aviso.id).subscribe({next:e=>{console.log("\u2705 Aviso completado exitosamente:",e),this.loading=!1,this.mostrarMensaje("Aviso completado exitosamente","success"),this.cargarAviso()},error:e=>{console.error("\u274C Error al completar aviso:",e),this.loading=!1;let t=e.message||"Error al completar el aviso. Verifica que haya trabajos realizados y facturas generadas.";this.mostrarMensaje(t,"error"),this.error=t}}))):(console.error("No hay aviso seleccionado para completar"),this.mostrarMensaje("No hay aviso seleccionado para completar","error"))}verAlbaran(n){return R(this,null,function*(){var e;if(!(n!=null&&n.id)){console.error("No se puede abrir el albar\xE1n: ID no v\xE1lido");return}try{console.log("Abriendo modal de albar\xE1n:",n);let t=yield this.modalController.create({component:dt,componentProps:{albaran:n,aviso:this.aviso},cssClass:"modal-ver-albaran modal-fullscreen",backdropDismiss:!0});yield t.present();let{data:c,role:u}=yield t.onWillDismiss();if(u==="confirm"&&c&&(console.log("Modal de albar\xE1n cerrado con datos:",c),c.accion==="presupuesto_creado")){console.log("\u2705 Presupuesto creado desde el modal del albar\xE1n:",c.presupuesto),c.mensaje&&alert(c.mensaje),c.navegoAPresupuesto||this.cargarAviso();return}console.log("Modal de albar\xE1n cerrado. Recargando datos..."),this.cargarAviso(),(e=this.aviso)!=null&&e.id&&this.flujoAvisosService.actualizarEstadoConFacturaAutomatica(this.aviso.id).subscribe({next:f=>{console.log("Estado del aviso actualizado autom\xE1ticamente despu\xE9s de cerrar albar\xE1n:",f.aviso.estado),f.facturaGenerada&&(console.log("\u{1F4B0} Factura generada autom\xE1ticamente despu\xE9s de cerrar albar\xE1n:",f.facturaGenerada),this.mostrarMensaje("Factura generada autom\xE1ticamente despu\xE9s de cerrar el albar\xE1n.","success")),this.cargarAviso()},error:f=>{console.error("Error al actualizar estado autom\xE1tico despu\xE9s de cerrar albar\xE1n:",f)}})}catch(t){console.error("Error al abrir el modal del albar\xE1n:",t),this.mostrarMensaje("Error al abrir el albar\xE1n. Por favor, int\xE9ntalo de nuevo.","error")}})}tienePresupuestoAsociado(n){var e;return!((e=this.aviso)!=null&&e.presupuestos)||this.aviso.presupuestos.length===0?!1:this.aviso.presupuestos.some(t=>t.albaran_id===n.id)}eliminarAlbaran(n){var t;if(!(n!=null&&n.id)){console.error("No se puede eliminar el albar\xE1n: ID no v\xE1lido");return}if(this.tienePresupuestoAsociado(n)){alert(`\u26A0\uFE0F No se puede eliminar este albar\xE1n porque tiene un presupuesto asociado.

Primero debes eliminar el presupuesto.`);return}confirm(`\xBFEst\xE1s seguro de que quieres eliminar el albar\xE1n #${(t=n.id)==null?void 0:t.substring(0,8)}?

Los repuestos utilizados se devolver\xE1n autom\xE1ticamente al inventario.

Esta acci\xF3n no se puede deshacer.`)&&(this.loading=!0,this.albaranesService.eliminarAlbaran(n.id).subscribe({next:()=>{console.log("Albar\xE1n eliminado exitosamente y repuestos devueltos al inventario"),this.loading=!1,alert(`\u2705 Albar\xE1n eliminado exitosamente.

Los repuestos utilizados han sido devueltos autom\xE1ticamente al inventario.`),this.cargarAviso()},error:c=>{console.error("Error al eliminar albar\xE1n:",c),this.loading=!1,alert("Error al eliminar el albar\xE1n: "+(c.message||"Error desconocido"))}}))}mostrarMensaje(n,e="info"){console.log(`[${e.toUpperCase()}] ${n}`),e==="error"?alert(`ERROR: ${n}`):e==="success"?console.log(`\u2705 ${n}`):e==="info"?(console.log(`\u2139\uFE0F ${n}`),alert(`\u2139\uFE0F ${n}`)):console.log(`\u2139\uFE0F ${n}`)}};d.\u0275fac=function(e){return new(e||d)(z(fe),z(rn),z(An),z(Hn),z(J),z($n))},d.\u0275cmp=H({type:d,selectors:[["app-ver-avisos"]],viewQuery:function(e,t){if(e&1&&(fn(Co,5),fn(ie,5)),e&2){let c;bn(c=Cn())&&(t.fileInput=c.first),bn(c=Cn())&&(t.flujoComponent=c.first)}},decls:34,vars:13,consts:[["fileInput",""],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","info-card",4,"ngIf"],[1,"info-card"],[1,"card-header"],[2,"text-wrap","nowrap"],["class","header-actions-jobs",4,"ngIf"],["class","flujo-section",4,"ngIf"],[1,"section-divider"],[1,"albaranes-section"],[1,"albaranes-container"],["class","no-albaranes",4,"ngIf"],["class","compact-albaranes-table",4,"ngIf"],[1,"card-header",2,"justify-content","space-between!important"],[1,"gallery-actions"],[1,"btn-primary",3,"click","disabled"],["name","add-circle"],[1,"desktop-only"],[1,"mobile-only"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"gallery-items"],["class","uploading-indicator",4,"ngIf"],["class","no-images",4,"ngIf"],["class","gallery-item",4,"ngFor","ngForOf"],[1,"loading-state"],[1,"loading-spinner"],["name","refresh-outline",1,"spinning"],[1,"error-state"],[1,"error-message"],["name","alert-circle-outline"],[1,"btn-retry",3,"click"],["name","refresh-outline"],[1,"header-container"],[1,"back-button"],[1,"btn-back",3,"click"],["name","arrow-back-outline"],[1,"header-actions"],["title","Recargar datos",1,"btn-secondary",3,"click"],["class","btn-secondary",3,"click",4,"ngIf"],["class","btn-primary",3,"click",4,"ngIf"],["class","aviso-completado-message",4,"ngIf"],["class","factura-generada-message",4,"ngIf"],[1,"mobile-only","title"],[1,"title"],[1,"info-grid"],[1,"info-row"],[1,"info-item"],[1,"estado-aviso",3,"ngClass"],[1,"urgent-badge"],[1,"descripcion-content"],[1,"descripcion-texto"],[1,"info-item","cliente-section"],[1,"cliente-info"],[1,"cliente-nombre"],[1,"ver-cliente",3,"click"],[1,"info-item","direccion-section"],[1,"direccion-info"],[1,"direccion-texto"],["title","Ver en mapa",1,"btn-map",3,"click"],["name","navigate"],[1,"contacto-section"],[1,"contacto-items"],["class","contacto-item nombre-contacto",4,"ngIf"],["class","contacto-item",4,"ngIf"],[1,"btn-secondary",3,"click"],["name","close"],[1,"btn-primary",3,"click"],["name","pencil-outline"],[1,"aviso-completado-message"],["name","checkmark-circle-outline"],[1,"factura-generada-message"],["name","document-text-outline"],[1,"contacto-item","nombre-contacto"],["name","person"],[1,"contacto-item"],["name","call"],[1,"contacto-link",3,"href"],["name","mail"],[1,"header-actions-jobs"],[1,"flujo-section"],[1,"flujo-container"],[3,"accionEjecutada","avisoId"],[1,"no-albaranes"],[1,"info-text"],[1,"compact-albaranes-table"],[1,"albaranes-table"],[1,"table-header"],[1,"header-row"],[1,"header-cell"],[1,"table-body"],["class","albaran-row",3,"ngClass",4,"ngFor","ngForOf"],[1,"albaran-row",3,"ngClass"],[1,"albaran-cell","numero-albaran"],[1,"albaran-cell","estado-albaran"],[1,"estado-container"],[1,"badge",3,"ngClass"],["class","badge badge-presupuesto","title","Presupuesto creado",4,"ngIf"],[1,"albaran-cell","fecha-albaran"],[1,"albaran-cell","repuestos-albaran"],["class","repuestos-info",4,"ngIf"],["class","repuestos-vacio",4,"ngIf"],[1,"albaran-cell","acciones"],["title","Ver albar\xE1n completo",1,"btn-ver",3,"click"],["name","eye-outline"],["title","Eliminar albar\xE1n",1,"btn-eliminar",3,"click"],["name","trash-outline"],["class","mobile-info",4,"ngIf"],["title","Presupuesto creado",1,"badge","badge-presupuesto"],["name","calculator"],[1,"repuestos-info"],[1,"repuestos-count"],[1,"repuestos-label"],[1,"repuestos-vacio"],[1,"mobile-info"],[1,"presupuesto-mobile"],[1,"uploading-indicator"],[1,"no-images"],["name","images-outline"],[1,"gallery-item"],[1,"clickable-image",3,"click","src","alt"],[1,"image-info"],[1,"image-title"],[1,"file-info"],["title","Eliminar imagen",1,"btn-delete",3,"click"]],template:function(e,t){if(e&1){let c=v();h(0,Oo,5,0,"div",1)(1,xo,8,1,"div",2)(2,So,76,27,"div",3),o(3,"div",4)(4,"div",5)(5,"h2",6),s(6,"Gesti\xF3n de Albaranes"),a(),h(7,Io,7,0,"div",7),a(),h(8,Ao,3,1,"div",8),o(9,"div",9),p(10,"hr"),o(11,"span"),s(12,"Albaranes Cerrados"),a()(),o(13,"div",10)(14,"div",11),h(15,Fo,6,0,"div",12)(16,Ro,16,1,"div",13),a()()(),o(17,"div",4)(18,"div",14)(19,"h2"),s(20,"Galer\xEDa de im\xE1genes"),a(),o(21,"div",15)(22,"button",16),_("click",function(){return P(c),O(t.seleccionarImagenes())}),p(23,"ion-icon",17),o(24,"span",18),s(25),a(),o(26,"span",19),s(27),a()(),o(28,"input",20,0),_("change",function(f){return P(c),O(t.onFileSelected(f))}),a()()(),o(30,"div",21),h(31,$o,4,0,"div",22)(32,Ho,4,0,"div",23)(33,Bo,10,7,"div",24),a()()}e&2&&(g("ngIf",t.loading),l(),g("ngIf",t.error&&!t.loading),l(),g("ngIf",t.aviso&&!t.loading),l(5),g("ngIf",(t.aviso==null?null:t.aviso.estado)!=="Completado"),l(),g("ngIf",t.aviso==null?null:t.aviso.id),l(7),g("ngIf",!(t.aviso!=null&&t.aviso.albaranes)||(t.aviso==null||t.aviso.albaranes==null?null:t.aviso.albaranes.length)===0),l(),g("ngIf",(t.aviso==null?null:t.aviso.albaranes)&&(t.aviso==null?null:t.aviso.albaranes.length)>0),l(6),g("disabled",t.subiendoImagenes),l(3),M(t.subiendoImagenes?"Subiendo...":"A\xF1adir im\xE1genes"),l(2),M(t.subiendoImagenes?"Subiendo...":"A\xF1adir"),l(4),g("ngIf",t.subiendoImagenes),l(),g("ngIf",!(t.aviso!=null&&t.aviso.fotos)||(t.aviso==null||t.aviso.fotos==null?null:t.aviso.fotos.length)===0),l(),g("ngForOf",t.aviso==null?null:t.aviso.fotos))},dependencies:[L,an,Q,B,_e,me,ue,U,ie],styles:['[_nghost-%COMP%]{display:block;padding:24px}.back-button[_ngcontent-%COMP%]{margin-bottom:0}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 16px;background-color:#fff;color:#4f46e5;border:1px solid #E5E7EB;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s ease}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]:hover{background-color:#f9fafb;border-color:#4f46e5}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px;text-align:center}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#4f46e5}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#6b7280;margin:0}.loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#ef4444}.loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 20px;background-color:#4f46e5;color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:background-color .2s ease}.loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]:hover, .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]:hover{background-color:#3a30e2}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.aviso-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.aviso-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#111827}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.btn-primary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:10px 15px;background-color:#4f46e5;color:#fff;border:none;border-radius:.5rem;cursor:pointer;font-size:15px;font-weight:500}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#3a30e2}.btn-secondary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:10px 15px;background-color:#fff;color:#26262a;border:none;border-radius:.5rem;cursor:pointer;font-size:15px;font-weight:500;border:1px solid rgba(125,131,152,.2431372549)}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.btn-danger[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:10px 15px;background-color:#ef4444;color:#fff;border:none;border-radius:.5rem;cursor:pointer;font-size:15px;font-weight:500}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#dc2626}.btn-danger.btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.info-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;box-shadow:0 2px 8px #e0e7ef33;margin-bottom:24px;overflow:hidden}.info-card[_ngcontent-%COMP%]   h2.title[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#111827;margin:0;padding:25px}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#111827;margin:0}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:25px 25px 0}.info-card[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.info-card[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-card[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#111827;font-size:16px}.badge-pendiente[_ngcontent-%COMP%]{background-color:#f59e0b1a;color:#f59e0b;padding:4px 12px;border-radius:16px;font-size:14px;font-weight:500}.badge-estado-aviso[_ngcontent-%COMP%]{padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.badge-estado-aviso.badge-en-curso[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.badge-estado-aviso.badge-pendiente[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.badge-estado-aviso.badge-completado[_ngcontent-%COMP%]{background:#10b981;color:#fff}.badge-estado-aviso.badge-pendiente-de-presupuesto[_ngcontent-%COMP%]{background:#fcd34d;color:#92400e}.badge-estado-aviso.badge-listo-para-facturar[_ngcontent-%COMP%]{background:#d1fae5;color:#059669}.info-grid[_ngcontent-%COMP%]{padding:25px;padding-top:0!important;display:grid;gap:24px}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#111827;font-size:16px}.info-grid[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;padding:0!important}.info-grid[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-grid[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#111827;font-size:16px}.info-grid[_ngcontent-%COMP%]   .direccion-section[_ngcontent-%COMP%]   .btn-map[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:none;border:none;padding:8px;cursor:pointer;color:#fff;background-color:#4f46e5;font-size:16px;border-radius:50%}.info-grid[_ngcontent-%COMP%]   .contacto-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:24px}.cliente-info[_ngcontent-%COMP%], .direccion-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.cliente-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%], .direccion-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%]{color:#4f46e5;text-decoration:none;font-size:14px;cursor:pointer}.cliente-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%]:hover, .direccion-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%]:hover{text-decoration:underline}.contacto-items[_ngcontent-%COMP%]{display:flex;gap:24px;margin-top:8px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background-color:#eef2ff;color:#4f46e5;padding:6px 15px;border-radius:10px;font-size:14px;font-weight:500}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]   .contacto-link[_ngcontent-%COMP%]{color:inherit;text-decoration:none;cursor:pointer;transition:color .2s ease}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]   .contacto-link[_ngcontent-%COMP%]:hover{color:#291fd9;text-decoration:underline}.info-item[_ngcontent-%COMP%]   .estado-aviso[_ngcontent-%COMP%]{font-weight:500}.info-item[_ngcontent-%COMP%]   .estado-aviso.estado-pendiente[_ngcontent-%COMP%]{color:#f59e0b!important}.info-item[_ngcontent-%COMP%]   .estado-aviso.estado-en-curso[_ngcontent-%COMP%]{color:#3b82f6!important}.info-item[_ngcontent-%COMP%]   .estado-aviso.estado-completado[_ngcontent-%COMP%]{color:#10b981!important}.info-item[_ngcontent-%COMP%]   .estado-aviso.estado-cancelado[_ngcontent-%COMP%]{color:#ef4444!important}.info-item[_ngcontent-%COMP%]   .estado-aviso.estado-pendiente-de-presupuesto[_ngcontent-%COMP%]{color:#f59e0b!important}.info-item[_ngcontent-%COMP%]   .estado-aviso.estado-listo-para-facturar[_ngcontent-%COMP%]{color:#059669!important}.info-item[_ngcontent-%COMP%]   .estado-aviso[_ngcontent-%COMP%]:not([class*=estado-]){color:#6b7280!important}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .estado-aviso.estado-pendiente[_ngcontent-%COMP%]{color:#f59e0b!important}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .estado-aviso.estado-en-curso[_ngcontent-%COMP%]{color:#3b82f6!important}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .estado-aviso.estado-completado[_ngcontent-%COMP%]{color:#10b981!important}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .estado-aviso.estado-cancelado[_ngcontent-%COMP%]{color:#ef4444!important}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .estado-aviso.estado-pendiente-de-presupuesto[_ngcontent-%COMP%]{color:#f59e0b!important}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .estado-aviso.estado-listo-para-facturar[_ngcontent-%COMP%]{color:#059669!important}.descripcion-content[_ngcontent-%COMP%]{padding:24px}.descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;line-height:1.5}.gallery-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{background:#f3f4f6;border-radius:30px;width:auto;height:auto;padding:2px 4px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]::part(indicator){background:none}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--background: transparent;--background-checked: white;--background-hover: rgba(255,255,255,.1);--background-focused: rgba(255,255,255,.2);--border-radius: 50%;--border-width: 0;--indicator-color: transparent;--color: #6B7280;--color-checked: #4F46E5;--margin-top: 0;--margin-bottom: 0;--margin-start: 0;--margin-end: 0;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0;min-height:30px;min-width:30px;transition:all .2s ease;position:relative}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]::part(native){margin:0;padding:0 6px;height:100%}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]::part(indicator){display:none}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button.segment-button-checked[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a}.gallery-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{margin-left:auto}.gallery-items[_ngcontent-%COMP%]{padding:24px;display:grid;gap:16px}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;color:#4f46e5}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px;margin-bottom:12px}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:500}.gallery-items[_ngcontent-%COMP%]   .no-images[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.gallery-items[_ngcontent-%COMP%]   .no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px;border:1px solid #E5E7EB;border-radius:6px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:48px;height:48px;object-fit:cover;border-radius:4px;margin-right:16px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img.clickable-image[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease;position:relative}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img.clickable-image[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 4px 12px #00000026}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img.clickable-image[_ngcontent-%COMP%]:active{transform:scale(.95)}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img.clickable-image[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:#0000001a;border-radius:4px;opacity:0;transition:opacity .2s ease;pointer-events:none}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img.clickable-image[_ngcontent-%COMP%]:hover:after{opacity:1}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]{flex:1}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#26262a}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span.file-info[_ngcontent-%COMP%]{color:#6b7280;font-size:14px;margin-top:4px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#ef4444;border-radius:4px;transition:all .2s ease}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]:hover{background-color:#ef44441a;color:#eb1515}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.table-container[_ngcontent-%COMP%]{padding:0 24px 24px}.table-search[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:center}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:8px;padding:7px 14px;font-size:1rem;border:none;background:#f9fbff;color:#26262a}.table-search[_ngcontent-%COMP%]   .order-by[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#26262a;font-size:14px}.table-search[_ngcontent-%COMP%]   .order-by[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#4f46e5;font-weight:500}.table-search[_ngcontent-%COMP%]   .order-by[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#4f46e5;font-size:16px}.custom-mat-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0 8px;margin-bottom:12px}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#64748b;font-size:14px;font-weight:400;text-align:left;padding:8px 16px;background:transparent}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#f9fafb}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;color:#26262a;font-size:14px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{border-top-left-radius:8px;border-bottom-left-radius:8px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-top-right-radius:8px;border-bottom-right-radius:8px}.descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px;font-size:14px;line-height:1.4}.descripcion-trabajo[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#6b7280;font-size:12px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:13px;color:#4b5563;padding:2px 6px;background-color:#f3f4f6;border-radius:4px;display:inline-block;margin-right:4px;margin-bottom:4px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.badge-estado[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.badge-estado.badge-pendiente[_ngcontent-%COMP%]{background-color:var(--estado-pendiente-bg);color:var(--estado-pendiente-color)}.badge-estado.badge-en-curso[_ngcontent-%COMP%]{background-color:var(--estado-en-curso-bg);color:var(--estado-en-curso-color)}.badge-estado.badge-completado[_ngcontent-%COMP%]{background-color:var(--estado-completado-bg);color:var(--estado-completado-color)}.badge-estado.badge-cancelado[_ngcontent-%COMP%]{background-color:var(--estado-cancelado-bg);color:var(--estado-cancelado-color)}.repuestos-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:14px;color:#4b5563;margin-bottom:4px}.repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.estado-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.estado-actions[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:11px;font-weight:500;text-transform:uppercase;letter-spacing:.5px;margin-left:auto}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-pendiente[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-en-curso[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-abierto[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1e40af}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-cerrado[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-finalizado[_ngcontent-%COMP%]{background-color:#ecfdf5;color:#14532d}.albaran-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px;margin:8px 0}.albaran-info[_ngcontent-%COMP%]   .badge-albaran[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:6px 10px;border-radius:16px;font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;white-space:nowrap;background:#10b981;color:#fff}.albaran-info[_ngcontent-%COMP%]   .badge-albaran[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.albaran-info[_ngcontent-%COMP%]   .badge-albaran.badge-finalizado[_ngcontent-%COMP%]{background:#10b981;color:#fff}.albaran-info[_ngcontent-%COMP%]   .badge-albaran.badge-presupuesto-pendiente[_ngcontent-%COMP%]{background:#f59e0b;color:#fff}.albaran-info[_ngcontent-%COMP%]   .badge-albaran.badge-otra-visita[_ngcontent-%COMP%]{background:#ef4444;color:#fff}.albaran-info[_ngcontent-%COMP%]   .albaran-details[_ngcontent-%COMP%]{font-size:10px;color:#6b7280;text-transform:capitalize}.no-trabajos[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#6b7280}.no-trabajos[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.no-repuestos[_ngcontent-%COMP%]{color:#6b7280;font-style:italic;font-size:14px}.flujo-container[_ngcontent-%COMP%]{padding:0 25px}.info-section[_ngcontent-%COMP%]{padding:0 25px 25px}.info-section[_ngcontent-%COMP%]   .flow-description[_ngcontent-%COMP%]{background:#f0f9ff;border:1px solid #BAE6FD;border-radius:8px;padding:16px;margin:0;color:#0c4a6e;font-size:14px;display:flex;align-items:flex-start;gap:8px;line-height:1.5}.info-section[_ngcontent-%COMP%]   .flow-description[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;color:#0ea5e9;margin-top:1px;flex-shrink:0}.info-section[_ngcontent-%COMP%]   .flow-description[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#0c4a6e}.flujo-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;font-weight:400;margin-left:12px}.card-header[_ngcontent-%COMP%]   .flujo-subtitle[_ngcontent-%COMP%]{display:block;margin-top:4px;margin-left:0}.flujo-section[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0}.flujo-section[_ngcontent-%COMP%]   .flujo-header[_ngcontent-%COMP%]{margin-bottom:16px}.flujo-section[_ngcontent-%COMP%]   .flujo-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#1a202c;margin:0 0 4px}.flujo-section[_ngcontent-%COMP%]   .flujo-header[_ngcontent-%COMP%]   .flujo-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:400}.section-divider[_ngcontent-%COMP%]{display:flex;align-items:center;margin:24px 0 20px}.section-divider[_ngcontent-%COMP%]:before, .section-divider[_ngcontent-%COMP%]:after{content:"";flex:1;height:1px;background:#e2e8f0}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0 16px;font-size:14px;font-weight:500;color:#64748b;background:#fff}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#64748b}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#cbd5e0;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:500;margin:0 0 8px;color:#4a5568}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:14px;color:#a0aec0}.desktop-only[_ngcontent-%COMP%]{display:inline}.mobile-only[_ngcontent-%COMP%]{display:none}.urgent-badge[_ngcontent-%COMP%]{padding:2px 8px;border-radius:12px;font-size:12px;font-weight:500}.urgent-badge.urgent[_ngcontent-%COMP%]{background-color:#fef2f2;color:#dc2626}.urgent-badge[_ngcontent-%COMP%]:not(.urgent){background-color:#f3f4f6;color:#6b7280}.cliente-nombre[_ngcontent-%COMP%]{font-weight:500;color:#111827}.direccion-texto[_ngcontent-%COMP%]{word-break:break-word;line-height:1.4}.tipo-aviso[_ngcontent-%COMP%]{font-weight:500;color:#4f46e5}.descripcion-texto[_ngcontent-%COMP%]{line-height:1.6;color:#111827;font-weight:500}.image-title[_ngcontent-%COMP%]{font-weight:500;color:#111827}.ver-cliente[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;color:#4f46e5;text-decoration:none;font-size:14px;cursor:pointer;transition:color .2s ease}.ver-cliente[_ngcontent-%COMP%]:hover{color:#291fd9}.ver-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.no-images[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.no-images[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#cbd5e0;margin-bottom:16px}.no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}@media (max-width: 768px){[_nghost-%COMP%]{padding:16px}.desktop-only[_ngcontent-%COMP%]{display:none}.mobile-only[_ngcontent-%COMP%]{display:inline}.info-card[_ngcontent-%COMP%]{margin-bottom:16px;border-radius:12px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:20px;flex-direction:row;align-items:center;justify-content:start;gap:25px!important}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .mobile-only.title[_ngcontent-%COMP%]{display:block;font-size:18px;font-weight:500;color:#111827;margin:0}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{width:auto;justify-content:space-between;gap:12px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:none;width:100%;flex-direction:column;gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions-jobs[_ngcontent-%COMP%]{display:flex;width:100%;flex-direction:column;gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions-jobs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .aviso-completado-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#10b981;font-size:14px;font-weight:500}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .aviso-completado-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.info-card[_ngcontent-%COMP%]   h2.title[_ngcontent-%COMP%]{font-size:16px;padding:20px}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px}.info-grid[_ngcontent-%COMP%]{padding:15px;gap:16px}.info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]{gap:20px}.info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{width:auto}.info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:max-content}.info-grid[_ngcontent-%COMP%]   .cliente-info[_ngcontent-%COMP%], .info-grid[_ngcontent-%COMP%]   .direccion-info[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between;gap:8px}.info-grid[_ngcontent-%COMP%]   .contacto-items[_ngcontent-%COMP%]{flex-direction:row;gap:8px}.info-grid[_ngcontent-%COMP%]   .contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{width:100%;justify-content:flex-start}.info-grid[_ngcontent-%COMP%]   .contacto-items[_ngcontent-%COMP%]   .contacto-item.nombre-contacto[_ngcontent-%COMP%]{display:none}.descripcion-content[_ngcontent-%COMP%]{padding:20px;gap:16px}.gallery-actions[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:stretch}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{align-self:center}.gallery-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{margin-left:0;width:100%;justify-content:center}.gallery-items[_ngcontent-%COMP%]{padding:20px;gap:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:200px;object-fit:cover;border-radius:8px;margin-right:0}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]{width:100%}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{align-self:flex-end}.table-container[_ngcontent-%COMP%]{padding:0 20px 20px}.custom-mat-table[_ngcontent-%COMP%]{font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:11px;padding:8px 12px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 12px;font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:10px}.estado-actions[_ngcontent-%COMP%]{flex-direction:column;gap:6px}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{width:100%;justify-content:center;padding:8px 12px;font-size:12px}.flujo-container[_ngcontent-%COMP%]{padding:0 20px 20px}.flujo-section[_ngcontent-%COMP%]{margin-bottom:0}.section-divider[_ngcontent-%COMP%]{margin:20px 0 16px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;padding:0 12px}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}.badge-pendiente[_ngcontent-%COMP%]{font-size:12px;padding:3px 8px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:11px;padding:2px 4px}.no-repuestos[_ngcontent-%COMP%]{font-size:12px}.empty-state[_ngcontent-%COMP%]{padding:30px 16px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px}.urgent-badge[_ngcontent-%COMP%]{font-size:11px;padding:2px 6px}.ver-cliente[_ngcontent-%COMP%]{font-size:12px}.ver-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.no-images[_ngcontent-%COMP%]{padding:30px 16px}.no-images[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px}.no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 480px){[_nghost-%COMP%]{padding:0}.info-card[_ngcontent-%COMP%]{margin-bottom:12px;border-radius:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:16px;gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{gap:6px}.info-card[_ngcontent-%COMP%]   h2.title[_ngcontent-%COMP%]{font-size:15px;padding:16px;display:none}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:15px!important}.descripcion-content[_ngcontent-%COMP%]{padding:16px;gap:12px}.descripcion-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px}.descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.gallery-actions[_ngcontent-%COMP%]{gap:8px}.gallery-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}.gallery-items[_ngcontent-%COMP%]{padding:16px;gap:8px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{gap:8px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:150px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span.file-info[_ngcontent-%COMP%]{font-size:11px}.table-container[_ngcontent-%COMP%]{padding:0 16px 16px}.custom-mat-table[_ngcontent-%COMP%]{font-size:11px}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:10px;padding:6px 8px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;font-size:11px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:9px}.estado-actions[_ngcontent-%COMP%]{gap:4px}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{padding:6px 8px;font-size:11px}.flujo-container[_ngcontent-%COMP%]{padding:0 16px 16px}.section-divider[_ngcontent-%COMP%]{margin:16px 0 12px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:0 8px}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{padding:6px 10px;font-size:12px}.badge-pendiente[_ngcontent-%COMP%]{font-size:11px;padding:2px 6px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:10px;padding:1px 3px}.no-repuestos[_ngcontent-%COMP%]{font-size:11px}.empty-state[_ngcontent-%COMP%]{padding:24px 12px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:11px}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}ion-icon[_ngcontent-%COMP%]{font-size:16px}.urgent-badge[_ngcontent-%COMP%]{font-size:10px;padding:1px 4px}.ver-cliente[_ngcontent-%COMP%]{font-size:11px}.ver-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:11px}.no-images[_ngcontent-%COMP%]{padding:24px 12px}.no-images[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}}.no-albaranes[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.no-albaranes[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#d1d5db;margin-bottom:16px}.no-albaranes[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;font-size:16px}.no-albaranes[_ngcontent-%COMP%]   p.info-text[_ngcontent-%COMP%]{font-size:14px;color:#9ca3af;font-style:italic}.albaranes-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.albaran-item[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;transition:all .2s ease}.albaran-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid #E5E7EB}.albaran-header[_ngcontent-%COMP%]   .albaran-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:18px;font-weight:600;color:#1f2937}.albaran-header[_ngcontent-%COMP%]   .albaran-info[_ngcontent-%COMP%]   .fecha-albaran[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;font-weight:500}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado[_ngcontent-%COMP%]{padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado.badge-finalizado[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado.badge-presupuesto-pendiente[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado.badge-otra-visita[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.albaran-header[_ngcontent-%COMP%]   .albaran-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.albaran-header[_ngcontent-%COMP%]   .albaran-actions[_ngcontent-%COMP%]   .btn-primary.btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px;background:#4f46e5;color:#fff;border:none;border-radius:6px;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;gap:4px}.albaran-header[_ngcontent-%COMP%]   .albaran-actions[_ngcontent-%COMP%]   .btn-primary.btn-small[_ngcontent-%COMP%]:hover{background:#4338ca}.albaran-header[_ngcontent-%COMP%]   .albaran-actions[_ngcontent-%COMP%]   .btn-primary.btn-small[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.header-actions[_ngcontent-%COMP%]   .btn-secondary.btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px;background:#6b7280;color:#fff;border:none;border-radius:6px;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;gap:4px}.header-actions[_ngcontent-%COMP%]   .btn-secondary.btn-small[_ngcontent-%COMP%]:hover{background:#4b5563}.header-actions[_ngcontent-%COMP%]   .btn-secondary.btn-small[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.albaran-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.albaran-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.albaran-details[_ngcontent-%COMP%]   .detail-item.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.5px}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#1f2937;margin:0}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{line-height:1.5;background:#f9fafb;padding:8px 12px;border-radius:6px;border:1px solid #E5E7EB}.albaran-details[_ngcontent-%COMP%]   .repuestos-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.albaran-details[_ngcontent-%COMP%]   .repuestos-tags[_ngcontent-%COMP%]   .repuesto-tag[_ngcontent-%COMP%]{background:#e0f2fe;color:#0c4a6e;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;border:1px solid #BAE6FD}@media (max-width: 768px){.albaranes-container[_ngcontent-%COMP%]{gap:16px}.albaran-item[_ngcontent-%COMP%]{padding:16px}.albaran-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:flex-start}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]{align-self:flex-start}.albaran-header[_ngcontent-%COMP%]   .albaran-actions[_ngcontent-%COMP%]{align-self:flex-start;margin-top:8px}.no-albaranes[_ngcontent-%COMP%]{padding:20px 10px}.no-albaranes[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.no-albaranes[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.no-albaranes[_ngcontent-%COMP%]   p.info-text[_ngcontent-%COMP%]{font-size:12px}.albaran-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}}.section-divider[_ngcontent-%COMP%]{position:relative;margin:32px 0;text-align:center}.section-divider[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{border:none;height:1px;background:linear-gradient(to right,transparent,#E5E7EB,transparent);margin:0}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:0 16px;font-size:14px;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.5px}.albaranes-section[_ngcontent-%COMP%]{margin-top:24px}.albaranes-section[_ngcontent-%COMP%]   .albaranes-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding:16px 20px;background:#f9fafb;border-radius:8px;border:1px solid #E5E7EB}.aviso-completado-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#10b981;font-size:14px;font-weight:500;padding:8px 12px;background:#ecfdf5;border:1px solid #D1FAE5;border-radius:8px}.aviso-completado-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.factura-generada-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#3b82f6;font-size:14px;font-weight:500;padding:8px 12px;background:#eff6ff;border:1px solid #DBEAFE;border-radius:8px}.factura-generada-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.albaranes-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.albaranes-info[_ngcontent-%COMP%]   .badge-info[_ngcontent-%COMP%]{padding:6px 12px;background:#e0f2fe;color:#0c4a6e;border-radius:20px;font-size:12px;font-weight:600;border:1px solid #BAE6FD}.btn-secondary.btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px;background:#6b7280;color:#fff;border:none;border-radius:6px;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;gap:4px}.btn-secondary.btn-small[_ngcontent-%COMP%]:hover{background:#4b5563}.btn-secondary.btn-small[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.compact-albaranes-table[_ngcontent-%COMP%]{max-height:60vh;overflow-y:auto;border-radius:8px;border:1px solid #E5E7EB;background:#fff;margin-bottom:16px;width:100%;overflow-x:hidden}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]{width:100%;display:grid;grid-template-columns:1fr 1.5fr 1fr 1.5fr 1fr;font-size:12px;min-width:0;gap:0;align-items:stretch}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%], .compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]{display:contents}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]   .header-cell[_ngcontent-%COMP%]{padding:12px 8px;background:#f9fafb;border-bottom:1px solid #E5E7EB;font-weight:500;color:#374151;font-size:12px;text-transform:uppercase;letter-spacing:.5px;display:flex;align-items:center;min-width:0;justify-content:center;text-align:center}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]{display:contents}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]{display:contents;cursor:pointer;transition:all .2s ease;-webkit-tap-highlight-color:transparent;touch-action:manipulation}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]:hover   .albaran-cell[_ngcontent-%COMP%]{background-color:#f9fafb}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]:active{transform:scale(.98)}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row.finalizado[_ngcontent-%COMP%]   .albaran-cell[_ngcontent-%COMP%]:first-child{border-left:4px solid #10B981}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row.finalizado[_ngcontent-%COMP%]   .albaran-cell[_ngcontent-%COMP%]{background-color:#ecfdf5}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row.finalizado[_ngcontent-%COMP%]:hover   .albaran-cell[_ngcontent-%COMP%]{background-color:#d1fae5}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row.presupuesto-pendiente[_ngcontent-%COMP%]   .albaran-cell[_ngcontent-%COMP%]:first-child{border-left:4px solid #F59E0B}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row.presupuesto-pendiente[_ngcontent-%COMP%]   .albaran-cell[_ngcontent-%COMP%]{background-color:#fffbeb}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row.presupuesto-pendiente[_ngcontent-%COMP%]:hover   .albaran-cell[_ngcontent-%COMP%]{background-color:#fef3c7}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row.otra-visita[_ngcontent-%COMP%]   .albaran-cell[_ngcontent-%COMP%]:first-child{border-left:4px solid #3B82F6}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row.otra-visita[_ngcontent-%COMP%]   .albaran-cell[_ngcontent-%COMP%]{background-color:#eff6ff}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row.otra-visita[_ngcontent-%COMP%]:hover   .albaran-cell[_ngcontent-%COMP%]{background-color:#dbeafe}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell[_ngcontent-%COMP%]{padding:12px 8px;border-bottom:1px solid #F3F4F6;display:flex;align-items:center;min-width:0;justify-content:center;text-align:center}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.numero-albaran[_ngcontent-%COMP%]{font-weight:600;color:#111827;font-size:14px;justify-content:center;flex-shrink:0}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.estado-albaran[_ngcontent-%COMP%]{justify-content:center;flex-shrink:0}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.estado-albaran[_ngcontent-%COMP%]   .estado-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.estado-albaran[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;white-space:nowrap;max-width:120px;overflow:hidden;text-overflow:ellipsis}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.estado-albaran[_ngcontent-%COMP%]   .badge.green[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.estado-albaran[_ngcontent-%COMP%]   .badge.yellow[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.estado-albaran[_ngcontent-%COMP%]   .badge.blue[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.estado-albaran[_ngcontent-%COMP%]   .badge.badge-presupuesto[_ngcontent-%COMP%]{background:#e0f2fe;color:#0369a1;border:1px solid #BAE6FD;padding:2px 6px;border-radius:8px;font-size:9px;display:flex;align-items:center;gap:2px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.estado-albaran[_ngcontent-%COMP%]   .badge.badge-presupuesto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:10px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.fecha-albaran[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;justify-content:center;flex-shrink:0}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.repuestos-albaran[_ngcontent-%COMP%]{justify-content:center;flex-shrink:0}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.repuestos-albaran[_ngcontent-%COMP%]   .repuestos-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.repuestos-albaran[_ngcontent-%COMP%]   .repuestos-info[_ngcontent-%COMP%]   .repuestos-count[_ngcontent-%COMP%]{font-size:11px;color:#059669;font-weight:600;padding:2px 6px;background:#d1fae5;border-radius:6px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.repuestos-albaran[_ngcontent-%COMP%]   .repuestos-info[_ngcontent-%COMP%]   .repuestos-label[_ngcontent-%COMP%]{font-size:10px;color:#6b7280;font-weight:500}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.repuestos-albaran[_ngcontent-%COMP%]   .repuestos-vacio[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af;font-style:italic}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]{justify-content:center;gap:4px;flex-shrink:0}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:28px;height:28px;border:none;border-radius:6px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;background:transparent;-webkit-tap-highlight-color:transparent;touch-action:manipulation}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;color:#6b7280}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button.btn-ver[_ngcontent-%COMP%]:hover{background-color:#10b981}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button.btn-ver[_ngcontent-%COMP%]:hover   ion-icon[_ngcontent-%COMP%]{color:#fff}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button.btn-ver[_ngcontent-%COMP%]:active{transform:scale(.9);background-color:#059669}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button.btn-eliminar[_ngcontent-%COMP%]:hover{background-color:#ef4444}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button.btn-eliminar[_ngcontent-%COMP%]:hover   ion-icon[_ngcontent-%COMP%]{color:#fff}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button.btn-eliminar[_ngcontent-%COMP%]:active{transform:scale(.9);background-color:#dc2626}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   .mobile-info[_ngcontent-%COMP%]{display:none}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   .mobile-info[_ngcontent-%COMP%]   .presupuesto-mobile[_ngcontent-%COMP%]{font-size:11px;color:#059669;font-weight:600;padding:2px 6px;background:#d1fae5;border-radius:6px}@media (min-width: 769px){.compact-albaranes-table[_ngcontent-%COMP%]{width:100%;overflow-x:hidden;border-radius:0;border-left:none;border-right:none}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]{grid-template-columns:1fr 1.5fr 1fr 1.5fr 1fr;font-size:13px;min-width:0}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]   .header-cell[_ngcontent-%COMP%]{font-size:12px;padding:12px 8px;min-width:0}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell[_ngcontent-%COMP%]{padding:12px 8px;min-width:0}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.numero-albaran[_ngcontent-%COMP%]{font-size:14px;flex-shrink:0}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.estado-albaran[_ngcontent-%COMP%], .compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.fecha-albaran[_ngcontent-%COMP%], .compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.repuestos-albaran[_ngcontent-%COMP%], .compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]{flex-shrink:0}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:28px;height:28px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}}@media (max-width: 768px){.compact-albaranes-table[_ngcontent-%COMP%]{border-radius:0;border-left:none;border-right:none;max-height:none}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]{grid-template-columns:.8fr 1.2fr 1fr 1.2fr .8fr}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]   .header-cell[_ngcontent-%COMP%]{font-size:10px;padding:8px 4px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell[_ngcontent-%COMP%]{padding:8px 4px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.numero-albaran[_ngcontent-%COMP%]{font-size:12px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.fecha-albaran[_ngcontent-%COMP%]{font-size:11px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:24px;height:24px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   .mobile-info[_ngcontent-%COMP%]{display:block;margin-left:4px}}@media (max-width: 480px){.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]{grid-template-columns:.6fr 1fr 1fr 1fr .8fr}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]   .header-cell[_ngcontent-%COMP%]{font-size:9px;padding:6px 2px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell[_ngcontent-%COMP%]{padding:6px 2px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.numero-albaran[_ngcontent-%COMP%]{font-size:11px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.estado-albaran[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:8px;padding:2px 4px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.fecha-albaran[_ngcontent-%COMP%]{font-size:10px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.repuestos-albaran[_ngcontent-%COMP%]{font-size:9px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.repuestos-albaran[_ngcontent-%COMP%]   .repuestos-info[_ngcontent-%COMP%]   .repuestos-count[_ngcontent-%COMP%]{font-size:8px;padding:1px 3px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.repuestos-albaran[_ngcontent-%COMP%]   .repuestos-info[_ngcontent-%COMP%]   .repuestos-label[_ngcontent-%COMP%], .compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.repuestos-albaran[_ngcontent-%COMP%]   .repuestos-vacio[_ngcontent-%COMP%]{font-size:8px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;align-items:center}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:22px;height:22px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.compact-albaranes-table[_ngcontent-%COMP%]   .albaranes-table[_ngcontent-%COMP%]   .table-body[_ngcontent-%COMP%]   .albaran-row[_ngcontent-%COMP%]   .albaran-cell.acciones[_ngcontent-%COMP%]   .mobile-info[_ngcontent-%COMP%]   .presupuesto-mobile[_ngcontent-%COMP%]{font-size:9px;padding:1px 4px}}@media (max-width: 768px){.section-divider[_ngcontent-%COMP%]{margin:24px 0}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:0 12px}.albaranes-section[_ngcontent-%COMP%]{margin-top:20px}.albaranes-section[_ngcontent-%COMP%]   .albaranes-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:stretch;padding:12px 16px}.albaranes-section[_ngcontent-%COMP%]   .albaranes-header[_ngcontent-%COMP%]   .albaranes-info[_ngcontent-%COMP%]{justify-content:center}.albaranes-section[_ngcontent-%COMP%]   .albaranes-header[_ngcontent-%COMP%]   .btn-secondary.btn-small[_ngcontent-%COMP%]{align-self:center;width:fit-content}}']});let r=d;return r})();export{Va as VerAvisosComponent};
