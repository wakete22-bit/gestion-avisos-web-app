import{a as X,b as Se}from"./chunk-KL254YJT.js";import"./chunk-PP5OIZL5.js";import"./chunk-NVYZAR2B.js";import{a as $t}from"./chunk-C3PYHPFP.js";import"./chunk-D3ML5XID.js";import{a as ze}from"./chunk-4OHMYGXZ.js";import"./chunk-Z5X5YNR5.js";import{a as ke}from"./chunk-LZ7UC2UF.js";import{A as vt,Aa as Rt,B as ht,Ba as J,D as yt,Da as K,E as wt,F as he,Fa as je,G as Et,J as N,O as jt,P as kt,R as ye,U as zt,X as St,Y as It,Z as At,a as z,b as ut,ba as Te,c as ft,ca as Ft,d as Ct,da as Ve,e as bt,fa as Re,g as xt,i as Ae,j as Ot,ja as ie,k as Pt,la as De,n as Me,na as Q,o as Fe,sa as Tt,t as W,ta as Y,u as Mt,ua as Vt,va as we,wa as Ee,x as ve,z as oe}from"./chunk-NN53FH56.js";import{a as Dt}from"./chunk-PY25U45N.js";import{e as gt,h as mt,j as _t}from"./chunk-RYV6EKVZ.js";import"./chunk-F6DTYNTW.js";import{c as nt,d as ot,e as it,f as at,g as rt,j as ct,k as st,l as Pe,q as G,r as lt,s as dt}from"./chunk-5Q3G5WFB.js";import{b as pt}from"./chunk-QYHMYRPA.js";import{$a as $,$b as me,Aa as v,Ba as V,C as He,Da as ee,Ea as te,F as qe,Fa as ne,Ha as Ue,J as f,K as C,Na as h,O as Be,Oa as L,Pa as k,Q as Le,T as se,Ua as Ge,V as s,Va as R,W as M,Wa as D,Xb as Ke,Y as T,Ya as We,Za as Qe,Zb as y,_a as U,_b as ge,aa as b,b as B,dc as _e,e as I,ec as ue,fa as d,ga as H,h as j,ha as Z,hb as Ye,hc as fe,ia as e,ic as Ce,j as A,ja as o,jc as Xe,ka as g,kb as Je,kc as Ze,lc as et,oa as P,pa as u,pc as tt,q as F,qa as m,qc as be,rc as xe,sc as Oe,ua as le,va as de,wa as pe,x as E,ya as c,za as _}from"./chunk-JSLDYZN7.js";import"./chunk-WSRQKSRN.js";import"./chunk-QUJFQN2Y.js";import"./chunk-K4IZC2RK.js";import"./chunk-XEKAQYZJ.js";import"./chunk-3PHZVRGI.js";import"./chunk-67GB35HJ.js";import"./chunk-ULLEADC5.js";import"./chunk-2ELISCRH.js";import"./chunk-MSFXF37Z.js";import"./chunk-55RMRGVQ.js";import"./chunk-G2E2NLL6.js";import"./chunk-CFQAPMCR.js";import"./chunk-CW65YK7W.js";import"./chunk-LBMIQEU6.js";import"./chunk-WI5MSH4N.js";import"./chunk-VAE5WQLH.js";import"./chunk-CKP3SGE2.js";import"./chunk-I2N4S4X5.js";import"./chunk-GS3KTSYS.js";import"./chunk-LBJ2JVNN.js";import"./chunk-5ZZWK7YK.js";import"./chunk-QXK7JUJJ.js";import"./chunk-JCSW2JUV.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-36KMLI7A.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as re,b as ce,k as w}from"./chunk-CRC5ZNR6.js";var Wt=()=>({standalone:!0});function Qt(r,l){r&1&&(e(0,"div",15)(1,"div",16),g(2,"ion-icon",17),e(3,"p"),c(4,"Cargando datos del trabajo..."),o()()())}function Yt(r,l){r&1&&(e(0,"div",46),g(1,"ion-icon",47),e(2,"p"),c(3,"Al editar el trabajo, los materiales se ajustar\xE1n autom\xE1ticamente en el inventario."),o()())}function Jt(r,l){r&1&&(e(0,"div",48),g(1,"ion-icon",17),e(2,"span"),c(3,"Cargando productos..."),o()())}function Kt(r,l){if(r&1&&(e(0,"div",49),c(1),o()),r&2){let a=m(2);s(),v(" ",a.errorProductos," ")}}function Xt(r,l){if(r&1&&(e(0,"span",63),c(1),o()),r&2){let a=m().$implicit;s(),_(a.descripcion)}}function Zt(r,l){if(r&1){let a=P();e(0,"div",53),u("click",function(){let n=f(a).$implicit,i=m(3);return C(i.agregarMaterial(n))}),e(1,"div",54)(2,"div",55)(3,"span",56),c(4),o(),e(5,"span",57),c(6),o()(),e(7,"span",58),c(8),o(),b(9,Xt,2,1,"span",59),e(10,"span",60),c(11),h(12,"currency"),o()(),e(13,"button",61),g(14,"ion-icon",62),o()()}if(r&2){let a=l.$implicit;H("sin-stock",a.cantidad_disponible<=0)("stock-bajo",a.cantidad_disponible>0&&a.cantidad_disponible<=5),s(4),_(a.codigo),s(),H("stock-bajo",a.cantidad_disponible>0&&a.cantidad_disponible<=5)("sin-stock",a.cantidad_disponible<=0),s(),V(" Stock: ",a.cantidad_disponible," ",a.unidad," "),s(2),_(a.nombre),s(),d("ngIf",a.descripcion),s(2),_(k(12,15,a.precio_neto,"EUR","symbol","1.2-2")),s(2),d("disabled",a.cantidad_disponible<=0)}}function en(r,l){if(r&1&&(e(0,"div",50)(1,"h4"),c(2,"Productos disponibles"),o(),e(3,"div",51),b(4,Zt,15,20,"div",52),o()()),r&2){let a=m(2);s(4),d("ngForOf",a.productosFiltrados)}}function tn(r,l){if(r&1){let a=P();e(0,"div",67)(1,"div",68)(2,"div",69)(3,"span",70),c(4),o(),e(5,"span",71),c(6),h(7,"currency"),o()(),e(8,"span",72),c(9),o(),e(10,"div",73)(11,"label"),c(12,"Cantidad:"),o(),e(13,"input",74),u("change",function(n){let i=f(a).index,p=m(3);return C(p.actualizarCantidadMaterial(i,n.target.value))}),o(),e(14,"span",75),c(15),o()()(),e(16,"button",76),u("click",function(){let n=f(a).index,i=m(3);return C(i.eliminarMaterial(n))}),g(17,"ion-icon",77),o()()}if(r&2){let a=l.$implicit;s(4),_(a.producto.codigo),s(2),_(k(7,7,a.producto.precio_neto,"EUR","symbol","1.2-2")),s(3),_(a.producto.nombre),s(4),d("value",a.cantidad)("min",1)("max",a.producto.cantidad_disponible),s(2),_(a.producto.unidad)}}function nn(r,l){if(r&1&&(e(0,"div",64)(1,"h4"),c(2,"Materiales a\xF1adidos"),o(),b(3,tn,18,12,"div",65),e(4,"div",66)(5,"strong"),c(6),h(7,"currency"),o()()()),r&2){let a=m(2);s(3),d("ngForOf",a.materiales),s(3),v("Costo total de materiales: ",k(7,2,a.calcularCostoTotal(),"EUR","symbol","1.2-2"),"")}}function on(r,l){r&1&&(e(0,"div",78),g(1,"ion-icon",47),e(2,"p"),c(3,"No se han a\xF1adido materiales"),o(),e(4,"span"),c(5,"Selecciona productos del inventario para a\xF1adirlos como materiales"),o()())}function an(r,l){if(r&1){let a=P();e(0,"div",18)(1,"div",19)(2,"div",20)(3,"label"),c(4,"Fecha del trabajo "),e(5,"span",21),c(6,"*"),o()(),g(7,"input",22),o(),e(8,"div",23)(9,"div",24)(10,"label"),c(11,"Hora de inicio "),e(12,"span",21),c(13,"*"),o()(),g(14,"input",25),o(),e(15,"div",24)(16,"label"),c(17,"Hora de fin "),e(18,"span",21),c(19,"*"),o()(),g(20,"input",26),o()(),e(21,"div",20)(22,"label"),c(23,"Descripci\xF3n del trabajo "),e(24,"span",21),c(25,"*"),o()(),e(26,"textarea",27),c(27,"            "),o(),e(28,"div",28),c(29),o()(),e(30,"div",20)(31,"label"),c(32,"Estado del trabajo"),o(),e(33,"select",29)(34,"option",30),c(35,"Pendiente"),o(),e(36,"option",31),c(37,"En curso"),o(),e(38,"option",32),c(39,"Completado"),o(),e(40,"option",33),c(41,"Cancelado"),o()()()(),e(42,"div",34)(43,"div",35)(44,"h3"),c(45,"Materiales utilizados"),o(),b(46,Yt,4,0,"div",36),e(47,"div",37)(48,"div",38),g(49,"ion-icon",39),e(50,"input",40),ne("ngModelChange",function(n){f(a);let i=m();return te(i.busquedaProducto,n)||(i.busquedaProducto=n),C(n)}),u("input",function(n){f(a);let i=m();return C(i.filtrarProductos(n))}),o()()(),b(51,Jt,4,0,"div",41)(52,Kt,2,1,"div",42)(53,en,5,1,"div",43)(54,nn,8,7,"div",44)(55,on,6,0,"div",45),o()()()}if(r&2){let a,t=m();s(29),v("",((a=t.trabajoForm.get("descripcion"))==null||a.value==null?null:a.value.length)||0,"/500"),s(17),d("ngIf",t.modoEdicion),s(4),ee("ngModel",t.busquedaProducto),d("ngModelOptions",Ue(9,Wt)),s(),d("ngIf",t.loadingProductos),s(),d("ngIf",t.errorProductos),s(),d("ngIf",!t.loadingProductos&&!t.errorProductos),s(),d("ngIf",t.materiales.length>0),s(),d("ngIf",t.materiales.length===0&&!t.loadingProductos&&!t.errorProductos)}}var Ht=(()=>{let l=class l{constructor(t,n,i,p,x,O){this.fb=t,this.modalController=n,this.viewportService=i,this.elementRef=p,this.inventarioService=x,this.trabajosService=O,this.avisoId="",this.materiales=[],this.productosInventario=[],this.productosFiltrados=[],this.loadingProductos=!1,this.errorProductos=null,this.busquedaProducto="",this.modoEdicion=!1,this.destroy$=new B,this.trabajoForm=this.fb.group({fecha_trabajo:[new Date().toISOString().split("T")[0],y.required],hora_inicio:["",y.required],hora_fin:["",y.required],descripcion:["",[y.required,y.maxLength(500)]],estado:["Pendiente",y.required]})}ngOnInit(){z({arrowForward:Ot,personOutline:Q,mailOutline:Ft,chevronDownOutline:ve,copyOutline:wt,shieldOutline:Rt,informationCircleOutline:It,cloudUploadOutline:ht,closeOutline:vt,save:Vt,saveOutline:we,trashOutline:K,timeOutline:J,calendarOutline:Me,documentTextOutline:N,addOutline:bt,searchOutline:Ee}),this.modoEdicion=!!this.trabajoExistente,this.modoEdicion&&this.trabajoExistente&&this.cargarDatosTrabajoExistente(),this.cargarProductosInventario()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngAfterViewInit(){setTimeout(()=>{let t=this.elementRef.nativeElement.querySelector(".modal-container");t&&this.viewportService.applySafeAreaToModal(t)},100)}cargarDatosTrabajoExistente(){return w(this,null,function*(){var t;if((t=this.trabajoExistente)!=null&&t.id)try{let n=yield j(this.trabajosService.getTrabajo(this.trabajoExistente.id));if(this.trabajoForm.patchValue({fecha_trabajo:this.trabajoExistente.fecha_trabajo,hora_inicio:this.trabajoExistente.hora_inicio,hora_fin:this.trabajoExistente.hora_fin,descripcion:this.trabajoExistente.descripcion,estado:this.trabajoExistente.estado}),n.materiales&&n.materiales.length>0){let i=yield Promise.all(n.materiales.map(p=>w(this,null,function*(){return{producto:yield j(this.inventarioService.getProducto(p.material_id)),cantidad:p.cantidad_utilizada}})));this.materiales=i}}catch(n){console.error("Error al cargar datos del trabajo existente:",n),alert("Error al cargar los datos del trabajo para editar.")}})}cargarProductosInventario(){this.loadingProductos=!0,this.errorProductos=null,this.inventarioService.getProductosConStock(1,100,"","nombre","asc").pipe(E(this.destroy$)).subscribe({next:t=>{this.productosInventario=t.inventario,this.productosFiltrados=t.inventario,this.loadingProductos=!1},error:t=>{console.error("Error al cargar productos:",t),this.errorProductos="Error al cargar los productos del inventario",this.loadingProductos=!1}})}filtrarProductos(t){let n=t.target.value.toLowerCase();this.busquedaProducto=n,n?this.productosFiltrados=this.productosInventario.filter(i=>i.nombre.toLowerCase().includes(n)||i.codigo.toLowerCase().includes(n)||i.descripcion&&i.descripcion.toLowerCase().includes(n)):this.productosFiltrados=this.productosInventario}agregarMaterial(t){let n=this.materiales.find(i=>i.producto.id===t.id);if(n){let i=n.cantidad+1;if(i>t.cantidad_disponible){alert(`No hay suficiente stock. Solo quedan ${t.cantidad_disponible} ${t.unidad} de ${t.nombre}`);return}n.cantidad=i}else{if(t.cantidad_disponible<=0){alert(`No hay stock disponible para ${t.nombre}`);return}this.materiales.push({producto:t,cantidad:1})}}eliminarMaterial(t){this.materiales.splice(t,1)}actualizarCantidadMaterial(t,n){let i=this.materiales[t],p=parseInt(n.toString());if(!(isNaN(p)||p<=0)){if(p>i.producto.cantidad_disponible){alert(`No hay suficiente stock. Solo quedan ${i.producto.cantidad_disponible} ${i.producto.unidad} de ${i.producto.nombre}`);return}i.cantidad=p}}calcularCostoTotal(){return this.materiales.reduce((t,n)=>t+n.cantidad*n.producto.precio_neto,0)}crearTrabajo(){return w(this,null,function*(){if(this.trabajoForm.valid){let t=this.materiales.filter(i=>i.cantidad>i.producto.cantidad_disponible);if(t.length>0){let i=t.map(p=>`${p.producto.nombre}: solicitado ${p.cantidad} ${p.producto.unidad}, disponible ${p.producto.cantidad_disponible} ${p.producto.unidad}`).join(`
`);alert(`No hay suficiente stock para los siguientes materiales:

${i}`);return}let n=ce(re({},this.trabajoForm.value),{aviso_id:this.avisoId,repuestos:this.materiales.map(i=>i.producto.nombre),materiales:this.materiales.map(i=>({material_id:i.producto.id,cantidad_utilizada:i.cantidad,precio_neto_al_momento:i.producto.precio_neto}))});yield this.modalController.dismiss(n,"confirm")}})}cerrarModal(){return w(this,null,function*(){yield this.modalController.dismiss(null,"cancel")})}};l.\u0275fac=function(n){return new(n||l)(M(be),M(mt),M(Dt),M(Le),M(ze),M(X))},l.\u0275cmp=T({type:l,selectors:[["app-crear-trabajos-realizados"]],inputs:{avisoId:"avisoId",trabajoExistente:"trabajoExistente"},decls:20,vars:7,consts:[[1,"modal-container"],[1,"modal-header"],[1,"header-content"],[1,"close-button",3,"click"],["name","close-outline"],[1,"subtitle"],[1,"modal-body",3,"ngSubmit","formGroup"],[1,"modal-content"],["class","loading-state",4,"ngIf"],["class","modal-grid",4,"ngIf"],[1,"modal-footer"],[1,"button-group"],["type","button",1,"btn","btn-outline",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["name","save-outline"],[1,"loading-state"],[1,"loading-spinner"],["name","refresh-outline",1,"spinning"],[1,"modal-grid"],[1,"form-section"],[1,"form-group"],[1,"required"],["type","date","formControlName","fecha_trabajo",1,"form-control"],[1,"form-row"],[1,"form-group","half"],["type","time","formControlName","hora_inicio",1,"form-control"],["type","time","formControlName","hora_fin",1,"form-control"],["formControlName","descripcion","placeholder","Describe detalladamente el trabajo realizado...","rows","4","maxlength","500",1,"form-control"],[1,"character-count"],["formControlName","estado",1,"form-control"],["value","Pendiente"],["value","En curso"],["value","Completado"],["value","Cancelado"],[1,"images-section"],[1,"repuestos-container"],["class","info-message",4,"ngIf"],[1,"search-container"],[1,"search-input"],["name","search-outline"],["type","text","placeholder","Buscar productos del inventario...",1,"form-control",3,"ngModelChange","input","ngModel","ngModelOptions"],["class","loading-indicator",4,"ngIf"],["class","error-message",4,"ngIf"],["class","productos-disponibles",4,"ngIf"],["class","repuestos-list",4,"ngIf"],["class","no-repuestos",4,"ngIf"],[1,"info-message"],["name","information-circle-outline"],[1,"loading-indicator"],[1,"error-message"],[1,"productos-disponibles"],[1,"productos-list"],["class","producto-item",3,"sin-stock","stock-bajo","click",4,"ngFor","ngForOf"],[1,"producto-item",3,"click"],[1,"producto-info"],[1,"producto-header"],[1,"producto-codigo"],[1,"producto-stock"],[1,"producto-nombre"],["class","producto-descripcion",4,"ngIf"],[1,"producto-precio"],["type","button",1,"add-producto-btn",3,"disabled"],["name","add-outline"],[1,"producto-descripcion"],[1,"repuestos-list"],["class","repuesto-item",4,"ngFor","ngForOf"],[1,"costo-total"],[1,"repuesto-item"],[1,"repuesto-info"],[1,"repuesto-header"],[1,"repuesto-codigo"],[1,"repuesto-precio"],[1,"repuesto-nombre"],[1,"repuesto-cantidad"],["type","number",1,"cantidad-input",3,"change","value","min","max"],[1,"unidad"],["type","button",1,"remove-repuesto",3,"click"],["name","trash-outline"],[1,"no-repuestos"]],template:function(n,i){n&1&&(e(0,"div",0)(1,"header",1)(2,"div",2)(3,"h2"),c(4),o(),e(5,"button",3),u("click",function(){return i.cerrarModal()}),g(6,"ion-icon",4),o()(),e(7,"p",5),c(8),o()(),e(9,"form",6),u("ngSubmit",function(){return i.crearTrabajo()}),e(10,"div",7),b(11,Qt,5,0,"div",8)(12,an,56,10,"div",9),o()(),e(13,"footer",10)(14,"div",11)(15,"button",12),u("click",function(){return i.cerrarModal()}),c(16," Cancelar "),o(),e(17,"button",13),u("click",function(){return i.crearTrabajo()}),c(18),g(19,"ion-icon",14),o()()()()),n&2&&(s(4),_(i.modoEdicion?"Editar parte de trabajo":"Crear parte de trabajo"),s(4),_(i.modoEdicion?"Modifica el trabajo realizado":"Registra el trabajo realizado en este aviso"),s(),d("formGroup",i.trabajoForm),s(2),d("ngIf",i.modoEdicion&&!i.trabajoExistente),s(),d("ngIf",!i.modoEdicion||i.trabajoExistente),s(5),d("disabled",!i.trabajoForm.valid),s(),v(" ",i.modoEdicion?"Actualizar trabajo":"Crear trabajo"," "))},dependencies:[_t,gt,$,R,D,U,Oe,ue,Ze,et,Ke,Xe,ge,me,tt,fe,Ce,xe,_e],styles:[`.modal-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:90vh;background:#fff;position:relative}.modal-header[_ngcontent-%COMP%]{padding:16px 24px;border-bottom:1px solid #e5e7eb;flex-shrink:0}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600;color:#111827}.modal-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:8px 0 0;color:#6b7280;font-size:14px}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#6b7280;display:flex;align-items:center;justify-content:center}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#111827}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px}.modal-body[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex;flex-direction:column;min-height:0}.modal-content[_ngcontent-%COMP%]{flex:1;overflow:auto;position:relative;min-height:0}.modal-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:0;height:100%;overflow:hidden}@media (max-width: 768px){.modal-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto auto;height:auto;overflow:visible}}.form-section[_ngcontent-%COMP%]{padding:24px;border-right:1px solid #e5e7eb;overflow-y:auto;height:100%;max-height:100%}@media (max-width: 768px){.form-section[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e5e7eb;height:auto;max-height:none;overflow:visible;padding-bottom:30px}}.form-section[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#d1d5db #f3f4f6}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f3f4f6;border-radius:3px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:3px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}.images-section[_ngcontent-%COMP%]{padding:24px;background-color:#f9fafb;overflow-y:auto;height:100%;max-height:100%}@media (max-width: 768px){.images-section[_ngcontent-%COMP%]{height:auto;max-height:none;overflow:visible;min-height:300px;padding-bottom:80px}}.images-section[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#d1d5db #f3f4f6}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f3f4f6;border-radius:3px}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:3px}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:14px;font-weight:500;color:#374151}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#dc2626}.form-group.half[_ngcontent-%COMP%]{flex:1}.form-control[_ngcontent-%COMP%]{position:relative;width:100%;padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px;color:#111827;background-color:#fff;transition:border-color .2s}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 2px #2563eb1a}.form-control[_ngcontent-%COMP%]:disabled{background-color:#f9fafb;color:#6b7280;cursor:not-allowed}select.form-control[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;background-size:16px;padding-right:40px}select.form-control[_ngcontent-%COMP%]:disabled{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")}select.form-control[_ngcontent-%COMP%]::placeholder{color:#9ca3af}select.form-control[_ngcontent-%COMP%]{padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s}select.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}input.form-control[_ngcontent-%COMP%]{padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s}input.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}textarea.form-control[_ngcontent-%COMP%]{position:relative;padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s;resize:vertical;min-height:80px}textarea.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}.character-count[_ngcontent-%COMP%]{margin-top:4px;text-align:right;font-size:12px;color:#6b7280;position:absolute;bottom:13px;right:13px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px}.form-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:0;flex:1}.repuestos-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;color:#374151;font-weight:600}.search-container[_ngcontent-%COMP%]{margin-bottom:16px}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;left:12px;color:#6b7280;font-size:18px;z-index:1}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:40px;width:100%}.loading-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:16px;color:#6b7280;font-size:14px}.loading-indicator[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.loading-indicator[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px;text-align:center}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#4f46e5}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#6b7280;margin:0}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%]{padding:12px;background:#fef2f2;color:#dc2626;border-radius:6px;font-size:14px;margin-bottom:16px}.productos-disponibles[_ngcontent-%COMP%]{margin-bottom:24px}.productos-disponibles[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:16px;color:#374151}.productos-list[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto;border:1px solid #E5E7EB;border-radius:6px}.producto-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid #F3F4F6;cursor:pointer;transition:background-color .2s}.producto-item[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.producto-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.producto-item.sin-stock[_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed}.producto-item.sin-stock[_ngcontent-%COMP%]:hover{background-color:transparent}.producto-item.stock-bajo[_ngcontent-%COMP%]{border-left:3px solid #F59E0B}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]{flex:1;min-width:0}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]   .producto-codigo[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]   .producto-stock[_ngcontent-%COMP%]{font-size:12px;color:#059669;font-weight:500}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]   .producto-stock.stock-bajo[_ngcontent-%COMP%]{color:#f59e0b;font-weight:600}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]   .producto-stock.sin-stock[_ngcontent-%COMP%]{color:#ef4444;font-weight:600}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-nombre[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#111827;margin-bottom:2px}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-descripcion[_ngcontent-%COMP%]{display:block;font-size:12px;color:#6b7280;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-precio[_ngcontent-%COMP%]{font-size:14px;color:#059669;font-weight:600}.producto-item[_ngcontent-%COMP%]   .add-producto-btn[_ngcontent-%COMP%]{background:#4f46e5;color:#fff;border:none;border-radius:50%;width:32px;height:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:background-color .2s}.producto-item[_ngcontent-%COMP%]   .add-producto-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#3730a3}.producto-item[_ngcontent-%COMP%]   .add-producto-btn[_ngcontent-%COMP%]:disabled{background:#9ca3af;cursor:not-allowed}.producto-item[_ngcontent-%COMP%]   .add-producto-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.repuestos-list[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;color:#374151;font-weight:500}.repuesto-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;background-color:#fff;border-radius:6px;border:1px solid #e5e7eb;margin-bottom:8px}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]{flex:1;min-width:0}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-header[_ngcontent-%COMP%]   .repuesto-codigo[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-header[_ngcontent-%COMP%]   .repuesto-precio[_ngcontent-%COMP%]{font-size:14px;color:#059669;font-weight:600}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-nombre[_ngcontent-%COMP%]{display:block;font-size:14px;color:#374151;font-weight:500;margin-bottom:8px}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   .cantidad-input[_ngcontent-%COMP%]{width:60px;padding:4px 8px;border:1px solid #D1D5DB;border-radius:4px;font-size:12px;text-align:center}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   .unidad[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.repuesto-item[_ngcontent-%COMP%]   .remove-repuesto[_ngcontent-%COMP%]{background:none;border:none;padding:8px;color:#dc2626;cursor:pointer;display:flex;align-items:center;justify-content:center}.repuesto-item[_ngcontent-%COMP%]   .remove-repuesto[_ngcontent-%COMP%]:hover{color:#b91c1c}.repuesto-item[_ngcontent-%COMP%]   .remove-repuesto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.costo-total[_ngcontent-%COMP%]{margin-top:16px;padding:12px;background-color:#f0f9ff;border:1px solid #BAE6FD;border-radius:6px;text-align:center}.costo-total[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#0369a1;font-size:14px}.no-repuestos[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.no-repuestos[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#d1d5db;margin-bottom:16px}.no-repuestos[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;color:#374151}.no-repuestos[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;color:#6b7280}.modal-footer[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e5e7eb;background:#fff;flex-shrink:0;z-index:10;position:sticky;bottom:0;left:0;right:0}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:6px;font-size:14px;font-weight:500;display:flex;align-items:center;gap:8px;cursor:pointer;transition:all .2s}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{background:none;border:1px solid #d1d5db;color:#374151}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f8fafc;border-color:#9ca3af}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#2563eb;border:1px solid #2563eb;color:#fff}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#1d4ed8;border-color:#1d4ed8}@media (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:100vh;max-height:none}.modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-content[_ngcontent-%COMP%]{height:auto;overflow:auto}.modal-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto auto;height:auto;overflow:visible}.form-section[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e5e7eb;height:auto;max-height:none;overflow:visible;padding-bottom:30px}.images-section[_ngcontent-%COMP%]{height:auto;max-height:none;overflow:visible;min-height:300px;padding-bottom:80px}.form-control[_ngcontent-%COMP%]{font-size:16px;padding:12px}textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{font-size:14px!important;padding:12px}.add-repuesto[_ngcontent-%COMP%]{flex-direction:column}.add-repuesto[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]{width:100%;justify-content:center}}@media (display-mode: standalone) and (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px));max-height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px))}.modal-header[_ngcontent-%COMP%]{padding-top:calc(16px + var(--safe-area-top, 0px))}.modal-footer[_ngcontent-%COMP%]{padding-bottom:calc(16px + var(--safe-area-bottom, 0px))}}@supports (-webkit-touch-callout: none){@media (display-mode: standalone) and (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px));max-height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px))}.modal-header[_ngcontent-%COMP%]{padding-top:calc(16px + var(--safe-area-top, 0px))}.modal-footer[_ngcontent-%COMP%]{padding-bottom:calc(16px + var(--safe-area-bottom, 0px))}}}@supports not (padding-top: env(safe-area-inset-top)){@media (display-mode: standalone) and (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:calc(100vh - 40px);max-height:calc(100vh - 40px)}.modal-header[_ngcontent-%COMP%]{padding-top:36px}.modal-footer[_ngcontent-%COMP%]{padding-bottom:36px}}}.info-message[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;padding:12px;background-color:#eff6ff;border:1px solid #BFDBFE;border-radius:6px;margin-bottom:16px}.info-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:18px;margin-top:2px;flex-shrink:0}.info-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#1e40af;line-height:1.4}`]});let r=l;return r})();var qt=(()=>{let l=class l{constructor(t){this.supabaseClientService=t,this.supabase=this.supabaseClientService.getClient()}crearAlbaran(t){return I(this.supabase.from("albaranes").insert([t]).select().single()).pipe(A(({data:n,error:i})=>{if(i)throw i;return n}),F(n=>{throw console.error("Error al crear albar\xE1n:",n),n}))}getAlbaran(t){return I(this.supabase.from("albaranes").select(`
          *,
          trabajo:trabajos_realizados(*),
          aviso:avisos(*)
        `).eq("id",t).single()).pipe(A(({data:n,error:i})=>{if(i)throw i;return n}),F(n=>{throw console.error("Error al obtener albar\xE1n:",n),n}))}getAlbaranesAviso(t){return I(this.supabase.from("albaranes").select(`
          *,
          trabajo:trabajos_realizados(*)
        `).eq("aviso_id",t).order("fecha_cierre",{ascending:!1})).pipe(A(({data:n,error:i})=>{if(i)throw i;return n}),F(n=>{throw console.error("Error al obtener albaranes del aviso:",n),n}))}getAlbaranesTrabajo(t){return I(this.supabase.from("albaranes").select("*").eq("trabajo_id",t).order("fecha_cierre",{ascending:!1})).pipe(A(({data:n,error:i})=>{if(i)throw i;return n}),F(n=>{throw console.error("Error al obtener albaranes del trabajo:",n),n}))}actualizarAlbaran(t,n){return I(this.supabase.from("albaranes").update(ce(re({},n),{fecha_actualizacion:new Date})).eq("id",t).select().single()).pipe(A(({data:i,error:p})=>{if(p)throw p;return i}),F(i=>{throw console.error("Error al actualizar albar\xE1n:",i),i}))}eliminarAlbaran(t){return I(this.supabase.from("albaranes").delete().eq("id",t)).pipe(A(({error:n})=>{if(n)throw n}),F(n=>{throw console.error("Error al eliminar albar\xE1n:",n),n}))}getEstadisticasAlbaranes(t){return I(this.supabase.from("albaranes").select("estado_cierre").eq("aviso_id",t)).pipe(A(({data:n,error:i})=>{if(i)throw i;let p=n;return{total:p.length,finalizados:p.filter(O=>O.estado_cierre==="Finalizado").length,presupuestoPendiente:p.filter(O=>O.estado_cierre==="Presupuesto pendiente").length,otraVisita:p.filter(O=>O.estado_cierre==="Otra visita").length}}),F(n=>{throw console.error("Error al obtener estad\xEDsticas de albaranes:",n),n}))}};l.\u0275fac=function(n){return new(n||l)(qe(pt))},l.\u0275prov=He({token:l,factory:l.\u0275fac,providedIn:"root"});let r=l;return r})();var ln=["signaturePad"];function dn(r,l){if(r&1){let a=P();e(0,"div",51),u("click",function(){let n=f(a).$implicit,i=m(2);return C(i.agregarRepuesto(n))}),e(1,"div",52)(2,"div",53)(3,"span",54),c(4),o(),e(5,"span",55),c(6),h(7,"currency"),o()(),e(8,"span",56),c(9),o(),e(10,"div",57)(11,"span",58),c(12),o(),e(13,"span",59),c(14),o()()(),g(15,"ion-icon",60),o()}if(r&2){let a=l.$implicit;s(4),_(a.codigo),s(2),_(k(7,6,a.precio_neto,"EUR","symbol","1.2-2")),s(3),_(a.nombre),s(3),V("Stock: ",a.cantidad_disponible," ",a.unidad,""),s(2),_(a.descripcion)}}function pn(r,l){if(r&1){let a=P();e(0,"div",43)(1,"div",44)(2,"h4"),c(3,"Seleccionar Repuestos"),o(),e(4,"button",45),u("click",function(){f(a);let n=m();return C(n.cerrarSelectorRepuestos())}),g(5,"ion-icon",3),o()(),e(6,"div",46)(7,"ion-input",47),ne("ngModelChange",function(n){f(a);let i=m();return te(i.busquedaRepuesto,n)||(i.busquedaRepuesto=n),C(n)}),u("ionInput",function(n){f(a);let i=m();return C(i.filtrarProductos(n))}),o(),g(8,"ion-icon",48),o(),e(9,"div",49),b(10,dn,16,11,"div",50),o()()}if(r&2){let a=m();s(7),ee("ngModel",a.busquedaRepuesto),s(3),d("ngForOf",a.productosFiltrados)}}function gn(r,l){if(r&1){let a=P();e(0,"div",63)(1,"span",64),c(2),o(),e(3,"button",65),u("click",function(){let n=f(a).$implicit,i=m(2);return C(i.eliminarRepuesto(n))}),g(4,"ion-icon",66),o()()}if(r&2){let a=l.$implicit;s(2),_(a)}}function mn(r,l){if(r&1&&(e(0,"div",61)(1,"h4"),c(2,"Repuestos Seleccionados:"),o(),b(3,gn,5,1,"div",62),o()),r&2){let a=m();s(3),d("ngForOf",a.repuestosSeleccionados)}}function _n(r,l){r&1&&(e(0,"div",67),g(1,"ion-icon",21),e(2,"p"),c(3,"No hay repuestos seleccionados"),o(),e(4,"small"),c(5,"Selecciona repuestos del inventario o agrega manualmente"),o()())}function un(r,l){r&1&&g(0,"ion-icon",71)}function fn(r,l){if(r&1){let a=P();e(0,"div",68),u("click",function(){let n=f(a).$implicit,i=m();return C(i.albaranForm.patchValue({estado_cierre:n.valor}))}),e(1,"div",69)(2,"h4"),c(3),o(),e(4,"p"),c(5),o()(),b(6,un,1,0,"ion-icon",70),o()}if(r&2){let a,t,n=l.$implicit,i=m();H("selected",((a=i.albaranForm.get("estado_cierre"))==null?null:a.value)===n.valor),s(3),_(n.label),s(2),_(n.descripcion),s(),d("ngIf",((t=i.albaranForm.get("estado_cierre"))==null?null:t.value)===n.valor)}}function Cn(r,l){r&1&&(e(0,"div",8)(1,"h3"),c(2,"Presupuesto Necesario"),o(),e(3,"div",10),g(4,"ion-input",72),o()())}function bn(r,l){if(r&1){let a=P();e(0,"div",73),g(1,"canvas",74,0),e(3,"div",75)(4,"button",76),u("click",function(){f(a);let n=m();return C(n.limpiarFirma())}),g(5,"ion-icon",66),c(6," Limpiar "),o(),e(7,"button",77),u("click",function(){f(a);let n=m();return C(n.guardarFirma())}),g(8,"ion-icon",78),c(9," Guardar Firma "),o()()()}}function xn(r,l){if(r&1){let a=P();e(0,"div",79),g(1,"img",80),e(2,"div",81)(3,"button",82),u("click",function(){f(a);let n=m();return C(n.editarFirma())}),g(4,"ion-icon",83),c(5," Editar "),o(),e(6,"button",65),u("click",function(){f(a);let n=m();return C(n.eliminarFirma())}),g(7,"ion-icon",66),c(8," Eliminar "),o()()()}if(r&2){let a=m();s(),d("src",a.firmaDataUrl,se)}}function On(r,l){if(r&1){let a=P();e(0,"div",84)(1,"span"),c(2,"\xC1rea de firma digital"),o(),e(3,"small"),c(4,"Haz clic para comenzar a firmar"),o(),e(5,"button",85),u("click",function(){f(a);let n=m();return C(n.iniciarFirma())}),g(6,"ion-icon",83),c(7," Comenzar Firma "),o()()}}function Pn(r,l){if(r&1){let a=P();e(0,"div",51),u("click",function(){let n=f(a).$implicit,i=m(2);return C(i.agregarRepuesto(n))}),e(1,"div",52)(2,"div",53)(3,"span",54),c(4),o(),e(5,"span",55),c(6),h(7,"currency"),o()(),e(8,"span",56),c(9),o(),e(10,"div",57)(11,"span",58),c(12),o(),e(13,"span",59),c(14),o()()(),g(15,"ion-icon",60),o()}if(r&2){let a=l.$implicit;s(4),_(a.codigo),s(2),_(k(7,6,a.precio_neto,"EUR","symbol","1.2-2")),s(3),_(a.nombre),s(3),V("Stock: ",a.cantidad_disponible," ",a.unidad,""),s(2),_(a.descripcion)}}function Mn(r,l){if(r&1){let a=P();e(0,"div",43)(1,"div",44)(2,"h4"),c(3,"Seleccionar Repuestos"),o(),e(4,"button",45),u("click",function(){f(a);let n=m();return C(n.cerrarSelectorRepuestos())}),g(5,"ion-icon",3),o()(),e(6,"div",46)(7,"ion-input",47),ne("ngModelChange",function(n){f(a);let i=m();return te(i.busquedaRepuesto,n)||(i.busquedaRepuesto=n),C(n)}),u("ionInput",function(n){f(a);let i=m();return C(i.filtrarProductos(n))}),o(),g(8,"ion-icon",48),o(),e(9,"div",49),b(10,Pn,16,11,"div",50),o()()}if(r&2){let a=m();s(7),ee("ngModel",a.busquedaRepuesto),s(3),d("ngForOf",a.productosFiltrados)}}function vn(r,l){if(r&1){let a=P();e(0,"div",63)(1,"span",64),c(2),o(),e(3,"button",65),u("click",function(){let n=f(a).$implicit,i=m(2);return C(i.eliminarRepuesto(n))}),g(4,"ion-icon",66),o()()}if(r&2){let a=l.$implicit;s(2),_(a)}}function hn(r,l){if(r&1&&(e(0,"div",61)(1,"h4"),c(2,"Repuestos Seleccionados:"),o(),b(3,vn,5,1,"div",62),o()),r&2){let a=m();s(3),d("ngForOf",a.repuestosSeleccionados)}}function yn(r,l){r&1&&(e(0,"div",67),g(1,"ion-icon",21),e(2,"p"),c(3,"No hay repuestos seleccionados"),o(),e(4,"small"),c(5,"Selecciona repuestos del inventario o agrega manualmente"),o()())}function wn(r,l){if(r&1&&(e(0,"div",86),g(1,"ion-icon",87),e(2,"span"),c(3),o()()),r&2){let a=m();s(3),_(a.error)}}function En(r,l){r&1&&g(0,"ion-icon",88)}function jn(r,l){r&1&&g(0,"ion-icon",89)}var Bt=(()=>{let l=class l{constructor(t,n,i,p,x,O){this.fb=t,this.modalController=n,this.inventarioService=i,this.albaranesService=p,this.trabajosService=x,this.avisosService=O,this.loading=!1,this.error=null,this.productosInventario=[],this.productosFiltrados=[],this.busquedaRepuesto="",this.mostrarSelectorRepuestos=!1,this.repuestosSeleccionados=[],this.firmaCapturada=!1,this.firmaDataUrl="",this.mostrarCanvas=!1,this.estadosCierre=[{valor:"Finalizado",label:"Finalizado",descripcion:"Trabajo completado, listo para facturar"},{valor:"Presupuesto pendiente",label:"Presupuesto pendiente",descripcion:"Se requiere presupuesto adicional"},{valor:"Otra visita",label:"Otra visita",descripcion:"Se necesita realizar otra visita"}],console.log("HacerAlbaranComponent constructor called"),z({close:oe,timeOutline:J,cubeOutline:Et,addCircleOutline:Ct,searchOutline:Ee,trashOutline:K,checkmarkCircleOutline:W,checkmarkOutline:Mt,createOutline:he,warningOutline:je,saveOutline:we,refreshOutline:Y,calendarOutline:Me,personOutline:Q,pencilOutline:ie,documentTextOutline:N}),this.albaranForm=this.fb.group({fecha_cierre:[new Date,y.required],hora_entrada:["",y.required],hora_salida:["",y.required],descripcion_trabajo_realizado:["",y.required],repuestos_utilizados:[[]],estado_cierre:["",y.required],presupuesto_necesario:[0,[y.min(0)]],dni_cliente:[""],nombre_firma:[""],firma_cliente:[""],observaciones:[""]})}ngOnInit(){console.log("\u{1F3AF} HacerAlbaranComponent ngOnInit - Trabajo:",this.trabajo),console.log("\u{1F3AF} HacerAlbaranComponent ngOnInit - Aviso:",this.aviso),console.log("\u{1F3AF} Formulario inicializado:",this.albaranForm),this.cargarProductosInventario(),this.inicializarFormulario()}ngAfterViewInit(){setTimeout(()=>{this.inicializarSignaturePad()},100)}inicializarFormulario(){this.trabajo&&(this.albaranForm.patchValue({hora_entrada:this.trabajo.hora_inicio,hora_salida:this.trabajo.hora_fin,repuestos_utilizados:this.trabajo.repuestos||[]}),this.trabajo.repuestos&&this.trabajo.repuestos.length>0&&(this.repuestosSeleccionados=[...this.trabajo.repuestos]))}cargarProductosInventario(){this.inventarioService.getInventario(1,1e3,"","nombre","asc",!1).subscribe({next:t=>{this.productosInventario=t.inventario,this.productosFiltrados=[...this.productosInventario]},error:t=>{console.error("Error al cargar productos del inventario:",t)}})}filtrarProductos(t){var i;let n=((i=t==null?void 0:t.target)==null?void 0:i.value)||t||"";this.busquedaRepuesto=n,n.trim()?this.productosFiltrados=this.productosInventario.filter(p=>{var x;return p.nombre.toLowerCase().includes(n.toLowerCase())||p.codigo.toLowerCase().includes(n.toLowerCase())||(((x=p.descripcion)==null?void 0:x.toLowerCase())||"").includes(n.toLowerCase())}):this.productosFiltrados=[...this.productosInventario]}abrirSelectorRepuestos(){this.mostrarSelectorRepuestos=!0,this.productosFiltrados=[...this.productosInventario],this.busquedaRepuesto=""}cerrarSelectorRepuestos(){this.mostrarSelectorRepuestos=!1}agregarRepuesto(t){this.repuestosSeleccionados.includes(t.nombre)||(this.repuestosSeleccionados.push(t.nombre),this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados})),this.cerrarSelectorRepuestos()}eliminarRepuesto(t){this.repuestosSeleccionados=this.repuestosSeleccionados.filter(n=>n!==t),this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados})}agregarRepuestoManual(){let t=prompt("Introduce el nombre del repuesto:");t&&t.trim()&&(this.repuestosSeleccionados.includes(t.trim())||(this.repuestosSeleccionados.push(t.trim()),this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados})))}generarHoraActual(){let t=new Date;return`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`}establecerHoraActual(){let t=this.generarHoraActual();this.albaranForm.patchValue({hora_salida:t})}establecerFechaActual(){this.albaranForm.patchValue({fecha_cierre:new Date})}guardarAlbaran(){if(this.albaranForm.valid){this.loading=!0,this.error=null;let t={trabajo_id:this.trabajo.id,aviso_id:this.aviso.id,fecha_cierre:this.albaranForm.value.fecha_cierre,hora_entrada:this.albaranForm.value.hora_entrada,hora_salida:this.albaranForm.value.hora_salida,descripcion_trabajo_realizado:this.albaranForm.value.descripcion_trabajo_realizado,repuestos_utilizados:this.albaranForm.value.repuestos_utilizados,estado_cierre:this.albaranForm.value.estado_cierre,presupuesto_necesario:this.albaranForm.value.presupuesto_necesario,dni_cliente:this.albaranForm.value.dni_cliente,nombre_firma:this.albaranForm.value.nombre_firma,firma_cliente:this.albaranForm.value.firma_cliente,observaciones:this.albaranForm.value.observaciones};console.log("Datos del albar\xE1n:",t),this.albaranesService.crearAlbaran(t).subscribe({next:n=>{console.log("Albar\xE1n guardado exitosamente:",n);let i="Abierto";n.estado_cierre==="Finalizado"?i="Finalizado":(n.estado_cierre==="Presupuesto pendiente"||n.estado_cierre==="Otra visita")&&(i="Cerrado"),this.trabajosService.actualizarEstadoTrabajo(this.trabajo.id,i,n.id).subscribe({next:p=>{console.log("Trabajo actualizado exitosamente:",p),this.avisosService.actualizarEstadoAutomatico(this.aviso.id).subscribe({next:x=>{this.loading=!1,console.log("Estado del aviso actualizado autom\xE1ticamente:",x),this.modalController.dismiss({success:!0,albaran:n,trabajo:p,aviso:x,mensaje:"Albar\xE1n guardado exitosamente"})},error:x=>{console.error("Error al actualizar estado del aviso:",x),this.loading=!1,this.modalController.dismiss({success:!0,albaran:n,trabajo:p,mensaje:"Albar\xE1n guardado exitosamente"})}})},error:p=>{this.loading=!1,this.error="Error al actualizar el trabajo: "+(p.message||"Error desconocido"),console.error("Error al actualizar trabajo:",p)}})},error:n=>{this.loading=!1,this.error="Error al guardar el albar\xE1n: "+(n.message||"Error desconocido"),console.error("Error al guardar albar\xE1n:",n)}})}else this.error="Por favor, complete todos los campos requeridos",this.marcarCamposComoTocados()}marcarCamposComoTocados(){Object.keys(this.albaranForm.controls).forEach(t=>{let n=this.albaranForm.get(t);n==null||n.markAsTouched()})}cancelar(){this.modalController.dismiss()}requierePresupuesto(){var t;return((t=this.albaranForm.get("estado_cierre"))==null?void 0:t.value)==="Presupuesto pendiente"}requiereOtraVisita(){var t;return((t=this.albaranForm.get("estado_cierre"))==null?void 0:t.value)==="Otra visita"}iniciarFirma(){this.mostrarCanvas=!0,this.firmaCapturada=!1,this.firmaDataUrl=""}inicializarSignaturePad(){var n;if(!((n=this.signaturePadElement)!=null&&n.nativeElement)){console.warn("Canvas no encontrado");return}let t=this.signaturePadElement.nativeElement;import("./chunk-PGY3UNFJ.js").then(({default:i})=>{this.signaturePad=new i(t,{backgroundColor:"white",penColor:"black",minWidth:1,maxWidth:2.5,throttle:16,velocityFilterWeight:.7,dotSize:1}),this.ajustarCanvas(),window.addEventListener("resize",()=>this.ajustarCanvas())})}ajustarCanvas(){var O;if(!((O=this.signaturePadElement)!=null&&O.nativeElement)||!this.signaturePad)return;let t=this.signaturePadElement.nativeElement,n=t.parentElement;if(!n)return;let i=n.getBoundingClientRect(),p=Math.max(i.width-40,200),x=150;t.width=p,t.height=x,this.signaturePad.resizeCanvas()}limpiarFirma(){this.signaturePad&&this.signaturePad.clear()}guardarFirma(){this.signaturePad&&!this.signaturePad.isEmpty()?(this.firmaDataUrl=this.signaturePad.toDataURL(),this.firmaCapturada=!0,this.mostrarCanvas=!1,this.albaranForm.patchValue({firma_cliente:this.firmaDataUrl}),console.log("Firma guardada exitosamente")):console.warn("No hay firma para guardar")}editarFirma(){this.mostrarCanvas=!0,this.firmaCapturada=!1,this.signaturePad&&this.signaturePad.clear()}eliminarFirma(){this.firmaCapturada=!1,this.firmaDataUrl="",this.mostrarCanvas=!1,this.signaturePad&&this.signaturePad.clear(),this.albaranForm.patchValue({firma_cliente:""}),console.log("Firma eliminada")}};l.\u0275fac=function(n){return new(n||l)(M(be),M(Pe),M(ze),M(qt),M(X),M(ke))},l.\u0275cmp=T({type:l,selectors:[["app-hacer-albaran"]],viewQuery:function(n,i){if(n&1&&le(ln,5),n&2){let p;de(p=pe())&&(i.signaturePadElement=p.first)}},inputs:{trabajo:"trabajo",aviso:"aviso"},decls:99,vars:17,consts:[["signaturePad",""],["slot","end"],[3,"click"],["name","close"],[1,"albaran-container"],[3,"ngSubmit","formGroup"],[1,"form-layout"],[1,"form-main"],[1,"form-section"],[1,"form-row"],[1,"form-group"],["type","date","formControlName","fecha_cierre",3,"click"],[1,"help-text"],["type","time","formControlName","hora_entrada","step","900"],["type","time","formControlName","hora_salida","step","900",3,"click"],["type","button",1,"btn-now",3,"click"],["name","time-outline"],["formControlName","descripcion_trabajo_realizado","placeholder","Describe detalladamente el trabajo realizado...","rows","3"],[1,"form-section","repuestos-section","mobile-only"],[1,"repuestos-actions"],["type","button",1,"btn-select-inventory",3,"click"],["name","cube-outline"],["class","inventory-selector",4,"ngIf"],["class","repuestos-list",4,"ngIf"],["class","repuestos-empty",4,"ngIf"],[1,"estados-grid"],["class","estado-option",3,"selected","click",4,"ngFor","ngForOf"],["class","form-section",4,"ngIf"],["formControlName","observaciones","placeholder","Observaciones adicionales...","rows","2"],["type","text","formControlName","dni_cliente","placeholder","DNI del cliente"],["type","text","formControlName","nombre_firma","placeholder","Nombre de la persona que firma"],[1,"signature-area"],["class","signature-canvas-container",4,"ngIf"],["class","signature-preview",4,"ngIf"],["class","signature-placeholder",4,"ngIf"],[1,"form-sidebar"],[1,"form-section","repuestos-section","desktop-only"],["class","error-message",4,"ngIf"],[1,"form-actions"],["type","button","fill","outline",3,"click"],["type","submit",3,"disabled"],["name","save-outline",4,"ngIf"],["name","refresh-outline","class","spinning",4,"ngIf"],[1,"inventory-selector"],[1,"selector-header"],["type","button",1,"btn-close",3,"click"],[1,"search-container"],["type","text","placeholder","Buscar repuestos...",1,"search-input",3,"ngModelChange","ionInput","ngModel"],["name","search-outline"],[1,"products-list"],["class","product-item",3,"click",4,"ngFor","ngForOf"],[1,"product-item",3,"click"],[1,"product-info"],[1,"product-header"],[1,"product-code"],[1,"product-price"],[1,"product-name"],[1,"product-details"],[1,"product-stock"],[1,"product-description"],["name","add-circle-outline",1,"add-icon"],[1,"repuestos-list"],["class","repuesto-item",4,"ngFor","ngForOf"],[1,"repuesto-item"],[1,"repuesto-nombre"],["type","button",1,"btn-remove",3,"click"],["name","trash-outline"],[1,"repuestos-empty"],[1,"estado-option",3,"click"],[1,"estado-content"],["name","checkmark-circle-outline",4,"ngIf"],["name","checkmark-circle-outline"],["type","number","formControlName","presupuesto_necesario","placeholder","0.00","step","0.01"],[1,"signature-canvas-container"],[1,"signature-canvas"],[1,"signature-controls"],["type","button",1,"btn-clear",3,"click"],["type","button",1,"btn-save",3,"click"],["name","checkmark-outline"],[1,"signature-preview"],["alt","Firma del cliente",1,"firma-image",3,"src"],[1,"signature-actions"],["type","button",1,"btn-edit",3,"click"],["name","create-outline"],[1,"signature-placeholder"],["type","button",1,"btn-start-signature",3,"click"],[1,"error-message"],["name","warning-outline"],["name","save-outline"],["name","refresh-outline",1,"spinning"]],template:function(n,i){n&1&&(e(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),c(3,"VISTA CIERRE ALBAR\xC1N"),o(),e(4,"ion-buttons",1)(5,"ion-button",2),u("click",function(){return i.cancelar()}),g(6,"ion-icon",3),o()()()(),e(7,"ion-content")(8,"div",4)(9,"form",5),u("ngSubmit",function(){return i.guardarAlbaran()}),e(10,"div",6)(11,"div",7)(12,"div",8)(13,"h3"),c(14,"Fecha y Horarios"),o(),e(15,"div",9)(16,"div",10)(17,"ion-label"),c(18,"FECHA"),o(),e(19,"ion-input",11),u("click",function(){return i.establecerFechaActual()}),o(),e(20,"small",12),c(21,"Autom\xE1tica d\xEDa actual"),o()(),e(22,"div",10)(23,"ion-label"),c(24,"HORA ENTRADA"),o(),g(25,"ion-input",13),e(26,"small",12),c(27,"Men\xFA interactivo 15 en 15 min"),o()(),e(28,"div",10)(29,"ion-label"),c(30,"HORA SALIDA"),o(),e(31,"ion-input",14),u("click",function(){return i.establecerHoraActual()}),o(),e(32,"button",15),u("click",function(){return i.establecerHoraActual()}),g(33,"ion-icon",16),c(34," Ahora "),o()()()(),e(35,"div",8)(36,"h3"),c(37,"Descripci\xF3n del Trabajo Realizado"),o(),e(38,"div",10),g(39,"ion-textarea",17),o()(),e(40,"div",18)(41,"h3"),c(42,"Repuestos Utilizados"),o(),e(43,"div",19)(44,"button",20),u("click",function(){return i.abrirSelectorRepuestos()}),g(45,"ion-icon",21),c(46," Seleccionar del Inventario "),o()(),b(47,pn,11,2,"div",22)(48,mn,4,1,"div",23)(49,_n,6,0,"div",24),o(),e(50,"div",8)(51,"h3"),c(52,"Estado de Cierre"),o(),e(53,"div",25),b(54,fn,7,5,"div",26),o()(),b(55,Cn,5,0,"div",27),e(56,"div",8)(57,"h3"),c(58,"Observaciones Adicionales"),o(),e(59,"div",10),g(60,"ion-textarea",28),o()(),e(61,"div",8)(62,"h3"),c(63,"Identificaci\xF3n y Firma"),o(),e(64,"div",9)(65,"div",10)(66,"ion-label"),c(67,"DNI"),o(),g(68,"ion-input",29),o(),e(69,"div",10)(70,"ion-label"),c(71,"NOMBRE FIRMA"),o(),g(72,"ion-input",30),o()(),e(73,"div",10)(74,"ion-label"),c(75,"FIRMA"),o(),e(76,"div",31),b(77,bn,10,0,"div",32)(78,xn,9,1,"div",33)(79,On,8,0,"div",34),o()()()(),e(80,"div",35)(81,"div",36)(82,"h3"),c(83,"Repuestos Utilizados"),o(),e(84,"div",19)(85,"button",20),u("click",function(){return i.abrirSelectorRepuestos()}),g(86,"ion-icon",21),c(87," Seleccionar del Inventario "),o()(),b(88,Mn,11,2,"div",22)(89,hn,4,1,"div",23)(90,yn,6,0,"div",24),o()()(),b(91,wn,4,1,"div",37),e(92,"div",38)(93,"ion-button",39),u("click",function(){return i.cancelar()}),c(94," Cancelar "),o(),e(95,"ion-button",40),b(96,En,1,0,"ion-icon",41)(97,jn,1,0,"ion-icon",42),c(98),o()()()()()),n&2&&(s(9),d("formGroup",i.albaranForm),s(38),d("ngIf",i.mostrarSelectorRepuestos),s(),d("ngIf",i.repuestosSeleccionados.length>0),s(),d("ngIf",i.repuestosSeleccionados.length===0&&!i.mostrarSelectorRepuestos),s(5),d("ngForOf",i.estadosCierre),s(),d("ngIf",i.requierePresupuesto()),s(22),d("ngIf",!i.firmaCapturada),s(),d("ngIf",i.firmaCapturada),s(),d("ngIf",!i.firmaCapturada&&!i.mostrarCanvas),s(9),d("ngIf",i.mostrarSelectorRepuestos),s(),d("ngIf",i.repuestosSeleccionados.length>0),s(),d("ngIf",i.repuestosSeleccionados.length===0&&!i.mostrarSelectorRepuestos),s(),d("ngIf",i.error),s(4),d("disabled",!i.albaranForm.valid||i.loading),s(),d("ngIf",!i.loading),s(),d("ngIf",i.loading),s(),v(" ",i.loading?"Guardando...":"Guardar Albar\xE1n"," "))},dependencies:[$,R,D,U,Oe,ue,ge,me,fe,Ce,xe,_e,G,nt,lt,dt,rt,it,at,st,ct,ot],styles:["ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #fff;--border-color: #e5e7eb;--color: #111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--color: #6b7280}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:hover{--color: #111827}.albaran-container[_ngcontent-%COMP%]{padding:24px;height:100%;display:flex;flex-direction:column;overflow:hidden;background:#fff}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;gap:20px;overflow-y:auto;padding-right:4px}form[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}form[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}form[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}form[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}.form-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:24px;flex:1}@media (min-width: 1200px){.form-layout[_ngcontent-%COMP%]{grid-template-columns:2fr 1fr;gap:32px}}.form-main[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;order:1}.form-sidebar[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;order:2}.form-section[_ngcontent-%COMP%]{background:#fff;border:1px solid #E2E8F0;border-radius:12px;padding:24px;box-shadow:0 1px 3px #0000001a;flex-shrink:0}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;font-size:18px;font-weight:600;color:#1f2937;border-bottom:2px solid #4F46E5;padding-bottom:8px}.repuestos-section[_ngcontent-%COMP%]{position:sticky;top:20px}.repuestos-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{border-bottom-color:#10b981}@media (max-width: 1199px){.repuestos-section[_ngcontent-%COMP%]{position:static;top:auto}}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px}@media (min-width: 1200px){.form-row[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr);gap:24px}}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.form-group[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:8px;text-transform:none;letter-spacing:normal}.form-group[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{--background: #FAFAFB;--border-radius: 6px;--border-width: 1px;--border-color: transparent;--padding-start: 12px;--padding-end: 12px;--padding-top: 10px;--padding-bottom: 10px;--color: #111827;--placeholder-color: #9CA3AF;font-size:14px;transition:border-color .2s}.form-group[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]:focus-within, .form-group[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]:focus-within, .form-group[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]:focus-within{--border-color: #2563eb;--background: #fff;box-shadow:0 0 0 2px #2563eb1a}.form-group[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{--min-height: 80px;resize:vertical}.help-text[_ngcontent-%COMP%]{display:block;font-size:11px;color:#6b7280;margin-top:4px;font-style:italic;line-height:1.4}.btn-now[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 12px;background:#2563eb;color:#fff;border:none;border-radius:6px;font-size:12px;font-weight:500;cursor:pointer;margin-top:8px;transition:all .2s ease}.btn-now[_ngcontent-%COMP%]:hover{background:#1d4ed8}.btn-now[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.estados-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}@media (min-width: 1200px){.estados-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr);gap:20px}}.estado-option[_ngcontent-%COMP%]{border:2px solid #E5E7EB;border-radius:8px;padding:20px;cursor:pointer;transition:all .2s ease;position:relative;background:#fff}.estado-option[_ngcontent-%COMP%]:hover{border-color:#2563eb;transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.estado-option.selected[_ngcontent-%COMP%]{border-color:#2563eb;background:#eff6ff}.estado-option.selected[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#2563eb}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;font-weight:600;color:#111827}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:13px;color:#6b7280;line-height:1.4}.estado-option[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px;font-size:20px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]{border:2px dashed #D1D5DB;border-radius:8px;padding:20px;text-align:center;background:#f9fafb;transition:all .2s ease;min-height:200px;display:flex;align-items:center;justify-content:center;position:relative}.signature-area[_ngcontent-%COMP%]:hover{border-color:#2563eb;background:#eff6ff}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;gap:16px}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-canvas[_ngcontent-%COMP%]{border:1px solid #E5E7EB;border-radius:6px;background:#fff;cursor:crosshair;touch-action:none}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-clear[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-clear[_ngcontent-%COMP%]:hover{background:#fecaca}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]{background:#10b981;color:#fff}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]:hover{background:#059669}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;gap:16px}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .firma-image[_ngcontent-%COMP%]{max-width:100%;max-height:120px;border:1px solid #E5E7EB;border-radius:6px;background:#fff}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]{background:#dbeafe;color:#1d4ed8}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]:hover{background:#bfdbfe}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]:hover{background:#fecaca}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;color:#6b7280;margin-top:15px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;font-weight:500}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 20px;background:#2563eb;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s;margin-top:8px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]:hover{background:#1d4ed8}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#fef2f2;border:1px solid #FECACA;border-radius:6px;color:#dc2626;margin-bottom:20px;font-size:14px}.error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;color:#dc2626;flex-shrink:0}.error-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end;margin-top:auto;padding-top:24px;border-top:1px solid #E5E7EB;flex-shrink:0;background:#fff;position:sticky;bottom:0;left:0;right:0;z-index:10}.form-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;--padding-top: 8px;--padding-bottom: 8px;font-weight:500;font-size:14px;min-width:140px;border-radius:6px;transition:all .2s}.form-actions[_ngcontent-%COMP%]   ion-button[fill=outline][_ngcontent-%COMP%]{--border-color: #d1d5db;--color: #374151}.form-actions[_ngcontent-%COMP%]   ion-button[fill=outline][_ngcontent-%COMP%]:hover{--background: #f8fafc;--border-color: #9ca3af}.form-actions[_ngcontent-%COMP%]   ion-button[type=submit][_ngcontent-%COMP%]{--background: #2563eb;--border-color: #2563eb;--color: #fff}.form-actions[_ngcontent-%COMP%]   ion-button[type=submit][_ngcontent-%COMP%]:hover{--background: #1d4ed8;--border-color: #1d4ed8}.repuestos-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:24px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;padding:10px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;width:100%}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.repuestos-actions[_ngcontent-%COMP%]   .btn-select-inventory[_ngcontent-%COMP%]{background:#2563eb;color:#fff}.repuestos-actions[_ngcontent-%COMP%]   .btn-select-inventory[_ngcontent-%COMP%]:hover{background:#1d4ed8}.repuestos-actions[_ngcontent-%COMP%]   .btn-add-manual[_ngcontent-%COMP%]{background:#10b981;color:#fff}.repuestos-actions[_ngcontent-%COMP%]   .btn-add-manual[_ngcontent-%COMP%]:hover{background:#059669}.repuestos-empty[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#9ca3af}.repuestos-empty[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:16px;opacity:.5}.repuestos-empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;font-weight:500;color:#6b7280}.repuestos-empty[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:13px;color:#9ca3af;line-height:1.4}.inventory-selector[_ngcontent-%COMP%]{background:#fff;border:1px solid #E2E8F0;border-radius:8px;padding:20px;margin-bottom:20px;box-shadow:0 1px 3px #0000001a;max-height:400px;overflow:hidden;display:flex;flex-direction:column}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#1f2937;font-size:16px;font-weight:600}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;font-size:20px;cursor:pointer;padding:4px;border-radius:4px;transition:all .2s}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{position:relative;margin-bottom:16px}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{--background: #FAFAFB;--border-radius: 6px;--border-width: 1px;--border-color: transparent;--padding-start: 40px 12px 12px;--padding-end: 12px;--padding-top: 10px;--padding-bottom: 10px;--color: #111827;--placeholder-color: #9CA3AF;font-size:14px;transition:border-color .2s}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus-within{--border-color: #2563eb;--background: #fff;box-shadow:0 0 0 2px #2563eb1a}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#9ca3af;font-size:18px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]{flex:1;max-height:250px;overflow-y:auto;border:1px solid #E5E7EB;border-radius:6px;background:#f9fafb}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid #E5E7EB;cursor:pointer;transition:all .2s}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]{flex:1}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]   .product-code[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;background:#e5e7eb;padding:2px 6px;border-radius:4px;font-weight:500}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]   .product-price[_ngcontent-%COMP%]{font-weight:600;color:#059669;font-size:13px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;font-size:13px;margin-bottom:4px;display:block}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-stock[_ngcontent-%COMP%]{font-size:11px;color:#6b7280}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-description[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .add-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:18px;margin-left:8px}.repuestos-list[_ngcontent-%COMP%]{margin-top:20px}.repuestos-list[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:#1f2937;font-size:16px;font-weight:600}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:#f0f9ff;border:1px solid #BAE6FD;border-radius:6px;margin-bottom:8px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-nombre[_ngcontent-%COMP%]{font-weight:500;color:#0369a1;font-size:14px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626;border:none;padding:6px;border-radius:6px;cursor:pointer;transition:all .2s}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]:hover{background:#fecaca}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}ion-button[type=submit][disabled][_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}ion-button[type=submit][_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{margin-right:8px}.mobile-only[_ngcontent-%COMP%]{display:block}.desktop-only[_ngcontent-%COMP%]{display:none}@media (min-width: 1200px){.mobile-only[_ngcontent-%COMP%]{display:none}.desktop-only[_ngcontent-%COMP%]{display:block}}@media (max-width: 768px){.albaran-container[_ngcontent-%COMP%]{padding:16px}.form-main[_ngcontent-%COMP%]{order:1}.form-sidebar[_ngcontent-%COMP%]{order:2}.form-section[_ngcontent-%COMP%]{padding:20px;margin-bottom:20px}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;margin-bottom:16px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.estados-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.estado-option[_ngcontent-%COMP%]{padding:16px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:15px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}.estado-option[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;top:12px;right:12px}.repuestos-actions[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.form-actions[_ngcontent-%COMP%]{gap:12px}.form-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%;justify-content:center}.signature-area[_ngcontent-%COMP%]{padding:30px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:11px}}@media (min-width: 769px) and (max-width: 1199px){.albaran-container[_ngcontent-%COMP%]{padding:24px}.form-main[_ngcontent-%COMP%]{order:1}.form-sidebar[_ngcontent-%COMP%]{order:2}.form-row[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:20px}.estados-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:16px}.repuestos-actions[_ngcontent-%COMP%]{flex-direction:row;gap:12px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;min-width:0}}@media (min-width: 1200px){.albaran-container[_ngcontent-%COMP%]{padding:32px}.form-main[_ngcontent-%COMP%]{order:1}.form-sidebar[_ngcontent-%COMP%]{order:2}.form-section[_ngcontent-%COMP%]{padding:28px}.form-row[_ngcontent-%COMP%]{gap:28px}.estados-grid[_ngcontent-%COMP%]{gap:24px}.repuestos-actions[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:14px 20px;font-size:15px}.form-actions[_ngcontent-%COMP%]{gap:20px}.form-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{min-width:160px;--padding-start: 28px;--padding-end: 28px;--padding-top: 14px;--padding-bottom: 14px;font-size:15px}}@media (max-width: 480px){.albaran-container[_ngcontent-%COMP%]{padding:12px}.form-main[_ngcontent-%COMP%]{order:1}.form-sidebar[_ngcontent-%COMP%]{order:2}.form-section[_ngcontent-%COMP%]{padding:16px;margin-bottom:16px}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px;margin-bottom:12px}.form-group[_ngcontent-%COMP%]{margin-bottom:16px}.form-group[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:13px;margin-bottom:6px}.estado-option[_ngcontent-%COMP%]{padding:12px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:14px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px}.estado-option[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;top:8px;right:8px}.signature-area[_ngcontent-%COMP%]{padding:15px 0;border-color:#2563eb;background:#eff6ff;display:flex;flex-direction:column}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .help-text[_ngcontent-%COMP%]{font-size:10px}.btn-now[_ngcontent-%COMP%]{padding:4px 8px;font-size:11px}.btn-now[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}}"]});let r=l;return r})();function zn(r,l){r&1&&(e(0,"div",4),g(1,"ion-icon",5),e(2,"span",6),c(3,"Cargando estado del flujo..."),o(),e(4,"span",7),c(5,"Cargando..."),o()())}function Sn(r,l){if(r&1){let a=P();e(0,"div",8),g(1,"ion-icon",9),e(2,"span",10),c(3),o(),e(4,"button",11),u("click",function(){f(a);let n=m();return C(n.recargar())}),g(5,"ion-icon",12),e(6,"span",6),c(7,"Reintentar"),o(),e(8,"span",7),c(9,"Reintentar"),o()()()}if(r&2){let a=m();s(3),_(a.error)}}function In(r,l){if(r&1){let a=P();e(0,"button",26),u("click",function(){let n=f(a).$implicit,i=m(3);return C(i.ejecutarAccion(n))}),g(1,"ion-icon",17),e(2,"span",27),c(3),o()()}if(r&2){let a=l.$implicit,t=m(3);d("disabled",t.loading)("title",t.getAccionTexto(a)),s(),d("name",t.getAccionIcon(a)),s(2),_(t.getAccionTexto(a))}}function An(r,l){if(r&1&&(e(0,"div",22)(1,"h4",23),c(2,"Acciones disponibles:"),o(),e(3,"div",24),b(4,In,4,4,"button",25),o()()),r&2){let a=m(2);s(4),d("ngForOf",a.accionesDisponibles)}}function Fn(r,l){r&1&&(e(0,"div",30),g(1,"ion-icon",31),e(2,"span",32),c(3,"No hay acciones pendientes"),o()())}function Tn(r,l){if(r&1&&(e(0,"div",28),b(1,Fn,4,0,"div",29),o()),r&2){let a=m(2);s(),d("ngIf",a.accionesDisponibles.length===0&&!a.estadoFlujo.puedeCrearPresupuesto)}}function Vn(r,l){if(r&1){let a=P();e(0,"div",13)(1,"div",14)(2,"div",15)(3,"div",16),g(4,"ion-icon",17),e(5,"span",18),c(6),o()(),e(7,"button",19),u("click",function(){f(a);let n=m();return C(n.recargar())}),g(8,"ion-icon",12),o()()(),b(9,An,5,1,"div",20)(10,Tn,2,1,"div",21),o()}if(r&2){let a=m();s(3),d("ngClass",a.getEstadoClass()),s(),d("name",a.getEstadoIcon()),s(2),_(a.estadoFlujo.estadoActual),s(3),d("ngIf",a.accionesDisponibles.length>0),s(),d("ngIf",a.estadoFlujo.estadoActual==="No visitado"||a.estadoFlujo.estadoActual==="Visitado pendiente")}}var Lt=(()=>{let l=class l{constructor(t){this.flujoService=t,this.accionEjecutada=new Be,this.estadoFlujo=null,this.accionesDisponibles=[],this.loading=!1,this.error=null,this.destroy$=new B,z({documentTextOutline:N,checkmarkCircleOutline:W,timeOutline:J,receiptOutline:Tt,createOutline:he,eyeOutline:ye,arrowForwardOutline:Pt,warningOutline:je,refreshOutline:Y})}ngOnInit(){this.avisoId&&this.cargarEstadoFlujo()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarEstadoFlujo(){this.loading=!0,this.error=null,this.flujoService.obtenerEstadoFlujo(this.avisoId).pipe(E(this.destroy$)).subscribe({next:t=>{this.estadoFlujo=t,this.cargarAccionesDisponibles(),this.loading=!1},error:t=>{console.error("Error al cargar estado del flujo:",t),this.error="Error al cargar el estado del flujo",this.loading=!1}})}cargarAccionesDisponibles(){this.flujoService.obtenerAccionesDisponibles(this.avisoId).pipe(E(this.destroy$)).subscribe({next:t=>{this.accionesDisponibles=t},error:t=>{console.error("Error al cargar acciones:",t)}})}ejecutarAccion(t){var i,p,x,O,ae,q;this.loading=!0,this.error=null;let n;switch(t){case"crear_presupuesto":n=this.flujoService.ejecutarFlujoCompleto(this.avisoId,!0);break;case"aprobar_presupuesto":let S=(x=(p=(i=this.estadoFlujo)==null?void 0:i.resumen)==null?void 0:p.presupuesto)==null?void 0:x.id;S&&(n=this.flujoService.aprobarPresupuesto(S));break;case"facturar_presupuesto":let Ne=(q=(ae=(O=this.estadoFlujo)==null?void 0:O.resumen)==null?void 0:ae.presupuesto)==null?void 0:q.id;Ne&&(n=this.flujoService.facturarPresupuesto(Ne));break;case"facturar_trabajos":n=this.flujoService.facturarTrabajos(this.avisoId);break;case"completar_aviso":this.completarAviso();break;default:this.loading=!1;return}n&&n.pipe(E(this.destroy$)).subscribe({next:S=>{console.log("Acci\xF3n ejecutada:",S),this.accionEjecutada.emit(S),this.cargarEstadoFlujo(),this.loading=!1},error:S=>{console.error("Error al ejecutar acci\xF3n:",S),this.error=`Error al ejecutar ${t}: ${S.message}`,this.loading=!1}})}iniciarFlujoDirecto(){this.loading=!0,this.flujoService.ejecutarFlujoCompleto(this.avisoId,!1).pipe(E(this.destroy$)).subscribe({next:t=>{console.log("Flujo directo iniciado:",t),this.accionEjecutada.emit(t),this.cargarEstadoFlujo(),this.loading=!1},error:t=>{console.error("Error al iniciar flujo directo:",t),this.error=`Error al iniciar flujo directo: ${t.message}`,this.loading=!1}})}completarAviso(){if(!this.avisoId){console.error("No hay aviso seleccionado para completar");return}console.log("\u{1F504} Completando aviso:",this.avisoId),this.loading=!0,this.flujoService.completarAviso(this.avisoId).subscribe({next:t=>{console.log("\u2705 Aviso completado exitosamente:",t),this.loading=!1,this.mostrarMensaje("Aviso completado exitosamente","success"),this.cargarEstadoFlujo()},error:t=>{console.error("\u274C Error al completar aviso:",t),this.loading=!1,this.mostrarMensaje(t.message||"Error al completar el aviso. Verifica que haya trabajos realizados y facturas generadas.","error")}})}mostrarMensaje(t,n="info"){console.log(`[${n.toUpperCase()}] ${t}`)}getEstadoIcon(){if(!this.estadoFlujo)return"time-outline";switch(this.estadoFlujo.estadoActual){case"No visitado":return"time-outline";case"Visitado pendiente":return"eye-outline";case"Pendiente de presupuesto":return"document-text-outline";case"En curso":return"create-outline";case"Completado":return"checkmark-circle-outline";default:return"time-outline"}}getEstadoClass(){if(!this.estadoFlujo)return"pendiente";switch(this.estadoFlujo.estadoActual){case"No visitado":case"Visitado pendiente":return"pendiente";case"Pendiente de presupuesto":return"presupuesto";case"En curso":return"en-curso";case"Completado":return"completado";default:return"pendiente"}}getAccionTexto(t){switch(t){case"crear_presupuesto":return"Crear Presupuesto";case"aprobar_presupuesto":return"Aprobar Presupuesto";case"facturar_presupuesto":return"Generar Factura desde Presupuesto";case"facturar_trabajos":return"Facturar Trabajos Realizados";case"completar_aviso":return"Completar Aviso";default:return t}}getAccionIcon(t){switch(t){case"crear_presupuesto":return"document-text-outline";case"aprobar_presupuesto":return"checkmark-circle-outline";case"facturar_presupuesto":case"facturar_trabajos":return"receipt-outline";case"completar_aviso":return"checkmark-circle-outline";default:return"arrow-forward-outline"}}recargar(){this.cargarEstadoFlujo()}};l.\u0275fac=function(n){return new(n||l)(M(Se))},l.\u0275cmp=T({type:l,selectors:[["app-flujo-estado"]],inputs:{avisoId:"avisoId"},outputs:{accionEjecutada:"accionEjecutada"},decls:4,vars:3,consts:[[1,"flujo-estado-container"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","flujo-content",4,"ngIf"],[1,"loading-state"],["name","refresh-outline",1,"spinning"],[1,"desktop-only"],[1,"mobile-only"],[1,"error-state"],["name","warning-outline"],[1,"error-text"],[1,"btn-retry",3,"click"],["name","refresh-outline"],[1,"flujo-content"],[1,"estado-actual"],[1,"estado-header"],[1,"estado-badge",3,"ngClass"],[3,"name"],[1,"estado-text"],["title","Actualizar estado",1,"btn-refresh",3,"click"],["class","acciones-disponibles",4,"ngIf"],["class","flujo-inicial",4,"ngIf"],[1,"acciones-disponibles"],[1,"section-title"],[1,"acciones-grid"],["class","btn-accion",3,"disabled","title","click",4,"ngFor","ngForOf"],[1,"btn-accion",3,"click","disabled","title"],[1,"accion-text"],[1,"flujo-inicial"],["class","sin-acciones",4,"ngIf"],[1,"sin-acciones"],["name","checkmark-circle-outline",1,"complete-icon"],[1,"complete-text"]],template:function(n,i){n&1&&(e(0,"div",0),b(1,zn,6,0,"div",1)(2,Sn,10,1,"div",2)(3,Vn,11,5,"div",3),o()),n&2&&(s(),d("ngIf",i.loading),s(),d("ngIf",i.error&&!i.loading),s(),d("ngIf",i.estadoFlujo&&!i.loading&&!i.error))},dependencies:[$,Ge,R,D,G],styles:[".flujo-estado-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;border:1px solid #E2E8F0;overflow:hidden;box-shadow:0 1px 3px #0000001a}.desktop-only[_ngcontent-%COMP%]{display:inline}.mobile-only[_ngcontent-%COMP%]{display:none}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;padding:24px;text-align:center;color:#64748b;font-size:14px}.loading-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#4f46e5}.loading-state.error-state[_ngcontent-%COMP%], .error-state.error-state[_ngcontent-%COMP%]{color:#dc2626}.loading-state.error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state.error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#dc2626}.error-text[_ngcontent-%COMP%]{word-break:break-word;line-height:1.4}.btn-retry[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:#f1f5f9;border:1px solid #CBD5E1;border-radius:8px;font-size:12px;color:#475569;cursor:pointer;transition:all .2s ease}.btn-retry[_ngcontent-%COMP%]:hover{background:#e2e8f0;border-color:#94a3b8}.btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.flujo-content[_ngcontent-%COMP%]{padding:20px}.estado-actual[_ngcontent-%COMP%]{margin-bottom:24px}.estado-actual[_ngcontent-%COMP%]   .estado-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;border-radius:20px;font-size:14px;font-weight:500}.estado-actual[_ngcontent-%COMP%]   .estado-badge.pendiente[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.estado-actual[_ngcontent-%COMP%]   .estado-badge.pendiente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#d97706}.estado-actual[_ngcontent-%COMP%]   .estado-badge.presupuesto[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.estado-actual[_ngcontent-%COMP%]   .estado-badge.presupuesto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#3b82f6}.estado-actual[_ngcontent-%COMP%]   .estado-badge.en-curso[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.estado-actual[_ngcontent-%COMP%]   .estado-badge.en-curso[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#22c55e}.estado-actual[_ngcontent-%COMP%]   .estado-badge.completado[_ngcontent-%COMP%]{background:#ecfdf5;color:#14532d}.estado-actual[_ngcontent-%COMP%]   .estado-badge.completado[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#10b981}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.estado-actual[_ngcontent-%COMP%]   .estado-text[_ngcontent-%COMP%]{font-weight:500}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:#f8fafc;border:1px solid #E2E8F0;border-radius:8px;cursor:pointer;transition:all .2s ease}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;color:#64748b}.resumen-info[_ngcontent-%COMP%]{background:#f8fafc;border-radius:8px;padding:16px}.resumen-info[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:13px;color:#64748b;font-weight:500}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:13px;color:#1e293b;font-weight:600}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value.si[_ngcontent-%COMP%]{color:#059669}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value.no[_ngcontent-%COMP%]{color:#dc2626}.acciones-disponibles[_ngcontent-%COMP%]{margin-bottom:24px}.acciones-disponibles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0 0 12px;font-size:16px;color:#1e293b;font-weight:600}.acciones-disponibles[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:12px 16px;background:#4f46e5;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;text-align:left}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]:hover:not(:disabled){background:#4338ca;transform:translateY(-1px);box-shadow:0 4px 8px #4f46e54d}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;flex-shrink:0}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   .accion-text[_ngcontent-%COMP%]{flex:1}.flujo-inicial[_ngcontent-%COMP%]{margin-bottom:24px}.flujo-inicial[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;color:#1e293b;font-weight:600}.flujo-inicial[_ngcontent-%COMP%]   .flujo-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:20px;background:#f8fafc;border:1px solid #E2E8F0;border-radius:12px;transition:all .2s ease}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]:hover{background:#f0f9ff;border-color:#4f46e5;transform:translateY(-1px);box-shadow:0 4px 12px #0000001a}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:28px;color:#4f46e5;flex-shrink:0;background:#eef2ff;padding:12px;border-radius:50%}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;flex:1}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1e293b}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-description[_ngcontent-%COMP%]{font-size:14px;color:#64748b;line-height:1.4}.sin-acciones[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;padding:20px;color:#64748b;font-size:14px;text-align:center}.sin-acciones[_ngcontent-%COMP%]   .complete-icon[_ngcontent-%COMP%]{font-size:20px;color:#10b981}.sin-acciones[_ngcontent-%COMP%]   .complete-text[_ngcontent-%COMP%]{font-weight:500}@media (max-width: 768px){.desktop-only[_ngcontent-%COMP%]{display:none}.mobile-only[_ngcontent-%COMP%]{display:inline}.flujo-content[_ngcontent-%COMP%]{padding:16px}.estado-actual[_ngcontent-%COMP%]{margin-bottom:20px}.estado-actual[_ngcontent-%COMP%]   .estado-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;margin-bottom:12px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{width:28px;height:28px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.resumen-info[_ngcontent-%COMP%]{padding:12px}.resumen-info[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:12px}.acciones-disponibles[_ngcontent-%COMP%]{margin-bottom:20px}.acciones-disponibles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:15px;margin-bottom:10px}.acciones-disponibles[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{padding:10px 12px;font-size:13px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.flujo-inicial[_ngcontent-%COMP%]{margin-bottom:20px}.flujo-inicial[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:15px;margin-bottom:10px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-info[_ngcontent-%COMP%]{gap:12px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]{padding:16px;gap:12px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;padding:10px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:14px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-description[_ngcontent-%COMP%]{font-size:12px}.sin-acciones[_ngcontent-%COMP%]{padding:16px}.sin-acciones[_ngcontent-%COMP%]   .complete-icon[_ngcontent-%COMP%]{font-size:18px}.sin-acciones[_ngcontent-%COMP%]   .complete-text[_ngcontent-%COMP%]{font-size:13px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{padding:20px;font-size:13px}.loading-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.btn-retry[_ngcontent-%COMP%]{padding:6px 12px;font-size:11px}.btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}}@media (max-width: 480px){.flujo-content[_ngcontent-%COMP%]{padding:12px}.estado-actual[_ngcontent-%COMP%]{margin-bottom:16px}.estado-actual[_ngcontent-%COMP%]   .estado-header[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between;gap:8px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{justify-content:center;padding:4px 10px;font-size:12px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{align-self:center;width:24px;height:24px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.resumen-info[_ngcontent-%COMP%]{padding:10px}.resumen-info[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{gap:6px}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:11px}.acciones-disponibles[_ngcontent-%COMP%]{margin-bottom:16px}.acciones-disponibles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:14px;margin-bottom:8px}.acciones-disponibles[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{gap:6px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{padding:8px 10px;font-size:12px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.flujo-inicial[_ngcontent-%COMP%]{margin-bottom:16px}.flujo-inicial[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:14px;margin-bottom:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-info[_ngcontent-%COMP%]{gap:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]{padding:12px;gap:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;padding:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:13px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-description[_ngcontent-%COMP%]{font-size:11px}.sin-acciones[_ngcontent-%COMP%]{padding:12px;gap:8px}.sin-acciones[_ngcontent-%COMP%]   .complete-icon[_ngcontent-%COMP%]{font-size:16px}.sin-acciones[_ngcontent-%COMP%]   .complete-text[_ngcontent-%COMP%]{font-size:12px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{padding:16px;font-size:12px;gap:8px}.loading-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.btn-retry[_ngcontent-%COMP%]{padding:4px 8px;font-size:10px}.btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:10px}}"]});let r=l;return r})();var Rn=["fileInput"];function Dn(r,l){r&1&&(e(0,"div",30)(1,"div",31),g(2,"ion-icon",32),e(3,"p"),c(4,"Cargando aviso..."),o()()())}function $n(r,l){if(r&1){let a=P();e(0,"div",33)(1,"div",34),g(2,"ion-icon",35),e(3,"p"),c(4),o(),e(5,"button",36),u("click",function(){f(a);let n=m();return C(n.cargarAviso())}),g(6,"ion-icon",37),c(7," Reintentar "),o()()()}if(r&2){let a=m();s(4),_(a.error)}}function Nn(r,l){if(r&1){let a=P();e(0,"button",65),u("click",function(){f(a);let n=m(2);return C(n.completarAviso())}),g(1,"ion-icon",66),e(2,"span",16),c(3,"Completar Aviso"),o(),e(4,"span",17),c(5,"Completar"),o()()}}function Hn(r,l){if(r&1){let a=P();e(0,"button",14),u("click",function(){f(a);let n=m(2);return C(n.editarAviso())}),g(1,"ion-icon",67),e(2,"span",16),c(3,"Editar aviso"),o(),e(4,"span",17),c(5,"Editar"),o()()}}function qn(r,l){r&1&&(e(0,"div",68),g(1,"ion-icon",69),e(2,"span"),c(3,"Aviso completado"),o()())}function Bn(r,l){if(r&1&&(e(0,"div",70),g(1,"ion-icon",71),e(2,"span"),c(3),o()()),r&2){let a=m(2);s(3),_(a.aviso.nombre_contacto)}}function Ln(r,l){if(r&1&&(e(0,"div",72),g(1,"ion-icon",73),e(2,"span"),c(3),o()()),r&2){let a=m(2);s(3),_(a.aviso.telefono_cliente_aviso)}}function Un(r,l){if(r&1&&(e(0,"div",72),g(1,"ion-icon",74),e(2,"span"),c(3),o()()),r&2){let a=m(2);s(3),_(a.aviso.cliente==null?null:a.aviso.cliente.email)}}function Gn(r,l){if(r&1){let a=P();e(0,"div",4)(1,"div",11)(2,"div",38)(3,"div",39)(4,"button",40),u("click",function(){f(a);let n=m();return C(n.volverALista())}),g(5,"ion-icon",41),e(6,"span",16),c(7,"Volver"),o(),e(8,"span",17),c(9,"Volver"),o()()()(),e(10,"div",42),b(11,Nn,6,0,"button",43)(12,Hn,6,0,"button",44)(13,qn,4,0,"div",45),o(),e(14,"span",46),c(15),o()(),e(16,"h2",47)(17,"span",16),c(18),o()(),e(19,"div",48)(20,"div",49)(21,"div",8)(22,"label"),c(23,"Estado"),o(),e(24,"span",50),c(25),o()(),e(26,"div",8)(27,"label"),c(28,"Urgente"),o(),e(29,"span",51),c(30),o()(),e(31,"div",8)(32,"label"),c(33,"Fecha de creaci\xF3n"),o(),e(34,"span"),c(35),h(36,"date"),o()()(),e(37,"div",52)(38,"label"),c(39,"Cliente"),o(),e(40,"div",53)(41,"span",54),c(42),o(),e(43,"a",55),u("click",function(){f(a);let n=m();return C(n.verCliente())}),e(44,"span",16),c(45,"Ver cliente"),o()()()(),e(46,"div",56)(47,"label"),c(48,"Direcci\xF3n"),o(),e(49,"div",57)(50,"span",58),c(51),o(),e(52,"button",59),u("click",function(){f(a);let n=m();return C(n.verMapa())}),g(53,"ion-icon",60),o()()(),e(54,"div",61)(55,"label"),c(56,"Contacto Cliente"),o(),e(57,"div",62),b(58,Bn,4,1,"div",63)(59,Ln,4,1,"div",64)(60,Un,4,1,"div",64),o()()()()}if(r&2){let a=m();s(11),d("ngIf",(a.aviso==null?null:a.aviso.estado)!=="Completado"),s(),d("ngIf",(a.aviso==null?null:a.aviso.estado)!=="Completado"),s(),d("ngIf",(a.aviso==null?null:a.aviso.estado)==="Completado"),s(2),v("Aviso #",a.aviso.id==null?null:a.aviso.id.substring(0,8),""),s(3),v("Informaci\xF3n general del Aviso - #",a.aviso.id==null?null:a.aviso.id.substring(0,8),""),s(7),_(a.aviso.estado),s(4),H("urgent",a.aviso.urgencia==="Alta"||a.aviso.es_urgente),s(),v(" ",a.aviso.urgencia==="Alta"||a.aviso.es_urgente?"S\xED":"No"," "),s(5),_(L(36,15,a.aviso.fecha_creacion,"dd/MM/yyyy")),s(7),_(a.aviso.nombre_cliente_aviso),s(9),_(a.aviso.direccion_cliente_aviso),s(7),d("ngIf",a.aviso.nombre_contacto),s(),d("ngIf",a.aviso.telefono_cliente_aviso),s(),d("ngIf",a.aviso.cliente==null?null:a.aviso.cliente.email)}}function Wn(r,l){if(r&1){let a=P();e(0,"div",75)(1,"div",76)(2,"app-flujo-estado",77),u("accionEjecutada",function(n){f(a);let i=m();return C(i.onAccionFlujoEjecutada(n))}),o()()()}if(r&2){let a=m();s(2),d("avisoId",(a.aviso==null?null:a.aviso.id)||"")}}function Qn(r,l){r&1&&(e(0,"div",30)(1,"div",31),g(2,"ion-icon",32),e(3,"p"),c(4,"Cargando trabajos..."),o()()())}function Yn(r,l){r&1&&(e(0,"div",78)(1,"div",79),g(2,"ion-icon",80),e(3,"p"),c(4,"No hay trabajos realizados para este aviso"),o(),e(5,"small"),c(6,"Crea el primer parte de trabajo para comenzar"),o()()())}function Jn(r,l){if(r&1&&(e(0,"li"),c(1),o()),r&2){let a=l.$implicit;s(),_(a)}}function Kn(r,l){if(r&1&&(e(0,"ul",100),b(1,Jn,2,1,"li",82),o()),r&2){let a=m().$implicit;s(),d("ngForOf",a.repuestos)}}function Xn(r,l){r&1&&(e(0,"span",101),c(1," Sin materiales "),o())}function Zn(r,l){if(r&1){let a=P();e(0,"button",102),u("click",function(){f(a);let n=m().$implicit,i=m(2);return C(i.hacerAlbaran(n))}),g(1,"ion-icon",103),e(2,"span",16),c(3,"Crear Albar\xE1n"),o(),e(4,"span",17),c(5,"Albar\xE1n"),o()()}}function eo(r,l){if(r&1&&(e(0,"div",104)(1,"span",105),g(2,"ion-icon",69),c(3," Albar\xE1n Cerrado "),o(),e(4,"small",106),c(5),o()()),r&2){let a=m().$implicit,t=m(2);s(),Z("badge-"+t.getAlbaranEstado(a)),s(4),v(" ",t.getAlbaranEstado(a)," ")}}function to(r,l){if(r&1){let a=P();e(0,"button",107),u("click",function(){f(a);let n=m().$implicit,i=m(2);return C(i.editarTrabajo(n))}),g(1,"ion-icon",67),e(2,"span",16),c(3,"Editar"),o(),e(4,"span",17),c(5,"Editar"),o()()}}function no(r,l){if(r&1){let a=P();e(0,"button",108),u("click",function(){f(a);let n=m().$implicit,i=m(2);return C(i.eliminarTrabajo(n))}),g(1,"ion-icon",109),e(2,"span",16),c(3,"Eliminar"),o(),e(4,"span",17),c(5,"Eliminar"),o()()}}function oo(r,l){if(r&1&&(e(0,"tr")(1,"td",83),c(2),o(),e(3,"td",84),c(4),h(5,"date"),o(),e(6,"td",85),c(7),h(8,"number"),o(),e(9,"td",86)(10,"div",87)(11,"p"),c(12),o(),e(13,"small"),c(14),o()()(),e(15,"td",88)(16,"div",89),b(17,Kn,2,1,"ul",90)(18,Xn,2,0,"span",91),o()(),e(19,"td",92)(20,"span",93),c(21),o()(),e(22,"td",94)(23,"div",95),b(24,Zn,6,0,"button",96)(25,eo,6,3,"div",97)(26,to,6,0,"button",98)(27,no,6,0,"button",99),o()()()),r&2){let a=l.$implicit,t=l.index,n=m(2);s(2),v("#",t+1,""),s(2),_(L(5,15,a.fecha_trabajo,"dd/MM/yyyy")),s(3),v("",L(8,18,n.calcularHorasTrabajo(a),"1.1-1"),"h"),s(5),_(a.descripcion),s(2),V("",a.hora_inicio," - ",a.hora_fin,""),s(3),d("ngIf",a.repuestos&&a.repuestos.length>0),s(),d("ngIf",!a.repuestos||a.repuestos.length===0),s(2),Z("badge-"+a.estado.toLowerCase().replace(" ","-")),s(),v(" ",a.estado," "),s(3),d("ngIf",a.estado==="En curso"||a.estado==="Abierto"),s(),d("ngIf",a.albaran_id),s(),d("ngIf",a.estado!=="Cerrado"&&a.estado!=="Finalizado"),s(),d("ngIf",a.estado!=="Cerrado"&&a.estado!=="Finalizado")}}function io(r,l){if(r&1&&(e(0,"table",81)(1,"thead")(2,"tr")(3,"th"),c(4,"N\xFAmero"),o(),e(5,"th"),c(6,"Fecha trabajo"),o(),e(7,"th"),c(8,"Horas"),o(),e(9,"th"),c(10,"Descripci\xF3n"),o(),e(11,"th"),c(12,"Materiales"),o(),e(13,"th"),c(14,"Estado"),o(),e(15,"th"),c(16,"Acciones"),o()()(),e(17,"tbody"),b(18,oo,28,21,"tr",82),o()()),r&2){let a=m();s(18),d("ngForOf",a.trabajosRealizados)}}function ao(r,l){if(r&1&&(e(0,"div",118)(1,"label"),c(2,"Presupuesto:"),o(),e(3,"span"),c(4),h(5,"currency"),o()()),r&2){let a=m().$implicit;s(4),_(k(5,1,a.presupuesto_necesario,"EUR","symbol","1.2-2"))}}function ro(r,l){if(r&1&&(e(0,"span",125),c(1),o()),r&2){let a=l.$implicit;s(),v(" ",a," ")}}function co(r,l){if(r&1&&(e(0,"div",120)(1,"label"),c(2,"Repuestos utilizados:"),o(),e(3,"div",123),b(4,ro,2,1,"span",124),o()()),r&2){let a=m().$implicit;s(4),d("ngForOf",a.repuestos_utilizados)}}function so(r,l){if(r&1&&(e(0,"div",118)(1,"label"),c(2,"DNI Cliente:"),o(),e(3,"span"),c(4),o()()),r&2){let a=m(2).$implicit;s(4),_(a.dni_cliente)}}function lo(r,l){if(r&1&&(e(0,"div",118)(1,"label"),c(2,"Firmado por:"),o(),e(3,"span"),c(4),o()()),r&2){let a=m(2).$implicit;s(4),_(a.nombre_firma)}}function po(r,l){if(r&1&&(e(0,"div",117),b(1,so,5,1,"div",119)(2,lo,5,1,"div",119),o()),r&2){let a=m().$implicit;s(),d("ngIf",a.dni_cliente),s(),d("ngIf",a.nombre_firma)}}function go(r,l){if(r&1&&(e(0,"div",120)(1,"label"),c(2,"Observaciones:"),o(),e(3,"p"),c(4),o()()),r&2){let a=m().$implicit;s(4),_(a.observaciones)}}function mo(r,l){if(r&1&&(e(0,"div",113)(1,"div",114)(2,"div",104)(3,"h4"),c(4),o(),e(5,"span",115),c(6),h(7,"date"),o()(),e(8,"div",116)(9,"span",93),c(10),o()()(),e(11,"div",106)(12,"div",117)(13,"div",118)(14,"label"),c(15,"Horario:"),o(),e(16,"span"),c(17),o()(),b(18,ao,6,6,"div",119),o(),e(19,"div",120)(20,"label"),c(21,"Descripci\xF3n del trabajo:"),o(),e(22,"p"),c(23),o()(),b(24,co,5,1,"div",121)(25,po,3,2,"div",122)(26,go,5,1,"div",121),o()()),r&2){let a=l.$implicit,t=l.index;s(4),v("Albar\xE1n #",t+1,""),s(2),_(L(7,12,a.fecha_cierre,"dd/MM/yyyy")),s(3),Z("badge-"+a.estado_cierre.toLowerCase().replace(" ","-")),s(),v(" ",a.estado_cierre," "),s(7),V("",a.hora_entrada," - ",a.hora_salida,""),s(),d("ngIf",a.presupuesto_necesario>0),s(5),_(a.descripcion_trabajo_realizado),s(),d("ngIf",a.repuestos_utilizados&&a.repuestos_utilizados.length>0),s(),d("ngIf",a.dni_cliente||a.nombre_firma),s(),d("ngIf",a.observaciones)}}function _o(r,l){if(r&1&&(e(0,"div",4)(1,"div",11)(2,"h2"),c(3,"Albaranes Cerrados"),o(),e(4,"div",42)(5,"span",110),c(6),o()()(),e(7,"div",111),b(8,mo,27,15,"div",112),o()()),r&2){let a=m();s(6),v("Total: ",a.aviso.albaranes.length,""),s(2),d("ngForOf",a.aviso.albaranes)}}function uo(r,l){r&1&&(e(0,"div",126),g(1,"ion-icon",32),e(2,"p"),c(3,"Subiendo im\xE1genes..."),o()())}function fo(r,l){r&1&&(e(0,"div",127),g(1,"ion-icon",128),e(2,"p"),c(3,"No hay im\xE1genes disponibles para este aviso"),o()())}function Co(r,l){if(r&1){let a=P();e(0,"div",129),g(1,"img",130),e(2,"div",131)(3,"span",132),c(4),o(),e(5,"span",133),c(6),h(7,"date"),o()(),e(8,"button",134),u("click",function(){let n=f(a).$implicit,i=m();return C(i.eliminarFoto(n))}),g(9,"ion-icon",109),o()()}if(r&2){let a=l.$implicit;s(),d("src",a.url,se)("alt",a.descripcion||"Imagen del aviso"),s(3),_(a.descripcion||"Imagen del aviso"),s(2),_(L(7,4,a.fecha_subida,"dd/MM/yyyy HH:mm"))}}z({close:oe,pencilOutline:ie,navigate:Re,person:De,call:Fe,mail:Te,mapOutline:Ve,arrowBackOutline:Ae});var ii=(()=>{let l=class l{constructor(t,n,i,p,x,O){this.route=t,this.router=n,this.avisosService=i,this.trabajosService=p,this.modalController=x,this.flujoAvisosService=O,this.vistaGaleria="grid",this.aviso=null,this.loading=!1,this.error=null,this.subiendoImagenes=!1,this.destroy$=new B,this.trabajosRealizados=[],this.loadingTrabajos=!1,z({refreshOutline:Y,alertCircleOutline:xt,arrowBackOutline:Ae,close:oe,pencilOutline:ie,navigate:Re,person:De,call:Fe,mail:Te,addCircle:ft,constructOutline:yt,documentTextOutline:N,checkmarkCircleOutline:W,trashOutline:K,imagesOutline:St,personOutline:Q,gridOutline:zt,listOutline:At,chevronDownOutline:ve,eyeOutline:ye,ellipsisVerticalOutline:kt,ellipsisVertical:jt,add:ut,mapOutline:Ve})}ngOnInit(){this.cargarAviso()}cargarTrabajos(){var t;(t=this.aviso)!=null&&t.id&&(this.loadingTrabajos=!0,this.trabajosService.getTrabajosAviso(this.aviso.id).pipe(E(this.destroy$)).subscribe({next:n=>{this.trabajosRealizados=n.trabajos,this.loadingTrabajos=!1},error:n=>{console.error("Error al cargar trabajos:",n),this.loadingTrabajos=!1}}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarAviso(){this.loading=!0,this.error=null,this.route.params.pipe(E(this.destroy$)).subscribe(t=>{let n=t["id-aviso"];n?this.avisosService.getAviso(n).pipe(E(this.destroy$)).subscribe({next:i=>{this.aviso=i,this.loading=!1,this.cargarTrabajos()},error:i=>{console.error("Error al cargar el aviso:",i),this.error="Error al cargar el aviso. Por favor, int\xE9ntalo de nuevo.",this.loading=!1}}):(this.error="ID de aviso no v\xE1lido",this.loading=!1)})}cambiarVistaGaleria(t){this.vistaGaleria=t.detail.value}volverALista(){let t=document.referrer;t&&t.includes("/historial")?this.router.navigate(["/historial"]):this.router.navigate(["/avisos"])}verCliente(){var t,n;(n=(t=this.aviso)==null?void 0:t.cliente)!=null&&n.id&&console.log("Navegar al cliente:",this.aviso.cliente.id)}verMapa(){var t;if((t=this.aviso)!=null&&t.direccion_cliente_aviso){let n=encodeURIComponent(this.aviso.direccion_cliente_aviso);window.open(`https://www.google.com/maps/search/?api=1&query=${n}`,"_blank")}}editarAviso(){var t;(t=this.aviso)!=null&&t.id&&this.abrirModalEditarAviso()}abrirModalEditarAviso(){return w(this,null,function*(){var p;if(!((p=this.aviso)!=null&&p.id))return;let t=yield this.modalController.create({component:$t,cssClass:"modal-crear-aviso",componentProps:{modoEdicion:!0,avisoExistente:this.aviso}});yield t.present();let{data:n,role:i}=yield t.onWillDismiss();if(i==="confirm"&&n)try{console.log("Datos del formulario de edici\xF3n:",n);let x={tipo:n.tipo,nombre_cliente_aviso:n.nombreContacto,direccion_cliente_aviso:n.direccionLocal,telefono_cliente_aviso:n.telefono,nombre_contacto:n.nombreContacto,descripcion_problema:n.descripcion,es_urgente:n.esUrgente,urgencia:n.esUrgente?"Alta":"Normal"};this.loading=!0,this.avisosService.actualizarAviso(this.aviso.id,x).pipe(E(this.destroy$)).subscribe({next:O=>{console.log("Aviso actualizado exitosamente:",O),this.loading=!1,this.mostrarMensaje("Aviso actualizado exitosamente","success"),this.cargarAviso()},error:O=>{console.error("Error al actualizar aviso:",O),this.loading=!1,this.mostrarMensaje(O.message||"Error al actualizar el aviso. Por favor, int\xE9ntalo de nuevo.","error")}})}catch(x){console.error("Error al procesar la edici\xF3n:",x),this.mostrarMensaje("Error al procesar la edici\xF3n. Por favor, int\xE9ntalo de nuevo.","error")}})}cerrarAlbaran(){var t;(t=this.aviso)!=null&&t.id&&console.log("Cerrar albar\xE1n para aviso:",this.aviso.id)}seleccionarImagenes(){this.fileInput&&this.fileInput.nativeElement.click()}onFileSelected(t){var i;let n=t.target.files;n.length>0&&((i=this.aviso)!=null&&i.id)&&this.subirImagenes(Array.from(n)),t.target.value=""}subirImagenes(t){return w(this,null,function*(){var n;if(!((n=this.aviso)!=null&&n.id)){console.error("No se puede subir im\xE1genes: aviso no v\xE1lido");return}this.subiendoImagenes=!0,this.error=null;try{yield new Promise(p=>{let x=0,O=t.length;t.forEach(ae=>{this.avisosService.subirFoto(this.aviso.id,ae).pipe(E(this.destroy$)).subscribe({next:q=>{console.log("Foto subida:",q),x++,x===O&&p()},error:q=>{console.error("Error al subir foto:",q),x++,x===O&&p()}})})}),this.cargarAviso()}catch(i){console.error("Error al subir im\xE1genes:",i),this.error="Error al subir las im\xE1genes. Por favor, int\xE9ntalo de nuevo."}finally{this.subiendoImagenes=!1}})}crearTrabajoRealizado(t){return w(this,null,function*(){var x;if(!((x=this.aviso)!=null&&x.id))return;let n=yield this.modalController.create({component:Ht,componentProps:{avisoId:this.aviso.id,trabajoExistente:t},cssClass:"modal-crear-trabajo"});yield n.present();let{data:i,role:p}=yield n.onWillDismiss();if(p==="confirm"&&i)try{if(t){let O=yield j(this.trabajosService.actualizarTrabajo(t.id,i));console.log("Trabajo actualizado exitosamente:",O),alert("Trabajo actualizado exitosamente.")}else{let O=yield j(this.trabajosService.crearTrabajo(i));console.log("Trabajo creado exitosamente:",O),alert("Trabajo creado exitosamente. Los materiales han sido descontados del inventario.")}this.cargarTrabajos()}catch(O){console.error("Error al procesar trabajo:",O),alert("Error al procesar el trabajo. Por favor, int\xE9ntalo de nuevo.")}})}editarTrabajo(t){return w(this,null,function*(){try{let n=yield j(this.trabajosService.getTrabajo(t.id));yield this.crearTrabajoRealizado(n.trabajo)}catch(n){console.error("Error al cargar el trabajo para editar:",n),alert("Error al cargar el trabajo para editar. Por favor, int\xE9ntalo de nuevo.")}})}eliminarTrabajo(t){return w(this,null,function*(){if(confirm(`\xBFEst\xE1s seguro de que quieres eliminar este trabajo?

Fecha: ${t.fecha_trabajo}
Descripci\xF3n: ${t.descripcion}

Esta acci\xF3n no se puede deshacer y los materiales ser\xE1n devueltos al inventario.`))try{yield j(this.trabajosService.eliminarTrabajo(t.id)),console.log("Trabajo eliminado exitosamente"),alert("Trabajo eliminado exitosamente. Los materiales han sido devueltos al inventario."),this.cargarTrabajos()}catch(i){console.error("Error al eliminar el trabajo:",i),alert("Error al eliminar el trabajo. Por favor, int\xE9ntalo de nuevo.")}})}hacerAlbaran(t){return w(this,null,function*(){var x;if(console.log("Abriendo modal de hacer albar\xE1n para trabajo:",t),!((x=this.aviso)!=null&&x.id))return;let n=yield this.modalController.create({component:Bt,componentProps:{trabajo:t,aviso:this.aviso},cssClass:"modal-hacer-albaran modal-fullscreen",backdropDismiss:!1});console.log("Modal creado:",n),console.log("Presentando modal..."),yield n.present(),console.log("Modal presentado");let{data:i,role:p}=yield n.onWillDismiss();if(p==="confirm"&&(i!=null&&i.success))try{console.log("Albar\xE1n creado exitosamente:",i.albaran),console.log("Trabajo actualizado:",i.trabajo),console.log("Aviso actualizado:",i.aviso),alert(i.mensaje||"Albar\xE1n creado exitosamente"),this.cargarTrabajos(),i.aviso&&(this.aviso=i.aviso),i.albaran.estado_cierre==="Finalizado"&&console.log("Trabajo finalizado, listo para facturar"),i.albaran.estado_cierre==="Presupuesto pendiente"&&console.log("Presupuesto pendiente, se puede crear presupuesto"),i.albaran.estado_cierre==="Otra visita"&&console.log("Otra visita requerida")}catch(O){console.error("Error al procesar albar\xE1n:",O),alert("Error al procesar el albar\xE1n. Por favor, int\xE9ntalo de nuevo.")}})}realizarOtraVisita(t){console.log("Realizar otra visita para el trabajo:",t)}eliminarFoto(t){return w(this,null,function*(){var i;if(!((i=this.aviso)!=null&&i.id)||!(t!=null&&t.id)){console.error("No se puede eliminar la foto: faltan datos");return}if(confirm(`\xBFEst\xE1s seguro de que quieres eliminar esta imagen?

Esta acci\xF3n no se puede deshacer.`))try{yield j(this.avisosService.eliminarFoto(t.id)),console.log("Foto eliminada exitosamente"),this.cargarAviso()}catch(p){console.error("Error al eliminar la foto:",p),alert("Error al eliminar la imagen. Por favor, int\xE9ntalo de nuevo.")}})}calcularHorasTrabajo(t){let n=new Date(`2000-01-01T${t.hora_inicio}`),p=(new Date(`2000-01-01T${t.hora_fin}`).getTime()-n.getTime())/(1e3*60*60);return Math.max(0,p)}getAlbaranEstado(t){var i;if(!t.albaran_id||!((i=this.aviso)!=null&&i.albaranes))return"pendiente";let n=this.aviso.albaranes.find(p=>p.id===t.albaran_id);return n?n.estado_cierre.toLowerCase().replace(/ /g,"-"):"pendiente"}getEstadoClass(t){return t?"badge-"+t.toLowerCase().replace(/ /g,"-"):"badge-pendiente"}onAccionFlujoEjecutada(t){console.log("Acci\xF3n de flujo ejecutada:",t),this.cargarAviso(),t.mensaje&&(console.log("Mensaje de \xE9xito:",t.mensaje),alert(t.mensaje)),t.facturaId&&confirm("Se ha generado una factura. \xBFDeseas ver la factura creada?")&&this.router.navigate(["/facturas",t.facturaId])}completarAviso(){var t;(t=this.aviso)!=null&&t.id?(console.log("\u{1F504} Completando aviso:",this.aviso.id),confirm("\xBFEst\xE1s seguro de que quieres marcar este aviso como completado? Esta acci\xF3n no se puede deshacer.")&&(this.loading=!0,this.flujoAvisosService.completarAviso(this.aviso.id).subscribe({next:n=>{console.log("\u2705 Aviso completado exitosamente:",n),this.loading=!1,this.mostrarMensaje("Aviso completado exitosamente","success"),this.cargarAviso()},error:n=>{console.error("\u274C Error al completar aviso:",n),this.loading=!1,this.mostrarMensaje(n.message||"Error al completar el aviso. Verifica que haya trabajos realizados y facturas generadas.","error")}}))):(console.error("No hay aviso seleccionado para completar"),this.mostrarMensaje("No hay aviso seleccionado para completar","error"))}mostrarMensaje(t,n="info"){console.log(`[${n.toUpperCase()}] ${t}`),n==="error"&&alert(t)}};l.\u0275fac=function(n){return new(n||l)(M(Ye),M(Je),M(ke),M(X),M(Pe),M(Se))},l.\u0275cmp=T({type:l,selectors:[["app-ver-avisos"]],viewQuery:function(n,i){if(n&1&&le(Rn,5),n&2){let p;de(p=pe())&&(i.fileInput=p.first)}},decls:57,vars:19,consts:[["fileInput",""],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","info-card",4,"ngIf"],[1,"info-card"],[1,"card-header",2,"justify-content","space-between!important"],[1,"badge-estado-aviso"],[1,"descripcion-content"],[1,"info-item"],[1,"tipo-aviso"],[1,"descripcion-texto"],[1,"card-header"],[2,"text-wrap","nowrap"],[1,"header-actions-jobs"],[1,"btn-primary",3,"click"],["name","add-circle"],[1,"desktop-only"],[1,"mobile-only"],["class","flujo-section",4,"ngIf"],[1,"section-divider"],[1,"table-container"],["class","no-trabajos",4,"ngIf"],["class","custom-mat-table",4,"ngIf"],[1,"gallery-actions"],[1,"btn-primary",3,"click","disabled"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"gallery-items"],["class","uploading-indicator",4,"ngIf"],["class","no-images",4,"ngIf"],["class","gallery-item",4,"ngFor","ngForOf"],[1,"loading-state"],[1,"loading-spinner"],["name","refresh-outline",1,"spinning"],[1,"error-state"],[1,"error-message"],["name","alert-circle-outline"],[1,"btn-retry",3,"click"],["name","refresh-outline"],[1,"header-container"],[1,"back-button"],[1,"btn-back",3,"click"],["name","arrow-back-outline"],[1,"header-actions"],["class","btn-secondary",3,"click",4,"ngIf"],["class","btn-primary",3,"click",4,"ngIf"],["class","aviso-completado-message",4,"ngIf"],[1,"mobile-only","title"],[1,"title"],[1,"info-grid"],[1,"info-row"],[1,"estado-pendiente"],[1,"urgent-badge"],[1,"info-item","cliente-section"],[1,"cliente-info"],[1,"cliente-nombre"],[1,"ver-cliente",3,"click"],[1,"info-item","direccion-section"],[1,"direccion-info"],[1,"direccion-texto"],["title","Ver en mapa",1,"btn-map",3,"click"],["name","navigate"],[1,"contacto-section"],[1,"contacto-items"],["class","contacto-item nombre-contacto",4,"ngIf"],["class","contacto-item",4,"ngIf"],[1,"btn-secondary",3,"click"],["name","close"],["name","pencil-outline"],[1,"aviso-completado-message"],["name","checkmark-circle-outline"],[1,"contacto-item","nombre-contacto"],["name","person"],[1,"contacto-item"],["name","call"],["name","mail"],[1,"flujo-section"],[1,"flujo-container"],[3,"accionEjecutada","avisoId"],[1,"no-trabajos"],[1,"empty-state"],["name","construct-outline"],[1,"custom-mat-table"],[4,"ngFor","ngForOf"],["data-label","N\xFAmero"],["data-label","Fecha trabajo"],["data-label","Horas"],["data-label","Descripci\xF3n"],[1,"descripcion-trabajo"],["data-label","Materiales"],[1,"materiales-info"],["class","repuestos-list",4,"ngIf"],["class","no-repuestos",4,"ngIf"],["data-label","Estado"],[1,"badge-estado"],["data-label","Acciones"],[1,"estado-actions"],["class","btn-primary btn-small","title","Hacer albar\xE1n",3,"click",4,"ngIf"],["class","albaran-info",4,"ngIf"],["class","btn-secondary btn-small","title","Editar trabajo",3,"click",4,"ngIf"],["class","btn-danger btn-small","title","Eliminar trabajo",3,"click",4,"ngIf"],[1,"repuestos-list"],[1,"no-repuestos"],["title","Hacer albar\xE1n",1,"btn-primary","btn-small",3,"click"],["name","document-text-outline"],[1,"albaran-info"],[1,"badge-albaran"],[1,"albaran-details"],["title","Editar trabajo",1,"btn-secondary","btn-small",3,"click"],["title","Eliminar trabajo",1,"btn-danger","btn-small",3,"click"],["name","trash-outline"],[1,"badge-info"],[1,"albaranes-container"],["class","albaran-item",4,"ngFor","ngForOf"],[1,"albaran-item"],[1,"albaran-header"],[1,"fecha-albaran"],[1,"estado-albaran"],[1,"detail-row"],[1,"detail-item"],["class","detail-item",4,"ngIf"],[1,"detail-item","full-width"],["class","detail-item full-width",4,"ngIf"],["class","detail-row",4,"ngIf"],[1,"repuestos-tags"],["class","repuesto-tag",4,"ngFor","ngForOf"],[1,"repuesto-tag"],[1,"uploading-indicator"],[1,"no-images"],["name","images-outline"],[1,"gallery-item"],[3,"src","alt"],[1,"image-info"],[1,"image-title"],[1,"file-info"],["title","Eliminar imagen",1,"btn-delete",3,"click"]],template:function(n,i){if(n&1){let p=P();b(0,Dn,5,0,"div",1)(1,$n,8,1,"div",2)(2,Gn,61,18,"div",3),e(3,"div",4)(4,"div",5)(5,"h2"),c(6,"Descripci\xF3n del Aviso"),o(),e(7,"span",6),c(8),o()(),e(9,"div",7)(10,"div",8)(11,"label"),c(12,"Tipo de Aviso"),o(),e(13,"p",9),c(14),o()(),e(15,"div",8)(16,"label"),c(17,"Descripci\xF3n Detallada del Problema/Petici\xF3n"),o(),e(18,"p",10),c(19),o()()()(),e(20,"div",4)(21,"div",11)(22,"h2",12),c(23,"Gesti\xF3n de Albaranes"),o(),e(24,"div",13)(25,"button",14),u("click",function(){return f(p),C(i.crearTrabajoRealizado())}),g(26,"ion-icon",15),e(27,"span",16),c(28,"Crear parte de trabajo"),o(),e(29,"span",17),c(30,"Crear trabajo"),o()()()(),b(31,Wn,3,1,"div",18),e(32,"div",19)(33,"span"),c(34,"Lista de Trabajos Registrados"),o()(),e(35,"div",20),b(36,Qn,5,0,"div",1)(37,Yn,7,0,"div",21)(38,io,19,1,"table",22),o()(),b(39,_o,9,2,"div",3),e(40,"div",4)(41,"div",5)(42,"h2"),c(43,"Galer\xEDa de im\xE1genes"),o(),e(44,"div",23)(45,"button",24),u("click",function(){return f(p),C(i.seleccionarImagenes())}),g(46,"ion-icon",15),e(47,"span",16),c(48),o(),e(49,"span",17),c(50),o()(),e(51,"input",25,0),u("change",function(O){return f(p),C(i.onFileSelected(O))}),o()()(),e(53,"div",26),b(54,uo,4,0,"div",27)(55,fo,4,0,"div",28)(56,Co,10,7,"div",29),o()()}n&2&&(d("ngIf",i.loading),s(),d("ngIf",i.error&&!i.loading),s(),d("ngIf",i.aviso&&!i.loading),s(5),Z(i.getEstadoClass(i.aviso==null?null:i.aviso.estado)),s(),v(" ",(i.aviso==null?null:i.aviso.estado)||"Pendiente"," "),s(6),_((i.aviso==null?null:i.aviso.tipo)||"No especificado"),s(5),_(i.aviso==null?null:i.aviso.descripcion_problema),s(12),d("ngIf",i.aviso==null?null:i.aviso.id),s(5),d("ngIf",i.loadingTrabajos),s(),d("ngIf",!i.loadingTrabajos&&(!i.trabajosRealizados||i.trabajosRealizados.length===0)),s(),d("ngIf",!i.loadingTrabajos&&i.trabajosRealizados.length>0),s(),d("ngIf",i.aviso&&i.aviso.albaranes&&i.aviso.albaranes.length>0),s(6),d("disabled",i.subiendoImagenes),s(3),_(i.subiendoImagenes?"Subiendo...":"A\xF1adir im\xE1genes"),s(2),_(i.subiendoImagenes?"Subiendo...":"A\xF1adir"),s(4),d("ngIf",i.subiendoImagenes),s(),d("ngIf",!(i.aviso!=null&&i.aviso.fotos)||(i.aviso==null||i.aviso.fotos==null?null:i.aviso.fotos.length)===0),s(),d("ngForOf",i.aviso==null?null:i.aviso.fotos))},dependencies:[$,R,D,Qe,U,We,G,Lt],styles:['[_nghost-%COMP%]{display:block;padding:24px}.back-button[_ngcontent-%COMP%]{margin-bottom:24px}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 16px;background-color:#fff;color:#4f46e5;border:1px solid #E5E7EB;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s ease}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]:hover{background-color:#f9fafb;border-color:#4f46e5}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px;text-align:center}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#4f46e5}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#6b7280;margin:0}.loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#ef4444}.loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 20px;background-color:#4f46e5;color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:background-color .2s ease}.loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]:hover, .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]:hover{background-color:#3a30e2}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.aviso-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.aviso-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#111827}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.btn-primary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:10px 15px;background-color:#4f46e5;color:#fff;border:none;border-radius:.5rem;cursor:pointer;font-size:15px;font-weight:500}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#3a30e2}.btn-secondary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:10px 15px;background-color:#fff;color:#26262a;border:none;border-radius:.5rem;cursor:pointer;font-size:15px;font-weight:500;border:1px solid rgba(125,131,152,.2431372549)}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.btn-danger[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:10px 15px;background-color:#ef4444;color:#fff;border:none;border-radius:.5rem;cursor:pointer;font-size:15px;font-weight:500}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#dc2626}.btn-danger.btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.info-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;box-shadow:0 2px 8px #e0e7ef33;margin-bottom:24px;overflow:hidden}.info-card[_ngcontent-%COMP%]   h2.title[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#111827;margin:0;padding:25px}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#111827;margin:0}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:25px 25px 0}.info-card[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.info-card[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-card[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#111827;font-size:16px}.badge-pendiente[_ngcontent-%COMP%]{background-color:#f59e0b1a;color:#f59e0b;padding:4px 12px;border-radius:16px;font-size:14px;font-weight:500}.badge-estado-aviso[_ngcontent-%COMP%]{padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.badge-estado-aviso.badge-en-curso[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.badge-estado-aviso.badge-pendiente[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.badge-estado-aviso.badge-completado[_ngcontent-%COMP%]{background:#10b981;color:#fff}.badge-estado-aviso.badge-pendiente-de-presupuesto[_ngcontent-%COMP%]{background:#fcd34d;color:#92400e}.badge-estado-aviso.badge-listo-para-facturar[_ngcontent-%COMP%]{background:#d1fae5;color:#059669}.info-grid[_ngcontent-%COMP%]{padding:25px;padding-top:0!important;display:grid;gap:24px}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#111827;font-size:16px}.info-grid[_ngcontent-%COMP%]   .direccion-section[_ngcontent-%COMP%]   .btn-map[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:none;border:none;padding:8px;cursor:pointer;color:#fff;background-color:#4f46e5;font-size:16px;border-radius:50%}.info-grid[_ngcontent-%COMP%]   .contacto-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:24px}.cliente-info[_ngcontent-%COMP%], .direccion-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.cliente-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%], .direccion-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%]{color:#4f46e5;text-decoration:none;font-size:14px;cursor:pointer}.cliente-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%]:hover, .direccion-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%]:hover{text-decoration:underline}.contacto-items[_ngcontent-%COMP%]{display:flex;gap:24px;margin-top:8px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background-color:#eef2ff;color:#4f46e5;padding:6px 15px;border-radius:10px;font-size:14px;font-weight:500}.estado-pendiente[_ngcontent-%COMP%]{color:#f59e0b!important;font-weight:500}.descripcion-content[_ngcontent-%COMP%]{padding:24px}.descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;line-height:1.5}.gallery-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{background:#f3f4f6;border-radius:30px;width:auto;height:auto;padding:2px 4px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]::part(indicator){background:none}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--background: transparent;--background-checked: white;--background-hover: rgba(255,255,255,.1);--background-focused: rgba(255,255,255,.2);--border-radius: 50%;--border-width: 0;--indicator-color: transparent;--color: #6B7280;--color-checked: #4F46E5;--margin-top: 0;--margin-bottom: 0;--margin-start: 0;--margin-end: 0;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0;min-height:30px;min-width:30px;transition:all .2s ease;position:relative}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]::part(native){margin:0;padding:0 6px;height:100%}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]::part(indicator){display:none}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button.segment-button-checked[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a}.gallery-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{margin-left:auto}.gallery-items[_ngcontent-%COMP%]{padding:24px;display:grid;gap:16px}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;color:#4f46e5}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px;margin-bottom:12px}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:500}.gallery-items[_ngcontent-%COMP%]   .no-images[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.gallery-items[_ngcontent-%COMP%]   .no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px;border:1px solid #E5E7EB;border-radius:6px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:48px;height:48px;object-fit:cover;border-radius:4px;margin-right:16px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]{flex:1}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#26262a}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span.file-info[_ngcontent-%COMP%]{color:#6b7280;font-size:14px;margin-top:4px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#ef4444;border-radius:4px;transition:all .2s ease}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]:hover{background-color:#ef44441a;color:#eb1515}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.table-container[_ngcontent-%COMP%]{padding:0 24px 24px}.table-search[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:center}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:8px;padding:7px 14px;font-size:1rem;border:none;background:#f9fbff;color:#26262a}.table-search[_ngcontent-%COMP%]   .order-by[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#26262a;font-size:14px}.table-search[_ngcontent-%COMP%]   .order-by[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#4f46e5;font-weight:500}.table-search[_ngcontent-%COMP%]   .order-by[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#4f46e5;font-size:16px}.custom-mat-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0 8px;margin-bottom:12px}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#64748b;font-size:14px;font-weight:400;text-align:left;padding:8px 16px;background:transparent}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#f9fafb}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;color:#26262a;font-size:14px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{border-top-left-radius:8px;border-bottom-left-radius:8px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-top-right-radius:8px;border-bottom-right-radius:8px}.descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px;font-size:14px;line-height:1.4}.descripcion-trabajo[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#6b7280;font-size:12px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:13px;color:#4b5563;padding:2px 6px;background-color:#f3f4f6;border-radius:4px;display:inline-block;margin-right:4px;margin-bottom:4px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.badge-estado[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.badge-estado.badge-pendiente[_ngcontent-%COMP%]{background-color:var(--estado-pendiente-bg);color:var(--estado-pendiente-color)}.badge-estado.badge-en-curso[_ngcontent-%COMP%]{background-color:var(--estado-en-curso-bg);color:var(--estado-en-curso-color)}.badge-estado.badge-completado[_ngcontent-%COMP%]{background-color:var(--estado-completado-bg);color:var(--estado-completado-color)}.badge-estado.badge-cancelado[_ngcontent-%COMP%]{background-color:var(--estado-cancelado-bg);color:var(--estado-cancelado-color)}.repuestos-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:14px;color:#4b5563;margin-bottom:4px}.repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.estado-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.estado-actions[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:11px;font-weight:500;text-transform:uppercase;letter-spacing:.5px;margin-left:auto}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-pendiente[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-en-curso[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-abierto[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1e40af}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-cerrado[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-finalizado[_ngcontent-%COMP%]{background-color:#ecfdf5;color:#14532d}.albaran-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px;margin:8px 0}.albaran-info[_ngcontent-%COMP%]   .badge-albaran[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:6px 10px;border-radius:16px;font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;white-space:nowrap;background:#10b981;color:#fff}.albaran-info[_ngcontent-%COMP%]   .badge-albaran[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.albaran-info[_ngcontent-%COMP%]   .badge-albaran.badge-finalizado[_ngcontent-%COMP%]{background:#10b981;color:#fff}.albaran-info[_ngcontent-%COMP%]   .badge-albaran.badge-presupuesto-pendiente[_ngcontent-%COMP%]{background:#f59e0b;color:#fff}.albaran-info[_ngcontent-%COMP%]   .badge-albaran.badge-otra-visita[_ngcontent-%COMP%]{background:#ef4444;color:#fff}.albaran-info[_ngcontent-%COMP%]   .albaran-details[_ngcontent-%COMP%]{font-size:10px;color:#6b7280;text-transform:capitalize}.no-trabajos[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#6b7280}.no-trabajos[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.no-repuestos[_ngcontent-%COMP%]{color:#6b7280;font-style:italic;font-size:14px}.flujo-container[_ngcontent-%COMP%]{padding:0 25px}.flujo-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;font-weight:400;margin-left:12px}.card-header[_ngcontent-%COMP%]   .flujo-subtitle[_ngcontent-%COMP%]{display:block;margin-top:4px;margin-left:0}.flujo-section[_ngcontent-%COMP%]{margin-top:25px;margin-bottom:5px}.flujo-section[_ngcontent-%COMP%]   .flujo-header[_ngcontent-%COMP%]{margin-bottom:16px}.flujo-section[_ngcontent-%COMP%]   .flujo-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#1a202c;margin:0 0 4px}.flujo-section[_ngcontent-%COMP%]   .flujo-header[_ngcontent-%COMP%]   .flujo-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:400}.section-divider[_ngcontent-%COMP%]{display:flex;align-items:center;margin:24px 0 20px}.section-divider[_ngcontent-%COMP%]:before, .section-divider[_ngcontent-%COMP%]:after{content:"";flex:1;height:1px;background:#e2e8f0}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0 16px;font-size:14px;font-weight:500;color:#64748b;background:#fff}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#64748b}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#cbd5e0;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:500;margin:0 0 8px;color:#4a5568}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:14px;color:#a0aec0}.desktop-only[_ngcontent-%COMP%]{display:inline}.mobile-only[_ngcontent-%COMP%]{display:none}.urgent-badge[_ngcontent-%COMP%]{padding:2px 8px;border-radius:12px;font-size:12px;font-weight:500}.urgent-badge.urgent[_ngcontent-%COMP%]{background-color:#fef2f2;color:#dc2626}.urgent-badge[_ngcontent-%COMP%]:not(.urgent){background-color:#f3f4f6;color:#6b7280}.cliente-nombre[_ngcontent-%COMP%]{font-weight:500;color:#111827}.direccion-texto[_ngcontent-%COMP%]{word-break:break-word;line-height:1.4}.tipo-aviso[_ngcontent-%COMP%]{font-weight:500;color:#4f46e5}.descripcion-texto[_ngcontent-%COMP%]{line-height:1.6;color:#111827}.image-title[_ngcontent-%COMP%]{font-weight:500;color:#111827}.ver-cliente[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;color:#4f46e5;text-decoration:none;font-size:14px;cursor:pointer;transition:color .2s ease}.ver-cliente[_ngcontent-%COMP%]:hover{color:#291fd9}.ver-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.no-images[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.no-images[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#cbd5e0;margin-bottom:16px}.no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}@media (max-width: 768px){[_nghost-%COMP%]{padding:16px}.desktop-only[_ngcontent-%COMP%]{display:none}.mobile-only[_ngcontent-%COMP%]{display:inline}.info-card[_ngcontent-%COMP%]{margin-bottom:16px;border-radius:12px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:20px;flex-direction:row;align-items:center;justify-content:start;gap:25px!important}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .mobile-only.title[_ngcontent-%COMP%]{display:block;font-size:18px;font-weight:500;color:#111827;margin:0}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{width:auto;justify-content:space-between;gap:12px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:none;width:100%;flex-direction:column;gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions-jobs[_ngcontent-%COMP%]{display:flex;width:100%;flex-direction:column;gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions-jobs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.info-card[_ngcontent-%COMP%]   h2.title[_ngcontent-%COMP%]{font-size:16px;padding:20px}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px}.info-grid[_ngcontent-%COMP%]{padding:15px;gap:16px}.info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]{gap:20px}.info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{width:auto}.info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:max-content}.info-grid[_ngcontent-%COMP%]   .cliente-info[_ngcontent-%COMP%], .info-grid[_ngcontent-%COMP%]   .direccion-info[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between;gap:8px}.info-grid[_ngcontent-%COMP%]   .contacto-items[_ngcontent-%COMP%]{flex-direction:row;gap:8px}.info-grid[_ngcontent-%COMP%]   .contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{width:100%;justify-content:flex-start}.info-grid[_ngcontent-%COMP%]   .contacto-items[_ngcontent-%COMP%]   .contacto-item.nombre-contacto[_ngcontent-%COMP%]{display:none}.descripcion-content[_ngcontent-%COMP%]{padding:20px;gap:16px}.gallery-actions[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:stretch}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{align-self:center}.gallery-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{margin-left:0;width:100%;justify-content:center}.gallery-items[_ngcontent-%COMP%]{padding:20px;gap:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:200px;object-fit:cover;border-radius:8px;margin-right:0}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]{width:100%}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{align-self:flex-end}.table-container[_ngcontent-%COMP%]{padding:0 20px 20px}.custom-mat-table[_ngcontent-%COMP%]{font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:11px;padding:8px 12px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 12px;font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:10px}.estado-actions[_ngcontent-%COMP%]{flex-direction:column;gap:6px}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{width:100%;justify-content:center;padding:8px 12px;font-size:12px}.flujo-container[_ngcontent-%COMP%]{padding:0 20px 20px}.flujo-section[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:0}.section-divider[_ngcontent-%COMP%]{margin:20px 0 16px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;padding:0 12px}.back-button[_ngcontent-%COMP%]{margin-bottom:16px}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}.badge-pendiente[_ngcontent-%COMP%]{font-size:12px;padding:3px 8px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:11px;padding:2px 4px}.no-repuestos[_ngcontent-%COMP%]{font-size:12px}.empty-state[_ngcontent-%COMP%]{padding:30px 16px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px}.urgent-badge[_ngcontent-%COMP%]{font-size:11px;padding:2px 6px}.ver-cliente[_ngcontent-%COMP%]{font-size:12px}.ver-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.no-images[_ngcontent-%COMP%]{padding:30px 16px}.no-images[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px}.no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 480px){[_nghost-%COMP%]{padding:0}.info-card[_ngcontent-%COMP%]{margin-bottom:12px;border-radius:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:16px;gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{gap:6px}.info-card[_ngcontent-%COMP%]   h2.title[_ngcontent-%COMP%]{font-size:15px;padding:16px;display:none}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:15px!important}.descripcion-content[_ngcontent-%COMP%]{padding:16px;gap:12px}.descripcion-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px}.descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.gallery-actions[_ngcontent-%COMP%]{gap:8px}.gallery-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}.gallery-items[_ngcontent-%COMP%]{padding:16px;gap:8px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{gap:8px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:150px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span.file-info[_ngcontent-%COMP%]{font-size:11px}.table-container[_ngcontent-%COMP%]{padding:0 16px 16px}.custom-mat-table[_ngcontent-%COMP%]{font-size:11px}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:10px;padding:6px 8px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;font-size:11px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:9px}.estado-actions[_ngcontent-%COMP%]{gap:4px}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{padding:6px 8px;font-size:11px}.flujo-container[_ngcontent-%COMP%]{padding:0 16px 16px}.flujo-section[_ngcontent-%COMP%]{margin-top:16px}.section-divider[_ngcontent-%COMP%]{margin:16px 0 12px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:0 8px}.back-button[_ngcontent-%COMP%]{margin-bottom:12px}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{padding:6px 10px;font-size:12px}.badge-pendiente[_ngcontent-%COMP%]{font-size:11px;padding:2px 6px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:10px;padding:1px 3px}.no-repuestos[_ngcontent-%COMP%]{font-size:11px}.empty-state[_ngcontent-%COMP%]{padding:24px 12px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:11px}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}ion-icon[_ngcontent-%COMP%]{font-size:16px}.urgent-badge[_ngcontent-%COMP%]{font-size:10px;padding:1px 4px}.ver-cliente[_ngcontent-%COMP%]{font-size:11px}.ver-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:11px}.no-images[_ngcontent-%COMP%]{padding:24px 12px}.no-images[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}}@media (max-width: 768px){.custom-mat-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;white-space:nowrap}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{display:block}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.custom-mat-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:8px;border-radius:8px;background:#f9fafb;padding:12px}.custom-mat-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:block;text-align:left;padding:4px 0;border:none;white-space:normal}.custom-mat-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:before, .custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label) ": ";font-weight:600;color:#6b7280;font-size:11px;text-transform:uppercase;letter-spacing:.5px}.custom-mat-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{display:none}.custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:13px;line-height:1.4}.custom-mat-table[_ngcontent-%COMP%]   td.descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px}.custom-mat-table[_ngcontent-%COMP%]   td.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]{margin-top:4px}.custom-mat-table[_ngcontent-%COMP%]   td.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-block;margin:2px 4px 2px 0}.custom-mat-table[_ngcontent-%COMP%]   td.estado-actions[_ngcontent-%COMP%]{margin-top:8px;padding-top:8px;border-top:1px solid #E5E7EB}.custom-mat-table[_ngcontent-%COMP%]   td.estado-actions[_ngcontent-%COMP%]:before{content:"Acciones: "}.estado-actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{flex:1;min-width:80px;max-width:120px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{border:1px solid #E5E7EB;border-radius:8px;padding:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:6px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]{margin:8px 0}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;margin-bottom:2px}.badge-estado[_ngcontent-%COMP%]{display:inline-block;margin:2px 0}.btn-map[_ngcontent-%COMP%]{min-width:36px;height:36px}.btn-map[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{border-radius:6px;padding:6px 10px;font-size:13px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.empty-state[_ngcontent-%COMP%]{background:#f9fafb;border-radius:8px;margin:16px 0}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{min-height:150px}.error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{background:#fef2f2;border:1px solid #FECACA;border-radius:8px;padding:20px}.error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#dc2626}.header-container[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{margin-bottom:0}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{--background: #F3F4F6;--background-checked: white;--color: #6B7280;--color-checked: #4F46E5}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--background: transparent;--background-checked: white;--color: #6B7280;--color-checked: #4F46E5;--indicator-color: transparent;--border-radius: 50%;--margin: 0;--padding: 0;min-height:32px;min-width:32px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.flujo-section[_ngcontent-%COMP%]   .flujo-container[_ngcontent-%COMP%]{padding:0 16px 16px}.section-divider[_ngcontent-%COMP%]{margin:16px 0 12px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:0 10px;background:#fff;color:#6b7280}.cliente-info[_ngcontent-%COMP%]   .cliente-nombre[_ngcontent-%COMP%]{font-size:14px;line-height:1.3}.direccion-info[_ngcontent-%COMP%]   .direccion-texto[_ngcontent-%COMP%]{font-size:13px;line-height:1.4}.descripcion-content[_ngcontent-%COMP%]   .tipo-aviso[_ngcontent-%COMP%]{font-size:14px}.descripcion-content[_ngcontent-%COMP%]   .descripcion-texto[_ngcontent-%COMP%]{font-size:13px}}@media (max-width: 480px){.custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{font-size:10px}.custom-mat-table[_ngcontent-%COMP%]   .estado-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:end;gap:20px}.custom-mat-table[_ngcontent-%COMP%]   .estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{min-width:70px;max-width:100px;font-size:11px;padding:6px 8px}.custom-mat-table[_ngcontent-%COMP%]   .estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{padding:8px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:120px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span.file-info[_ngcontent-%COMP%]{font-size:10px}.contacto-items[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between;gap:8px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{padding:4px 8px;font-size:12px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.btn-map[_ngcontent-%COMP%]{min-width:32px;height:32px}.btn-map[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.empty-state[_ngcontent-%COMP%]{padding:20px 12px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:10px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{min-height:120px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{min-height:28px;min-width:28px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px;min-height:40px}.flujo-section[_ngcontent-%COMP%]   .flujo-container[_ngcontent-%COMP%]{padding:0 12px 12px}.section-divider[_ngcontent-%COMP%]{margin:12px 0 8px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;padding:0 8px}.cliente-info[_ngcontent-%COMP%]   .cliente-nombre[_ngcontent-%COMP%]{font-size:13px}.direccion-info[_ngcontent-%COMP%]   .direccion-texto[_ngcontent-%COMP%]{font-size:12px}.descripcion-content[_ngcontent-%COMP%]   .tipo-aviso[_ngcontent-%COMP%]{font-size:13px}.descripcion-content[_ngcontent-%COMP%]   .descripcion-texto[_ngcontent-%COMP%]{font-size:12px}}.albaranes-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.albaran-item[_ngcontent-%COMP%]{background:#fff;border:1px solid #E2E8F0;border-radius:12px;padding:20px;box-shadow:0 1px 3px #0000001a;transition:all .2s ease}.albaran-item[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026;transform:translateY(-2px)}.albaran-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid #E5E7EB}.albaran-header[_ngcontent-%COMP%]   .albaran-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:18px;font-weight:600;color:#1f2937}.albaran-header[_ngcontent-%COMP%]   .albaran-info[_ngcontent-%COMP%]   .fecha-albaran[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;font-weight:500}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado[_ngcontent-%COMP%]{padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado.badge-finalizado[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado.badge-presupuesto-pendiente[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado.badge-otra-visita[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.albaran-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.albaran-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.albaran-details[_ngcontent-%COMP%]   .detail-item.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.5px}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#1f2937;margin:0}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{line-height:1.5;background:#f9fafb;padding:8px 12px;border-radius:6px;border:1px solid #E5E7EB}.albaran-details[_ngcontent-%COMP%]   .repuestos-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.albaran-details[_ngcontent-%COMP%]   .repuestos-tags[_ngcontent-%COMP%]   .repuesto-tag[_ngcontent-%COMP%]{background:#e0f2fe;color:#0c4a6e;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;border:1px solid #BAE6FD}@media (max-width: 768px){.albaranes-container[_ngcontent-%COMP%]{gap:16px}.albaran-item[_ngcontent-%COMP%]{padding:16px}.albaran-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:flex-start}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]{align-self:flex-start}.albaran-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}}']});let r=l;return r})();export{ii as VerAvisosComponent};
