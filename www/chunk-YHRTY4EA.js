import{a as Z,b as Ie}from"./chunk-SSLLGZOZ.js";import"./chunk-Q5TPT4RW.js";import"./chunk-7JXIQDSA.js";import{a as Lt}from"./chunk-ZE67QYES.js";import"./chunk-3AC3MB3J.js";import{a as Se}from"./chunk-DBF2D4ZP.js";import"./chunk-GVEUVWXM.js";import{a as ze}from"./chunk-S7IKXOHM.js";import{A as ie,B as jt,Ba as qt,C as zt,Ca as K,E as St,Ea as X,F as It,G as ye,Ga as je,H as At,K as q,P as Ft,Q as Tt,S as we,V as Vt,Y as Rt,Z as Dt,_ as $t,a as F,b as Pt,c as Ot,ca as Re,d as Mt,da as Ht,e as vt,ea as De,g as ht,ga as $e,i as Te,j as yt,k as wt,ka as ae,l as Et,ma as He,o as ve,oa as Y,p as Ve,ta as Nt,u as Q,ua as J,v as kt,va as Bt,wa as Ee,xa as ke,y as he}from"./chunk-MD3YUAPK.js";import{a as Ut}from"./chunk-GLG6J6XG.js";import{e as Ct,h as bt,j as xt}from"./chunk-FZEECF2M.js";import"./chunk-NPXMDSDS.js";import{c as ct,d as st,e as lt,f as dt,g as pt,k as gt,m as mt,n as Me,s as W,t as _t,u as ut}from"./chunk-HFTMICQT.js";import{$a as ge,$b as w,Aa as _,Ba as v,Ca as z,D as qe,Da as Fe,Ea as te,Fa as ne,G as Ue,Ga as oe,Ia as Je,K as C,L as b,Oa as h,P as Le,Pa as A,Qa as k,Qc as ft,R as Ge,Ra as Ke,U as se,W as s,Wa as Xe,X as M,Xa as H,Ya as N,Z as $,Zb as nt,_a as Ze,ab as G,ac as me,ba as x,bb as B,bc as _e,c as L,f as V,fc as ue,ga as p,gc as fe,ha as U,i as I,ia as ee,ja as n,jb as et,jc as Ce,k as R,ka as a,kc as be,la as m,lc as ot,ma as We,mb as tt,mc as it,na as Qe,nc as at,pa as O,qa as u,r as D,ra as g,rc as rt,sc as xe,tc as Pe,uc as Oe,va as le,wa as de,xa as pe,y as E,ya as Ye,za as c}from"./chunk-6H2HYE5V.js";import"./chunk-O2UL5LLU.js";import"./chunk-QUJFQN2Y.js";import"./chunk-AM627M6F.js";import"./chunk-JTD5GKUD.js";import"./chunk-A2YKKFU3.js";import"./chunk-2KHLCIYP.js";import"./chunk-ULLEADC5.js";import"./chunk-2ELISCRH.js";import"./chunk-I5TDVWGU.js";import"./chunk-6ZFSPUJJ.js";import"./chunk-G2E2NLL6.js";import"./chunk-TRL2EEEF.js";import"./chunk-KULRFOS2.js";import"./chunk-6MUOMDRB.js";import"./chunk-LBMIQEU6.js";import"./chunk-WI5MSH4N.js";import"./chunk-JS2PKTDC.js";import"./chunk-CKP3SGE2.js";import"./chunk-A77EQ7UG.js";import"./chunk-NBD2MYJO.js";import"./chunk-3SBX7V6R.js";import"./chunk-SQKDQBOS.js";import"./chunk-SWRJZAEI.js";import"./chunk-JCSW2JUV.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-36KMLI7A.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as re,b as ce,k as y}from"./chunk-CRC5ZNR6.js";var Zt=()=>({standalone:!0});function en(r,l){r&1&&(n(0,"div",15)(1,"div",16),m(2,"ion-icon",17),n(3,"p"),c(4,"Cargando datos del trabajo..."),a()()())}function tn(r,l){r&1&&(n(0,"div",46),m(1,"ion-icon",47),n(2,"p"),c(3,"Al editar el trabajo, los materiales se ajustar\xE1n autom\xE1ticamente en el inventario."),a()())}function nn(r,l){r&1&&(n(0,"div",48),m(1,"ion-icon",17),n(2,"span"),c(3,"Cargando productos..."),a()())}function on(r,l){if(r&1&&(n(0,"div",49),c(1),a()),r&2){let i=g(2);s(),v(" ",i.errorProductos," ")}}function an(r,l){if(r&1&&(n(0,"span",63),c(1),a()),r&2){let i=g().$implicit;s(),_(i.descripcion)}}function rn(r,l){if(r&1){let i=O();n(0,"div",53),u("click",function(){let t=C(i).$implicit,o=g(3);return b(o.agregarMaterial(t))}),n(1,"div",54)(2,"div",55)(3,"span",56),c(4),a(),n(5,"span",57),c(6),a()(),n(7,"span",58),c(8),a(),x(9,an,2,1,"span",59),n(10,"span",60),c(11),h(12,"currency"),a()(),n(13,"button",61),m(14,"ion-icon",62),a()()}if(r&2){let i=l.$implicit;U("sin-stock",i.cantidad_disponible<=0)("stock-bajo",i.cantidad_disponible>0&&i.cantidad_disponible<=5),s(4),_(i.codigo),s(),U("stock-bajo",i.cantidad_disponible>0&&i.cantidad_disponible<=5)("sin-stock",i.cantidad_disponible<=0),s(),z(" Stock: ",i.cantidad_disponible," ",i.unidad," "),s(2),_(i.nombre),s(),p("ngIf",i.descripcion),s(2),_(k(12,15,i.precio_neto,"EUR","symbol","1.2-2")),s(2),p("disabled",i.cantidad_disponible<=0)}}function cn(r,l){if(r&1&&(n(0,"div",50)(1,"h4"),c(2,"Productos disponibles"),a(),n(3,"div",51),x(4,rn,15,20,"div",52),a()()),r&2){let i=g(2);s(4),p("ngForOf",i.productosFiltrados)}}function sn(r,l){if(r&1){let i=O();n(0,"div",67)(1,"div",68)(2,"div",69)(3,"span",70),c(4),a(),n(5,"span",71),c(6),h(7,"currency"),a()(),n(8,"span",72),c(9),a(),n(10,"div",73)(11,"label"),c(12,"Cantidad:"),a(),n(13,"input",74),u("change",function(t){let o=C(i).index,d=g(3);return b(d.actualizarCantidadMaterial(o,t.target.value))}),a(),n(14,"span",75),c(15),a()()(),n(16,"button",76),u("click",function(){let t=C(i).index,o=g(3);return b(o.eliminarMaterial(t))}),m(17,"ion-icon",77),a()()}if(r&2){let i=l.$implicit;s(4),_(i.producto.codigo),s(2),_(k(7,7,i.producto.precio_neto,"EUR","symbol","1.2-2")),s(3),_(i.producto.nombre),s(4),p("value",i.cantidad)("min",1)("max",i.producto.cantidad_disponible),s(2),_(i.producto.unidad)}}function ln(r,l){if(r&1&&(n(0,"div",64)(1,"h4"),c(2,"Materiales a\xF1adidos"),a(),x(3,sn,18,12,"div",65),n(4,"div",66)(5,"strong"),c(6),h(7,"currency"),a()()()),r&2){let i=g(2);s(3),p("ngForOf",i.materiales),s(3),v("Costo total de materiales: ",k(7,2,i.calcularCostoTotal(),"EUR","symbol","1.2-2"),"")}}function dn(r,l){r&1&&(n(0,"div",78),m(1,"ion-icon",47),n(2,"p"),c(3,"No se han a\xF1adido materiales"),a(),n(4,"span"),c(5,"Selecciona productos del inventario para a\xF1adirlos como materiales"),a()())}function pn(r,l){if(r&1){let i=O();n(0,"div",18)(1,"div",19)(2,"div",20)(3,"label"),c(4,"Fecha del trabajo "),n(5,"span",21),c(6,"*"),a()(),m(7,"input",22),a(),n(8,"div",23)(9,"div",24)(10,"label"),c(11,"Hora de inicio "),n(12,"span",21),c(13,"*"),a()(),m(14,"input",25),a(),n(15,"div",24)(16,"label"),c(17,"Hora de fin "),n(18,"span",21),c(19,"*"),a()(),m(20,"input",26),a()(),n(21,"div",20)(22,"label"),c(23,"Descripci\xF3n del trabajo "),n(24,"span",21),c(25,"*"),a()(),n(26,"textarea",27),c(27,"            "),a(),n(28,"div",28),c(29),a()(),n(30,"div",20)(31,"label"),c(32,"Estado del trabajo"),a(),n(33,"select",29)(34,"option",30),c(35,"Pendiente"),a(),n(36,"option",31),c(37,"En curso"),a(),n(38,"option",32),c(39,"Completado"),a(),n(40,"option",33),c(41,"Cancelado"),a()()()(),n(42,"div",34)(43,"div",35)(44,"h3"),c(45,"Materiales utilizados"),a(),x(46,tn,4,0,"div",36),n(47,"div",37)(48,"div",38),m(49,"ion-icon",39),n(50,"input",40),oe("ngModelChange",function(t){C(i);let o=g();return ne(o.busquedaProducto,t)||(o.busquedaProducto=t),b(t)}),u("input",function(t){C(i);let o=g();return b(o.filtrarProductos(t))}),a()()(),x(51,nn,4,0,"div",41)(52,on,2,1,"div",42)(53,cn,5,1,"div",43)(54,ln,8,7,"div",44)(55,dn,6,0,"div",45),a()()()}if(r&2){let i,e=g();s(29),v("",((i=e.trabajoForm.get("descripcion"))==null||i.value==null?null:i.value.length)||0,"/500"),s(17),p("ngIf",e.modoEdicion),s(4),te("ngModel",e.busquedaProducto),p("ngModelOptions",Je(9,Zt)),s(),p("ngIf",e.loadingProductos),s(),p("ngIf",e.errorProductos),s(),p("ngIf",!e.loadingProductos&&!e.errorProductos),s(),p("ngIf",e.materiales.length>0),s(),p("ngIf",e.materiales.length===0&&!e.loadingProductos&&!e.errorProductos)}}var Wt=(()=>{let l=class l{constructor(e,t,o,d,f,P){this.fb=e,this.modalController=t,this.viewportService=o,this.elementRef=d,this.inventarioService=f,this.trabajosService=P,this.avisoId="",this.materiales=[],this.productosInventario=[],this.productosFiltrados=[],this.loadingProductos=!1,this.errorProductos=null,this.busquedaProducto="",this.modoEdicion=!1,this.destroy$=new L,this.trabajoForm=this.fb.group({fecha_trabajo:[new Date().toISOString().split("T")[0],w.required],hora_inicio:["",w.required],hora_fin:["",w.required],descripcion:["",[w.required,w.maxLength(500)]],estado:["Pendiente",w.required]})}ngOnInit(){F({arrowForward:yt,personOutline:Y,mailOutline:Ht,chevronDownOutline:he,copyOutline:It,shieldOutline:qt,informationCircleOutline:Dt,cloudUploadOutline:zt,closeOutline:jt,save:Bt,saveOutline:Ee,trashOutline:X,timeOutline:K,calendarOutline:ve,documentTextOutline:q,addOutline:vt,searchOutline:ke}),this.modoEdicion=!!this.trabajoExistente,this.modoEdicion&&this.trabajoExistente&&this.cargarDatosTrabajoExistente(),this.cargarProductosInventario()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngAfterViewInit(){setTimeout(()=>{let e=this.elementRef.nativeElement.querySelector(".modal-container");e&&this.viewportService.applySafeAreaToModal(e)},100)}cargarDatosTrabajoExistente(){return y(this,null,function*(){var e;if((e=this.trabajoExistente)!=null&&e.id)try{let t=yield I(this.trabajosService.getTrabajo(this.trabajoExistente.id));if(this.trabajoForm.patchValue({fecha_trabajo:this.trabajoExistente.fecha_trabajo,hora_inicio:this.trabajoExistente.hora_inicio,hora_fin:this.trabajoExistente.hora_fin,descripcion:this.trabajoExistente.descripcion,estado:this.trabajoExistente.estado}),t.materiales&&t.materiales.length>0){let o=yield Promise.all(t.materiales.map(d=>y(this,null,function*(){return{producto:yield I(this.inventarioService.getProducto(d.material_id)),cantidad:d.cantidad_utilizada}})));this.materiales=o}}catch(t){console.error("Error al cargar datos del trabajo existente:",t),alert("Error al cargar los datos del trabajo para editar.")}})}cargarProductosInventario(){this.loadingProductos=!0,this.errorProductos=null,this.inventarioService.getProductosConStock(1,100,"","nombre","asc").pipe(E(this.destroy$)).subscribe({next:e=>{this.productosInventario=e.inventario,this.productosFiltrados=e.inventario,this.loadingProductos=!1},error:e=>{console.error("Error al cargar productos:",e),this.errorProductos="Error al cargar los productos del inventario",this.loadingProductos=!1}})}filtrarProductos(e){let t=e.target.value.toLowerCase();this.busquedaProducto=t,t?this.productosFiltrados=this.productosInventario.filter(o=>o.nombre.toLowerCase().includes(t)||o.codigo.toLowerCase().includes(t)||o.descripcion&&o.descripcion.toLowerCase().includes(t)):this.productosFiltrados=this.productosInventario}agregarMaterial(e){let t=this.materiales.find(o=>o.producto.id===e.id);if(t){let o=t.cantidad+1;if(o>e.cantidad_disponible){alert(`No hay suficiente stock. Solo quedan ${e.cantidad_disponible} ${e.unidad} de ${e.nombre}`);return}t.cantidad=o}else{if(e.cantidad_disponible<=0){alert(`No hay stock disponible para ${e.nombre}`);return}this.materiales.push({producto:e,cantidad:1})}}eliminarMaterial(e){this.materiales.splice(e,1)}actualizarCantidadMaterial(e,t){let o=this.materiales[e],d=parseInt(t.toString());if(!(isNaN(d)||d<=0)){if(d>o.producto.cantidad_disponible){alert(`No hay suficiente stock. Solo quedan ${o.producto.cantidad_disponible} ${o.producto.unidad} de ${o.producto.nombre}`);return}o.cantidad=d}}calcularCostoTotal(){return this.materiales.reduce((e,t)=>e+t.cantidad*t.producto.precio_neto,0)}crearTrabajo(){return y(this,null,function*(){if(this.trabajoForm.valid){let e=this.materiales.filter(o=>o.cantidad>o.producto.cantidad_disponible);if(e.length>0){let o=e.map(d=>`${d.producto.nombre}: solicitado ${d.cantidad} ${d.producto.unidad}, disponible ${d.producto.cantidad_disponible} ${d.producto.unidad}`).join(`
`);alert(`No hay suficiente stock para los siguientes materiales:

${o}`);return}let t=ce(re({},this.trabajoForm.value),{aviso_id:this.avisoId,repuestos:this.materiales.map(o=>o.producto.nombre),materiales:this.materiales.map(o=>({material_id:o.producto.id,cantidad_utilizada:o.cantidad,precio_neto_al_momento:o.producto.precio_neto}))});yield this.modalController.dismiss(t,"confirm")}})}cerrarModal(){return y(this,null,function*(){yield this.modalController.dismiss(null,"cancel")})}};l.\u0275fac=function(t){return new(t||l)(M(xe),M(bt),M(Ut),M(Ge),M(Se),M(Z))},l.\u0275cmp=$({type:l,selectors:[["app-crear-trabajos-realizados"]],inputs:{avisoId:"avisoId",trabajoExistente:"trabajoExistente"},decls:20,vars:7,consts:[[1,"modal-container"],[1,"modal-header"],[1,"header-content"],[1,"close-button",3,"click"],["name","close-outline"],[1,"subtitle"],[1,"modal-body",3,"ngSubmit","formGroup"],[1,"modal-content"],["class","loading-state",4,"ngIf"],["class","modal-grid",4,"ngIf"],[1,"modal-footer"],[1,"button-group"],["type","button",1,"btn","btn-outline",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["name","save-outline"],[1,"loading-state"],[1,"loading-spinner"],["name","refresh-outline",1,"spinning"],[1,"modal-grid"],[1,"form-section"],[1,"form-group"],[1,"required"],["type","date","formControlName","fecha_trabajo",1,"form-control"],[1,"form-row"],[1,"form-group","half"],["type","time","formControlName","hora_inicio",1,"form-control"],["type","time","formControlName","hora_fin",1,"form-control"],["formControlName","descripcion","placeholder","Describe detalladamente el trabajo realizado...","rows","4","maxlength","500",1,"form-control"],[1,"character-count"],["formControlName","estado",1,"form-control"],["value","Pendiente"],["value","En curso"],["value","Completado"],["value","Cancelado"],[1,"images-section"],[1,"repuestos-container"],["class","info-message",4,"ngIf"],[1,"search-container"],[1,"search-input"],["name","search-outline"],["type","text","placeholder","Buscar productos del inventario...",1,"form-control",3,"ngModelChange","input","ngModel","ngModelOptions"],["class","loading-indicator",4,"ngIf"],["class","error-message",4,"ngIf"],["class","productos-disponibles",4,"ngIf"],["class","repuestos-list",4,"ngIf"],["class","no-repuestos",4,"ngIf"],[1,"info-message"],["name","information-circle-outline"],[1,"loading-indicator"],[1,"error-message"],[1,"productos-disponibles"],[1,"productos-list"],["class","producto-item",3,"sin-stock","stock-bajo","click",4,"ngFor","ngForOf"],[1,"producto-item",3,"click"],[1,"producto-info"],[1,"producto-header"],[1,"producto-codigo"],[1,"producto-stock"],[1,"producto-nombre"],["class","producto-descripcion",4,"ngIf"],[1,"producto-precio"],["type","button",1,"add-producto-btn",3,"disabled"],["name","add-outline"],[1,"producto-descripcion"],[1,"repuestos-list"],["class","repuesto-item",4,"ngFor","ngForOf"],[1,"costo-total"],[1,"repuesto-item"],[1,"repuesto-info"],[1,"repuesto-header"],[1,"repuesto-codigo"],[1,"repuesto-precio"],[1,"repuesto-nombre"],[1,"repuesto-cantidad"],["type","number",1,"cantidad-input",3,"change","value","min","max"],[1,"unidad"],["type","button",1,"remove-repuesto",3,"click"],["name","trash-outline"],[1,"no-repuestos"]],template:function(t,o){t&1&&(n(0,"div",0)(1,"header",1)(2,"div",2)(3,"h2"),c(4),a(),n(5,"button",3),u("click",function(){return o.cerrarModal()}),m(6,"ion-icon",4),a()(),n(7,"p",5),c(8),a()(),n(9,"form",6),u("ngSubmit",function(){return o.crearTrabajo()}),n(10,"div",7),x(11,en,5,0,"div",8)(12,pn,56,10,"div",9),a()(),n(13,"footer",10)(14,"div",11)(15,"button",12),u("click",function(){return o.cerrarModal()}),c(16," Cancelar "),a(),n(17,"button",13),u("click",function(){return o.crearTrabajo()}),c(18),m(19,"ion-icon",14),a()()()()),t&2&&(s(4),_(o.modoEdicion?"Editar parte de trabajo":"Crear parte de trabajo"),s(4),_(o.modoEdicion?"Modifica el trabajo realizado":"Registra el trabajo realizado en este aviso"),s(),p("formGroup",o.trabajoForm),s(2),p("ngIf",o.modoEdicion&&!o.trabajoExistente),s(),p("ngIf",!o.modoEdicion||o.trabajoExistente),s(5),p("disabled",!o.trabajoForm.valid),s(),v(" ",o.modoEdicion?"Actualizar trabajo":"Crear trabajo"," "))},dependencies:[xt,Ct,B,H,N,G,Oe,fe,it,at,nt,ot,me,_e,rt,Ce,be,Pe,ue],styles:[`.modal-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:90vh;background:#fff;position:relative}.modal-header[_ngcontent-%COMP%]{padding:16px 24px;border-bottom:1px solid #e5e7eb;flex-shrink:0}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600;color:#111827}.modal-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:8px 0 0;color:#6b7280;font-size:14px}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#6b7280;display:flex;align-items:center;justify-content:center}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#111827}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px}.modal-body[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex;flex-direction:column;min-height:0}.modal-content[_ngcontent-%COMP%]{flex:1;overflow:auto;position:relative;min-height:0}.modal-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:0;height:100%;overflow:hidden}@media (max-width: 768px){.modal-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto auto;height:auto;overflow:visible}}.form-section[_ngcontent-%COMP%]{padding:24px;border-right:1px solid #e5e7eb;overflow-y:auto;height:100%;max-height:100%}@media (max-width: 768px){.form-section[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e5e7eb;height:auto;max-height:none;overflow:visible;padding-bottom:30px}}.form-section[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#d1d5db #f3f4f6}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f3f4f6;border-radius:3px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:3px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}.images-section[_ngcontent-%COMP%]{padding:24px;background-color:#f9fafb;overflow-y:auto;height:100%;max-height:100%}@media (max-width: 768px){.images-section[_ngcontent-%COMP%]{height:auto;max-height:none;overflow:visible;min-height:300px;padding-bottom:80px}}.images-section[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#d1d5db #f3f4f6}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f3f4f6;border-radius:3px}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:3px}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:14px;font-weight:500;color:#374151}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#dc2626}.form-group.half[_ngcontent-%COMP%]{flex:1}.form-control[_ngcontent-%COMP%]{position:relative;width:100%;padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px;color:#111827;background-color:#fff;transition:border-color .2s}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 2px #2563eb1a}.form-control[_ngcontent-%COMP%]:disabled{background-color:#f9fafb;color:#6b7280;cursor:not-allowed}select.form-control[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;background-size:16px;padding-right:40px}select.form-control[_ngcontent-%COMP%]:disabled{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")}select.form-control[_ngcontent-%COMP%]::placeholder{color:#9ca3af}select.form-control[_ngcontent-%COMP%]{padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s}select.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}input.form-control[_ngcontent-%COMP%]{padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s}input.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}textarea.form-control[_ngcontent-%COMP%]{position:relative;padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s;resize:vertical;min-height:80px}textarea.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}.character-count[_ngcontent-%COMP%]{margin-top:4px;text-align:right;font-size:12px;color:#6b7280;position:absolute;bottom:13px;right:13px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px}.form-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:0;flex:1}.repuestos-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;color:#374151;font-weight:600}.search-container[_ngcontent-%COMP%]{margin-bottom:16px}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;left:12px;color:#6b7280;font-size:18px;z-index:1}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:40px;width:100%}.loading-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:16px;color:#6b7280;font-size:14px}.loading-indicator[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.loading-indicator[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px;text-align:center}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#4f46e5}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#6b7280;margin:0}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%]{padding:12px;background:#fef2f2;color:#dc2626;border-radius:6px;font-size:14px;margin-bottom:16px}.productos-disponibles[_ngcontent-%COMP%]{margin-bottom:24px}.productos-disponibles[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:16px;color:#374151}.productos-list[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto;border:1px solid #E5E7EB;border-radius:6px}.producto-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid #F3F4F6;cursor:pointer;transition:background-color .2s}.producto-item[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.producto-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.producto-item.sin-stock[_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed}.producto-item.sin-stock[_ngcontent-%COMP%]:hover{background-color:transparent}.producto-item.stock-bajo[_ngcontent-%COMP%]{border-left:3px solid #F59E0B}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]{flex:1;min-width:0}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]   .producto-codigo[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]   .producto-stock[_ngcontent-%COMP%]{font-size:12px;color:#059669;font-weight:500}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]   .producto-stock.stock-bajo[_ngcontent-%COMP%]{color:#f59e0b;font-weight:600}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]   .producto-stock.sin-stock[_ngcontent-%COMP%]{color:#ef4444;font-weight:600}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-nombre[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#111827;margin-bottom:2px}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-descripcion[_ngcontent-%COMP%]{display:block;font-size:12px;color:#6b7280;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-precio[_ngcontent-%COMP%]{font-size:14px;color:#059669;font-weight:600}.producto-item[_ngcontent-%COMP%]   .add-producto-btn[_ngcontent-%COMP%]{background:#4f46e5;color:#fff;border:none;border-radius:50%;width:32px;height:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:background-color .2s}.producto-item[_ngcontent-%COMP%]   .add-producto-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#3730a3}.producto-item[_ngcontent-%COMP%]   .add-producto-btn[_ngcontent-%COMP%]:disabled{background:#9ca3af;cursor:not-allowed}.producto-item[_ngcontent-%COMP%]   .add-producto-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.repuestos-list[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;color:#374151;font-weight:500}.repuesto-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;background-color:#fff;border-radius:6px;border:1px solid #e5e7eb;margin-bottom:8px}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]{flex:1;min-width:0}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-header[_ngcontent-%COMP%]   .repuesto-codigo[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-header[_ngcontent-%COMP%]   .repuesto-precio[_ngcontent-%COMP%]{font-size:14px;color:#059669;font-weight:600}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-nombre[_ngcontent-%COMP%]{display:block;font-size:14px;color:#374151;font-weight:500;margin-bottom:8px}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   .cantidad-input[_ngcontent-%COMP%]{width:60px;padding:4px 8px;border:1px solid #D1D5DB;border-radius:4px;font-size:12px;text-align:center;background-color:#fafafb;color:#111827}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   .unidad[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.repuesto-item[_ngcontent-%COMP%]   .remove-repuesto[_ngcontent-%COMP%]{background:none;border:none;padding:8px;color:#dc2626;cursor:pointer;display:flex;align-items:center;justify-content:center}.repuesto-item[_ngcontent-%COMP%]   .remove-repuesto[_ngcontent-%COMP%]:hover{color:#b91c1c}.repuesto-item[_ngcontent-%COMP%]   .remove-repuesto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.costo-total[_ngcontent-%COMP%]{margin-top:16px;padding:12px;background-color:#f0f9ff;border:1px solid #BAE6FD;border-radius:6px;text-align:center}.costo-total[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#0369a1;font-size:14px}.no-repuestos[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.no-repuestos[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#d1d5db;margin-bottom:16px}.no-repuestos[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;color:#374151}.no-repuestos[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;color:#6b7280}.modal-footer[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e5e7eb;background:#fff;flex-shrink:0;z-index:10;position:sticky;bottom:0;left:0;right:0}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:6px;font-size:14px;font-weight:500;display:flex;align-items:center;gap:8px;cursor:pointer;transition:all .2s}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{background:none;border:1px solid #d1d5db;color:#374151}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f8fafc;border-color:#9ca3af}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#2563eb;border:1px solid #2563eb;color:#fff}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#1d4ed8;border-color:#1d4ed8}@media (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:100vh;max-height:none}.modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-content[_ngcontent-%COMP%]{height:auto;overflow:auto}.modal-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto auto;height:auto;overflow:visible}.form-section[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e5e7eb;height:auto;max-height:none;overflow:visible;padding-bottom:30px}.images-section[_ngcontent-%COMP%]{height:auto;max-height:none;overflow:visible;min-height:300px;padding-bottom:80px}.form-control[_ngcontent-%COMP%]{font-size:16px;padding:12px}textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{font-size:14px!important;padding:12px}.add-repuesto[_ngcontent-%COMP%]{flex-direction:column}.add-repuesto[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]{width:100%;justify-content:center}}@media (display-mode: standalone) and (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px));max-height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px))}.modal-header[_ngcontent-%COMP%]{padding-top:calc(16px + var(--safe-area-top, 0px))}.modal-footer[_ngcontent-%COMP%]{padding-bottom:calc(16px + var(--safe-area-bottom, 0px))}}@supports (-webkit-touch-callout: none){@media (display-mode: standalone) and (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px));max-height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px))}.modal-header[_ngcontent-%COMP%]{padding-top:calc(16px + var(--safe-area-top, 0px))}.modal-footer[_ngcontent-%COMP%]{padding-bottom:calc(16px + var(--safe-area-bottom, 0px))}}}@supports not (padding-top: env(safe-area-inset-top)){@media (display-mode: standalone) and (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:calc(100vh - 40px);max-height:calc(100vh - 40px)}.modal-header[_ngcontent-%COMP%]{padding-top:36px}.modal-footer[_ngcontent-%COMP%]{padding-bottom:36px}}}.info-message[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;padding:12px;background-color:#eff6ff;border:1px solid #BFDBFE;border-radius:6px;margin-bottom:16px}.info-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:18px;margin-top:2px;flex-shrink:0}.info-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#1e40af;line-height:1.4}`]});let r=l;return r})();var Qt=(()=>{let l=class l{constructor(e){this.supabaseClientService=e,this.supabase=this.supabaseClientService.getClient()}crearAlbaran(e){return V(this.supabase.from("albaranes").insert([e]).select().single()).pipe(R(({data:t,error:o})=>{if(o)throw o;return t}),D(t=>{throw console.error("Error al crear albar\xE1n:",t),t}))}getAlbaran(e){return V(this.supabase.from("albaranes").select(`
          *,
          trabajo:trabajos_realizados(*),
          aviso:avisos(*)
        `).eq("id",e).single()).pipe(R(({data:t,error:o})=>{if(o)throw o;return t}),D(t=>{throw console.error("Error al obtener albar\xE1n:",t),t}))}getAlbaranesAviso(e){return V(this.supabase.from("albaranes").select(`
          *,
          trabajo:trabajos_realizados(*)
        `).eq("aviso_id",e).order("fecha_cierre",{ascending:!1})).pipe(R(({data:t,error:o})=>{if(o)throw o;return t}),D(t=>{throw console.error("Error al obtener albaranes del aviso:",t),t}))}getAlbaranesTrabajo(e){return V(this.supabase.from("albaranes").select("*").eq("trabajo_id",e).order("fecha_cierre",{ascending:!1})).pipe(R(({data:t,error:o})=>{if(o)throw o;return t}),D(t=>{throw console.error("Error al obtener albaranes del trabajo:",t),t}))}actualizarAlbaran(e,t){return V(this.supabase.from("albaranes").update(ce(re({},t),{fecha_actualizacion:new Date})).eq("id",e).select().single()).pipe(R(({data:o,error:d})=>{if(d)throw d;return o}),D(o=>{throw console.error("Error al actualizar albar\xE1n:",o),o}))}eliminarAlbaran(e){return V(this.supabase.from("albaranes").delete().eq("id",e)).pipe(R(({error:t})=>{if(t)throw t}),D(t=>{throw console.error("Error al eliminar albar\xE1n:",t),t}))}getEstadisticasAlbaranes(e){return V(this.supabase.from("albaranes").select("estado_cierre").eq("aviso_id",e)).pipe(R(({data:t,error:o})=>{if(o)throw o;let d=t;return{total:d.length,finalizados:d.filter(P=>P.estado_cierre==="Finalizado").length,presupuestoPendiente:d.filter(P=>P.estado_cierre==="Presupuesto pendiente").length,otraVisita:d.filter(P=>P.estado_cierre==="Otra visita").length}}),D(t=>{throw console.error("Error al obtener estad\xEDsticas de albaranes:",t),t}))}};l.\u0275fac=function(t){return new(t||l)(Ue(ft))},l.\u0275prov=qe({token:l,factory:l.\u0275fac,providedIn:"root"});let r=l;return r})();var un=["signaturePad"];function fn(r,l){if(r&1){let i=O();n(0,"div",53),u("click",function(){let t=C(i).$implicit,o=g(2);return b(o.agregarRepuesto(t))}),n(1,"div",54)(2,"div",55)(3,"span",56),c(4),a(),n(5,"span",57),c(6),h(7,"currency"),a()(),n(8,"span",58),c(9),a(),n(10,"div",59)(11,"span",60),c(12),a(),n(13,"span",61),c(14),a()()(),m(15,"ion-icon",62),a()}if(r&2){let i=l.$implicit;s(4),_(i.codigo),s(2),_(k(7,6,i.precio_neto,"EUR","symbol","1.2-2")),s(3),_(i.nombre),s(3),z("Stock: ",i.cantidad_disponible," ",i.unidad,""),s(2),_(i.descripcion)}}function Cn(r,l){if(r&1){let i=O();n(0,"div",45)(1,"div",46)(2,"h4"),c(3,"Seleccionar Repuestos"),a(),n(4,"button",47),u("click",function(){C(i);let t=g();return b(t.cerrarSelectorRepuestos())}),m(5,"ion-icon",3),a()(),n(6,"div",48)(7,"ion-input",49),oe("ngModelChange",function(t){C(i);let o=g();return ne(o.busquedaRepuesto,t)||(o.busquedaRepuesto=t),b(t)}),u("ionInput",function(t){C(i);let o=g();return b(o.filtrarProductos(t))}),a(),m(8,"ion-icon",50),a(),n(9,"div",51),x(10,fn,16,11,"div",52),a()()}if(r&2){let i=g();s(7),te("ngModel",i.busquedaRepuesto),s(3),p("ngForOf",i.productosFiltrados)}}function bn(r,l){if(r&1&&(n(0,"div",66)(1,"strong"),c(2),h(3,"currency"),a()()),r&2){let i=g(2);s(2),v("Precio Total: ",k(3,1,i.calcularPrecioTotalRepuestos(),"EUR","symbol","1.2-2"),"")}}function xn(r,l){if(r&1){let i=O();n(0,"div",67)(1,"div",68)(2,"span",69),c(3),a(),n(4,"div",70)(5,"label"),c(6,"Cantidad:"),a(),n(7,"input",71),u("change",function(t){let o=C(i).$implicit,d=g(2);return b(d.actualizarCantidadRepuesto(o,t.target.value))}),a(),n(8,"span",72),c(9),a()(),n(10,"div",73)(11,"span",74),c(12),h(13,"number"),a(),n(14,"span",75),c(15),h(16,"currency"),a()()(),n(17,"button",76),u("click",function(){let t=C(i).$implicit,o=g(2);return b(o.eliminarRepuesto(t))}),m(18,"ion-icon",77),a()()}if(r&2){let i=l.$implicit;s(3),_(i.nombre),s(4),p("value",i.cantidad)("min",1),s(2),_(i.unidad),s(3),z("\u20AC",A(13,7,i.precio_pvp,"1.2-2"),"/",i.unidad,""),s(3),_(k(16,10,i.precio_pvp*i.cantidad,"EUR","symbol","1.2-2"))}}function Pn(r,l){if(r&1&&(n(0,"div",63)(1,"h4"),c(2,"Repuestos Seleccionados:"),a(),x(3,bn,4,6,"div",64)(4,xn,19,15,"div",65),a()),r&2){let i=g();s(3),p("ngIf",i.repuestosSeleccionados.length>0),s(),p("ngForOf",i.repuestosSeleccionados)}}function On(r,l){r&1&&(n(0,"div",78),m(1,"ion-icon",21),n(2,"p"),c(3,"No hay repuestos seleccionados"),a(),n(4,"small"),c(5,"Selecciona repuestos del inventario o agrega manualmente"),a()())}function Mn(r,l){r&1&&m(0,"ion-icon",82)}function vn(r,l){if(r&1){let i=O();n(0,"div",79),u("click",function(){let t=C(i).$implicit,o=g();return b(o.albaranForm.patchValue({estado_cierre:t.valor}))}),n(1,"div",80)(2,"h4"),c(3),a(),n(4,"p"),c(5),a()(),x(6,Mn,1,0,"ion-icon",81),a()}if(r&2){let i,e,t=l.$implicit,o=g();U("selected",((i=o.albaranForm.get("estado_cierre"))==null?null:i.value)===t.valor),s(3),_(t.label),s(2),_(t.descripcion),s(),p("ngIf",((e=o.albaranForm.get("estado_cierre"))==null?null:e.value)===t.valor)}}function hn(r,l){r&1&&(n(0,"div",8)(1,"h3"),c(2,"Presupuesto Necesario"),a(),n(3,"div",10),m(4,"ion-input",83),a()())}function yn(r,l){if(r&1){let i=O();n(0,"div",84),m(1,"canvas",85,0),n(3,"div",86)(4,"button",87),u("click",function(){C(i);let t=g();return b(t.limpiarFirma())}),m(5,"ion-icon",77),c(6," Limpiar "),a(),n(7,"button",88),u("click",function(){C(i);let t=g();return b(t.guardarFirma())}),m(8,"ion-icon",89),c(9," Guardar Firma "),a()()()}}function wn(r,l){if(r&1){let i=O();n(0,"div",90),m(1,"img",91),n(2,"div",92)(3,"button",93),u("click",function(){C(i);let t=g();return b(t.editarFirma())}),m(4,"ion-icon",94),c(5," Editar "),a(),n(6,"button",76),u("click",function(){C(i);let t=g();return b(t.eliminarFirma())}),m(7,"ion-icon",77),c(8," Eliminar "),a()()()}if(r&2){let i=g();s(),p("src",i.firmaDataUrl,se)}}function En(r,l){if(r&1){let i=O();n(0,"div",95)(1,"span"),c(2,"\xC1rea de firma digital"),a(),n(3,"small"),c(4,"Haz clic para comenzar a firmar"),a(),n(5,"button",96),u("click",function(){C(i);let t=g();return b(t.iniciarFirma())}),m(6,"ion-icon",94),c(7," Comenzar Firma "),a()()}}function kn(r,l){if(r&1){let i=O();n(0,"div",53),u("click",function(){let t=C(i).$implicit,o=g(2);return b(o.agregarRepuesto(t))}),n(1,"div",54)(2,"div",55)(3,"span",56),c(4),a(),n(5,"span",57),c(6),h(7,"currency"),a()(),n(8,"span",58),c(9),a(),n(10,"div",59)(11,"span",60),c(12),a(),n(13,"span",61),c(14),a()()(),m(15,"ion-icon",62),a()}if(r&2){let i=l.$implicit;s(4),_(i.codigo),s(2),_(k(7,6,i.precio_neto,"EUR","symbol","1.2-2")),s(3),_(i.nombre),s(3),z("Stock: ",i.cantidad_disponible," ",i.unidad,""),s(2),_(i.descripcion)}}function jn(r,l){if(r&1){let i=O();n(0,"div",45)(1,"div",46)(2,"h4"),c(3,"Seleccionar Repuestos"),a(),n(4,"button",47),u("click",function(){C(i);let t=g();return b(t.cerrarSelectorRepuestos())}),m(5,"ion-icon",3),a()(),n(6,"div",48)(7,"ion-input",49),oe("ngModelChange",function(t){C(i);let o=g();return ne(o.busquedaRepuesto,t)||(o.busquedaRepuesto=t),b(t)}),u("ionInput",function(t){C(i);let o=g();return b(o.filtrarProductos(t))}),a(),m(8,"ion-icon",50),a(),n(9,"div",51),x(10,kn,16,11,"div",52),a()()}if(r&2){let i=g();s(7),te("ngModel",i.busquedaRepuesto),s(3),p("ngForOf",i.productosFiltrados)}}function zn(r,l){if(r&1&&(n(0,"div",66)(1,"strong"),c(2),h(3,"currency"),a()()),r&2){let i=g(2);s(2),v("Precio Total: ",k(3,1,i.calcularPrecioTotalRepuestos(),"EUR","symbol","1.2-2"),"")}}function Sn(r,l){if(r&1){let i=O();n(0,"div",67)(1,"div",68)(2,"span",69),c(3),a(),n(4,"div",70)(5,"label"),c(6,"Cantidad:"),a(),n(7,"input",71),u("change",function(t){let o=C(i).$implicit,d=g(2);return b(d.actualizarCantidadRepuesto(o,t.target.value))}),a(),n(8,"span",72),c(9),a()(),n(10,"div",73)(11,"span",74),c(12),h(13,"number"),a(),n(14,"span",75),c(15),h(16,"currency"),a()()(),n(17,"button",76),u("click",function(){let t=C(i).$implicit,o=g(2);return b(o.eliminarRepuesto(t))}),m(18,"ion-icon",77),a()()}if(r&2){let i=l.$implicit;s(3),_(i.nombre),s(4),p("value",i.cantidad)("min",1),s(2),_(i.unidad),s(3),z("\u20AC",A(13,7,i.precio_pvp,"1.2-2"),"/",i.unidad,""),s(3),_(k(16,10,i.precio_pvp*i.cantidad,"EUR","symbol","1.2-2"))}}function In(r,l){if(r&1&&(n(0,"div",63)(1,"h4"),c(2,"Repuestos Seleccionados:"),a(),x(3,zn,4,6,"div",64)(4,Sn,19,15,"div",65),a()),r&2){let i=g();s(3),p("ngIf",i.repuestosSeleccionados.length>0),s(),p("ngForOf",i.repuestosSeleccionados)}}function An(r,l){r&1&&(n(0,"div",78),m(1,"ion-icon",21),n(2,"p"),c(3,"No hay repuestos seleccionados"),a(),n(4,"small"),c(5,"Selecciona repuestos del inventario o agrega manualmente"),a()())}function Fn(r,l){if(r&1&&(n(0,"div",97),m(1,"ion-icon",98),n(2,"span"),c(3),a()()),r&2){let i=g();s(3),_(i.error)}}function Tn(r,l){r&1&&m(0,"ion-icon",99)}function Vn(r,l){r&1&&m(0,"ion-icon",100)}var Yt=(()=>{let l=class l{constructor(e,t,o,d,f,P){this.fb=e,this.modalController=t,this.inventarioService=o,this.albaranesService=d,this.trabajosService=f,this.avisosService=P,this.loading=!1,this.error=null,this.productosInventario=[],this.productosFiltrados=[],this.busquedaRepuesto="",this.mostrarSelectorRepuestos=!1,this.repuestosSeleccionados=[],this.firmaCapturada=!1,this.firmaDataUrl="",this.mostrarCanvas=!1,this.estadosCierre=[{valor:"Finalizado",label:"Finalizado",descripcion:"Trabajo completado, listo para facturar"},{valor:"Presupuesto pendiente",label:"Presupuesto pendiente",descripcion:"Se requiere presupuesto adicional"},{valor:"Otra visita",label:"Otra visita",descripcion:"Se necesita realizar otra visita"}],console.log("HacerAlbaranComponent constructor called"),F({close:ie,timeOutline:K,cubeOutline:At,addCircleOutline:Mt,searchOutline:ke,trashOutline:X,checkmarkCircleOutline:Q,checkmarkOutline:kt,createOutline:ye,warningOutline:je,saveOutline:Ee,refreshOutline:J,calendarOutline:ve,personOutline:Y,pencilOutline:ae,documentTextOutline:q}),this.albaranForm=this.fb.group({fecha_cierre:[new Date,w.required],hora_entrada:["",w.required],hora_salida:["",w.required],descripcion_trabajo_realizado:["",w.required],repuestos_utilizados:[[]],estado_cierre:["",w.required],presupuesto_necesario:[0,[w.min(0)]],dni_cliente:[""],nombre_firma:[""],firma_cliente:[""],observaciones:[""]})}ngOnInit(){return y(this,null,function*(){console.log("\u{1F3AF} HacerAlbaranComponent ngOnInit - Trabajo:",this.trabajo),console.log("\u{1F3AF} HacerAlbaranComponent ngOnInit - Aviso:",this.aviso),console.log("\u{1F3AF} Formulario inicializado:",this.albaranForm);try{yield this.cargarProductosInventario(),this.inicializarFormulario()}catch(e){console.error("Error al inicializar componente:",e)}})}ngAfterViewInit(){setTimeout(()=>{this.inicializarSignaturePad()},100)}inicializarFormulario(){this.trabajo&&(this.albaranForm.patchValue({hora_entrada:this.trabajo.hora_inicio,hora_salida:this.trabajo.hora_fin,repuestos_utilizados:this.trabajo.repuestos||[]}),this.trabajo.repuestos&&this.trabajo.repuestos.length>0&&(console.log("\u{1F50D} inicializarFormulario - Repuestos existentes encontrados:",this.trabajo.repuestos),console.log("\u{1F50D} inicializarFormulario - Materiales del trabajo:",this.trabajo.materiales),this.repuestosSeleccionados=this.trabajo.repuestos.map(e=>{var P;let t=this.productosInventario.find(j=>j.nombre===e),o=(P=this.trabajo.materiales)==null?void 0:P.find(j=>{var S;return((S=j.material)==null?void 0:S.nombre)===e}),d=(o==null?void 0:o.cantidad_utilizada)||1;console.log("\u{1F50D} Buscando material:",e,"Material encontrado:",o,"Cantidad real:",d);let f={nombre:e,cantidad:d,precio_neto:(t==null?void 0:t.precio_neto)||0,precio_pvp:(t==null?void 0:t.pvp)||(t==null?void 0:t.precio_neto)||0,unidad:(t==null?void 0:t.unidad)||"unidad",codigo:(t==null?void 0:t.codigo)||""};return console.log("\u{1F50D} inicializarFormulario - Repuesto convertido:",f),f}),this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados})))}cargarProductosInventario(){return new Promise((e,t)=>{this.inventarioService.getInventario(1,1e3,"","nombre","asc",!1).subscribe({next:o=>{this.productosInventario=o.inventario,this.productosFiltrados=[...this.productosInventario],console.log(" Inventario cargado:",this.productosInventario.length,"productos"),e()},error:o=>{console.error("Error al cargar productos del inventario:",o),t(o)}})})}filtrarProductos(e){var o;let t=((o=e==null?void 0:e.target)==null?void 0:o.value)||e||"";this.busquedaRepuesto=t,t.trim()?this.productosFiltrados=this.productosInventario.filter(d=>{var f;return d.nombre.toLowerCase().includes(t.toLowerCase())||d.codigo.toLowerCase().includes(t.toLowerCase())||(((f=d.descripcion)==null?void 0:f.toLowerCase())||"").includes(t.toLowerCase())}):this.productosFiltrados=[...this.productosInventario]}abrirSelectorRepuestos(){this.mostrarSelectorRepuestos=!0,this.productosFiltrados=[...this.productosInventario],this.busquedaRepuesto=""}cerrarSelectorRepuestos(){this.mostrarSelectorRepuestos=!1}agregarRepuesto(e){console.log("\u{1F50D} agregarRepuesto - Producto recibido:",e);let t=this.repuestosSeleccionados.find(o=>o.nombre===e.nombre);if(t)t.cantidad+=1,console.log("\u{1F50D} agregarRepuesto - Repuesto existente, cantidad aumentada a:",t.cantidad);else{let o={nombre:e.nombre,cantidad:1,precio_neto:e.precio_neto||0,precio_pvp:e.pvp||e.precio_neto||0,unidad:e.unidad||"unidad",codigo:e.codigo||""};console.log("\u{1F50D} agregarRepuesto - Nuevo repuesto creado:",o),this.repuestosSeleccionados.push(o)}this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados}),console.log("\u{1F50D} agregarRepuesto - Repuestos seleccionados actualizados:",this.repuestosSeleccionados),this.cerrarSelectorRepuestos()}eliminarRepuesto(e){this.repuestosSeleccionados=this.repuestosSeleccionados.filter(t=>t!==e),this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados})}actualizarCantidadRepuesto(e,t){t>0&&(e.cantidad=t,this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados}))}agregarRepuestoManual(){let e=prompt("Introduce el nombre del repuesto:");if(e&&e.trim()){let t=prompt("Introduce la cantidad utilizada:"),o=parseInt(t||"1");if(o>0){let d=prompt("Introduce el precio por unidad (\u20AC):"),f=parseFloat(d||"0"),P=prompt("Introduce la unidad (unidad, kg, m, etc.):")||"unidad",j={nombre:e.trim(),cantidad:o,precio_neto:f,precio_pvp:f,unidad:P,codigo:""};console.log("\u{1F50D} agregarRepuestoManual - Repuesto manual creado:",j),this.repuestosSeleccionados.push(j),this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados})}}}generarHoraActual(){let e=new Date;return`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`}establecerHoraActual(){let e=this.generarHoraActual();this.albaranForm.patchValue({hora_salida:e})}establecerFechaActual(){this.albaranForm.patchValue({fecha_cierre:new Date})}guardarAlbaran(){if(this.albaranForm.valid){this.loading=!0,this.error=null;let e={trabajo_id:this.trabajo.id,aviso_id:this.aviso.id,fecha_cierre:this.albaranForm.value.fecha_cierre,hora_entrada:this.albaranForm.value.hora_entrada,hora_salida:this.albaranForm.value.hora_salida,descripcion_trabajo_realizado:this.albaranForm.value.descripcion_trabajo_realizado,repuestos_utilizados:this.albaranForm.value.repuestos_utilizados,estado_cierre:this.albaranForm.value.estado_cierre,presupuesto_necesario:this.albaranForm.value.presupuesto_necesario,dni_cliente:this.albaranForm.value.dni_cliente,nombre_firma:this.albaranForm.value.nombre_firma,firma_cliente:this.albaranForm.value.firma_cliente,observaciones:this.albaranForm.value.observaciones};console.log("Datos del albar\xE1n:",e),this.albaranesService.crearAlbaran(e).subscribe({next:t=>{console.log("Albar\xE1n guardado exitosamente:",t);let o="Abierto";t.estado_cierre==="Finalizado"?o="Finalizado":(t.estado_cierre==="Presupuesto pendiente"||t.estado_cierre==="Otra visita")&&(o="Cerrado"),this.trabajosService.actualizarEstadoTrabajo(this.trabajo.id,o,t.id).subscribe({next:d=>{console.log("Trabajo actualizado exitosamente:",d),this.avisosService.actualizarEstadoAutomatico(this.aviso.id).subscribe({next:f=>{this.loading=!1,console.log("Estado del aviso actualizado autom\xE1ticamente:",f),this.modalController.dismiss({success:!0,albaran:t,trabajo:d,aviso:f,mensaje:"Albar\xE1n guardado exitosamente"})},error:f=>{console.error("Error al actualizar estado del aviso:",f),this.loading=!1,this.modalController.dismiss({success:!0,albaran:t,trabajo:d,mensaje:"Albar\xE1n guardado exitosamente"})}})},error:d=>{this.loading=!1,this.error="Error al actualizar el trabajo: "+(d.message||"Error desconocido"),console.error("Error al actualizar trabajo:",d)}})},error:t=>{this.loading=!1,this.error="Error al guardar el albar\xE1n: "+(t.message||"Error desconocido"),console.error("Error al guardar albar\xE1n:",t)}})}else this.error="Por favor, complete todos los campos requeridos",this.marcarCamposComoTocados()}marcarCamposComoTocados(){Object.keys(this.albaranForm.controls).forEach(e=>{let t=this.albaranForm.get(e);t==null||t.markAsTouched()})}cancelar(){this.modalController.dismiss()}requierePresupuesto(){var e;return((e=this.albaranForm.get("estado_cierre"))==null?void 0:e.value)==="Presupuesto pendiente"}requiereOtraVisita(){var e;return((e=this.albaranForm.get("estado_cierre"))==null?void 0:e.value)==="Otra visita"}calcularPrecioTotalRepuestos(){return this.repuestosSeleccionados.reduce((e,t)=>e+t.precio_pvp*t.cantidad,0)}debugTrabajo(e){console.log("Trabajo:",e),console.log("Repuestos:",e.repuestos),console.log("Repuestos con cantidades:",e.materiales),console.log("Precio total repuestos:",this.calcularPrecioTotalRepuestos())}iniciarFirma(){this.mostrarCanvas=!0,this.firmaCapturada=!1,this.firmaDataUrl=""}inicializarSignaturePad(){var t;if(!((t=this.signaturePadElement)!=null&&t.nativeElement)){console.warn("Canvas no encontrado");return}let e=this.signaturePadElement.nativeElement;import("./chunk-PGY3UNFJ.js").then(({default:o})=>{this.signaturePad=new o(e,{backgroundColor:"white",penColor:"black",minWidth:1,maxWidth:2.5,throttle:16,velocityFilterWeight:.7,dotSize:1}),this.ajustarCanvas(),window.addEventListener("resize",()=>this.ajustarCanvas())})}ajustarCanvas(){var P;if(!((P=this.signaturePadElement)!=null&&P.nativeElement)||!this.signaturePad)return;let e=this.signaturePadElement.nativeElement,t=e.parentElement;if(!t)return;let o=t.getBoundingClientRect(),d=Math.max(o.width-40,200),f=150;e.width=d,e.height=f,this.signaturePad.resizeCanvas()}limpiarFirma(){this.signaturePad&&this.signaturePad.clear()}guardarFirma(){this.signaturePad&&!this.signaturePad.isEmpty()?(this.firmaDataUrl=this.signaturePad.toDataURL(),this.firmaCapturada=!0,this.mostrarCanvas=!1,this.albaranForm.patchValue({firma_cliente:this.firmaDataUrl}),console.log("Firma guardada exitosamente")):console.warn("No hay firma para guardar")}editarFirma(){this.mostrarCanvas=!0,this.firmaCapturada=!1,this.signaturePad&&this.signaturePad.clear()}eliminarFirma(){this.firmaCapturada=!1,this.firmaDataUrl="",this.mostrarCanvas=!1,this.signaturePad&&this.signaturePad.clear(),this.albaranForm.patchValue({firma_cliente:""}),console.log("Firma eliminada")}};l.\u0275fac=function(t){return new(t||l)(M(xe),M(Me),M(Se),M(Qt),M(Z),M(ze))},l.\u0275cmp=$({type:l,selectors:[["app-hacer-albaran"]],viewQuery:function(t,o){if(t&1&&le(un,5),t&2){let d;de(d=pe())&&(o.signaturePadElement=d.first)}},inputs:{trabajo:"trabajo",aviso:"aviso"},decls:105,vars:17,consts:[["signaturePad",""],["slot","end"],[3,"click"],["name","close"],[1,"albaran-container"],[3,"ngSubmit","formGroup"],[1,"form-layout"],[1,"form-main"],[1,"form-section"],[1,"form-row"],[1,"form-group"],["type","date","formControlName","fecha_cierre",3,"click"],[1,"help-text"],["type","time","formControlName","hora_entrada","step","900"],["type","time","formControlName","hora_salida","step","900",3,"click"],["type","button",1,"btn-now",3,"click"],["name","time-outline"],["formControlName","descripcion_trabajo_realizado","placeholder","Describe detalladamente el trabajo realizado...","rows","3"],[1,"form-section","repuestos-section","mobile-only"],[1,"repuestos-actions"],["type","button",1,"btn-select-inventory",3,"click"],["name","cube-outline"],["type","button",1,"btn-add-manual",3,"click"],["name","add-circle-outline"],["class","inventory-selector",4,"ngIf"],["class","repuestos-list",4,"ngIf"],["class","repuestos-empty",4,"ngIf"],[1,"estados-grid"],["class","estado-option",3,"selected","click",4,"ngFor","ngForOf"],["class","form-section",4,"ngIf"],["formControlName","observaciones","placeholder","Observaciones adicionales...","rows","2"],["type","text","formControlName","dni_cliente","placeholder","DNI del cliente"],["type","text","formControlName","nombre_firma","placeholder","Nombre de la persona que firma"],[1,"signature-area"],["class","signature-canvas-container",4,"ngIf"],["class","signature-preview",4,"ngIf"],["class","signature-placeholder",4,"ngIf"],[1,"form-sidebar"],[1,"form-section","repuestos-section","desktop-only"],["class","error-message",4,"ngIf"],[1,"form-actions"],["type","button","fill","outline",3,"click"],["type","submit",3,"disabled"],["name","save-outline",4,"ngIf"],["name","refresh-outline","class","spinning",4,"ngIf"],[1,"inventory-selector"],[1,"selector-header"],["type","button",1,"btn-close",3,"click"],[1,"search-container"],["type","text","placeholder","Buscar repuestos...",1,"search-input",3,"ngModelChange","ionInput","ngModel"],["name","search-outline"],[1,"products-list"],["class","product-item",3,"click",4,"ngFor","ngForOf"],[1,"product-item",3,"click"],[1,"product-info"],[1,"product-header"],[1,"product-code"],[1,"product-price"],[1,"product-name"],[1,"product-details"],[1,"product-stock"],[1,"product-description"],["name","add-circle-outline",1,"add-icon"],[1,"repuestos-list"],["class","precio-total",4,"ngIf"],["class","repuesto-item",4,"ngFor","ngForOf"],[1,"precio-total"],[1,"repuesto-item"],[1,"repuesto-info"],[1,"repuesto-nombre"],[1,"repuesto-cantidad"],["type","number",1,"cantidad-input",3,"change","value","min"],[1,"unidad"],[1,"repuesto-precio-info"],[1,"precio-unitario"],[1,"precio-total-item"],["type","button",1,"btn-remove",3,"click"],["name","trash-outline"],[1,"repuestos-empty"],[1,"estado-option",3,"click"],[1,"estado-content"],["name","checkmark-circle-outline",4,"ngIf"],["name","checkmark-circle-outline"],["type","number","formControlName","presupuesto_necesario","placeholder","0.00","step","0.01"],[1,"signature-canvas-container"],[1,"signature-canvas"],[1,"signature-controls"],["type","button",1,"btn-clear",3,"click"],["type","button",1,"btn-save",3,"click"],["name","checkmark-outline"],[1,"signature-preview"],["alt","Firma del cliente",1,"firma-image",3,"src"],[1,"signature-actions"],["type","button",1,"btn-edit",3,"click"],["name","create-outline"],[1,"signature-placeholder"],["type","button",1,"btn-start-signature",3,"click"],[1,"error-message"],["name","warning-outline"],["name","save-outline"],["name","refresh-outline",1,"spinning"]],template:function(t,o){t&1&&(n(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),c(3,"VISTA CIERRE ALBAR\xC1N"),a(),n(4,"ion-buttons",1)(5,"ion-button",2),u("click",function(){return o.cancelar()}),m(6,"ion-icon",3),a()()()(),n(7,"ion-content")(8,"div",4)(9,"form",5),u("ngSubmit",function(){return o.guardarAlbaran()}),n(10,"div",6)(11,"div",7)(12,"div",8)(13,"h3"),c(14,"Fecha y Horarios"),a(),n(15,"div",9)(16,"div",10)(17,"ion-label"),c(18,"FECHA"),a(),n(19,"ion-input",11),u("click",function(){return o.establecerFechaActual()}),a(),n(20,"small",12),c(21,"Autom\xE1tica d\xEDa actual"),a()(),n(22,"div",10)(23,"ion-label"),c(24,"HORA ENTRADA"),a(),m(25,"ion-input",13),n(26,"small",12),c(27,"Men\xFA interactivo 15 en 15 min"),a()(),n(28,"div",10)(29,"ion-label"),c(30,"HORA SALIDA"),a(),n(31,"ion-input",14),u("click",function(){return o.establecerHoraActual()}),a(),n(32,"button",15),u("click",function(){return o.establecerHoraActual()}),m(33,"ion-icon",16),c(34," Ahora "),a()()()(),n(35,"div",8)(36,"h3"),c(37,"Descripci\xF3n del Trabajo Realizado"),a(),n(38,"div",10),m(39,"ion-textarea",17),a()(),n(40,"div",18)(41,"h3"),c(42,"Repuestos Utilizados"),a(),n(43,"div",19)(44,"button",20),u("click",function(){return o.abrirSelectorRepuestos()}),m(45,"ion-icon",21),c(46," Seleccionar del Inventario "),a(),n(47,"button",22),u("click",function(){return o.agregarRepuestoManual()}),m(48,"ion-icon",23),c(49," Agregar Manualmente "),a()(),x(50,Cn,11,2,"div",24)(51,Pn,5,2,"div",25)(52,On,6,0,"div",26),a(),n(53,"div",8)(54,"h3"),c(55,"Estado de Cierre"),a(),n(56,"div",27),x(57,vn,7,5,"div",28),a()(),x(58,hn,5,0,"div",29),n(59,"div",8)(60,"h3"),c(61,"Observaciones Adicionales"),a(),n(62,"div",10),m(63,"ion-textarea",30),a()(),n(64,"div",8)(65,"h3"),c(66,"Identificaci\xF3n y Firma"),a(),n(67,"div",9)(68,"div",10)(69,"ion-label"),c(70,"DNI"),a(),m(71,"ion-input",31),a(),n(72,"div",10)(73,"ion-label"),c(74,"NOMBRE FIRMA"),a(),m(75,"ion-input",32),a()(),n(76,"div",10)(77,"ion-label"),c(78,"FIRMA"),a(),n(79,"div",33),x(80,yn,10,0,"div",34)(81,wn,9,1,"div",35)(82,En,8,0,"div",36),a()()()(),n(83,"div",37)(84,"div",38)(85,"h3"),c(86,"Repuestos Utilizados"),a(),n(87,"div",19)(88,"button",20),u("click",function(){return o.abrirSelectorRepuestos()}),m(89,"ion-icon",21),c(90," Seleccionar del Inventario "),a(),n(91,"button",22),u("click",function(){return o.agregarRepuestoManual()}),m(92,"ion-icon",23),c(93," Agregar Manualmente "),a()(),x(94,jn,11,2,"div",24)(95,In,5,2,"div",25)(96,An,6,0,"div",26),a()()(),x(97,Fn,4,1,"div",39),n(98,"div",40)(99,"ion-button",41),u("click",function(){return o.cancelar()}),c(100," Cancelar "),a(),n(101,"ion-button",42),x(102,Tn,1,0,"ion-icon",43)(103,Vn,1,0,"ion-icon",44),c(104),a()()()()()),t&2&&(s(9),p("formGroup",o.albaranForm),s(41),p("ngIf",o.mostrarSelectorRepuestos),s(),p("ngIf",o.repuestosSeleccionados.length>0),s(),p("ngIf",o.repuestosSeleccionados.length===0&&!o.mostrarSelectorRepuestos),s(5),p("ngForOf",o.estadosCierre),s(),p("ngIf",o.requierePresupuesto()),s(22),p("ngIf",!o.firmaCapturada),s(),p("ngIf",o.firmaCapturada),s(),p("ngIf",!o.firmaCapturada&&!o.mostrarCanvas),s(12),p("ngIf",o.mostrarSelectorRepuestos),s(),p("ngIf",o.repuestosSeleccionados.length>0),s(),p("ngIf",o.repuestosSeleccionados.length===0&&!o.mostrarSelectorRepuestos),s(),p("ngIf",o.error),s(4),p("disabled",!o.albaranForm.valid||o.loading),s(),p("ngIf",!o.loading),s(),p("ngIf",o.loading),s(),v(" ",o.loading?"Guardando...":"Guardar Albar\xE1n"," "))},dependencies:[B,H,N,ge,G,Oe,fe,me,_e,Ce,be,Pe,ue,W,ct,_t,ut,pt,lt,dt,mt,gt,st],styles:["ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #fff;--border-color: #e5e7eb;--color: #111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--color: #6b7280}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:hover{--color: #111827}.albaran-container[_ngcontent-%COMP%]{padding:24px;height:100%;display:flex;flex-direction:column;overflow:hidden;background:#fff}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;gap:20px;overflow-y:auto;padding-right:4px}form[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}form[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}form[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}form[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}.form-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:24px;flex:1}@media (min-width: 1200px){.form-layout[_ngcontent-%COMP%]{grid-template-columns:2fr 1fr;gap:32px}}.form-main[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;order:1}.form-sidebar[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;order:2}.form-section[_ngcontent-%COMP%]{background:#fff;border:1px solid #E2E8F0;border-radius:12px;padding:24px;box-shadow:0 1px 3px #0000001a;flex-shrink:0}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;font-size:18px;font-weight:600;color:#1f2937;border-bottom:2px solid #4F46E5;padding-bottom:8px}.repuestos-section[_ngcontent-%COMP%]{position:sticky;top:20px}.repuestos-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{border-bottom-color:#10b981}@media (max-width: 1199px){.repuestos-section[_ngcontent-%COMP%]{position:static;top:auto}}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px}@media (min-width: 1200px){.form-row[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr);gap:24px}}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.form-group[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:8px;text-transform:none;letter-spacing:normal}.form-group[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{--background: #FAFAFB;--border-radius: 6px;--border-width: 1px;--border-color: transparent;--padding-start: 12px;--padding-end: 12px;--padding-top: 10px;--padding-bottom: 10px;--color: #111827;--placeholder-color: #9CA3AF;font-size:14px;transition:border-color .2s}.form-group[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]:focus-within, .form-group[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]:focus-within, .form-group[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]:focus-within{--border-color: #2563eb;--background: #fff;box-shadow:0 0 0 2px #2563eb1a}.form-group[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{--min-height: 80px;resize:vertical}.help-text[_ngcontent-%COMP%]{display:block;font-size:11px;color:#6b7280;margin-top:4px;font-style:italic;line-height:1.4}.btn-now[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 12px;background:#2563eb;color:#fff;border:none;border-radius:6px;font-size:12px;font-weight:500;cursor:pointer;margin-top:8px;transition:all .2s ease}.btn-now[_ngcontent-%COMP%]:hover{background:#1d4ed8}.btn-now[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.estados-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}@media (min-width: 1200px){.estados-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr);gap:20px}}.estado-option[_ngcontent-%COMP%]{border:2px solid #E5E7EB;border-radius:8px;padding:20px;cursor:pointer;transition:all .2s ease;position:relative;background:#fff}.estado-option[_ngcontent-%COMP%]:hover{border-color:#2563eb;transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.estado-option.selected[_ngcontent-%COMP%]{border-color:#2563eb;background:#eff6ff}.estado-option.selected[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#2563eb}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;font-weight:600;color:#111827}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:13px;color:#6b7280;line-height:1.4}.estado-option[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px;font-size:20px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]{border:2px dashed #D1D5DB;border-radius:8px;padding:20px;text-align:center;background:#f9fafb;transition:all .2s ease;min-height:200px;display:flex;align-items:center;justify-content:center;position:relative}.signature-area[_ngcontent-%COMP%]:hover{border-color:#2563eb;background:#eff6ff}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;gap:16px}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-canvas[_ngcontent-%COMP%]{border:1px solid #E5E7EB;border-radius:6px;background:#fff;cursor:crosshair;touch-action:none}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-clear[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-clear[_ngcontent-%COMP%]:hover{background:#fecaca}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]{background:#10b981;color:#fff}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]:hover{background:#059669}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;gap:16px}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .firma-image[_ngcontent-%COMP%]{max-width:100%;max-height:120px;border:1px solid #E5E7EB;border-radius:6px;background:#fff}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]{background:#dbeafe;color:#1d4ed8}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]:hover{background:#bfdbfe}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]:hover{background:#fecaca}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;color:#6b7280;margin-top:15px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;font-weight:500}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 20px;background:#2563eb;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s;margin-top:8px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]:hover{background:#1d4ed8}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#fef2f2;border:1px solid #FECACA;border-radius:6px;color:#dc2626;margin-bottom:20px;font-size:14px}.error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;color:#dc2626;flex-shrink:0}.error-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end;margin-top:auto;padding-top:24px;border-top:1px solid #E5E7EB;flex-shrink:0;background:#fff;position:sticky;bottom:0;left:0;right:0;z-index:10}.form-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;--padding-top: 8px;--padding-bottom: 8px;font-weight:500;font-size:14px;min-width:140px;border-radius:6px;transition:all .2s}.form-actions[_ngcontent-%COMP%]   ion-button[fill=outline][_ngcontent-%COMP%]{--border-color: #d1d5db;--color: #374151}.form-actions[_ngcontent-%COMP%]   ion-button[fill=outline][_ngcontent-%COMP%]:hover{--background: #f8fafc;--border-color: #9ca3af}.form-actions[_ngcontent-%COMP%]   ion-button[type=submit][_ngcontent-%COMP%]{--background: #2563eb;--border-color: #2563eb;--color: #fff}.form-actions[_ngcontent-%COMP%]   ion-button[type=submit][_ngcontent-%COMP%]:hover{--background: #1d4ed8;--border-color: #1d4ed8}.repuestos-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:24px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;padding:10px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;width:100%}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.repuestos-actions[_ngcontent-%COMP%]   .btn-select-inventory[_ngcontent-%COMP%]{background:#2563eb;color:#fff}.repuestos-actions[_ngcontent-%COMP%]   .btn-select-inventory[_ngcontent-%COMP%]:hover{background:#1d4ed8}.repuestos-actions[_ngcontent-%COMP%]   .btn-add-manual[_ngcontent-%COMP%]{background:#10b981;color:#fff}.repuestos-actions[_ngcontent-%COMP%]   .btn-add-manual[_ngcontent-%COMP%]:hover{background:#059669}.repuestos-empty[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#9ca3af}.repuestos-empty[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:16px;opacity:.5}.repuestos-empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;font-weight:500;color:#6b7280}.repuestos-empty[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:13px;color:#9ca3af;line-height:1.4}.inventory-selector[_ngcontent-%COMP%]{background:#fff;border:1px solid #E2E8F0;border-radius:8px;padding:20px;margin-bottom:20px;box-shadow:0 1px 3px #0000001a;max-height:400px;overflow:hidden;display:flex;flex-direction:column}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#1f2937;font-size:16px;font-weight:600}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;font-size:20px;cursor:pointer;padding:4px;border-radius:4px;transition:all .2s}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{position:relative;margin-bottom:16px}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{--background: #FAFAFB;--border-radius: 6px;--border-width: 1px;--border-color: transparent;--padding-start: 40px 12px 12px;--padding-end: 12px;--padding-top: 10px;--padding-bottom: 10px;--color: #111827;--placeholder-color: #9CA3AF;font-size:14px;transition:border-color .2s}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus-within{--border-color: #2563eb;--background: #fff;box-shadow:0 0 0 2px #2563eb1a}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#9ca3af;font-size:18px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]{flex:1;max-height:250px;overflow-y:auto;border:1px solid #E5E7EB;border-radius:6px;background:#f9fafb}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid #E5E7EB;cursor:pointer;transition:all .2s}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]{flex:1}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]   .product-code[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;background:#e5e7eb;padding:2px 6px;border-radius:4px;font-weight:500}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]   .product-price[_ngcontent-%COMP%]{font-weight:600;color:#059669;font-size:13px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;font-size:13px;margin-bottom:4px;display:block}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-stock[_ngcontent-%COMP%]{font-size:11px;color:#6b7280}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-description[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .add-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:18px;margin-left:8px}.repuestos-list[_ngcontent-%COMP%]{margin-top:20px}.repuestos-list[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:#1f2937;font-size:16px;font-weight:600}.repuestos-list[_ngcontent-%COMP%]   .precio-total[_ngcontent-%COMP%]{background:#f0fdf4;border:1px solid #BBF7D0;border-radius:6px;padding:12px 16px;margin-bottom:16px;text-align:center}.repuestos-list[_ngcontent-%COMP%]   .precio-total[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#059669;font-size:16px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:#f0f9ff;border:1px solid #BAE6FD;border-radius:6px;margin-bottom:8px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:16px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-nombre[_ngcontent-%COMP%]{font-weight:500;color:#0369a1;font-size:14px;min-width:120px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   .cantidad-input[_ngcontent-%COMP%]{width:60px;padding:4px 8px;border:1px solid #D1D5DB;border-radius:4px;font-size:12px;text-align:center;background-color:#fafafb;color:#111827}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   .unidad[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;font-weight:500}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-precio-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:4px;min-width:100px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-precio-info[_ngcontent-%COMP%]   .precio-unitario[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;font-weight:500}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-precio-info[_ngcontent-%COMP%]   .precio-total-item[_ngcontent-%COMP%]{font-weight:600;color:#059669;font-size:13px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626;border:none;padding:6px;border-radius:6px;cursor:pointer;transition:all .2s}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]:hover{background:#fecaca}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}ion-button[type=submit][disabled][_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}ion-button[type=submit][_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{margin-right:8px}.mobile-only[_ngcontent-%COMP%]{display:block}.desktop-only[_ngcontent-%COMP%]{display:none}@media (min-width: 1200px){.mobile-only[_ngcontent-%COMP%]{display:none}.desktop-only[_ngcontent-%COMP%]{display:block}}@media (max-width: 768px){.albaran-container[_ngcontent-%COMP%]{padding:16px}.form-main[_ngcontent-%COMP%]{order:1}.form-sidebar[_ngcontent-%COMP%]{order:2}.form-section[_ngcontent-%COMP%]{padding:20px;margin-bottom:20px}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;margin-bottom:16px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.estados-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.estado-option[_ngcontent-%COMP%]{padding:16px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:15px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}.estado-option[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;top:12px;right:12px}.repuestos-actions[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.form-actions[_ngcontent-%COMP%]{gap:12px}.form-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%;justify-content:center}.signature-area[_ngcontent-%COMP%]{padding:30px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:11px}}@media (min-width: 769px) and (max-width: 1199px){.albaran-container[_ngcontent-%COMP%]{padding:24px}.form-main[_ngcontent-%COMP%]{order:1}.form-sidebar[_ngcontent-%COMP%]{order:2}.form-row[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:20px}.estados-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:16px}.repuestos-actions[_ngcontent-%COMP%]{flex-direction:row;gap:12px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;min-width:0}}@media (min-width: 1200px){.albaran-container[_ngcontent-%COMP%]{padding:32px}.form-main[_ngcontent-%COMP%]{order:1}.form-sidebar[_ngcontent-%COMP%]{order:2}.form-section[_ngcontent-%COMP%]{padding:28px}.form-row[_ngcontent-%COMP%]{gap:28px}.estados-grid[_ngcontent-%COMP%]{gap:24px}.repuestos-actions[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:14px 20px;font-size:15px}.form-actions[_ngcontent-%COMP%]{gap:20px}.form-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{min-width:160px;--padding-start: 28px;--padding-end: 28px;--padding-top: 14px;--padding-bottom: 14px;font-size:15px}}@media (max-width: 480px){.albaran-container[_ngcontent-%COMP%]{padding:12px}.form-main[_ngcontent-%COMP%]{order:1}.form-sidebar[_ngcontent-%COMP%]{order:2}.form-section[_ngcontent-%COMP%]{padding:16px;margin-bottom:16px}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px;margin-bottom:12px}.form-group[_ngcontent-%COMP%]{margin-bottom:16px}.form-group[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:13px;margin-bottom:6px}.estado-option[_ngcontent-%COMP%]{padding:12px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:14px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px}.estado-option[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;top:8px;right:8px}.signature-area[_ngcontent-%COMP%]{padding:15px 0;border-color:#2563eb;background:#eff6ff;display:flex;flex-direction:column}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .help-text[_ngcontent-%COMP%]{font-size:10px}.btn-now[_ngcontent-%COMP%]{padding:4px 8px;font-size:11px}.btn-now[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}}"]});let r=l;return r})();function Dn(r,l){r&1&&(n(0,"div",4),m(1,"ion-icon",5),n(2,"span",6),c(3,"Cargando estado del flujo..."),a(),n(4,"span",7),c(5,"Cargando..."),a()())}function $n(r,l){if(r&1){let i=O();n(0,"div",8),m(1,"ion-icon",9),n(2,"span",10),c(3),a(),n(4,"button",11),u("click",function(){C(i);let t=g();return b(t.recargar())}),m(5,"ion-icon",12),n(6,"span",6),c(7,"Reintentar"),a(),n(8,"span",7),c(9,"Reintentar"),a()()()}if(r&2){let i=g();s(3),_(i.error)}}function Hn(r,l){if(r&1){let i=O();n(0,"button",26),u("click",function(){let t=C(i).$implicit,o=g(3);return b(o.ejecutarAccion(t))}),m(1,"ion-icon",17),n(2,"span",27),c(3),a()()}if(r&2){let i=l.$implicit,e=g(3);p("disabled",e.loading)("title",e.getAccionTexto(i)),s(),p("name",e.getAccionIcon(i)),s(2),_(e.getAccionTexto(i))}}function Nn(r,l){if(r&1&&(n(0,"div",22)(1,"h4",23),c(2,"Acciones disponibles:"),a(),n(3,"div",24),x(4,Hn,4,4,"button",25),a()()),r&2){let i=g(2);s(4),p("ngForOf",i.accionesDisponibles)}}function Bn(r,l){r&1&&(n(0,"div",30),m(1,"ion-icon",31),n(2,"span",32),c(3,"No hay acciones pendientes"),a()())}function qn(r,l){if(r&1&&(n(0,"div",28),x(1,Bn,4,0,"div",29),a()),r&2){let i=g(2);s(),p("ngIf",i.accionesDisponibles.length===0&&!i.estadoFlujo.puedeCrearPresupuesto)}}function Un(r,l){if(r&1){let i=O();n(0,"div",13)(1,"div",14)(2,"div",15)(3,"div",16),m(4,"ion-icon",17),n(5,"span",18),c(6),a()(),n(7,"button",19),u("click",function(){C(i);let t=g();return b(t.recargar())}),m(8,"ion-icon",12),a()()(),x(9,Nn,5,1,"div",20)(10,qn,2,1,"div",21),a()}if(r&2){let i=g();s(3),p("ngClass",i.getEstadoClass()),s(),p("name",i.getEstadoIcon()),s(2),_(i.estadoFlujo.estadoActual),s(3),p("ngIf",i.accionesDisponibles.length>0),s(),p("ngIf",i.estadoFlujo.estadoActual==="No visitado"||i.estadoFlujo.estadoActual==="Visitado pendiente")}}var Jt=(()=>{let l=class l{constructor(e){this.flujoService=e,this.accionEjecutada=new Le,this.estadoFlujo=null,this.accionesDisponibles=[],this.loading=!1,this.error=null,this.destroy$=new L,F({documentTextOutline:q,checkmarkCircleOutline:Q,timeOutline:K,receiptOutline:Nt,createOutline:ye,eyeOutline:we,arrowForwardOutline:wt,warningOutline:je,refreshOutline:J})}ngOnInit(){this.avisoId&&this.cargarEstadoFlujo()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarEstadoFlujo(){this.loading=!0,this.error=null,this.flujoService.obtenerEstadoFlujo(this.avisoId).pipe(E(this.destroy$)).subscribe({next:e=>{this.estadoFlujo=e,this.cargarAccionesDisponibles(),this.loading=!1},error:e=>{console.error("Error al cargar estado del flujo:",e),this.error="Error al cargar el estado del flujo",this.loading=!1}})}cargarAccionesDisponibles(){this.flujoService.obtenerAccionesDisponibles(this.avisoId).pipe(E(this.destroy$)).subscribe({next:e=>{this.accionesDisponibles=e},error:e=>{console.error("Error al cargar acciones:",e)}})}ejecutarAccion(e){var o,d,f,P,j,S;this.loading=!0,this.error=null;let t;switch(e){case"crear_presupuesto":t=this.flujoService.ejecutarFlujoCompleto(this.avisoId,!0);break;case"aprobar_presupuesto":let T=(f=(d=(o=this.estadoFlujo)==null?void 0:o.resumen)==null?void 0:d.presupuesto)==null?void 0:f.id;T&&(t=this.flujoService.aprobarPresupuesto(T));break;case"facturar_presupuesto":let Be=(S=(j=(P=this.estadoFlujo)==null?void 0:P.resumen)==null?void 0:j.presupuesto)==null?void 0:S.id;Be&&(t=this.flujoService.facturarPresupuesto(Be));break;case"facturar_trabajos":t=this.flujoService.facturarTrabajos(this.avisoId);break;case"completar_aviso":this.completarAviso();break;default:this.loading=!1;return}t&&t.pipe(E(this.destroy$)).subscribe({next:T=>{console.log("Acci\xF3n ejecutada:",T),this.accionEjecutada.emit(T),this.cargarEstadoFlujo(),this.loading=!1},error:T=>{console.error("Error al ejecutar acci\xF3n:",T),this.error=`Error al ejecutar ${e}: ${T.message}`,this.loading=!1}})}iniciarFlujoDirecto(){this.loading=!0,this.flujoService.ejecutarFlujoCompleto(this.avisoId,!1).pipe(E(this.destroy$)).subscribe({next:e=>{console.log("Flujo directo iniciado:",e),this.accionEjecutada.emit(e),this.cargarEstadoFlujo(),this.loading=!1},error:e=>{console.error("Error al iniciar flujo directo:",e),this.error=`Error al iniciar flujo directo: ${e.message}`,this.loading=!1}})}completarAviso(){if(!this.avisoId){console.error("No hay aviso seleccionado para completar");return}console.log("\u{1F504} Completando aviso:",this.avisoId),this.loading=!0,this.flujoService.completarAviso(this.avisoId).subscribe({next:e=>{console.log("\u2705 Aviso completado exitosamente:",e),this.loading=!1,this.mostrarMensaje("Aviso completado exitosamente","success"),this.cargarEstadoFlujo()},error:e=>{console.error("\u274C Error al completar aviso:",e),this.loading=!1,this.mostrarMensaje(e.message||"Error al completar el aviso. Verifica que haya trabajos realizados y facturas generadas.","error")}})}mostrarMensaje(e,t="info"){console.log(`[${t.toUpperCase()}] ${e}`)}getEstadoIcon(){if(!this.estadoFlujo)return"time-outline";switch(this.estadoFlujo.estadoActual){case"No visitado":return"time-outline";case"Visitado pendiente":return"eye-outline";case"Pendiente de presupuesto":return"document-text-outline";case"En curso":return"create-outline";case"Completado":return"checkmark-circle-outline";default:return"time-outline"}}getEstadoClass(){if(!this.estadoFlujo)return"pendiente";switch(this.estadoFlujo.estadoActual){case"No visitado":case"Visitado pendiente":return"pendiente";case"Pendiente de presupuesto":return"presupuesto";case"En curso":return"en-curso";case"Completado":return"completado";default:return"pendiente"}}getAccionTexto(e){switch(e){case"crear_presupuesto":return"Crear Presupuesto";case"aprobar_presupuesto":return"Aprobar Presupuesto";case"facturar_presupuesto":return"Generar Factura desde Presupuesto";case"facturar_trabajos":return"Facturar Trabajos Realizados";case"completar_aviso":return"Completar Aviso";default:return e}}getAccionIcon(e){switch(e){case"crear_presupuesto":return"document-text-outline";case"aprobar_presupuesto":return"checkmark-circle-outline";case"facturar_presupuesto":case"facturar_trabajos":return"receipt-outline";case"completar_aviso":return"checkmark-circle-outline";default:return"arrow-forward-outline"}}recargar(){this.cargarEstadoFlujo()}};l.\u0275fac=function(t){return new(t||l)(M(Ie))},l.\u0275cmp=$({type:l,selectors:[["app-flujo-estado"]],inputs:{avisoId:"avisoId"},outputs:{accionEjecutada:"accionEjecutada"},decls:4,vars:3,consts:[[1,"flujo-estado-container"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","flujo-content",4,"ngIf"],[1,"loading-state"],["name","refresh-outline",1,"spinning"],[1,"desktop-only"],[1,"mobile-only"],[1,"error-state"],["name","warning-outline"],[1,"error-text"],[1,"btn-retry",3,"click"],["name","refresh-outline"],[1,"flujo-content"],[1,"estado-actual"],[1,"estado-header"],[1,"estado-badge",3,"ngClass"],[3,"name"],[1,"estado-text"],["title","Actualizar estado",1,"btn-refresh",3,"click"],["class","acciones-disponibles",4,"ngIf"],["class","flujo-inicial",4,"ngIf"],[1,"acciones-disponibles"],[1,"section-title"],[1,"acciones-grid"],["class","btn-accion",3,"disabled","title","click",4,"ngFor","ngForOf"],[1,"btn-accion",3,"click","disabled","title"],[1,"accion-text"],[1,"flujo-inicial"],["class","sin-acciones",4,"ngIf"],[1,"sin-acciones"],["name","checkmark-circle-outline",1,"complete-icon"],[1,"complete-text"]],template:function(t,o){t&1&&(n(0,"div",0),x(1,Dn,6,0,"div",1)(2,$n,10,1,"div",2)(3,Un,11,5,"div",3),a()),t&2&&(s(),p("ngIf",o.loading),s(),p("ngIf",o.error&&!o.loading),s(),p("ngIf",o.estadoFlujo&&!o.loading&&!o.error))},dependencies:[B,Xe,H,N,W],styles:[".flujo-estado-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;border:1px solid #E2E8F0;overflow:hidden;box-shadow:0 1px 3px #0000001a}.desktop-only[_ngcontent-%COMP%]{display:inline}.mobile-only[_ngcontent-%COMP%]{display:none}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;padding:24px;text-align:center;color:#64748b;font-size:14px}.loading-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#4f46e5}.loading-state.error-state[_ngcontent-%COMP%], .error-state.error-state[_ngcontent-%COMP%]{color:#dc2626}.loading-state.error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state.error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#dc2626}.error-text[_ngcontent-%COMP%]{word-break:break-word;line-height:1.4}.btn-retry[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:#f1f5f9;border:1px solid #CBD5E1;border-radius:8px;font-size:12px;color:#475569;cursor:pointer;transition:all .2s ease}.btn-retry[_ngcontent-%COMP%]:hover{background:#e2e8f0;border-color:#94a3b8}.btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.flujo-content[_ngcontent-%COMP%]{padding:20px}.estado-actual[_ngcontent-%COMP%]{margin-bottom:24px}.estado-actual[_ngcontent-%COMP%]   .estado-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;border-radius:20px;font-size:14px;font-weight:500}.estado-actual[_ngcontent-%COMP%]   .estado-badge.pendiente[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.estado-actual[_ngcontent-%COMP%]   .estado-badge.pendiente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#d97706}.estado-actual[_ngcontent-%COMP%]   .estado-badge.presupuesto[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.estado-actual[_ngcontent-%COMP%]   .estado-badge.presupuesto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#3b82f6}.estado-actual[_ngcontent-%COMP%]   .estado-badge.en-curso[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.estado-actual[_ngcontent-%COMP%]   .estado-badge.en-curso[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#22c55e}.estado-actual[_ngcontent-%COMP%]   .estado-badge.completado[_ngcontent-%COMP%]{background:#ecfdf5;color:#14532d}.estado-actual[_ngcontent-%COMP%]   .estado-badge.completado[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#10b981}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.estado-actual[_ngcontent-%COMP%]   .estado-text[_ngcontent-%COMP%]{font-weight:500}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:#f8fafc;border:1px solid #E2E8F0;border-radius:8px;cursor:pointer;transition:all .2s ease}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;color:#64748b}.resumen-info[_ngcontent-%COMP%]{background:#f8fafc;border-radius:8px;padding:16px}.resumen-info[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:13px;color:#64748b;font-weight:500}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:13px;color:#1e293b;font-weight:600}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value.si[_ngcontent-%COMP%]{color:#059669}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value.no[_ngcontent-%COMP%]{color:#dc2626}.acciones-disponibles[_ngcontent-%COMP%]{margin-bottom:24px}.acciones-disponibles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0 0 12px;font-size:16px;color:#1e293b;font-weight:600}.acciones-disponibles[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:12px 16px;background:#4f46e5;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;text-align:left}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]:hover:not(:disabled){background:#4338ca;transform:translateY(-1px);box-shadow:0 4px 8px #4f46e54d}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;flex-shrink:0}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   .accion-text[_ngcontent-%COMP%]{flex:1}.flujo-inicial[_ngcontent-%COMP%]{margin-bottom:24px}.flujo-inicial[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;color:#1e293b;font-weight:600}.flujo-inicial[_ngcontent-%COMP%]   .flujo-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:20px;background:#f8fafc;border:1px solid #E2E8F0;border-radius:12px;transition:all .2s ease}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]:hover{background:#f0f9ff;border-color:#4f46e5;transform:translateY(-1px);box-shadow:0 4px 12px #0000001a}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:28px;color:#4f46e5;flex-shrink:0;background:#eef2ff;padding:12px;border-radius:50%}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;flex:1}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1e293b}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-description[_ngcontent-%COMP%]{font-size:14px;color:#64748b;line-height:1.4}.sin-acciones[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;padding:20px;color:#64748b;font-size:14px;text-align:center}.sin-acciones[_ngcontent-%COMP%]   .complete-icon[_ngcontent-%COMP%]{font-size:20px;color:#10b981}.sin-acciones[_ngcontent-%COMP%]   .complete-text[_ngcontent-%COMP%]{font-weight:500}@media (max-width: 768px){.desktop-only[_ngcontent-%COMP%]{display:none}.mobile-only[_ngcontent-%COMP%]{display:inline}.flujo-content[_ngcontent-%COMP%]{padding:16px}.estado-actual[_ngcontent-%COMP%]{margin-bottom:20px}.estado-actual[_ngcontent-%COMP%]   .estado-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;margin-bottom:12px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{width:28px;height:28px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.resumen-info[_ngcontent-%COMP%]{padding:12px}.resumen-info[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:12px}.acciones-disponibles[_ngcontent-%COMP%]{margin-bottom:20px}.acciones-disponibles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:15px;margin-bottom:10px}.acciones-disponibles[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{padding:10px 12px;font-size:13px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.flujo-inicial[_ngcontent-%COMP%]{margin-bottom:20px}.flujo-inicial[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:15px;margin-bottom:10px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-info[_ngcontent-%COMP%]{gap:12px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]{padding:16px;gap:12px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;padding:10px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:14px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-description[_ngcontent-%COMP%]{font-size:12px}.sin-acciones[_ngcontent-%COMP%]{padding:16px}.sin-acciones[_ngcontent-%COMP%]   .complete-icon[_ngcontent-%COMP%]{font-size:18px}.sin-acciones[_ngcontent-%COMP%]   .complete-text[_ngcontent-%COMP%]{font-size:13px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{padding:20px;font-size:13px}.loading-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.btn-retry[_ngcontent-%COMP%]{padding:6px 12px;font-size:11px}.btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}}@media (max-width: 480px){.flujo-content[_ngcontent-%COMP%]{padding:12px}.estado-actual[_ngcontent-%COMP%]{margin-bottom:16px}.estado-actual[_ngcontent-%COMP%]   .estado-header[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between;gap:8px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{justify-content:center;padding:4px 10px;font-size:12px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{align-self:center;width:24px;height:24px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.resumen-info[_ngcontent-%COMP%]{padding:10px}.resumen-info[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{gap:6px}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:11px}.acciones-disponibles[_ngcontent-%COMP%]{margin-bottom:16px}.acciones-disponibles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:14px;margin-bottom:8px}.acciones-disponibles[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{gap:6px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{padding:8px 10px;font-size:12px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.flujo-inicial[_ngcontent-%COMP%]{margin-bottom:16px}.flujo-inicial[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:14px;margin-bottom:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-info[_ngcontent-%COMP%]{gap:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]{padding:12px;gap:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;padding:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:13px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-description[_ngcontent-%COMP%]{font-size:11px}.sin-acciones[_ngcontent-%COMP%]{padding:12px;gap:8px}.sin-acciones[_ngcontent-%COMP%]   .complete-icon[_ngcontent-%COMP%]{font-size:16px}.sin-acciones[_ngcontent-%COMP%]   .complete-text[_ngcontent-%COMP%]{font-size:12px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{padding:16px;font-size:12px;gap:8px}.loading-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.btn-retry[_ngcontent-%COMP%]{padding:4px 8px;font-size:10px}.btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:10px}}"]});let r=l;return r})();var Ln=["fileInput"];function Gn(r,l){r&1&&(n(0,"div",31)(1,"div",32),m(2,"ion-icon",33),n(3,"p"),c(4,"Cargando aviso..."),a()()())}function Wn(r,l){if(r&1){let i=O();n(0,"div",34)(1,"div",35),m(2,"ion-icon",36),n(3,"p"),c(4),a(),n(5,"button",37),u("click",function(){C(i);let t=g();return b(t.cargarAviso())}),m(6,"ion-icon",38),c(7," Reintentar "),a()()()}if(r&2){let i=g();s(4),_(i.error)}}function Qn(r,l){if(r&1){let i=O();n(0,"button",66),u("click",function(){C(i);let t=g(2);return b(t.completarAviso())}),m(1,"ion-icon",67),n(2,"span",17),c(3,"Completar Aviso"),a(),n(4,"span",18),c(5,"Completar"),a()()}}function Yn(r,l){if(r&1){let i=O();n(0,"button",15),u("click",function(){C(i);let t=g(2);return b(t.editarAviso())}),m(1,"ion-icon",68),n(2,"span",17),c(3,"Editar aviso"),a(),n(4,"span",18),c(5,"Editar"),a()()}}function Jn(r,l){r&1&&(n(0,"div",69),m(1,"ion-icon",70),n(2,"span"),c(3,"Aviso completado"),a()())}function Kn(r,l){if(r&1&&(n(0,"div",71),m(1,"ion-icon",72),n(2,"span"),c(3),a()()),r&2){let i=g(2);s(3),_(i.aviso.nombre_contacto)}}function Xn(r,l){if(r&1&&(n(0,"div",73),m(1,"ion-icon",74),n(2,"span"),c(3),a()()),r&2){let i=g(2);s(3),_(i.aviso.telefono_cliente_aviso)}}function Zn(r,l){if(r&1&&(n(0,"div",73),m(1,"ion-icon",75),n(2,"span"),c(3),a()()),r&2){let i=g(2);s(3),_(i.aviso.cliente==null?null:i.aviso.cliente.email)}}function eo(r,l){if(r&1){let i=O();n(0,"div",5)(1,"div",12)(2,"div",39)(3,"div",40)(4,"button",41),u("click",function(){C(i);let t=g();return b(t.volverALista())}),m(5,"ion-icon",42),n(6,"span",17),c(7,"Volver"),a(),n(8,"span",18),c(9,"Volver"),a()()()(),n(10,"div",43),x(11,Qn,6,0,"button",44)(12,Yn,6,0,"button",45)(13,Jn,4,0,"div",46),a(),n(14,"span",47),c(15),a()(),n(16,"h2",48)(17,"span",17),c(18),a()(),n(19,"div",49)(20,"div",50)(21,"div",9)(22,"label"),c(23,"Estado"),a(),n(24,"span",51),c(25),a()(),n(26,"div",9)(27,"label"),c(28,"Urgente"),a(),n(29,"span",52),c(30),a()(),n(31,"div",9)(32,"label"),c(33,"Fecha de creaci\xF3n"),a(),n(34,"span"),c(35),h(36,"date"),a()()(),n(37,"div",53)(38,"label"),c(39,"Cliente"),a(),n(40,"div",54)(41,"span",55),c(42),a(),n(43,"a",56),u("click",function(){C(i);let t=g();return b(t.verCliente())}),n(44,"span",17),c(45,"Ver cliente"),a()()()(),n(46,"div",57)(47,"label"),c(48,"Direcci\xF3n"),a(),n(49,"div",58)(50,"span",59),c(51),a(),n(52,"button",60),u("click",function(){C(i);let t=g();return b(t.verMapa())}),m(53,"ion-icon",61),a()()(),n(54,"div",62)(55,"label"),c(56,"Contacto Cliente"),a(),n(57,"div",63),x(58,Kn,4,1,"div",64)(59,Xn,4,1,"div",65)(60,Zn,4,1,"div",65),a()()()()}if(r&2){let i=g();s(11),p("ngIf",(i.aviso==null?null:i.aviso.estado)!=="Completado"),s(),p("ngIf",(i.aviso==null?null:i.aviso.estado)!=="Completado"),s(),p("ngIf",(i.aviso==null?null:i.aviso.estado)==="Completado"),s(2),v("Aviso #",i.aviso.id==null?null:i.aviso.id.substring(0,8),""),s(3),v("Informaci\xF3n general del Aviso - #",i.aviso.id==null?null:i.aviso.id.substring(0,8),""),s(7),_(i.aviso.estado),s(4),U("urgent",i.aviso.urgencia==="Alta"||i.aviso.es_urgente),s(),v(" ",i.aviso.urgencia==="Alta"||i.aviso.es_urgente?"S\xED":"No"," "),s(5),_(A(36,15,i.aviso.fecha_creacion,"dd/MM/yyyy")),s(7),_(i.aviso.nombre_cliente_aviso),s(9),_(i.aviso.direccion_cliente_aviso),s(7),p("ngIf",i.aviso.nombre_contacto),s(),p("ngIf",i.aviso.telefono_cliente_aviso),s(),p("ngIf",i.aviso.cliente==null?null:i.aviso.cliente.email)}}function to(r,l){if(r&1){let i=O();n(0,"div",76)(1,"div",77)(2,"app-flujo-estado",78),u("accionEjecutada",function(t){C(i);let o=g();return b(o.onAccionFlujoEjecutada(t))}),a()()()}if(r&2){let i=g();s(2),p("avisoId",(i.aviso==null?null:i.aviso.id)||"")}}function no(r,l){r&1&&(n(0,"div",31)(1,"div",32),m(2,"ion-icon",33),n(3,"p"),c(4,"Cargando trabajos..."),a()()())}function oo(r,l){r&1&&(n(0,"div",79)(1,"div",80),m(2,"ion-icon",81),n(3,"p"),c(4,"No hay trabajos realizados para este aviso"),a(),n(5,"small"),c(6,"Crea el primer parte de trabajo para comenzar"),a()()())}function io(r,l){if(r&1&&(n(0,"li"),c(1),a()),r&2){let i=l.$implicit;s(),Fe(" ",(i.material==null?null:i.material.nombre)||"Material",": ",i.cantidad_utilizada," ",(i.material==null?null:i.material.unidad)||"unidad"," ")}}function ao(r,l){if(r&1&&(n(0,"ul",104),x(1,io,2,3,"li",83),a()),r&2){let i=g().$implicit;s(),p("ngForOf",i.materiales)}}function ro(r,l){if(r&1&&(n(0,"li"),c(1),a()),r&2){let i=l.$implicit;s(),_(i)}}function co(r,l){if(r&1&&(n(0,"ul",104),x(1,ro,2,1,"li",83),a()),r&2){let i=g().$implicit;s(),p("ngForOf",i.repuestos)}}function so(r,l){r&1&&(n(0,"span",105),c(1," Sin materiales "),a())}function lo(r,l){if(r&1&&(n(0,"div",106)(1,"span",107),m(2,"ion-icon",70),c(3," Albar\xE1n Cerrado "),a(),n(4,"small",108),c(5),a()()),r&2){let i=g().$implicit,e=g(2);s(),ee("badge-"+e.getAlbaranEstado(i)),s(4),v(" ",e.getAlbaranEstado(i)," ")}}function po(r,l){if(r&1){let i=O();n(0,"button",109),u("click",function(){C(i);let t=g().$implicit,o=g(2);return b(o.editarTrabajo(t))}),m(1,"ion-icon",68),n(2,"span",17),c(3,"Editar"),a(),n(4,"span",18),c(5,"Editar"),a()()}}function go(r,l){if(r&1){let i=O();n(0,"button",110),u("click",function(){C(i);let t=g().$implicit,o=g(2);return b(o.eliminarTrabajo(t))}),m(1,"ion-icon",111),n(2,"span",17),c(3,"Eliminar"),a(),n(4,"span",18),c(5,"Eliminar"),a()()}}function mo(r,l){if(r&1){let i=O();n(0,"tr")(1,"td",84),c(2),a(),n(3,"td",85),c(4),h(5,"date"),a(),n(6,"td",86),c(7),h(8,"number"),a(),n(9,"td",87)(10,"div",88)(11,"p"),c(12),a(),n(13,"small"),c(14),a()()(),n(15,"td",89)(16,"div",90),x(17,ao,2,1,"ul",91)(18,co,2,1,"ul",91)(19,so,2,0,"span",92),a()(),n(20,"td",93)(21,"span",94),c(22),a()(),n(23,"td",95)(24,"div",96)(25,"button",97),u("click",function(){let t=C(i).$implicit,o=g(2);return b(o.debugTrabajo(t))}),m(26,"ion-icon",98),n(27,"span",17),c(28,"Debug"),a(),n(29,"span",18),c(30,"Debug"),a()(),n(31,"button",99),u("click",function(){let t=C(i).$implicit,o=g(2);return b(o.hacerAlbaran(t))}),m(32,"ion-icon",100),n(33,"span",17),c(34,"Crear Albar\xE1n"),a(),n(35,"span",18),c(36,"Albar\xE1n"),a()(),x(37,lo,6,3,"div",101)(38,po,6,0,"button",102)(39,go,6,0,"button",103),a()()()}if(r&2){let i=l.$implicit,e=l.index,t=g(2);s(2),v("#",e+1,""),s(2),_(A(5,15,i.fecha_trabajo,"dd/MM/yyyy")),s(3),v("",A(8,18,t.calcularHorasTrabajo(i),"1.1-1"),"h"),s(5),_(i.descripcion),s(2),z("",i.hora_inicio," - ",i.hora_fin,""),s(3),p("ngIf",i.materiales&&i.materiales.length>0),s(),p("ngIf",(!i.materiales||i.materiales.length===0)&&i.repuestos&&i.repuestos.length>0),s(),p("ngIf",(!i.materiales||i.materiales.length===0)&&(!i.repuestos||i.repuestos.length===0)),s(2),ee("badge-"+i.estado.toLowerCase().replace(" ","-")),s(),v(" ",i.estado," "),s(15),p("ngIf",i.albaran_id),s(),p("ngIf",i.estado!=="Cerrado"&&i.estado!=="Finalizado"),s(),p("ngIf",i.estado!=="Cerrado"&&i.estado!=="Finalizado")}}function _o(r,l){if(r&1&&(n(0,"table",82)(1,"thead")(2,"tr")(3,"th"),c(4,"N\xFAmero"),a(),n(5,"th"),c(6,"Fecha trabajo"),a(),n(7,"th"),c(8,"Horas"),a(),n(9,"th"),c(10,"Descripci\xF3n"),a(),n(11,"th"),c(12,"Materiales"),a(),n(13,"th"),c(14,"Estado"),a(),n(15,"th"),c(16,"Acciones"),a()()(),n(17,"tbody"),x(18,mo,40,21,"tr",83),a()()),r&2){let i=g();s(18),p("ngForOf",i.trabajosRealizados)}}function uo(r,l){if(r&1&&(n(0,"div",120)(1,"label"),c(2,"Presupuesto:"),a(),n(3,"span"),c(4),h(5,"currency"),a()()),r&2){let i=g().$implicit;s(4),_(k(5,1,i.presupuesto_necesario,"EUR","symbol","1.2-2"))}}function fo(r,l){if(r&1&&(We(0),c(1),Qe()),r&2){let i=g().$implicit;s(),Fe(" ",i.nombre,": ",i.cantidad," ",i.unidad||"unidad"," ")}}function Co(r,l){if(r&1&&c(0),r&2){let i=g().$implicit;v(" ",i," ")}}function bo(r,l){if(r&1&&(n(0,"span",127),x(1,fo,2,3,"ng-container",128)(2,Co,1,1,"ng-template",null,1,Ke),a()),r&2){let i=l.$implicit,e=Ye(3);s(),p("ngIf",i.cantidad)("ngIfElse",e)}}function xo(r,l){if(r&1&&(n(0,"div",122)(1,"label"),c(2,"Repuestos utilizados:"),a(),n(3,"div",125),x(4,bo,4,2,"span",126),a()()),r&2){let i=g().$implicit;s(4),p("ngForOf",i.repuestos_utilizados)}}function Po(r,l){if(r&1&&(n(0,"div",120)(1,"label"),c(2,"DNI Cliente:"),a(),n(3,"span"),c(4),a()()),r&2){let i=g(2).$implicit;s(4),_(i.dni_cliente)}}function Oo(r,l){if(r&1&&(n(0,"div",120)(1,"label"),c(2,"Firmado por:"),a(),n(3,"span"),c(4),a()()),r&2){let i=g(2).$implicit;s(4),_(i.nombre_firma)}}function Mo(r,l){if(r&1&&(n(0,"div",119),x(1,Po,5,1,"div",121)(2,Oo,5,1,"div",121),a()),r&2){let i=g().$implicit;s(),p("ngIf",i.dni_cliente),s(),p("ngIf",i.nombre_firma)}}function vo(r,l){if(r&1&&(n(0,"div",122)(1,"label"),c(2,"Observaciones:"),a(),n(3,"p"),c(4),a()()),r&2){let i=g().$implicit;s(4),_(i.observaciones)}}function ho(r,l){if(r&1&&(n(0,"div",115)(1,"div",116)(2,"div",106)(3,"h4"),c(4),a(),n(5,"span",117),c(6),h(7,"date"),a()(),n(8,"div",118)(9,"span",94),c(10),a()()(),n(11,"div",108)(12,"div",119)(13,"div",120)(14,"label"),c(15,"Horario:"),a(),n(16,"span"),c(17),a()(),x(18,uo,6,6,"div",121),a(),n(19,"div",122)(20,"label"),c(21,"Descripci\xF3n del trabajo:"),a(),n(22,"p"),c(23),a()(),x(24,xo,5,1,"div",123)(25,Mo,3,2,"div",124)(26,vo,5,1,"div",123),a()()),r&2){let i=l.$implicit,e=l.index;s(4),v("Albar\xE1n #",e+1,""),s(2),_(A(7,12,i.fecha_cierre,"dd/MM/yyyy")),s(3),ee("badge-"+i.estado_cierre.toLowerCase().replace(" ","-")),s(),v(" ",i.estado_cierre," "),s(7),z("",i.hora_entrada," - ",i.hora_salida,""),s(),p("ngIf",i.presupuesto_necesario>0),s(5),_(i.descripcion_trabajo_realizado),s(),p("ngIf",i.repuestos_utilizados&&i.repuestos_utilizados.length>0),s(),p("ngIf",i.dni_cliente||i.nombre_firma),s(),p("ngIf",i.observaciones)}}function yo(r,l){if(r&1&&(n(0,"div",5)(1,"div",12)(2,"h2"),c(3,"Albaranes Cerrados"),a(),n(4,"div",43)(5,"span",112),c(6),a()()(),n(7,"div",113),x(8,ho,27,15,"div",114),a()()),r&2){let i=g();s(6),v("Total: ",i.aviso.albaranes.length,""),s(2),p("ngForOf",i.aviso.albaranes)}}function wo(r,l){r&1&&(n(0,"div",129),m(1,"ion-icon",33),n(2,"p"),c(3,"Subiendo im\xE1genes..."),a()())}function Eo(r,l){r&1&&(n(0,"div",130),m(1,"ion-icon",131),n(2,"p"),c(3,"No hay im\xE1genes disponibles para este aviso"),a()())}function ko(r,l){if(r&1){let i=O();n(0,"div",132),m(1,"img",133),n(2,"div",134)(3,"span",135),c(4),a(),n(5,"span",136),c(6),h(7,"date"),a()(),n(8,"button",137),u("click",function(){let t=C(i).$implicit,o=g();return b(o.eliminarFoto(t))}),m(9,"ion-icon",111),a()()}if(r&2){let i=l.$implicit;s(),p("src",i.url,se)("alt",i.descripcion||"Imagen del aviso"),s(3),_(i.descripcion||"Imagen del aviso"),s(2),_(A(7,4,i.fecha_subida,"dd/MM/yyyy HH:mm"))}}F({close:ie,pencilOutline:ae,navigate:$e,person:He,call:Ve,mail:Re,mapOutline:De,arrowBackOutline:Te});var fi=(()=>{let l=class l{constructor(e,t,o,d,f,P){this.route=e,this.router=t,this.avisosService=o,this.trabajosService=d,this.modalController=f,this.flujoAvisosService=P,this.vistaGaleria="grid",this.aviso=null,this.loading=!1,this.error=null,this.subiendoImagenes=!1,this.destroy$=new L,this.trabajosRealizados=[],this.loadingTrabajos=!1,F({refreshOutline:J,alertCircleOutline:ht,arrowBackOutline:Te,close:ie,pencilOutline:ae,checkmarkCircleOutline:Q,navigate:$e,person:He,call:Ve,mail:Re,addCircle:Ot,constructOutline:St,bugOutline:Et,documentTextOutline:q,trashOutline:X,imagesOutline:Rt,personOutline:Y,gridOutline:Vt,listOutline:$t,chevronDownOutline:he,eyeOutline:we,ellipsisVerticalOutline:Tt,ellipsisVertical:Ft,add:Pt,mapOutline:De})}ngOnInit(){this.cargarAviso()}cargarTrabajos(){var e;(e=this.aviso)!=null&&e.id&&(this.loadingTrabajos=!0,this.trabajosService.getTrabajosAviso(this.aviso.id).pipe(E(this.destroy$)).subscribe({next:t=>{console.log("\u{1F50D} cargarTrabajos - Respuesta completa:",t),this.trabajosRealizados=t.trabajos,console.log("\u{1F50D} cargarTrabajos - Trabajos cargados:",this.trabajosRealizados),this.trabajosRealizados.forEach((o,d)=>{console.log(`\u{1F50D} cargarTrabajos - Trabajo ${d+1}:`,{id:o.id,estado:o.estado,albaran_id:o.albaran_id,materiales:o.materiales,puedeCrearAlbaran:this.puedeCrearAlbaran(o)})}),this.loadingTrabajos=!1},error:t=>{console.error("Error al cargar trabajos:",t),this.loadingTrabajos=!1}}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarAviso(){this.loading=!0,this.error=null,this.route.params.pipe(E(this.destroy$)).subscribe(e=>{let t=e["id-aviso"];t?this.avisosService.getAviso(t).pipe(E(this.destroy$)).subscribe({next:o=>{this.aviso=o,this.loading=!1,this.cargarTrabajos()},error:o=>{console.error("Error al cargar el aviso:",o),this.error="Error al cargar el aviso. Por favor, int\xE9ntalo de nuevo.",this.loading=!1}}):(this.error="ID de aviso no v\xE1lido",this.loading=!1)})}cambiarVistaGaleria(e){this.vistaGaleria=e.detail.value}volverALista(){let e=document.referrer;e&&e.includes("/historial")?this.router.navigate(["/historial"]):this.router.navigate(["/avisos"])}verCliente(){var e,t;(t=(e=this.aviso)==null?void 0:e.cliente)!=null&&t.id&&console.log("Navegar al cliente:",this.aviso.cliente.id)}verMapa(){var e;if((e=this.aviso)!=null&&e.direccion_cliente_aviso){let t=encodeURIComponent(this.aviso.direccion_cliente_aviso);window.open(`https://www.google.com/maps/search/?api=1&query=${t}`,"_blank")}}editarAviso(){var e;(e=this.aviso)!=null&&e.id&&this.abrirModalEditarAviso()}abrirModalEditarAviso(){return y(this,null,function*(){var d;if(!((d=this.aviso)!=null&&d.id))return;let e=yield this.modalController.create({component:Lt,cssClass:"modal-crear-aviso",componentProps:{modoEdicion:!0,avisoExistente:this.aviso}});yield e.present();let{data:t,role:o}=yield e.onWillDismiss();if(o==="confirm"&&t)try{console.log("Datos del formulario de edici\xF3n:",t);let f={tipo:t.tipo,nombre_cliente_aviso:t.nombreContacto,direccion_cliente_aviso:t.direccionLocal,telefono_cliente_aviso:t.telefono,nombre_contacto:t.nombreContacto,descripcion_problema:t.descripcion,es_urgente:t.esUrgente,urgencia:t.esUrgente?"Alta":"Normal"};this.loading=!0,this.avisosService.actualizarAviso(this.aviso.id,f).pipe(E(this.destroy$)).subscribe({next:P=>{console.log("Aviso actualizado exitosamente:",P),this.loading=!1,this.mostrarMensaje("Aviso actualizado exitosamente","success"),this.cargarAviso()},error:P=>{console.error("Error al actualizar aviso:",P),this.loading=!1,this.mostrarMensaje(P.message||"Error al actualizar el aviso. Por favor, int\xE9ntalo de nuevo.","error")}})}catch(f){console.error("Error al procesar la edici\xF3n:",f),this.mostrarMensaje("Error al procesar la edici\xF3n. Por favor, int\xE9ntalo de nuevo.","error")}})}cerrarAlbaran(){var e;(e=this.aviso)!=null&&e.id&&console.log("Cerrar albar\xE1n para aviso:",this.aviso.id)}seleccionarImagenes(){this.fileInput&&this.fileInput.nativeElement.click()}onFileSelected(e){var o;let t=e.target.files;t.length>0&&((o=this.aviso)!=null&&o.id)&&this.subirImagenes(Array.from(t)),e.target.value=""}subirImagenes(e){return y(this,null,function*(){var t;if(!((t=this.aviso)!=null&&t.id)){console.error("No se puede subir im\xE1genes: aviso no v\xE1lido");return}this.subiendoImagenes=!0,this.error=null;try{yield new Promise(d=>{let f=0,P=e.length;e.forEach(j=>{this.avisosService.subirFoto(this.aviso.id,j).pipe(E(this.destroy$)).subscribe({next:S=>{console.log("Foto subida:",S),f++,f===P&&d()},error:S=>{console.error("Error al subir foto:",S),f++,f===P&&d()}})})}),this.cargarAviso()}catch(o){console.error("Error al subir im\xE1genes:",o),this.error="Error al subir las im\xE1genes. Por favor, int\xE9ntalo de nuevo."}finally{this.subiendoImagenes=!1}})}crearTrabajoRealizado(e){return y(this,null,function*(){var f;if(!((f=this.aviso)!=null&&f.id))return;let t=yield this.modalController.create({component:Wt,componentProps:{avisoId:this.aviso.id,trabajoExistente:e},cssClass:"modal-crear-trabajo"});yield t.present();let{data:o,role:d}=yield t.onWillDismiss();if(d==="confirm"&&o)try{if(e){let P=yield I(this.trabajosService.actualizarTrabajo(e.id,o));console.log("Trabajo actualizado exitosamente:",P),alert("Trabajo actualizado exitosamente.")}else{let P=yield I(this.trabajosService.crearTrabajo(o));console.log("Trabajo creado exitosamente:",P),alert("Trabajo creado exitosamente. Los materiales han sido descontados del inventario.")}this.cargarTrabajos()}catch(P){console.error("Error al procesar trabajo:",P),alert("Error al procesar el trabajo. Por favor, int\xE9ntalo de nuevo.")}})}editarTrabajo(e){return y(this,null,function*(){try{let t=yield I(this.trabajosService.getTrabajo(e.id));yield this.crearTrabajoRealizado(t.trabajo)}catch(t){console.error("Error al cargar el trabajo para editar:",t),alert("Error al cargar el trabajo para editar. Por favor, int\xE9ntalo de nuevo.")}})}eliminarTrabajo(e){return y(this,null,function*(){if(confirm(`\xBFEst\xE1s seguro de que quieres eliminar este trabajo?

Fecha: ${e.fecha_trabajo}
Descripci\xF3n: ${e.descripcion}

Esta acci\xF3n no se puede deshacer y los materiales ser\xE1n devueltos al inventario.`))try{yield I(this.trabajosService.eliminarTrabajo(e.id)),console.log("Trabajo eliminado exitosamente"),alert("Trabajo eliminado exitosamente. Los materiales han sido devueltos al inventario."),this.cargarTrabajos()}catch(o){console.error("Error al eliminar el trabajo:",o),alert("Error al eliminar el trabajo. Por favor, int\xE9ntalo de nuevo.")}})}hacerAlbaran(e){return y(this,null,function*(){var f;if(console.log("Abriendo modal de hacer albar\xE1n para trabajo:",e),!((f=this.aviso)!=null&&f.id))return;let t=yield this.modalController.create({component:Yt,componentProps:{trabajo:e,aviso:this.aviso},cssClass:"modal-hacer-albaran modal-fullscreen",backdropDismiss:!1});console.log("Modal creado:",t),console.log("Presentando modal..."),yield t.present(),console.log("Modal presentado");let{data:o,role:d}=yield t.onWillDismiss();if(d==="confirm"&&(o!=null&&o.success))try{console.log("Albar\xE1n creado exitosamente:",o.albaran),console.log("Trabajo actualizado:",o.trabajo),console.log("Aviso actualizado:",o.aviso),alert(o.mensaje||"Albar\xE1n creado exitosamente"),this.cargarTrabajos(),o.aviso&&(this.aviso=o.aviso),o.albaran.estado_cierre==="Finalizado"&&console.log("Trabajo finalizado, listo para facturar"),o.albaran.estado_cierre==="Presupuesto pendiente"&&console.log("Presupuesto pendiente, se puede crear presupuesto"),o.albaran.estado_cierre==="Otra visita"&&console.log("Otra visita requerida")}catch(P){console.error("Error al procesar albar\xE1n:",P),alert("Error al procesar el albar\xE1n. Por favor, int\xE9ntalo de nuevo.")}})}realizarOtraVisita(e){console.log("Realizar otra visita para el trabajo:",e)}eliminarFoto(e){return y(this,null,function*(){var o;if(!((o=this.aviso)!=null&&o.id)||!(e!=null&&e.id)){console.error("No se puede eliminar la foto: faltan datos");return}if(confirm(`\xBFEst\xE1s seguro de que quieres eliminar esta imagen?

Esta acci\xF3n no se puede deshacer.`))try{yield I(this.avisosService.eliminarFoto(e.id)),console.log("Foto eliminada exitosamente"),this.cargarAviso()}catch(d){console.error("Error al eliminar la foto:",d),alert("Error al eliminar la imagen. Por favor, int\xE9ntalo de nuevo.")}})}calcularHorasTrabajo(e){let t=new Date(`2000-01-01T${e.hora_inicio}`),d=(new Date(`2000-01-01T${e.hora_fin}`).getTime()-t.getTime())/(1e3*60*60);return Math.max(0,d)}getAlbaranEstado(e){var d,f;if(console.log("\u{1F50D} getAlbaranEstado - Trabajo:",e),console.log("\u{1F50D} getAlbaranEstado - Aviso albaranes:",(d=this.aviso)==null?void 0:d.albaranes),!e.albaran_id||!((f=this.aviso)!=null&&f.albaranes))return console.log("\u{1F50D} getAlbaranEstado - Sin albar\xE1n o sin albaranes en aviso"),"pendiente";let t=this.aviso.albaranes.find(P=>P.id===e.albaran_id);if(console.log("\u{1F50D} getAlbaranEstado - Albar\xE1n encontrado:",t),!t)return console.log("\u{1F50D} getAlbaranEstado - Albar\xE1n no encontrado"),"pendiente";let o=t.estado_cierre.toLowerCase().replace(/ /g,"-");return console.log("\u{1F50D} getAlbaranEstado - Estado final:",o),o}puedeCrearAlbaran(e){if(console.log("\u{1F50D} puedeCrearAlbaran - Trabajo:",e),console.log("\u{1F50D} puedeCrearAlbaran - Estado:",e.estado),console.log("\u{1F50D} puedeCrearAlbaran - Albar\xE1n ID:",e.albaran_id),e.albaran_id)return console.log("\u{1F50D} puedeCrearAlbaran - Ya tiene albar\xE1n, no se puede crear"),!1;let o=["En curso","Abierto","Pendiente"].includes(e.estado);return console.log("\u{1F50D} puedeCrearAlbaran - Estado v\xE1lido:",o),o}debugTrabajo(e){var t,o,d;console.log("\u{1F41B} DEBUG TRABAJO:",e),console.log("\u{1F41B} Estado:",e.estado),console.log("\u{1F41B} Albar\xE1n ID:",e.albaran_id),console.log("\u{1F41B} Puede crear albar\xE1n:",this.puedeCrearAlbaran(e)),console.log("\u{1F41B} Aviso albaranes:",(t=this.aviso)==null?void 0:t.albaranes),alert(`DEBUG TRABAJO:
ID: ${e.id}
Estado: ${e.estado}
Albar\xE1n ID: ${e.albaran_id||"Ninguno"}
Puede crear albar\xE1n: ${this.puedeCrearAlbaran(e)}
Total albaranes en aviso: ${((d=(o=this.aviso)==null?void 0:o.albaranes)==null?void 0:d.length)||0}`)}getEstadoClass(e){return e?"badge-"+e.toLowerCase().replace(/ /g,"-"):"badge-pendiente"}onAccionFlujoEjecutada(e){console.log("Acci\xF3n de flujo ejecutada:",e),this.cargarAviso(),e.mensaje&&(console.log("Mensaje de \xE9xito:",e.mensaje),alert(e.mensaje)),e.facturaId&&confirm("Se ha generado una factura. \xBFDeseas ver la factura creada?")&&this.router.navigate(["/facturas",e.facturaId])}completarAviso(){var e;(e=this.aviso)!=null&&e.id?(console.log("\u{1F504} Completando aviso:",this.aviso.id),confirm("\xBFEst\xE1s seguro de que quieres marcar este aviso como completado? Esta acci\xF3n no se puede deshacer.")&&(this.loading=!0,this.flujoAvisosService.completarAviso(this.aviso.id).subscribe({next:t=>{console.log("\u2705 Aviso completado exitosamente:",t),this.loading=!1,this.mostrarMensaje("Aviso completado exitosamente","success"),this.cargarAviso()},error:t=>{console.error("\u274C Error al completar aviso:",t),this.loading=!1,this.mostrarMensaje(t.message||"Error al completar el aviso. Verifica que haya trabajos realizados y facturas generadas.","error")}}))):(console.error("No hay aviso seleccionado para completar"),this.mostrarMensaje("No hay aviso seleccionado para completar","error"))}mostrarMensaje(e,t="info"){console.log(`[${t.toUpperCase()}] ${e}`),t==="error"&&alert(e)}};l.\u0275fac=function(t){return new(t||l)(M(et),M(tt),M(ze),M(Z),M(Me),M(Ie))},l.\u0275cmp=$({type:l,selectors:[["app-ver-avisos"]],viewQuery:function(t,o){if(t&1&&le(Ln,5),t&2){let d;de(d=pe())&&(o.fileInput=d.first)}},decls:57,vars:19,consts:[["fileInput",""],["repuestoBasico",""],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","info-card",4,"ngIf"],[1,"info-card"],[1,"card-header",2,"justify-content","space-between!important"],[1,"badge-estado-aviso"],[1,"descripcion-content"],[1,"info-item"],[1,"tipo-aviso"],[1,"descripcion-texto"],[1,"card-header"],[2,"text-wrap","nowrap"],[1,"header-actions-jobs"],[1,"btn-primary",3,"click"],["name","add-circle"],[1,"desktop-only"],[1,"mobile-only"],["class","flujo-section",4,"ngIf"],[1,"section-divider"],[1,"table-container"],["class","no-trabajos",4,"ngIf"],["class","custom-mat-table",4,"ngIf"],[1,"gallery-actions"],[1,"btn-primary",3,"click","disabled"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"gallery-items"],["class","uploading-indicator",4,"ngIf"],["class","no-images",4,"ngIf"],["class","gallery-item",4,"ngFor","ngForOf"],[1,"loading-state"],[1,"loading-spinner"],["name","refresh-outline",1,"spinning"],[1,"error-state"],[1,"error-message"],["name","alert-circle-outline"],[1,"btn-retry",3,"click"],["name","refresh-outline"],[1,"header-container"],[1,"back-button"],[1,"btn-back",3,"click"],["name","arrow-back-outline"],[1,"header-actions"],["class","btn-secondary",3,"click",4,"ngIf"],["class","btn-primary",3,"click",4,"ngIf"],["class","aviso-completado-message",4,"ngIf"],[1,"mobile-only","title"],[1,"title"],[1,"info-grid"],[1,"info-row"],[1,"estado-pendiente"],[1,"urgent-badge"],[1,"info-item","cliente-section"],[1,"cliente-info"],[1,"cliente-nombre"],[1,"ver-cliente",3,"click"],[1,"info-item","direccion-section"],[1,"direccion-info"],[1,"direccion-texto"],["title","Ver en mapa",1,"btn-map",3,"click"],["name","navigate"],[1,"contacto-section"],[1,"contacto-items"],["class","contacto-item nombre-contacto",4,"ngIf"],["class","contacto-item",4,"ngIf"],[1,"btn-secondary",3,"click"],["name","close"],["name","pencil-outline"],[1,"aviso-completado-message"],["name","checkmark-circle-outline"],[1,"contacto-item","nombre-contacto"],["name","person"],[1,"contacto-item"],["name","call"],["name","mail"],[1,"flujo-section"],[1,"flujo-container"],[3,"accionEjecutada","avisoId"],[1,"no-trabajos"],[1,"empty-state"],["name","construct-outline"],[1,"custom-mat-table"],[4,"ngFor","ngForOf"],["data-label","N\xFAmero"],["data-label","Fecha trabajo"],["data-label","Horas"],["data-label","Descripci\xF3n"],[1,"descripcion-trabajo"],["data-label","Materiales"],[1,"materiales-info"],["class","repuestos-list",4,"ngIf"],["class","no-repuestos",4,"ngIf"],["data-label","Estado"],[1,"badge-estado"],["data-label","Acciones"],[1,"estado-actions"],["title","Debug trabajo",1,"btn-secondary","btn-small",2,"background","#FF6B6B","color","white",3,"click"],["name","bug-outline"],["title","Hacer albar\xE1n",1,"btn-primary","btn-small",2,"background","#4CAF50",3,"click"],["name","document-text-outline"],["class","albaran-info",4,"ngIf"],["class","btn-secondary btn-small","title","Editar trabajo",3,"click",4,"ngIf"],["class","btn-danger btn-small","title","Eliminar trabajo",3,"click",4,"ngIf"],[1,"repuestos-list"],[1,"no-repuestos"],[1,"albaran-info"],[1,"badge-albaran"],[1,"albaran-details"],["title","Editar trabajo",1,"btn-secondary","btn-small",3,"click"],["title","Eliminar trabajo",1,"btn-danger","btn-small",3,"click"],["name","trash-outline"],[1,"badge-info"],[1,"albaranes-container"],["class","albaran-item",4,"ngFor","ngForOf"],[1,"albaran-item"],[1,"albaran-header"],[1,"fecha-albaran"],[1,"estado-albaran"],[1,"detail-row"],[1,"detail-item"],["class","detail-item",4,"ngIf"],[1,"detail-item","full-width"],["class","detail-item full-width",4,"ngIf"],["class","detail-row",4,"ngIf"],[1,"repuestos-tags"],["class","repuesto-tag",4,"ngFor","ngForOf"],[1,"repuesto-tag"],[4,"ngIf","ngIfElse"],[1,"uploading-indicator"],[1,"no-images"],["name","images-outline"],[1,"gallery-item"],[3,"src","alt"],[1,"image-info"],[1,"image-title"],[1,"file-info"],["title","Eliminar imagen",1,"btn-delete",3,"click"]],template:function(t,o){if(t&1){let d=O();x(0,Gn,5,0,"div",2)(1,Wn,8,1,"div",3)(2,eo,61,18,"div",4),n(3,"div",5)(4,"div",6)(5,"h2"),c(6,"Descripci\xF3n del Aviso"),a(),n(7,"span",7),c(8),a()(),n(9,"div",8)(10,"div",9)(11,"label"),c(12,"Tipo de Aviso"),a(),n(13,"p",10),c(14),a()(),n(15,"div",9)(16,"label"),c(17,"Descripci\xF3n Detallada del Problema/Petici\xF3n"),a(),n(18,"p",11),c(19),a()()()(),n(20,"div",5)(21,"div",12)(22,"h2",13),c(23,"Gesti\xF3n de Albaranes"),a(),n(24,"div",14)(25,"button",15),u("click",function(){return C(d),b(o.crearTrabajoRealizado())}),m(26,"ion-icon",16),n(27,"span",17),c(28,"Crear parte de trabajo"),a(),n(29,"span",18),c(30,"Crear trabajo"),a()()()(),x(31,to,3,1,"div",19),n(32,"div",20)(33,"span"),c(34,"Lista de Trabajos Registrados"),a()(),n(35,"div",21),x(36,no,5,0,"div",2)(37,oo,7,0,"div",22)(38,_o,19,1,"table",23),a()(),x(39,yo,9,2,"div",4),n(40,"div",5)(41,"div",6)(42,"h2"),c(43,"Galer\xEDa de im\xE1genes"),a(),n(44,"div",24)(45,"button",25),u("click",function(){return C(d),b(o.seleccionarImagenes())}),m(46,"ion-icon",16),n(47,"span",17),c(48),a(),n(49,"span",18),c(50),a()(),n(51,"input",26,0),u("change",function(P){return C(d),b(o.onFileSelected(P))}),a()()(),n(53,"div",27),x(54,wo,4,0,"div",28)(55,Eo,4,0,"div",29)(56,ko,10,7,"div",30),a()()}t&2&&(p("ngIf",o.loading),s(),p("ngIf",o.error&&!o.loading),s(),p("ngIf",o.aviso&&!o.loading),s(5),ee(o.getEstadoClass(o.aviso==null?null:o.aviso.estado)),s(),v(" ",(o.aviso==null?null:o.aviso.estado)||"Pendiente"," "),s(6),_((o.aviso==null?null:o.aviso.tipo)||"No especificado"),s(5),_(o.aviso==null?null:o.aviso.descripcion_problema),s(12),p("ngIf",o.aviso==null?null:o.aviso.id),s(5),p("ngIf",o.loadingTrabajos),s(),p("ngIf",!o.loadingTrabajos&&(!o.trabajosRealizados||o.trabajosRealizados.length===0)),s(),p("ngIf",!o.loadingTrabajos&&o.trabajosRealizados.length>0),s(),p("ngIf",o.aviso&&o.aviso.albaranes&&o.aviso.albaranes.length>0),s(6),p("disabled",o.subiendoImagenes),s(3),_(o.subiendoImagenes?"Subiendo...":"A\xF1adir im\xE1genes"),s(2),_(o.subiendoImagenes?"Subiendo...":"A\xF1adir"),s(4),p("ngIf",o.subiendoImagenes),s(),p("ngIf",!(o.aviso!=null&&o.aviso.fotos)||(o.aviso==null||o.aviso.fotos==null?null:o.aviso.fotos.length)===0),s(),p("ngForOf",o.aviso==null?null:o.aviso.fotos))},dependencies:[B,H,N,ge,G,Ze,W,Jt],styles:['[_nghost-%COMP%]{display:block;padding:24px}.back-button[_ngcontent-%COMP%]{margin-bottom:24px}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 16px;background-color:#fff;color:#4f46e5;border:1px solid #E5E7EB;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s ease}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]:hover{background-color:#f9fafb;border-color:#4f46e5}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px;text-align:center}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#4f46e5}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#6b7280;margin:0}.loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#ef4444}.loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 20px;background-color:#4f46e5;color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:background-color .2s ease}.loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]:hover, .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]:hover{background-color:#3a30e2}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.aviso-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.aviso-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#111827}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.btn-primary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:10px 15px;background-color:#4f46e5;color:#fff;border:none;border-radius:.5rem;cursor:pointer;font-size:15px;font-weight:500}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#3a30e2}.btn-secondary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:10px 15px;background-color:#fff;color:#26262a;border:none;border-radius:.5rem;cursor:pointer;font-size:15px;font-weight:500;border:1px solid rgba(125,131,152,.2431372549)}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.btn-danger[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:10px 15px;background-color:#ef4444;color:#fff;border:none;border-radius:.5rem;cursor:pointer;font-size:15px;font-weight:500}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#dc2626}.btn-danger.btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.info-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;box-shadow:0 2px 8px #e0e7ef33;margin-bottom:24px;overflow:hidden}.info-card[_ngcontent-%COMP%]   h2.title[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#111827;margin:0;padding:25px}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#111827;margin:0}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:25px 25px 0}.info-card[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.info-card[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-card[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#111827;font-size:16px}.badge-pendiente[_ngcontent-%COMP%]{background-color:#f59e0b1a;color:#f59e0b;padding:4px 12px;border-radius:16px;font-size:14px;font-weight:500}.badge-estado-aviso[_ngcontent-%COMP%]{padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.badge-estado-aviso.badge-en-curso[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.badge-estado-aviso.badge-pendiente[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.badge-estado-aviso.badge-completado[_ngcontent-%COMP%]{background:#10b981;color:#fff}.badge-estado-aviso.badge-pendiente-de-presupuesto[_ngcontent-%COMP%]{background:#fcd34d;color:#92400e}.badge-estado-aviso.badge-listo-para-facturar[_ngcontent-%COMP%]{background:#d1fae5;color:#059669}.info-grid[_ngcontent-%COMP%]{padding:25px;padding-top:0!important;display:grid;gap:24px}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#111827;font-size:16px}.info-grid[_ngcontent-%COMP%]   .direccion-section[_ngcontent-%COMP%]   .btn-map[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:none;border:none;padding:8px;cursor:pointer;color:#fff;background-color:#4f46e5;font-size:16px;border-radius:50%}.info-grid[_ngcontent-%COMP%]   .contacto-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:24px}.cliente-info[_ngcontent-%COMP%], .direccion-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.cliente-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%], .direccion-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%]{color:#4f46e5;text-decoration:none;font-size:14px;cursor:pointer}.cliente-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%]:hover, .direccion-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%]:hover{text-decoration:underline}.contacto-items[_ngcontent-%COMP%]{display:flex;gap:24px;margin-top:8px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background-color:#eef2ff;color:#4f46e5;padding:6px 15px;border-radius:10px;font-size:14px;font-weight:500}.estado-pendiente[_ngcontent-%COMP%]{color:#f59e0b!important;font-weight:500}.descripcion-content[_ngcontent-%COMP%]{padding:24px}.descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;line-height:1.5}.gallery-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{background:#f3f4f6;border-radius:30px;width:auto;height:auto;padding:2px 4px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]::part(indicator){background:none}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--background: transparent;--background-checked: white;--background-hover: rgba(255,255,255,.1);--background-focused: rgba(255,255,255,.2);--border-radius: 50%;--border-width: 0;--indicator-color: transparent;--color: #6B7280;--color-checked: #4F46E5;--margin-top: 0;--margin-bottom: 0;--margin-start: 0;--margin-end: 0;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0;min-height:30px;min-width:30px;transition:all .2s ease;position:relative}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]::part(native){margin:0;padding:0 6px;height:100%}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]::part(indicator){display:none}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button.segment-button-checked[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a}.gallery-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{margin-left:auto}.gallery-items[_ngcontent-%COMP%]{padding:24px;display:grid;gap:16px}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;color:#4f46e5}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px;margin-bottom:12px}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:500}.gallery-items[_ngcontent-%COMP%]   .no-images[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.gallery-items[_ngcontent-%COMP%]   .no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px;border:1px solid #E5E7EB;border-radius:6px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:48px;height:48px;object-fit:cover;border-radius:4px;margin-right:16px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]{flex:1}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#26262a}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span.file-info[_ngcontent-%COMP%]{color:#6b7280;font-size:14px;margin-top:4px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#ef4444;border-radius:4px;transition:all .2s ease}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]:hover{background-color:#ef44441a;color:#eb1515}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.table-container[_ngcontent-%COMP%]{padding:0 24px 24px}.table-search[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:center}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:8px;padding:7px 14px;font-size:1rem;border:none;background:#f9fbff;color:#26262a}.table-search[_ngcontent-%COMP%]   .order-by[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#26262a;font-size:14px}.table-search[_ngcontent-%COMP%]   .order-by[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#4f46e5;font-weight:500}.table-search[_ngcontent-%COMP%]   .order-by[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#4f46e5;font-size:16px}.custom-mat-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0 8px;margin-bottom:12px}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#64748b;font-size:14px;font-weight:400;text-align:left;padding:8px 16px;background:transparent}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#f9fafb}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;color:#26262a;font-size:14px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{border-top-left-radius:8px;border-bottom-left-radius:8px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-top-right-radius:8px;border-bottom-right-radius:8px}.descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px;font-size:14px;line-height:1.4}.descripcion-trabajo[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#6b7280;font-size:12px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:13px;color:#4b5563;padding:2px 6px;background-color:#f3f4f6;border-radius:4px;display:inline-block;margin-right:4px;margin-bottom:4px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.badge-estado[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.badge-estado.badge-pendiente[_ngcontent-%COMP%]{background-color:var(--estado-pendiente-bg);color:var(--estado-pendiente-color)}.badge-estado.badge-en-curso[_ngcontent-%COMP%]{background-color:var(--estado-en-curso-bg);color:var(--estado-en-curso-color)}.badge-estado.badge-completado[_ngcontent-%COMP%]{background-color:var(--estado-completado-bg);color:var(--estado-completado-color)}.badge-estado.badge-cancelado[_ngcontent-%COMP%]{background-color:var(--estado-cancelado-bg);color:var(--estado-cancelado-color)}.repuestos-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:14px;color:#4b5563;margin-bottom:4px}.repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.estado-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.estado-actions[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:11px;font-weight:500;text-transform:uppercase;letter-spacing:.5px;margin-left:auto}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-pendiente[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-en-curso[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-abierto[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1e40af}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-cerrado[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-finalizado[_ngcontent-%COMP%]{background-color:#ecfdf5;color:#14532d}.albaran-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px;margin:8px 0}.albaran-info[_ngcontent-%COMP%]   .badge-albaran[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:6px 10px;border-radius:16px;font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;white-space:nowrap;background:#10b981;color:#fff}.albaran-info[_ngcontent-%COMP%]   .badge-albaran[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.albaran-info[_ngcontent-%COMP%]   .badge-albaran.badge-finalizado[_ngcontent-%COMP%]{background:#10b981;color:#fff}.albaran-info[_ngcontent-%COMP%]   .badge-albaran.badge-presupuesto-pendiente[_ngcontent-%COMP%]{background:#f59e0b;color:#fff}.albaran-info[_ngcontent-%COMP%]   .badge-albaran.badge-otra-visita[_ngcontent-%COMP%]{background:#ef4444;color:#fff}.albaran-info[_ngcontent-%COMP%]   .albaran-details[_ngcontent-%COMP%]{font-size:10px;color:#6b7280;text-transform:capitalize}.no-trabajos[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#6b7280}.no-trabajos[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.no-repuestos[_ngcontent-%COMP%]{color:#6b7280;font-style:italic;font-size:14px}.flujo-container[_ngcontent-%COMP%]{padding:0 25px}.flujo-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;font-weight:400;margin-left:12px}.card-header[_ngcontent-%COMP%]   .flujo-subtitle[_ngcontent-%COMP%]{display:block;margin-top:4px;margin-left:0}.flujo-section[_ngcontent-%COMP%]{margin-top:25px;margin-bottom:5px}.flujo-section[_ngcontent-%COMP%]   .flujo-header[_ngcontent-%COMP%]{margin-bottom:16px}.flujo-section[_ngcontent-%COMP%]   .flujo-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#1a202c;margin:0 0 4px}.flujo-section[_ngcontent-%COMP%]   .flujo-header[_ngcontent-%COMP%]   .flujo-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:400}.section-divider[_ngcontent-%COMP%]{display:flex;align-items:center;margin:24px 0 20px}.section-divider[_ngcontent-%COMP%]:before, .section-divider[_ngcontent-%COMP%]:after{content:"";flex:1;height:1px;background:#e2e8f0}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0 16px;font-size:14px;font-weight:500;color:#64748b;background:#fff}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#64748b}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#cbd5e0;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:500;margin:0 0 8px;color:#4a5568}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:14px;color:#a0aec0}.desktop-only[_ngcontent-%COMP%]{display:inline}.mobile-only[_ngcontent-%COMP%]{display:none}.urgent-badge[_ngcontent-%COMP%]{padding:2px 8px;border-radius:12px;font-size:12px;font-weight:500}.urgent-badge.urgent[_ngcontent-%COMP%]{background-color:#fef2f2;color:#dc2626}.urgent-badge[_ngcontent-%COMP%]:not(.urgent){background-color:#f3f4f6;color:#6b7280}.cliente-nombre[_ngcontent-%COMP%]{font-weight:500;color:#111827}.direccion-texto[_ngcontent-%COMP%]{word-break:break-word;line-height:1.4}.tipo-aviso[_ngcontent-%COMP%]{font-weight:500;color:#4f46e5}.descripcion-texto[_ngcontent-%COMP%]{line-height:1.6;color:#111827}.image-title[_ngcontent-%COMP%]{font-weight:500;color:#111827}.ver-cliente[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;color:#4f46e5;text-decoration:none;font-size:14px;cursor:pointer;transition:color .2s ease}.ver-cliente[_ngcontent-%COMP%]:hover{color:#291fd9}.ver-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.no-images[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.no-images[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#cbd5e0;margin-bottom:16px}.no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}@media (max-width: 768px){[_nghost-%COMP%]{padding:16px}.desktop-only[_ngcontent-%COMP%]{display:none}.mobile-only[_ngcontent-%COMP%]{display:inline}.info-card[_ngcontent-%COMP%]{margin-bottom:16px;border-radius:12px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:20px;flex-direction:row;align-items:center;justify-content:start;gap:25px!important}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .mobile-only.title[_ngcontent-%COMP%]{display:block;font-size:18px;font-weight:500;color:#111827;margin:0}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{width:auto;justify-content:space-between;gap:12px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:none;width:100%;flex-direction:column;gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions-jobs[_ngcontent-%COMP%]{display:flex;width:100%;flex-direction:column;gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions-jobs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.info-card[_ngcontent-%COMP%]   h2.title[_ngcontent-%COMP%]{font-size:16px;padding:20px}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px}.info-grid[_ngcontent-%COMP%]{padding:15px;gap:16px}.info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]{gap:20px}.info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{width:auto}.info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:max-content}.info-grid[_ngcontent-%COMP%]   .cliente-info[_ngcontent-%COMP%], .info-grid[_ngcontent-%COMP%]   .direccion-info[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between;gap:8px}.info-grid[_ngcontent-%COMP%]   .contacto-items[_ngcontent-%COMP%]{flex-direction:row;gap:8px}.info-grid[_ngcontent-%COMP%]   .contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{width:100%;justify-content:flex-start}.info-grid[_ngcontent-%COMP%]   .contacto-items[_ngcontent-%COMP%]   .contacto-item.nombre-contacto[_ngcontent-%COMP%]{display:none}.descripcion-content[_ngcontent-%COMP%]{padding:20px;gap:16px}.gallery-actions[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:stretch}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{align-self:center}.gallery-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{margin-left:0;width:100%;justify-content:center}.gallery-items[_ngcontent-%COMP%]{padding:20px;gap:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:200px;object-fit:cover;border-radius:8px;margin-right:0}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]{width:100%}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{align-self:flex-end}.table-container[_ngcontent-%COMP%]{padding:0 20px 20px}.custom-mat-table[_ngcontent-%COMP%]{font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:11px;padding:8px 12px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 12px;font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:10px}.estado-actions[_ngcontent-%COMP%]{flex-direction:column;gap:6px}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{width:100%;justify-content:center;padding:8px 12px;font-size:12px}.flujo-container[_ngcontent-%COMP%]{padding:0 20px 20px}.flujo-section[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:0}.section-divider[_ngcontent-%COMP%]{margin:20px 0 16px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;padding:0 12px}.back-button[_ngcontent-%COMP%]{margin-bottom:16px}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}.badge-pendiente[_ngcontent-%COMP%]{font-size:12px;padding:3px 8px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:11px;padding:2px 4px}.no-repuestos[_ngcontent-%COMP%]{font-size:12px}.empty-state[_ngcontent-%COMP%]{padding:30px 16px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px}.urgent-badge[_ngcontent-%COMP%]{font-size:11px;padding:2px 6px}.ver-cliente[_ngcontent-%COMP%]{font-size:12px}.ver-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.no-images[_ngcontent-%COMP%]{padding:30px 16px}.no-images[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px}.no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 480px){[_nghost-%COMP%]{padding:0}.info-card[_ngcontent-%COMP%]{margin-bottom:12px;border-radius:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:16px;gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{gap:6px}.info-card[_ngcontent-%COMP%]   h2.title[_ngcontent-%COMP%]{font-size:15px;padding:16px;display:none}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:15px!important}.descripcion-content[_ngcontent-%COMP%]{padding:16px;gap:12px}.descripcion-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px}.descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.gallery-actions[_ngcontent-%COMP%]{gap:8px}.gallery-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}.gallery-items[_ngcontent-%COMP%]{padding:16px;gap:8px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{gap:8px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:150px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span.file-info[_ngcontent-%COMP%]{font-size:11px}.table-container[_ngcontent-%COMP%]{padding:0 16px 16px}.custom-mat-table[_ngcontent-%COMP%]{font-size:11px}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:10px;padding:6px 8px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;font-size:11px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:9px}.estado-actions[_ngcontent-%COMP%]{gap:4px}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{padding:6px 8px;font-size:11px}.flujo-container[_ngcontent-%COMP%]{padding:0 16px 16px}.flujo-section[_ngcontent-%COMP%]{margin-top:16px}.section-divider[_ngcontent-%COMP%]{margin:16px 0 12px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:0 8px}.back-button[_ngcontent-%COMP%]{margin-bottom:12px}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{padding:6px 10px;font-size:12px}.badge-pendiente[_ngcontent-%COMP%]{font-size:11px;padding:2px 6px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:10px;padding:1px 3px}.no-repuestos[_ngcontent-%COMP%]{font-size:11px}.empty-state[_ngcontent-%COMP%]{padding:24px 12px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:11px}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}ion-icon[_ngcontent-%COMP%]{font-size:16px}.urgent-badge[_ngcontent-%COMP%]{font-size:10px;padding:1px 4px}.ver-cliente[_ngcontent-%COMP%]{font-size:11px}.ver-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:11px}.no-images[_ngcontent-%COMP%]{padding:24px 12px}.no-images[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}}@media (max-width: 768px){.custom-mat-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;white-space:nowrap}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{display:block}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.custom-mat-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:8px;border-radius:8px;background:#f9fafb;padding:12px}.custom-mat-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:block;text-align:left;padding:4px 0;border:none;white-space:normal}.custom-mat-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:before, .custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label) ": ";font-weight:600;color:#6b7280;font-size:11px;text-transform:uppercase;letter-spacing:.5px}.custom-mat-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{display:none}.custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:13px;line-height:1.4}.custom-mat-table[_ngcontent-%COMP%]   td.descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px}.custom-mat-table[_ngcontent-%COMP%]   td.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]{margin-top:4px}.custom-mat-table[_ngcontent-%COMP%]   td.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-block;margin:2px 4px 2px 0}.custom-mat-table[_ngcontent-%COMP%]   td.estado-actions[_ngcontent-%COMP%]{margin-top:8px;padding-top:8px;border-top:1px solid #E5E7EB}.custom-mat-table[_ngcontent-%COMP%]   td.estado-actions[_ngcontent-%COMP%]:before{content:"Acciones: "}.estado-actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{flex:1;min-width:80px;max-width:120px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{border:1px solid #E5E7EB;border-radius:8px;padding:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:6px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]{margin:8px 0}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;margin-bottom:2px}.badge-estado[_ngcontent-%COMP%]{display:inline-block;margin:2px 0}.btn-map[_ngcontent-%COMP%]{min-width:36px;height:36px}.btn-map[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{border-radius:6px;padding:6px 10px;font-size:13px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.empty-state[_ngcontent-%COMP%]{background:#f9fafb;border-radius:8px;margin:16px 0}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{min-height:150px}.error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{background:#fef2f2;border:1px solid #FECACA;border-radius:8px;padding:20px}.error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#dc2626}.header-container[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{margin-bottom:0}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{--background: #F3F4F6;--background-checked: white;--color: #6B7280;--color-checked: #4F46E5}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--background: transparent;--background-checked: white;--color: #6B7280;--color-checked: #4F46E5;--indicator-color: transparent;--border-radius: 50%;--margin: 0;--padding: 0;min-height:32px;min-width:32px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.flujo-section[_ngcontent-%COMP%]   .flujo-container[_ngcontent-%COMP%]{padding:0 16px 16px}.section-divider[_ngcontent-%COMP%]{margin:16px 0 12px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:0 10px;background:#fff;color:#6b7280}.cliente-info[_ngcontent-%COMP%]   .cliente-nombre[_ngcontent-%COMP%]{font-size:14px;line-height:1.3}.direccion-info[_ngcontent-%COMP%]   .direccion-texto[_ngcontent-%COMP%]{font-size:13px;line-height:1.4}.descripcion-content[_ngcontent-%COMP%]   .tipo-aviso[_ngcontent-%COMP%]{font-size:14px}.descripcion-content[_ngcontent-%COMP%]   .descripcion-texto[_ngcontent-%COMP%]{font-size:13px}}@media (max-width: 480px){.custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{font-size:10px}.custom-mat-table[_ngcontent-%COMP%]   .estado-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:end;gap:20px}.custom-mat-table[_ngcontent-%COMP%]   .estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{min-width:70px;max-width:100px;font-size:11px;padding:6px 8px}.custom-mat-table[_ngcontent-%COMP%]   .estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{padding:8px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:120px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span.file-info[_ngcontent-%COMP%]{font-size:10px}.contacto-items[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between;gap:8px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{padding:4px 8px;font-size:12px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.btn-map[_ngcontent-%COMP%]{min-width:32px;height:32px}.btn-map[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.empty-state[_ngcontent-%COMP%]{padding:20px 12px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:10px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{min-height:120px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{min-height:28px;min-width:28px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px;min-height:40px}.flujo-section[_ngcontent-%COMP%]   .flujo-container[_ngcontent-%COMP%]{padding:0 12px 12px}.section-divider[_ngcontent-%COMP%]{margin:12px 0 8px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;padding:0 8px}.cliente-info[_ngcontent-%COMP%]   .cliente-nombre[_ngcontent-%COMP%]{font-size:13px}.direccion-info[_ngcontent-%COMP%]   .direccion-texto[_ngcontent-%COMP%]{font-size:12px}.descripcion-content[_ngcontent-%COMP%]   .tipo-aviso[_ngcontent-%COMP%]{font-size:13px}.descripcion-content[_ngcontent-%COMP%]   .descripcion-texto[_ngcontent-%COMP%]{font-size:12px}}.albaranes-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.albaran-item[_ngcontent-%COMP%]{background:#fff;border:1px solid #E2E8F0;border-radius:12px;padding:20px;box-shadow:0 1px 3px #0000001a;transition:all .2s ease}.albaran-item[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026;transform:translateY(-2px)}.albaran-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid #E5E7EB}.albaran-header[_ngcontent-%COMP%]   .albaran-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:18px;font-weight:600;color:#1f2937}.albaran-header[_ngcontent-%COMP%]   .albaran-info[_ngcontent-%COMP%]   .fecha-albaran[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;font-weight:500}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado[_ngcontent-%COMP%]{padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado.badge-finalizado[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado.badge-presupuesto-pendiente[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado.badge-otra-visita[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.albaran-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.albaran-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.albaran-details[_ngcontent-%COMP%]   .detail-item.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.5px}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#1f2937;margin:0}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{line-height:1.5;background:#f9fafb;padding:8px 12px;border-radius:6px;border:1px solid #E5E7EB}.albaran-details[_ngcontent-%COMP%]   .repuestos-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.albaran-details[_ngcontent-%COMP%]   .repuestos-tags[_ngcontent-%COMP%]   .repuesto-tag[_ngcontent-%COMP%]{background:#e0f2fe;color:#0c4a6e;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;border:1px solid #BAE6FD}@media (max-width: 768px){.albaranes-container[_ngcontent-%COMP%]{gap:16px}.albaran-item[_ngcontent-%COMP%]{padding:16px}.albaran-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:flex-start}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]{align-self:flex-start}.albaran-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}}']});let r=l;return r})();export{fi as VerAvisosComponent};
