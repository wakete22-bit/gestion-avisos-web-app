import{a as ge}from"./chunk-RSAD4EEI.js";import"./chunk-RP6VPHKN.js";import"./chunk-FK6H3RFT.js";import{a as be}from"./chunk-UG5ATQHO.js";import{a as fe}from"./chunk-XEVZMQZH.js";import"./chunk-5JOXGAFT.js";import"./chunk-5YRB7RVB.js";import{a as _e}from"./chunk-4XNYWQEP.js";import{Ba as Ee,Ea as ye,J as Pe,P as Oe,U as Me,a as Ce,f as xe,h as he,ha as we,m as ve}from"./chunk-CPCGS7XX.js";import"./chunk-KYCVJEX4.js";import"./chunk-STXSJFLK.js";import{h as me,w as ue}from"./chunk-YOFVTXCH.js";import"./chunk-A72QMOGB.js";import{K as ie,P as ce,W as se,X as le,Y as de,ca as pe}from"./chunk-TWOPYUJN.js";import{A as W,Eb as re,F as z,Hb as oe,I as Z,Ia as s,Ja as g,Ka as x,N as S,Na as G,O as I,Oa as Q,Pa as X,Xa as O,_ as d,_a as M,ba as k,c as K,da as J,ha as F,lb as ee,mb as te,na as b,pa as q,qa as Y,ra as c,rb as ne,sa as i,sb as ae,ta as v,xa as H,ya as L,za as C}from"./chunk-4AY4VQCP.js";import"./chunk-ULLEADC5.js";import"./chunk-2ELISCRH.js";import"./chunk-BV4CTHEE.js";import"./chunk-NBD2MYJO.js";import"./chunk-3SBX7V6R.js";import"./chunk-SQKDQBOS.js";import"./chunk-SWRJZAEI.js";import"./chunk-JCSW2JUV.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-36KMLI7A.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as E,k as u}from"./chunk-CRC5ZNR6.js";var P=class{constructor(o=0,a="Network Error"){this.status=o,this.text=a}};var Se=()=>{if(!(typeof localStorage>"u"))return{get:n=>Promise.resolve(localStorage.getItem(n)),set:(n,o)=>Promise.resolve(localStorage.setItem(n,o)),remove:n=>Promise.resolve(localStorage.removeItem(n))}};var f={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:Se()};var T=n=>n?typeof n=="string"?{publicKey:n}:n.toString()==="[object Object]"?n:{}:{};var Ie=(n,o="https://api.emailjs.com")=>{if(!n)return;let a=T(n);f.publicKey=a.publicKey,f.blockHeadless=a.blockHeadless,f.storageProvider=a.storageProvider,f.blockList=a.blockList,f.limitRate=a.limitRate,f.origin=a.origin||o};var A=(e,t,...r)=>u(null,[e,t,...r],function*(n,o,a={}){let l=yield fetch(f.origin+n,{method:"POST",headers:a,body:o}),p=yield l.text(),m=new P(l.status,p);if(l.ok)return m;throw m});var D=(n,o,a)=>{if(!n||typeof n!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!o||typeof o!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!a||typeof a!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"};var ke=n=>{if(n&&n.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"};var j=n=>n.webdriver||!n.languages||n.languages.length===0;var N=()=>new P(451,"Unavailable For Headless Browser");var Fe=(n,o)=>{if(!Array.isArray(n))throw"The BlockList list has to be an array";if(typeof o!="string")throw"The BlockList watchVariable has to be a string"};var Ve=n=>{var o;return!((o=n.list)!=null&&o.length)||!n.watchVariable},$e=(n,o)=>n instanceof FormData?n.get(o):n[o],V=(n,o)=>{if(Ve(n))return!1;Fe(n.list,n.watchVariable);let a=$e(o,n.watchVariable);return typeof a!="string"?!1:n.list.includes(a)};var $=()=>new P(403,"Forbidden");var Le=(n,o)=>{if(typeof n!="number"||n<0)throw"The LimitRate throttle has to be a positive number";if(o&&typeof o!="string")throw"The LimitRate ID has to be a non-empty string"};var Ue=(n,o,a)=>u(null,null,function*(){let e=Number((yield a.get(n))||0);return o-Date.now()+e}),U=(n,o,a)=>u(null,null,function*(){if(!o.throttle||!a)return!1;Le(o.throttle,o.id);let e=o.id||n;return(yield Ue(e,o.throttle,a))>0?!0:(yield a.set(e,Date.now().toString()),!1)});var B=()=>new P(429,"Too Many Requests");var Te=(n,o,a,e)=>u(null,null,function*(){let t=T(e),r=t.publicKey||f.publicKey,l=t.blockHeadless||f.blockHeadless,p=t.storageProvider||f.storageProvider,m=E(E({},f.blockList),t.blockList),_=E(E({},f.limitRate),t.limitRate);return l&&j(navigator)?Promise.reject(N()):(D(r,n,o),ke(a),a&&V(m,a)?Promise.reject($()):(yield U(location.pathname,_,p))?Promise.reject(B()):A("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:r,service_id:n,template_id:o,template_params:a}),{"Content-type":"application/json"}))});var Re=n=>{if(!n||n.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"};var Be=n=>typeof n=="string"?document.querySelector(n):n,ze=(n,o,a,e)=>u(null,null,function*(){let t=T(e),r=t.publicKey||f.publicKey,l=t.blockHeadless||f.blockHeadless,p=f.storageProvider||t.storageProvider,m=E(E({},f.blockList),t.blockList),_=E(E({},f.limitRate),t.limitRate);if(l&&j(navigator))return Promise.reject(N());let h=Be(a);D(r,n,o),Re(h);let w=new FormData(h);return V(m,w)?Promise.reject($()):(yield U(location.pathname,_,p))?Promise.reject(B()):(w.append("lib_version","4.4.1"),w.append("service_id",n),w.append("template_id",o),w.append("user_id",r),A("/api/v1.0/email/send-form",w))});var R={init:Ie,send:Te,sendForm:ze,EmailJSResponseStatus:P};var De=(()=>{let o=class o{constructor(){this.DOWNLOAD_BASE_URL="https://gestion-avisos-web-app.vercel.app/descarga-publica"}crearEnlaceDescargaPublico(e,t){return u(this,null,function*(){try{return yield this.crearEnlaceConParametros(e,t)}catch(r){return console.error("\u274C Error al crear enlace p\xFAblico:",r),yield this.crearEnlaceDirecto(e,t)}})}crearEnlaceConParametros(e,t){return u(this,null,function*(){return new Promise((r,l)=>{let p=new FileReader;p.onload=()=>{try{let m=p.result.split(",")[1],_=this.extraerIdFactura(t),h=`${this.DOWNLOAD_BASE_URL}?factura=${_}&file=${encodeURIComponent(m)}&name=${encodeURIComponent(t)}`;console.log("\u{1F4C4} Enlace p\xFAblico creado:",h),r(h)}catch(m){l(m)}},p.onerror=l,p.readAsDataURL(e)})})}crearEnlaceDirecto(e,t){return u(this,null,function*(){return new Promise((r,l)=>{let p=new FileReader;p.onload=()=>{let m=p.result;console.log("\u{1F4C4} Enlace directo creado:",m.substring(0,100)+"..."),r(m)},p.onerror=l,p.readAsDataURL(e)})})}extraerIdFactura(e){let t=e.match(/factura_(.+)\.pdf$/);return t?t[1]:e.replace(".pdf","")}crearEnlaceTemporalLocal(e,t){let r=URL.createObjectURL(e);return console.log("\u{1F4C4} Enlace temporal local creado:",r),r}esEnlaceValido(e){try{return new URL(e),!0}catch{return!1}}obtenerTipoEnlace(e){return this.esEnlaceValido(e)?e.startsWith("data:")?"directo":e.includes("/descarga-publica")?"publico":e.startsWith("blob:")?"temporal":"invalido":"invalido"}};o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=z({token:o,factory:o.\u0275fac,providedIn:"root"});let n=o;return n})();var je=(()=>{let o=class o{constructor(e){this.publicDownloadService=e,this.SERVICE_ID="service_ylignlb",this.TEMPLATE_ID="template_s8jrauj",this.PUBLIC_KEY="hSwFP37-p0NR3D4wV",R.init(this.PUBLIC_KEY)}enviarFacturaPorCorreo(e,t,r,l,p,m,_){return u(this,null,function*(){try{console.log("\u{1F4E7} Iniciando env\xEDo de factura por correo con enlace de descarga...");let h=`factura_${r}.pdf`,w=yield this.crearEnlaceDescargaPublico(l,h),y={to_email:e,to_name:t,from_name:"T\xC9CNICOS CLIMATIZACI\xD3N S.L.",subject:m||`Factura ${r} - T\xC9CNICOS CLIMATIZACI\xD3N S.L.`,message:_||this.crearMensajeHTML(t,r,w,p),factura_numero:r,fecha_factura:new Date().toLocaleDateString("es-ES"),total_factura:"\u20AC"+(p||0).toFixed(2),link_descarga:w,pdf_url:w};console.log("\u{1F4E7} Par\xE1metros del template:",{to_email:y.to_email,to_name:y.to_name,from_name:y.from_name,subject:y.subject,factura_numero:y.factura_numero,total_factura:y.total_factura,link_descarga:y.link_descarga});let Ne=yield R.send(this.SERVICE_ID,this.TEMPLATE_ID,y);return console.log("\u2705 Factura enviada exitosamente con enlace de descarga:",Ne),{success:!0,message:"Factura enviada correctamente con enlace de descarga"}}catch(h){return console.error("\u274C Error al enviar factura por correo:",h),{success:!1,message:"Error al enviar la factura. Int\xE9ntelo de nuevo."}}})}enviarCorreoSimple(e,t,r,l){return u(this,null,function*(){try{console.log("\u{1F4E7} Enviando correo simple de prueba..."),console.log("\u{1F4E7} Datos:",{emailDestino:e,asunto:t,mensaje:r,nombreDestinatario:l});let p={to_email:e,to_name:l||"Cliente",from_name:"T\xC9CNICOS CLIMATIZACI\xD3N S.L.",subject:t,message:r};console.log("\u{1F4E7} Par\xE1metros del template (formato 1):",p);try{let m=yield R.send(this.SERVICE_ID,this.TEMPLATE_ID,p);return console.log("\u2705 Correo simple enviado exitosamente:",m),{success:!0,message:"Correo enviado correctamente"}}catch{console.log("\u274C Error con formato 1, probando formato 2...");let _={to:e,name:l||"Cliente",from:"T\xC9CNICOS CLIMATIZACI\xD3N S.L.",subject:t,message:r};console.log("\u{1F4E7} Par\xE1metros del template (formato 2):",_);let h=yield R.send(this.SERVICE_ID,this.TEMPLATE_ID,_);return console.log("\u2705 Correo simple enviado exitosamente (formato 2):",h),{success:!0,message:"Correo enviado correctamente"}}}catch(p){return console.error("\u274C Error al enviar correo:",p),{success:!1,message:"Error al enviar el correo. Verifica la configuraci\xF3n del template en EmailJS."}}})}crearEnlaceDescargaPublico(e,t){return u(this,null,function*(){try{return yield this.publicDownloadService.crearEnlaceDescargaPublico(e,t)}catch(r){return console.error("\u274C Error al crear enlace p\xFAblico, usando fallback:",r),yield this.publicDownloadService.crearEnlaceDirecto(e,t)}})}crearMensajeConEnlace(e,t,r,l){return`Hola ${e},

Le enviamos la factura ${t} con todos los detalles de los servicios realizados.

DETALLES DE LA FACTURA:
- N\xFAmero: ${t}
- Fecha: ${new Date().toLocaleDateString("es-ES")}
- Total: \u20AC${(l||0).toFixed(2)}

Puede descargar la factura en PDF haciendo clic en el siguiente enlace:
${r}

Si tiene alguna pregunta sobre esta factura o necesita asistencia, no dude en contactarnos.

Gracias por confiar en nuestros servicios de climatizaci\xF3n profesional.

Saludos,
T\xC9CNICOS CLIMATIZACI\xD3N S.L.

\u{1F4E7} info@tecnicosclimatizacion.es
\u{1F4DE} +34 91 123 45 67
\u{1F310} www.tecnicosclimatizacion.es`}crearMensajeTexto(e,t,r){return`Hola ${e},

Adjunto encontrar\xE1 la factura ${t} con todos los detalles de los servicios realizados.

DETALLES DE LA FACTURA:
- N\xFAmero: ${t}
- Fecha: ${new Date().toLocaleDateString("es-ES")}
- Total: \u20AC${(r||0).toFixed(2)}

El archivo PDF est\xE1 adjunto a este correo electr\xF3nico.

Si tiene alguna pregunta sobre esta factura o necesita asistencia, no dude en contactarnos.

Gracias por confiar en nuestros servicios de climatizaci\xF3n profesional.

Saludos,
T\xC9CNICOS CLIMATIZACI\xD3N S.L.

\u{1F4E7} info@tecnicosclimatizacion.es
\u{1F4DE} +34 91 123 45 67
\u{1F310} www.tecnicosclimatizacion.es`}crearMensajeHTML(e,t,r,l){return`
      <div style="font-family: 'Segoe UI', Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);">
        <div style="background-color: white; padding: 40px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); border: 1px solid #e2e8f0;">
          <div style="text-align: center; margin-bottom: 35px; padding-bottom: 20px; border-bottom: 3px solid #2563eb;">
            <h1 style="color: #2563eb; margin: 0; font-size: 32px; font-weight: 700; letter-spacing: 1px;">T\xC9CNICOS CLIMATIZACI\xD3N S.L.</h1>
            <p style="color: #64748b; margin: 8px 0 0 0; font-size: 16px; font-weight: 500;">Servicios profesionales de climatizaci\xF3n</p>
          </div>
          
          <h2 style="color: #333; margin-bottom: 20px;">Hola ${e},</h2>
          
          <p style="color: #555; line-height: 1.6; margin-bottom: 20px;">
            Le enviamos la factura <strong>${t}</strong> con todos los detalles de los servicios realizados.
          </p>
          
          <div style="background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); padding: 25px; border-radius: 12px; margin: 25px 0; border-left: 5px solid #2563eb; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.1);">
            <h3 style="color: #2563eb; margin: 0 0 15px 0; font-size: 20px; font-weight: 600;">\u{1F4C4} Factura ${t}</h3>
            <div style="display: flex; justify-content: space-between; align-items: center; margin: 8px 0;">
              <span style="color: #64748b; font-weight: 500;">Fecha:</span>
              <span style="color: #1e293b; font-weight: 600;">${new Date().toLocaleDateString("es-ES")}</span>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin: 8px 0; padding-top: 8px; border-top: 1px solid #cbd5e1;">
              <span style="color: #64748b; font-weight: 500;">Total:</span>
              <span style="color: #1e293b; font-weight: 700; font-size: 18px;">\u20AC${(l||0).toFixed(2)}</span>
            </div>
          </div>
          
          <div style="text-align: center; margin: 30px 0;">
            <a href="${r}" 
               style="background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); 
                      color: white; 
                      padding: 18px 35px; 
                      text-decoration: none; 
                      border-radius: 12px; 
                      font-weight: bold; 
                      display: inline-block; 
                      font-size: 18px; 
                      box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
                      transition: all 0.3s ease;
                      border: none;
                      cursor: pointer;
                      text-align: center;
                      min-width: 200px;">
              \u{1F4E5} DESCARGAR FACTURA PDF
            </a>
            <p style="color: #666; font-size: 12px; margin-top: 10px; font-style: italic;">
              Haga clic en el bot\xF3n para descargar su factura
            </p>
          </div>
          
          <p style="color: #555; line-height: 1.6; margin-bottom: 20px;">
            Si tiene alguna pregunta sobre esta factura o necesita asistencia, no dude en contactarnos.
          </p>
          
          <div style="border-top: 2px solid #e2e8f0; padding-top: 25px; margin-top: 35px; background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); padding: 20px; border-radius: 8px;">
            <p style="color: #475569; font-size: 15px; margin: 0; text-align: center;">
              <strong style="color: #2563eb; font-size: 16px;">T\xC9CNICOS CLIMATIZACI\xD3N S.L.</strong><br>
              <span style="margin: 5px 0; display: block;">\u{1F4E7} info@tecnicosclimatizacion.es</span>
              <span style="margin: 5px 0; display: block;">\u{1F4DE} +34 91 123 45 67</span>
              <span style="margin: 5px 0; display: block;">\u{1F310} www.tecnicosclimatizacion.es</span>
            </p>
          </div>
        </div>
      </div>
    `}crearEnlaceDescargaPDF(e,t){return u(this,null,function*(){try{let r=URL.createObjectURL(e),l=document.createElement("a");return l.href=r,l.download=`factura_${t}.pdf`,console.log("\u{1F4C4} Enlace de descarga creado:",r),r}catch(r){return console.error("\u274C Error al crear enlace de descarga:",r),`data:application/pdf;base64,${yield this.convertirBlobABase64(e)}`}})}convertirBlobABase64(e){return u(this,null,function*(){return new Promise((t,r)=>{let l=new FileReader;l.onload=()=>{let m=l.result.split(",")[1];t(m)},l.onerror=r,l.readAsDataURL(e)})})}verificarConfiguracion(){return!!(this.SERVICE_ID&&this.TEMPLATE_ID&&this.PUBLIC_KEY)}};o.\u0275fac=function(t){return new(t||o)(Z(De))},o.\u0275prov=z({token:o,factory:o.\u0275fac,providedIn:"root"});let n=o;return n})();function We(n,o){n&1&&v(0,"ion-icon",25)}function Ze(n,o){n&1&&v(0,"ion-icon",26)}function Je(n,o){if(n&1){let a=H();c(0,"div",8)(1,"div",9)(2,"div",10)(3,"label",11),s(4,"Estado:"),i(),c(5,"select",12),X("ngModelChange",function(t){S(a);let r=C();return Q(r.factura.factura.estado,t)||(r.factura.factura.estado=t),I(t)}),L("change",function(t){S(a);let r=C();return I(r.cambiarEstado(t))}),c(6,"option",13),s(7,"Pendiente"),i(),c(8,"option",14),s(9,"En curso"),i(),c(10,"option",15),s(11,"Completado"),i()()(),c(12,"button",16),L("click",function(){S(a);let t=C();return I(t.imprimirFactura())}),v(13,"ion-icon",17),s(14," Imprimir "),i(),c(15,"button",16),L("click",function(){S(a);let t=C();return I(t.editarFactura())}),v(16,"ion-icon",18),s(17," Editar "),i(),c(18,"div",19)(19,"button",20),L("click",function(){S(a);let t=C();return I(t.enviarFacturaPorCorreo())}),F(20,We,1,0,"ion-icon",21)(21,Ze,1,0,"ion-icon",22),s(22),i()(),c(23,"button",23),L("click",function(){S(a);let t=C();return I(t.descargarFactura())}),v(24,"ion-icon",24),s(25," Descargar PDF "),i()()()}if(n&2){let a=C();d(5),G("ngModel",a.factura.factura.estado),d(14),q("loading",a.enviandoCorreo),b("disabled",a.enviandoCorreo||!(!(a.factura==null||a.factura.factura==null)&&a.factura.factura.email_cliente)),d(),b("ngIf",!a.enviandoCorreo),d(),b("ngIf",a.enviandoCorreo),d(),x(" ",a.enviandoCorreo?"Enviando...":"Enviar con PDF"," ")}}function qe(n,o){n&1&&(c(0,"div",27)(1,"div",28),v(2,"ion-icon",26),c(3,"p"),s(4,"Cargando factura..."),i()()())}function Ye(n,o){if(n&1){let a=H();c(0,"div",29)(1,"div",30),v(2,"ion-icon",31),c(3,"p"),s(4),i(),c(5,"button",32),L("click",function(){S(a);let t=C();return I(t.cargarFactura())}),v(6,"ion-icon",33),s(7," Reintentar "),i()()()}if(n&2){let a=C();d(4),g(a.error)}}function Ge(n,o){if(n&1&&(c(0,"tr")(1,"td"),s(2),i(),c(3,"td"),s(4),i(),c(5,"td"),s(6),O(7,"currency"),i(),c(8,"td"),s(9),O(10,"currency"),i()()),n&2){let a=o.$implicit;d(2),g(a.nombre),d(2),g(a.cantidad),d(2),g(M(7,4,a.precio_neto,"EUR","symbol","1.2-2")),d(3),g(M(10,9,a.precio_pvp,"EUR","symbol","1.2-2"))}}function Qe(n,o){if(n&1&&(c(0,"div",55)(1,"div",56),s(2,"Repuestos utilizados"),i(),c(3,"table")(4,"thead")(5,"tr")(6,"th"),s(7,"Repuestos utilizados"),i(),c(8,"th"),s(9,"CANTIDAD"),i(),c(10,"th"),s(11,"NETO"),i(),c(12,"th"),s(13,"PVP"),i()()(),c(14,"tbody"),F(15,Ge,11,14,"tr",57),c(16,"tr",58)(17,"td")(18,"b"),s(19,"TOTAL"),i()(),v(20,"td"),c(21,"td",59),s(22),O(23,"currency"),i(),c(24,"td",59),s(25),O(26,"currency"),i()()()()()),n&2){let a=C(2);d(15),b("ngForOf",a.repuestos),d(7),x(" ",M(23,3,a.totalRepuestosNeto,"EUR","symbol","1.2-2")," "),d(3),x(" ",M(26,8,a.totalRepuestosPvp,"EUR","symbol","1.2-2")," ")}}function Xe(n,o){if(n&1&&(c(0,"tr")(1,"td"),s(2),i(),c(3,"td"),s(4),i(),c(5,"td"),s(6),O(7,"currency"),i()()),n&2){let a=o.$implicit;d(2),g(a.nombre),d(2),x("",a.cantidad,"h"),d(2),g(M(7,3,a.precio_pvp,"EUR","symbol","1.2-2"))}}function et(n,o){if(n&1&&(c(0,"tr")(1,"td"),s(2),i(),c(3,"td"),s(4),i(),c(5,"td"),s(6),O(7,"currency"),i()()),n&2){let a=o.$implicit;d(2),g(a.nombre),d(2),g(a.cantidad),d(2),g(M(7,3,a.precio_pvp,"EUR","symbol","1.2-2"))}}function tt(n,o){if(n&1&&(c(0,"div",55)(1,"div",56),s(2,"Mano de obra/Kilometraje"),i(),c(3,"table")(4,"thead")(5,"tr")(6,"th"),s(7,"Mano de obra/Kilometraje"),i(),c(8,"th"),s(9,"CANTIDAD"),i(),c(10,"th"),s(11,"PVP"),i()()(),c(12,"tbody"),F(13,Xe,8,8,"tr",57)(14,et,8,8,"tr",57),c(15,"tr",58)(16,"td",60)(17,"b"),s(18,"TOTAL"),i()(),c(19,"td",59),s(20),O(21,"currency"),i()()()()()),n&2){let a=C(2);d(13),b("ngForOf",a.manoObra),d(),b("ngForOf",a.desplazamientos),d(6),x(" ",M(21,3,a.totalManoObraDesplazamiento,"EUR","symbol","1.2-2")," ")}}function nt(n,o){if(n&1&&(c(0,"div",61)(1,"b"),s(2,"Notas"),i(),c(3,"div",62),s(4),i()()),n&2){let a=C(2);d(4),x(" ",a.factura.factura.notas," ")}}function at(n,o){if(n&1&&(c(0,"div",34)(1,"div",35)(2,"h2"),s(3),i(),c(4,"div",36)(5,"span",37),s(6),i()()(),c(7,"div",38)(8,"div",39),v(9,"img",40),i(),c(10,"div",41)(11,"div")(12,"span",42),s(13,"Datos de empresa"),i(),c(14,"span"),s(15,"Nombre de empresa"),i(),c(16,"address"),s(17,"Direcci\xF3n de empresa"),i(),c(18,"span"),s(19,"Ciudad de empresa"),i(),c(20,"span"),s(21,"CIF de empresa"),i(),c(22,"span",43),s(23,"ejemplodominio.es"),i(),c(24,"span"),s(25,"+34 123 45 56 65"),i()(),c(26,"div",44)(27,"label",45),s(28,"Factura"),i(),c(29,"label",46),s(30,"N\xBA FACTURA"),i(),c(31,"label"),s(32),i(),c(33,"label",46),s(34,"FECHA DE EMISI\xD3N"),i(),c(35,"label"),s(36),i()()()(),c(37,"div",47)(38,"h3"),s(39,"Datos del Cliente"),i(),c(40,"div",48)(41,"p")(42,"strong"),s(43,"Nombre:"),i(),s(44),i(),c(45,"p")(46,"strong"),s(47,"Direcci\xF3n:"),i(),s(48),i(),c(49,"p")(50,"strong"),s(51,"CIF:"),i(),s(52),i(),c(53,"p")(54,"strong"),s(55,"Email:"),i(),s(56),i()()(),F(57,Qe,27,13,"div",49)(58,tt,22,8,"div",49),c(59,"div",50)(60,"div",51)(61,"span"),s(62,"Subtotal"),i(),c(63,"span"),s(64),O(65,"currency"),i()(),c(66,"div",51)(67,"span"),s(68),i(),c(69,"span"),s(70),O(71,"currency"),i()(),c(72,"div",52)(73,"span"),s(74,"TOTAL"),i(),c(75,"span"),s(76),O(77,"currency"),i()()(),F(78,nt,5,1,"div",53),c(79,"div",54)(80,"span"),s(81,"Nombre de empresa"),i(),c(82,"span"),s(83,"+34 698 12 12 12"),i(),c(84,"span"),s(85,"ejemploemail.com"),i()()()),n&2){let a=C();d(3),x("Factura ",a.factura.factura.numero_factura,""),d(2),Y(a.getEstadoClass(a.factura.factura.estado)),d(),x(" ",a.factura.factura.estado," "),d(26),g(a.factura.factura.numero_factura),d(4),g(a.formatearFecha(a.factura.factura.fecha_emision)),d(8),x(" ",a.factura.factura.nombre_cliente,""),d(4),x(" ",a.factura.factura.direccion_cliente,""),d(4),x(" ",a.factura.factura.cif_cliente,""),d(4),x(" ",a.factura.factura.email_cliente,""),d(),b("ngIf",a.repuestos.length>0),d(),b("ngIf",a.manoObra.length>0||a.desplazamientos.length>0),d(6),g(M(65,17,a.factura.factura.subtotal,"EUR","symbol","1.2-2")),d(4),x("IVA (",a.ivaPorcentaje,"%)"),d(2),g(M(71,22,a.factura.factura.iva,"EUR","symbol","1.2-2")),d(6),g(M(77,27,a.factura.factura.total,"EUR","symbol","1.2-2")),d(2),b("ngIf",a.factura.factura.notas)}}var Sn=(()=>{let o=class o{constructor(e,t,r,l,p,m,_){this.route=e,this.router=t,this.facturasService=r,this.pdfService=l,this.avisosService=p,this.configuracionService=m,this.emailService=_,this.factura=null,this.loading=!1,this.error=null,this.facturaId=null,this.modoEdicion=!1,this.ivaPorcentaje=21,this.enviandoCorreo=!1,this.repuestos=[],this.manoObra=[],this.desplazamientos=[],this.destroy$=new K,Ce({arrowBackOutline:he,printOutline:Ee,createOutline:Pe,downloadOutline:Oe,bugOutline:ve,refreshOutline:ye,alertCircleOutline:xe,eyeOutline:Me,mailOutline:we})}ngOnInit(){this.route.params.subscribe(e=>{this.facturaId=e.id,this.facturaId&&this.cargarFactura()}),this.route.queryParams.subscribe(e=>{this.modoEdicion=e.edit==="true"}),this.configuracionService.getIvaPorDefecto().pipe(W(this.destroy$)).subscribe(e=>{this.ivaPorcentaje=e})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarFactura(){this.facturaId&&(this.loading=!0,this.error=null,this.facturasService.getFactura(this.facturaId).subscribe({next:e=>{console.log("\u{1F50D} Factura completa recibida del servicio:",e),console.log("\u{1F50D} L\xEDneas de la factura:",e.lineas),this.factura=e,this.procesarLineasFactura(e.lineas),this.loading=!1},error:e=>{console.error("Error al cargar factura:",e),this.error="Error al cargar la factura",this.loading=!1}}))}volver(){this.router.navigate(["/facturas"])}procesarLineasFactura(e){if(!e||!Array.isArray(e)){this.repuestos=[],this.manoObra=[],this.desplazamientos=[];return}let t=e.map(r=>this.parsearLinea(r)).filter(r=>r!==null);this.repuestos=t.filter(r=>r.tipo==="repuesto"),this.manoObra=t.filter(r=>r.tipo==="mano_obra"),this.desplazamientos=t.filter(r=>r.tipo==="desplazamiento"),console.log("\u2705 L\xEDneas procesadas:",{total:t.length,repuestos:this.repuestos.length,manoObra:this.manoObra.length,desplazamientos:this.desplazamientos.length})}editarFactura(){this.facturaId&&this.router.navigate(["/facturas/editar",this.facturaId])}cambiarEstado(e){if(!this.facturaId||!this.factura)return;let t=e.target.value;this.facturasService.cambiarEstado(this.facturaId,t).subscribe({next:r=>{var l,p,m,_;console.log("\u2705 Estado de factura actualizado:",r),this.factura&&(this.factura.factura.estado=r.estado),t==="Completado"&&((p=(l=this.factura)==null?void 0:l.factura)!=null&&p.aviso_id)&&(console.log("\u{1F504} Actualizando estado del aviso asociado..."),this.actualizarEstadoAvisoAsociado((_=(m=this.factura)==null?void 0:m.factura)==null?void 0:_.aviso_id))},error:r=>{console.error("\u274C Error al cambiar estado:",r),this.factura&&(this.factura.factura.estado=e.target.defaultValue)}})}actualizarEstadoAvisoAsociado(e){this.avisosService.actualizarEstadoAutomatico(e).subscribe({next:t=>{console.log("\u2705 Estado del aviso actualizado autom\xE1ticamente:",t.estado),t.estado==="Completado"&&console.log("\u{1F389} El aviso se ha marcado autom\xE1ticamente como completado")},error:t=>{console.error("\u274C Error al actualizar estado del aviso:",t)}})}imprimirFactura(){window.print()}descargarFactura(){if(!this.factura){console.error("No hay factura para descargar");return}try{console.log("\u{1F527} Iniciando descarga de factura...");let t=`factura_${this.factura.factura.numero_factura||"factura"}.pdf`,r={numero_factura:this.factura.factura.numero_factura,fecha_emision:this.factura.factura.fecha_emision,nombre_cliente:this.factura.factura.nombre_cliente,direccion_cliente:this.factura.factura.direccion_cliente,cif_cliente:this.factura.factura.cif_cliente,email_cliente:this.factura.factura.email_cliente,cliente_id:this.factura.factura.cliente_id,subtotal:this.factura.factura.subtotal,iva:this.factura.factura.iva,total:this.factura.factura.total,estado:this.factura.factura.estado,notas:this.factura.factura.notas,lineas:this.factura.lineas};this.pdfService.generarPdfHtml(r,t),console.log("\u2705 Factura descargada exitosamente")}catch(e){console.error("\u274C Error al descargar factura:",e)}}probarEnvioCorreo(){return u(this,null,function*(){if(!this.factura){console.error("No hay factura para probar");return}if(!this.factura.factura.email_cliente){console.error("No hay email del cliente"),alert("Error: No se encontr\xF3 email del cliente.");return}try{this.enviandoCorreo=!0,console.log("\u{1F4E7} Probando env\xEDo de correo simple...");let e=yield this.emailService.enviarCorreoSimple(this.factura.factura.email_cliente,`Prueba - Factura ${this.factura.factura.numero_factura}`,`Hola ${this.factura.factura.nombre_cliente},

Esta es una prueba de env\xEDo de correo para la factura ${this.factura.factura.numero_factura}.

Saludos,
T\xC9CNICOS CLIMATIZACI\xD3N S.L.`,this.factura.factura.nombre_cliente);e.success?(console.log("\u2705 Correo de prueba enviado exitosamente"),alert("\u2705 Correo de prueba enviado correctamente")):(console.error("\u274C Error al enviar correo de prueba:",e.message),alert("\u274C Error al enviar correo de prueba: "+e.message))}catch(e){console.error("\u274C Error al probar env\xEDo de correo:",e),alert("\u274C Error inesperado al probar el env\xEDo de correo.")}finally{this.enviandoCorreo=!1}})}enviarFacturaPorCorreo(){return u(this,null,function*(){if(!this.factura){console.error("No hay factura para enviar");return}if(!this.factura.factura.email_cliente){console.error("No hay email del cliente"),alert("Error: No se encontr\xF3 email del cliente. Por favor, verifica que la factura tenga un email v\xE1lido.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.factura.factura.email_cliente)){console.error("Email del cliente no es v\xE1lido:",this.factura.factura.email_cliente),alert("Error: El email del cliente no tiene un formato v\xE1lido.");return}try{this.enviandoCorreo=!0,console.log("\u{1F4E7} Iniciando env\xEDo de factura por correo..."),console.log("\u{1F4E7} Datos de la factura:",{email_cliente:this.factura.factura.email_cliente,nombre_cliente:this.factura.factura.nombre_cliente,numero_factura:this.factura.factura.numero_factura,total:this.factura.factura.total});let t={numero_factura:this.factura.factura.numero_factura,fecha_emision:this.factura.factura.fecha_emision,nombre_cliente:this.factura.factura.nombre_cliente,direccion_cliente:this.factura.factura.direccion_cliente,cif_cliente:this.factura.factura.cif_cliente,email_cliente:this.factura.factura.email_cliente,cliente_id:this.factura.factura.cliente_id,subtotal:this.factura.factura.subtotal,iva:this.factura.factura.iva,total:this.factura.factura.total,estado:this.factura.factura.estado,notas:this.factura.factura.notas,lineas:this.factura.lineas},r=yield this.pdfService.generarPdfBlob(t,`factura_${this.factura.factura.numero_factura}.pdf`);console.log("\u{1F4E7} Enviando correo con datos:",{emailCliente:this.factura.factura.email_cliente,nombreCliente:this.factura.factura.nombre_cliente,numeroFactura:this.factura.factura.numero_factura,totalFactura:this.factura.factura.total});let l=yield this.emailService.enviarFacturaPorCorreo(this.factura.factura.email_cliente,this.factura.factura.nombre_cliente,this.factura.factura.numero_factura,r,this.factura.factura.total);l.success?(console.log("\u2705 Factura enviada exitosamente"),alert("\u2705 Factura enviada correctamente al cliente")):(console.error("\u274C Error al enviar factura:",l.message),alert("\u274C Error al enviar la factura: "+l.message))}catch(t){console.error("\u274C Error al enviar factura por correo:",t),alert("\u274C Error inesperado al enviar la factura. Por favor, int\xE9ntelo de nuevo.")}finally{this.enviandoCorreo=!1}})}formatearMoneda(e){return new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(e)}formatearFecha(e){return new Date(e).toLocaleDateString("es-ES")}getEstadoClass(e){switch(e.toLowerCase()){case"pendiente":return"estado-pendiente";case"en curso":return"estado-en-curso";case"completado":return"estado-completado";default:return"estado-default"}}parsearLinea(e){if(!e)return null;let t;if(typeof e=="string")try{t=JSON.parse(e)}catch(l){return console.warn("\u26A0\uFE0F Error al parsear l\xEDnea JSON:",l),null}else if(typeof e=="object"&&e!==null)t=e;else return console.warn("\u26A0\uFE0F L\xEDnea no es string ni objeto:",e),null;return{id:t.id||"",tipo:t.tipo||"repuesto",nombre:t.nombre||"Sin nombre",cantidad:Number(t.cantidad)||0,precio_neto:Number(t.precio_neto)||0,precio_pvp:Number(t.precio_pvp)||0,descripcion:t.descripcion||"",fecha_creacion:t.fecha_creacion||""}}get totalRepuestosNeto(){return this.repuestos.reduce((e,t)=>{let r=Number(t.cantidad)||0,l=Number(t.precio_neto)||0;return e+r*l},0)}get totalRepuestosPvp(){return this.repuestos.reduce((e,t)=>{let r=Number(t.cantidad)||0,l=Number(t.precio_pvp)||0;return e+r*l},0)}get totalManoObraDesplazamiento(){return[...this.manoObra,...this.desplazamientos].reduce((t,r)=>{let l=Number(r.cantidad)||0,p=Number(r.precio_pvp)||0;return t+l*p},0)}};o.\u0275fac=function(t){return new(t||o)(k(re),k(oe),k(be),k(ge),k(_e),k(fe),k(je))},o.\u0275cmp=J({type:o,selectors:[["app-ver-factura"]],decls:10,vars:4,consts:[[1,"factura-container"],[1,"page-header"],[1,"btn-back",3,"click"],["name","arrow-back-outline"],["class","header-actions",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","factura-preview active",4,"ngIf"],[1,"header-actions"],[1,"action-buttons"],[1,"estado-selector"],["for","estado-factura"],["id","estado-factura",1,"estado-select",3,"ngModelChange","change","ngModel"],["value","Pendiente"],["value","En curso"],["value","Completado"],[1,"btn-secondary",3,"click"],["name","print-outline"],["name","create-outline"],[1,"email-buttons"],[1,"btn-email",3,"click","disabled"],["name","mail-outline",4,"ngIf"],["name","refresh-outline","class","spinning",4,"ngIf"],[1,"btn-primary",3,"click"],["name","download-outline"],["name","mail-outline"],["name","refresh-outline",1,"spinning"],[1,"loading-state"],[1,"loading-spinner"],[1,"error-state"],[1,"error-message"],["name","alert-circle-outline"],[1,"btn-retry",3,"click"],["name","refresh-outline"],[1,"factura-preview","active"],[1,"header-container"],[1,"estado-badge"],[1,"badge"],[1,"preview-header"],[1,"logo-box"],["src","assets/icon/favicon.png","alt","Logo"],[1,"empresa-datos"],[1,"empresa-nombre"],[2,"margin-top","20px"],[1,"factura-info"],[1,"factura-label"],[2,"color","#111827","font-weight","500"],[1,"cliente-datos"],[1,"cliente-info"],["class","preview-tabla",4,"ngIf"],[1,"preview-totales-box"],[1,"totales-row"],[1,"totales-row","total-final"],["class","preview-notas",4,"ngIf"],[1,"preview-footer"],[1,"preview-tabla"],[1,"tabla-titulo"],[4,"ngFor","ngForOf"],[1,"total-row"],[1,"success"],["colspan","2"],[1,"preview-notas"],[1,"notas-texto"]],template:function(t,r){t&1&&(c(0,"ion-content")(1,"div",0)(2,"div",1)(3,"button",2),L("click",function(){return r.volver()}),v(4,"ion-icon",3),s(5," Volver a Facturas "),i(),F(6,Je,26,7,"div",4),i(),F(7,qe,5,0,"div",5)(8,Ye,8,1,"div",6)(9,at,86,32,"div",7),i()()),t&2&&(d(6),b("ngIf",r.factura),d(),b("ngIf",r.loading),d(),b("ngIf",r.error&&!r.loading),d(),b("ngIf",r.factura&&!r.loading))},dependencies:[ae,ee,te,ne,pe,le,de,se,ie,ce,me,ue],styles:["ion-content[_ngcontent-%COMP%]{--background: #fff}.factura-container[_ngcontent-%COMP%]{margin:0 auto;padding:20px;gap:0;display:block;background-color:#fff}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #e2e8f0}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.page-header[_ngcontent-%COMP%]   .pdf-options[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.page-header[_ngcontent-%COMP%]   .pdf-options[_ngcontent-%COMP%]   .pdf-template-selector[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #e2e8f0;border-radius:6px;font-size:14px;background:#fff;color:#4a5568;cursor:pointer;transition:all .2s}.page-header[_ngcontent-%COMP%]   .pdf-options[_ngcontent-%COMP%]   .pdf-template-selector[_ngcontent-%COMP%]:hover{border-color:#cbd5e0}.page-header[_ngcontent-%COMP%]   .pdf-options[_ngcontent-%COMP%]   .pdf-template-selector[_ngcontent-%COMP%]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 3px #4f46e51a}.page-header[_ngcontent-%COMP%]   .estado-selector[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.page-header[_ngcontent-%COMP%]   .estado-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#4a5568;white-space:nowrap}.page-header[_ngcontent-%COMP%]   .estado-selector[_ngcontent-%COMP%]   .estado-select[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #e2e8f0;border-radius:6px;font-size:14px;background:#fff;color:#4a5568;cursor:pointer;transition:all .2s;min-width:120px}.page-header[_ngcontent-%COMP%]   .estado-selector[_ngcontent-%COMP%]   .estado-select[_ngcontent-%COMP%]:hover{border-color:#cbd5e0}.page-header[_ngcontent-%COMP%]   .estado-selector[_ngcontent-%COMP%]   .estado-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 3px #4f46e51a}.btn-back[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:#f7fafc;border:1px solid #e2e8f0;border-radius:8px;color:#4a5568;text-decoration:none;cursor:pointer;transition:all .2s}.btn-back[_ngcontent-%COMP%]:hover{background:#edf2f7;border-color:#cbd5e0}.btn-back[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#4a5568;border:1px solid #e2e8f0}.btn-secondary[_ngcontent-%COMP%]:hover{background:#f7fafc;border-color:#cbd5e0}.btn-primary[_ngcontent-%COMP%]{background:#4f46e5;color:#fff;border:1px solid #4f46e5}.btn-primary[_ngcontent-%COMP%]:hover{background:#4338ca;border-color:#4338ca}.email-buttons[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap}.btn-email[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);color:#fff;border:none;padding:12px 20px;border-radius:8px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:8px;transition:all .3s ease;font-size:14px;flex:1;min-width:140px;justify-content:center}.btn-email[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#059669,#047857);transform:translateY(-1px);box-shadow:0 4px 12px #10b9814d}.btn-email[_ngcontent-%COMP%]:disabled{background:#9ca3af;cursor:not-allowed;transform:none;box-shadow:none}.btn-email.loading[_ngcontent-%COMP%]{background:#6b7280}.btn-email.btn-test[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb)}.btn-email.btn-test[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#2563eb,#1d4ed8);box-shadow:0 4px 12px #3b82f64d}.btn-email[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:300px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{text-align:center;color:#64748b}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:16px;color:#cbd5e0}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;margin:0}.loading-state[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]{margin-top:16px;padding:8px 16px;background:#4f46e5;color:#fff;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;gap:8px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.factura-preview[_ngcontent-%COMP%]{background:#fff;border-radius:24px;padding:32px;display:flex;flex-direction:column;gap:24px;border:1px solid #e2e8f0}.factura-preview.active[_ngcontent-%COMP%]{display:flex}.factura-preview[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.factura-preview[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#111827;margin:0}.factura-preview[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{padding:6px 12px;border-radius:16px;font-size:12px;font-weight:600;text-transform:uppercase}.factura-preview[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   .badge.estado-pendiente[_ngcontent-%COMP%]{background:var(--estado-pendiente-bg);color:var(--estado-pendiente-color)}.factura-preview[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   .badge.estado-en-curso[_ngcontent-%COMP%]{background:var(--estado-en-curso-bg);color:var(--estado-en-curso-color)}.factura-preview[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   .badge.estado-completado[_ngcontent-%COMP%]{background:var(--estado-completado-bg);color:var(--estado-completado-color)}.factura-preview[_ngcontent-%COMP%]   .preview-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:32px}.factura-preview[_ngcontent-%COMP%]   .preview-header[_ngcontent-%COMP%]   .logo-box[_ngcontent-%COMP%]{border-radius:12px;display:flex;align-items:center;justify-content:center}.factura-preview[_ngcontent-%COMP%]   .preview-header[_ngcontent-%COMP%]   .logo-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:44px}.factura-preview[_ngcontent-%COMP%]   .preview-header[_ngcontent-%COMP%]   .empresa-datos[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:space-between}.factura-preview[_ngcontent-%COMP%]   .preview-header[_ngcontent-%COMP%]   .empresa-datos[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .factura-preview[_ngcontent-%COMP%]   .preview-header[_ngcontent-%COMP%]   .empresa-datos[_ngcontent-%COMP%]   address[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:13px;margin-bottom:2px;font-style:normal}.factura-preview[_ngcontent-%COMP%]   .preview-header[_ngcontent-%COMP%]   .empresa-datos[_ngcontent-%COMP%]   .empresa-nombre[_ngcontent-%COMP%]{color:#4f46e5;font-weight:600;font-size:14px;margin-bottom:8px;text-transform:capitalize}.factura-preview[_ngcontent-%COMP%]   .preview-header[_ngcontent-%COMP%]   .factura-info[_ngcontent-%COMP%]{text-align:right}.factura-preview[_ngcontent-%COMP%]   .preview-header[_ngcontent-%COMP%]   .factura-info[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:13px;color:#6b7280;margin-bottom:2px}.factura-preview[_ngcontent-%COMP%]   .preview-header[_ngcontent-%COMP%]   .factura-info[_ngcontent-%COMP%]   .factura-label[_ngcontent-%COMP%]{color:#4f46e5;font-weight:600;font-size:14px;margin-bottom:8px}.factura-preview[_ngcontent-%COMP%]   .cliente-datos[_ngcontent-%COMP%]{background:#f8fafc;border-radius:12px;padding:20px;margin:16px 0}.factura-preview[_ngcontent-%COMP%]   .cliente-datos[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#4f46e5;font-size:16px;font-weight:600;margin:0 0 12px}.factura-preview[_ngcontent-%COMP%]   .cliente-datos[_ngcontent-%COMP%]   .cliente-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;color:#4a5568}.factura-preview[_ngcontent-%COMP%]   .cliente-datos[_ngcontent-%COMP%]   .cliente-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#2d3748}.factura-preview[_ngcontent-%COMP%]   .preview-tabla[_ngcontent-%COMP%]   .tabla-titulo[_ngcontent-%COMP%]{font-weight:600;color:#6b7280;margin-bottom:8px;font-size:1rem}.factura-preview[_ngcontent-%COMP%]   .preview-tabla[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:8px}.factura-preview[_ngcontent-%COMP%]   .preview-tabla[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .factura-preview[_ngcontent-%COMP%]   .preview-tabla[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px;text-align:left}.factura-preview[_ngcontent-%COMP%]   .preview-tabla[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#9ca3af;font-weight:400;background:none;border-bottom:1px solid #E5E7EB}.factura-preview[_ngcontent-%COMP%]   .preview-tabla[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#111827;border-bottom:1px solid #F3F4F6}.factura-preview[_ngcontent-%COMP%]   .preview-tabla[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]{color:#27c26c;font-weight:600}.factura-preview[_ngcontent-%COMP%]   .preview-tabla[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700;color:#4f46e5;border-bottom:none}.factura-preview[_ngcontent-%COMP%]   .preview-totales-box[_ngcontent-%COMP%]{margin:24px 0 0;background:#eef2ff;border-radius:16px;padding:15px;width:300px;align-self:flex-end}.factura-preview[_ngcontent-%COMP%]   .preview-totales-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#4f46e5}.factura-preview[_ngcontent-%COMP%]   .preview-totales-box[_ngcontent-%COMP%]   .totales-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:14px;margin-bottom:8px}.factura-preview[_ngcontent-%COMP%]   .preview-totales-box[_ngcontent-%COMP%]   .totales-row.total-final[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#fff;background:#4f46e5;border-radius:12px;padding:10px 16px;margin-top:12px;margin-bottom:0}.factura-preview[_ngcontent-%COMP%]   .preview-totales-box[_ngcontent-%COMP%]   .totales-row.total-final[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff!important}.factura-preview[_ngcontent-%COMP%]   .preview-notas[_ngcontent-%COMP%]{margin-top:24px}.factura-preview[_ngcontent-%COMP%]   .preview-notas[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#4f46e5;font-size:1rem}.factura-preview[_ngcontent-%COMP%]   .preview-notas[_ngcontent-%COMP%]   .notas-texto[_ngcontent-%COMP%]{color:#6b7280;font-size:.95rem;margin-top:4px}.factura-preview[_ngcontent-%COMP%]   .preview-footer[_ngcontent-%COMP%]{margin-top:32px;display:flex;justify-content:space-between;color:#6b7280;font-size:.95rem;border-top:1px solid #E5E7EB;padding-top:12px}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:12px}@media (max-width: 768px){.factura-container[_ngcontent-%COMP%]{padding:16px}.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%;justify-content:flex-end}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .pdf-options[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .pdf-options[_ngcontent-%COMP%]   .pdf-template-selector[_ngcontent-%COMP%]{width:100%;text-align:center}.factura-preview[_ngcontent-%COMP%]{padding:16px;border-radius:12px}.factura-preview[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.factura-preview[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px}.factura-preview[_ngcontent-%COMP%]   .preview-header[_ngcontent-%COMP%], .factura-preview[_ngcontent-%COMP%]   .preview-header[_ngcontent-%COMP%]   .empresa-datos[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.factura-preview[_ngcontent-%COMP%]   .preview-totales-box[_ngcontent-%COMP%]{width:100%}.factura-preview[_ngcontent-%COMP%]   .preview-tabla[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{font-size:12px}.factura-preview[_ngcontent-%COMP%]   .preview-tabla[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .factura-preview[_ngcontent-%COMP%]   .preview-tabla[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:6px 8px}}@media (max-width: 480px){.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .estado-selector[_ngcontent-%COMP%]{width:100%;justify-content:center}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .estado-selector[_ngcontent-%COMP%]   .estado-select[_ngcontent-%COMP%]{min-width:120px}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .pdf-options[_ngcontent-%COMP%]{width:100%;justify-content:center}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .pdf-options[_ngcontent-%COMP%]   .pdf-template-selector[_ngcontent-%COMP%]{min-width:120px}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:8px;width:100%}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center;padding:10px 12px;font-size:13px}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.factura-preview[_ngcontent-%COMP%]{padding:12px}.factura-preview[_ngcontent-%COMP%]   .preview-tabla[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{display:block;overflow-x:auto;white-space:nowrap}}.pdf-preview-section[_ngcontent-%COMP%]{margin:20px 0;padding:20px;background-color:#f8f9fa;border-radius:8px;border:1px solid #e9ecef}.pdf-preview-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;color:#495057;font-size:18px;font-weight:600}"]});let n=o;return n})();export{Sn as VerFacturaComponent};
