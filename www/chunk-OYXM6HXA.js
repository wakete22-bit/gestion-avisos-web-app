import{a as ie,b as Fe}from"./chunk-D322JJUJ.js";import{a as Qt}from"./chunk-YJVQTXXH.js";import"./chunk-V637VMVD.js";import{a as Ae}from"./chunk-VBMSTODI.js";import"./chunk-V7KIGSPH.js";import{a as Ie}from"./chunk-4SM7WR35.js";import"./chunk-5FXVTEKZ.js";import"./chunk-KH26CASC.js";import{A as K,B as jt,C as It,Ca as Gt,Da as Y,E as At,F as Ft,Fa as ne,G as we,H as ke,Ha as oe,K as V,M as Tt,P as Vt,Q as Rt,S as Se,V as Dt,Y as Bt,Z as $t,_ as Nt,a as z,b as Pt,c as vt,ca as Be,d as ht,da as Ht,e as yt,ea as $e,g as Et,ga as Ne,i as Re,j as wt,k as kt,ka as le,l as St,ma as He,o as te,oa as W,p as De,sa as qt,u as G,ua as Ut,v as zt,va as Q,wa as Lt,xa as ze,y as Ee,ya as je}from"./chunk-QJI27CM7.js";import{a as Wt}from"./chunk-ZPOZPA6O.js";import{e as xt,h as Mt,j as Ot}from"./chunk-B7BVV76N.js";import"./chunk-N55KPTHA.js";import{c as lt,d as dt,e as pt,f as gt,g as mt,k as _t,m as ut,n as ee,s as L,t as ft,u as Ct}from"./chunk-IFFBEWRT.js";import{$a as tt,$b as it,Aa as r,Ba as _,Ca as h,D as Ue,Da as I,Ea as Ve,Fa as re,G as Le,Ga as ce,Ha as se,Ja as Xe,K as C,L as b,P as Ge,Pa as v,Qa as B,R as We,Ra as y,Sa as Ze,Sc as bt,U as Z,W as s,X as P,Xa as et,Ya as A,Z as j,Za as F,ab as fe,ba as f,bb as U,bc as k,c as X,cb as T,cc as Ce,dc as be,f as N,ga as d,ha as Qe,hc as xe,i as D,ia as J,ic as Me,ja as ae,k as H,ka as e,la as n,lb as nt,lc as Oe,ma as m,mc as Pe,na as Ye,nc as at,oa as Je,ob as ot,oc as rt,pc as ct,qa as O,r as q,ra as u,sa as g,tc as st,uc as ve,vc as he,wa as me,wc as ye,xa as _e,y as w,ya as ue,za as Ke}from"./chunk-EYPZOMIL.js";import"./chunk-3SUPCH3T.js";import"./chunk-QUJFQN2Y.js";import"./chunk-OGR5ZLHR.js";import"./chunk-CUT3BV6K.js";import"./chunk-73IMGLZG.js";import"./chunk-G2E2NLL6.js";import"./chunk-ILJSYHS4.js";import"./chunk-OAP23YNX.js";import"./chunk-YYM7CL2V.js";import"./chunk-5LR2YXX6.js";import"./chunk-WDU4QEMV.js";import"./chunk-CKP3SGE2.js";import"./chunk-ULLEADC5.js";import"./chunk-2ELISCRH.js";import"./chunk-BV4CTHEE.js";import"./chunk-JILLMCFB.js";import"./chunk-WWN5RJW3.js";import"./chunk-H3LYBNOM.js";import"./chunk-LBMIQEU6.js";import"./chunk-WI5MSH4N.js";import"./chunk-NBD2MYJO.js";import"./chunk-3SBX7V6R.js";import"./chunk-SQKDQBOS.js";import"./chunk-SWRJZAEI.js";import"./chunk-JCSW2JUV.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-36KMLI7A.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as pe,b as ge,k as E}from"./chunk-CRC5ZNR6.js";var an=()=>({standalone:!0});function rn(c,l){c&1&&(e(0,"div",15)(1,"div",16),m(2,"ion-icon",17),e(3,"p"),r(4,"Cargando datos del trabajo..."),n()()())}function cn(c,l){c&1&&(e(0,"div",46),m(1,"ion-icon",47),e(2,"p"),r(3,"Al editar el trabajo, los materiales se ajustar\xE1n autom\xE1ticamente en el inventario."),n()())}function sn(c,l){c&1&&(e(0,"div",48),m(1,"ion-icon",17),e(2,"span"),r(3,"Cargando productos..."),n()())}function ln(c,l){if(c&1&&(e(0,"div",49),r(1),n()),c&2){let a=g(2);s(),h(" ",a.errorProductos," ")}}function dn(c,l){if(c&1&&(e(0,"span",63),r(1),n()),c&2){let a=g().$implicit;s(),_(a.descripcion)}}function pn(c,l){if(c&1){let a=O();e(0,"div",53),u("click",function(){let i=C(a).$implicit,t=g(3);return b(t.agregarMaterial(i))}),e(1,"div",54)(2,"div",55)(3,"span",56),r(4),n(),e(5,"span",57),r(6),n()(),e(7,"span",58),r(8),n(),f(9,dn,2,1,"span",59),e(10,"span",60),r(11),v(12,"currency"),n()(),e(13,"button",61),m(14,"ion-icon",62),n()()}if(c&2){let a=l.$implicit;J("sin-stock",a.cantidad_disponible<=0)("stock-bajo",a.cantidad_disponible>0&&a.cantidad_disponible<=5),s(4),_(a.codigo),s(),J("stock-bajo",a.cantidad_disponible>0&&a.cantidad_disponible<=5)("sin-stock",a.cantidad_disponible<=0),s(),I(" Stock: ",a.cantidad_disponible," ",a.unidad," "),s(2),_(a.nombre),s(),d("ngIf",a.descripcion),s(2),_(y(12,15,a.precio_neto,"EUR","symbol","1.2-2")),s(2),d("disabled",a.cantidad_disponible<=0)}}function gn(c,l){if(c&1&&(e(0,"div",50)(1,"h4"),r(2,"Productos disponibles"),n(),e(3,"div",51),f(4,pn,15,20,"div",52),n()()),c&2){let a=g(2);s(4),d("ngForOf",a.productosFiltrados)}}function mn(c,l){if(c&1){let a=O();e(0,"div",67)(1,"div",68)(2,"div",69)(3,"span",70),r(4),n(),e(5,"span",71),r(6),v(7,"currency"),n()(),e(8,"span",72),r(9),n(),e(10,"div",73)(11,"label"),r(12,"Cantidad:"),n(),e(13,"input",74),u("change",function(i){let t=C(a).index,p=g(3);return b(p.actualizarCantidadMaterial(t,i.target.value))}),n(),e(14,"span",75),r(15),n()()(),e(16,"button",76),u("click",function(){let i=C(a).index,t=g(3);return b(t.eliminarMaterial(i))}),m(17,"ion-icon",77),n()()}if(c&2){let a=l.$implicit;s(4),_(a.producto.codigo),s(2),_(y(7,7,a.producto.precio_neto,"EUR","symbol","1.2-2")),s(3),_(a.producto.nombre),s(4),d("value",a.cantidad)("min",1)("max",a.producto.cantidad_disponible),s(2),_(a.producto.unidad)}}function _n(c,l){if(c&1&&(e(0,"div",64)(1,"h4"),r(2,"Materiales a\xF1adidos"),n(),f(3,mn,18,12,"div",65),e(4,"div",66)(5,"strong"),r(6),v(7,"currency"),n()()()),c&2){let a=g(2);s(3),d("ngForOf",a.materiales),s(3),h("Costo total de materiales: ",y(7,2,a.calcularCostoTotal(),"EUR","symbol","1.2-2"),"")}}function un(c,l){c&1&&(e(0,"div",78),m(1,"ion-icon",47),e(2,"p"),r(3,"No se han a\xF1adido materiales"),n(),e(4,"span"),r(5,"Selecciona productos del inventario para a\xF1adirlos como materiales"),n()())}function fn(c,l){if(c&1){let a=O();e(0,"div",18)(1,"div",19)(2,"div",20)(3,"label"),r(4,"Fecha del trabajo "),e(5,"span",21),r(6,"*"),n()(),m(7,"input",22),n(),e(8,"div",23)(9,"div",24)(10,"label"),r(11,"Hora de inicio "),e(12,"span",21),r(13,"*"),n()(),m(14,"input",25),n(),e(15,"div",24)(16,"label"),r(17,"Hora de fin "),e(18,"span",21),r(19,"*"),n()(),m(20,"input",26),n()(),e(21,"div",20)(22,"label"),r(23,"Descripci\xF3n del trabajo "),e(24,"span",21),r(25,"*"),n()(),e(26,"textarea",27),r(27,"            "),n(),e(28,"div",28),r(29),n()(),e(30,"div",20)(31,"label"),r(32,"Estado del trabajo"),n(),e(33,"select",29)(34,"option",30),r(35,"Pendiente"),n(),e(36,"option",31),r(37,"En curso"),n(),e(38,"option",32),r(39,"Completado"),n(),e(40,"option",33),r(41,"Cancelado"),n()()()(),e(42,"div",34)(43,"div",35)(44,"h3"),r(45,"Materiales utilizados"),n(),f(46,cn,4,0,"div",36),e(47,"div",37)(48,"div",38),m(49,"ion-icon",39),e(50,"input",40),se("ngModelChange",function(i){C(a);let t=g();return ce(t.busquedaProducto,i)||(t.busquedaProducto=i),b(i)}),u("input",function(i){C(a);let t=g();return b(t.filtrarProductos(i))}),n()()(),f(51,sn,4,0,"div",41)(52,ln,2,1,"div",42)(53,gn,5,1,"div",43)(54,_n,8,7,"div",44)(55,un,6,0,"div",45),n()()()}if(c&2){let a,o=g();s(29),h("",((a=o.trabajoForm.get("descripcion"))==null||a.value==null?null:a.value.length)||0,"/500"),s(17),d("ngIf",o.modoEdicion),s(4),re("ngModel",o.busquedaProducto),d("ngModelOptions",Xe(9,an)),s(),d("ngIf",o.loadingProductos),s(),d("ngIf",o.errorProductos),s(),d("ngIf",!o.loadingProductos&&!o.errorProductos),s(),d("ngIf",o.materiales.length>0),s(),d("ngIf",o.materiales.length===0&&!o.loadingProductos&&!o.errorProductos)}}var Jt=(()=>{let l=class l{constructor(o,i,t,p,x,M){this.fb=o,this.modalController=i,this.viewportService=t,this.elementRef=p,this.inventarioService=x,this.trabajosService=M,this.avisoId="",this.materiales=[],this.productosInventario=[],this.productosFiltrados=[],this.loadingProductos=!1,this.errorProductos=null,this.busquedaProducto="",this.modoEdicion=!1,this.destroy$=new X,this.trabajoForm=this.fb.group({fecha_trabajo:[new Date().toISOString().split("T")[0],k.required],hora_inicio:["",k.required],hora_fin:["",k.required],descripcion:["",[k.required,k.maxLength(500)]],estado:["Pendiente",k.required]})}ngOnInit(){z({arrowForward:wt,personOutline:W,mailOutline:Ht,chevronDownOutline:Ee,copyOutline:Ft,shieldOutline:Gt,informationCircleOutline:$t,cloudUploadOutline:It,closeOutline:jt,save:Lt,saveOutline:ze,trashOutline:ne,timeOutline:Y,calendarOutline:te,documentTextOutline:V,addOutline:yt,searchOutline:je}),this.modoEdicion=!!this.trabajoExistente,this.modoEdicion&&this.trabajoExistente&&this.cargarDatosTrabajoExistente(),this.cargarProductosInventario()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngAfterViewInit(){setTimeout(()=>{let o=this.elementRef.nativeElement.querySelector(".modal-container");o&&this.viewportService.applySafeAreaToModal(o)},100)}cargarDatosTrabajoExistente(){return E(this,null,function*(){var o;if((o=this.trabajoExistente)!=null&&o.id)try{let i=yield D(this.trabajosService.getTrabajo(this.trabajoExistente.id));if(this.trabajoForm.patchValue({fecha_trabajo:this.trabajoExistente.fecha_trabajo,hora_inicio:this.trabajoExistente.hora_inicio,hora_fin:this.trabajoExistente.hora_fin,descripcion:this.trabajoExistente.descripcion,estado:this.trabajoExistente.estado}),i.materiales&&i.materiales.length>0){let t=yield Promise.all(i.materiales.map(p=>E(this,null,function*(){return{producto:yield D(this.inventarioService.getProducto(p.material_id)),cantidad:p.cantidad_utilizada}})));this.materiales=t}}catch(i){console.error("Error al cargar datos del trabajo existente:",i),alert("Error al cargar los datos del trabajo para editar.")}})}cargarProductosInventario(){this.loadingProductos=!0,this.errorProductos=null,this.inventarioService.getProductosConStock(1,100,"","nombre","asc").pipe(w(this.destroy$)).subscribe({next:o=>{this.productosInventario=o.inventario,this.productosFiltrados=o.inventario,this.loadingProductos=!1},error:o=>{console.error("Error al cargar productos:",o),this.errorProductos="Error al cargar los productos del inventario",this.loadingProductos=!1}})}filtrarProductos(o){let i=o.target.value.toLowerCase();this.busquedaProducto=i,i?this.productosFiltrados=this.productosInventario.filter(t=>t.nombre.toLowerCase().includes(i)||t.codigo.toLowerCase().includes(i)||t.descripcion&&t.descripcion.toLowerCase().includes(i)):this.productosFiltrados=this.productosInventario}agregarMaterial(o){let i=this.materiales.find(t=>t.producto.id===o.id);if(i){let t=i.cantidad+1;if(t>o.cantidad_disponible){alert(`No hay suficiente stock. Solo quedan ${o.cantidad_disponible} ${o.unidad} de ${o.nombre}`);return}i.cantidad=t}else{if(o.cantidad_disponible<=0){alert(`No hay stock disponible para ${o.nombre}`);return}this.materiales.push({producto:o,cantidad:1})}}eliminarMaterial(o){this.materiales.splice(o,1)}actualizarCantidadMaterial(o,i){let t=this.materiales[o],p=parseInt(i.toString());if(!(isNaN(p)||p<=0)){if(p>t.producto.cantidad_disponible){alert(`No hay suficiente stock. Solo quedan ${t.producto.cantidad_disponible} ${t.producto.unidad} de ${t.producto.nombre}`);return}t.cantidad=p}}calcularCostoTotal(){return this.materiales.reduce((o,i)=>o+i.cantidad*i.producto.precio_neto,0)}crearTrabajo(){return E(this,null,function*(){if(this.trabajoForm.valid){let o=this.materiales.filter(t=>t.cantidad>t.producto.cantidad_disponible);if(o.length>0){let t=o.map(p=>`${p.producto.nombre}: solicitado ${p.cantidad} ${p.producto.unidad}, disponible ${p.producto.cantidad_disponible} ${p.producto.unidad}`).join(`
`);alert(`No hay suficiente stock para los siguientes materiales:

${t}`);return}let i=ge(pe({},this.trabajoForm.value),{aviso_id:this.avisoId,repuestos:this.materiales.map(t=>t.producto.nombre),materiales:this.materiales.map(t=>({material_id:t.producto.id,cantidad_utilizada:t.cantidad,precio_neto_al_momento:t.producto.precio_neto}))});yield this.modalController.dismiss(i,"confirm")}})}cerrarModal(){return E(this,null,function*(){yield this.modalController.dismiss(null,"cancel")})}};l.\u0275fac=function(i){return new(i||l)(P(ve),P(Mt),P(Wt),P(We),P(Ae),P(ie))},l.\u0275cmp=j({type:l,selectors:[["app-crear-trabajos-realizados"]],inputs:{avisoId:"avisoId",trabajoExistente:"trabajoExistente"},decls:20,vars:7,consts:[[1,"modal-container"],[1,"modal-header"],[1,"header-content"],[1,"close-button",3,"click"],["name","close-outline"],[1,"subtitle"],[1,"modal-body",3,"ngSubmit","formGroup"],[1,"modal-content"],["class","loading-state",4,"ngIf"],["class","modal-grid",4,"ngIf"],[1,"modal-footer"],[1,"button-group"],["type","button",1,"btn","btn-outline",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["name","save-outline"],[1,"loading-state"],[1,"loading-spinner"],["name","refresh-outline",1,"spinning"],[1,"modal-grid"],[1,"form-section"],[1,"form-group"],[1,"required"],["type","date","formControlName","fecha_trabajo",1,"form-control"],[1,"form-row"],[1,"form-group","half"],["type","time","formControlName","hora_inicio",1,"form-control"],["type","time","formControlName","hora_fin",1,"form-control"],["formControlName","descripcion","placeholder","Describe detalladamente el trabajo realizado...","rows","4","maxlength","500",1,"form-control"],[1,"character-count"],["formControlName","estado",1,"form-control"],["value","Pendiente"],["value","En curso"],["value","Completado"],["value","Cancelado"],[1,"images-section"],[1,"repuestos-container"],["class","info-message",4,"ngIf"],[1,"search-container"],[1,"search-input"],["name","search-outline"],["type","text","placeholder","Buscar productos del inventario...",1,"form-control",3,"ngModelChange","input","ngModel","ngModelOptions"],["class","loading-indicator",4,"ngIf"],["class","error-message",4,"ngIf"],["class","productos-disponibles",4,"ngIf"],["class","repuestos-list",4,"ngIf"],["class","no-repuestos",4,"ngIf"],[1,"info-message"],["name","information-circle-outline"],[1,"loading-indicator"],[1,"error-message"],[1,"productos-disponibles"],[1,"productos-list"],["class","producto-item",3,"sin-stock","stock-bajo","click",4,"ngFor","ngForOf"],[1,"producto-item",3,"click"],[1,"producto-info"],[1,"producto-header"],[1,"producto-codigo"],[1,"producto-stock"],[1,"producto-nombre"],["class","producto-descripcion",4,"ngIf"],[1,"producto-precio"],["type","button",1,"add-producto-btn",3,"disabled"],["name","add-outline"],[1,"producto-descripcion"],[1,"repuestos-list"],["class","repuesto-item",4,"ngFor","ngForOf"],[1,"costo-total"],[1,"repuesto-item"],[1,"repuesto-info"],[1,"repuesto-header"],[1,"repuesto-codigo"],[1,"repuesto-precio"],[1,"repuesto-nombre"],[1,"repuesto-cantidad"],["type","number",1,"cantidad-input",3,"change","value","min","max"],[1,"unidad"],["type","button",1,"remove-repuesto",3,"click"],["name","trash-outline"],[1,"no-repuestos"]],template:function(i,t){i&1&&(e(0,"div",0)(1,"header",1)(2,"div",2)(3,"h2"),r(4),n(),e(5,"button",3),u("click",function(){return t.cerrarModal()}),m(6,"ion-icon",4),n()(),e(7,"p",5),r(8),n()(),e(9,"form",6),u("ngSubmit",function(){return t.crearTrabajo()}),e(10,"div",7),f(11,rn,5,0,"div",8)(12,fn,56,10,"div",9),n()(),e(13,"footer",10)(14,"div",11)(15,"button",12),u("click",function(){return t.cerrarModal()}),r(16," Cancelar "),n(),e(17,"button",13),u("click",function(){return t.crearTrabajo()}),r(18),m(19,"ion-icon",14),n()()()()),i&2&&(s(4),_(t.modoEdicion?"Editar parte de trabajo":"Crear parte de trabajo"),s(4),_(t.modoEdicion?"Modifica el trabajo realizado":"Registra el trabajo realizado en este aviso"),s(),d("formGroup",t.trabajoForm),s(2),d("ngIf",t.modoEdicion&&!t.trabajoExistente),s(),d("ngIf",!t.modoEdicion||t.trabajoExistente),s(5),d("disabled",!t.trabajoForm.valid),s(),h(" ",t.modoEdicion?"Actualizar trabajo":"Crear trabajo"," "))},dependencies:[Ot,xt,T,A,F,U,ye,Me,rt,ct,it,at,Ce,be,st,Oe,Pe,he,xe],styles:[`.modal-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:90vh;background:#fff;position:relative}.modal-header[_ngcontent-%COMP%]{padding:16px 24px;border-bottom:1px solid #e5e7eb;flex-shrink:0}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600;color:#111827}.modal-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:8px 0 0;color:#6b7280;font-size:14px}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#6b7280;display:flex;align-items:center;justify-content:center}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#111827}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px}.modal-body[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex;flex-direction:column;min-height:0}.modal-content[_ngcontent-%COMP%]{flex:1;overflow:auto;position:relative;min-height:0}.modal-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:0;height:100%;overflow:hidden}@media (max-width: 768px){.modal-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto auto;height:auto;overflow:visible}}.form-section[_ngcontent-%COMP%]{padding:24px;border-right:1px solid #e5e7eb;overflow-y:auto;height:100%;max-height:100%}@media (max-width: 768px){.form-section[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e5e7eb;height:auto;max-height:none;overflow:visible;padding-bottom:30px}}.form-section[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#d1d5db #f3f4f6}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f3f4f6;border-radius:3px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:3px}.form-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}.images-section[_ngcontent-%COMP%]{padding:24px;background-color:#f9fafb;overflow-y:auto;height:100%;max-height:100%}@media (max-width: 768px){.images-section[_ngcontent-%COMP%]{height:auto;max-height:none;overflow:visible;min-height:300px;padding-bottom:80px}}.images-section[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#d1d5db #f3f4f6}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f3f4f6;border-radius:3px}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:3px}.images-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:14px;font-weight:500;color:#374151}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#dc2626}.form-group.half[_ngcontent-%COMP%]{flex:1}.form-control[_ngcontent-%COMP%]{position:relative;width:100%;padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px;color:#111827;background-color:#fff;transition:border-color .2s}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 2px #2563eb1a}.form-control[_ngcontent-%COMP%]:disabled{background-color:#f9fafb;color:#6b7280;cursor:not-allowed}select.form-control[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;background-size:16px;padding-right:40px}select.form-control[_ngcontent-%COMP%]:disabled{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")}select.form-control[_ngcontent-%COMP%]::placeholder{color:#9ca3af}select.form-control[_ngcontent-%COMP%]{padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s}select.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}input.form-control[_ngcontent-%COMP%]{padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s}input.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}textarea.form-control[_ngcontent-%COMP%]{position:relative;padding-right:40px;background-color:#fafafb;border:1px solid transparent;padding-top:10px;padding-bottom:10px;border-radius:6px;font-size:14px;color:#111827;transition:border-color .2s;resize:vertical;min-height:80px}textarea.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb}.character-count[_ngcontent-%COMP%]{margin-top:4px;text-align:right;font-size:12px;color:#6b7280;position:absolute;bottom:13px;right:13px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px}.form-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:0;flex:1}.repuestos-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;color:#374151;font-weight:600}.search-container[_ngcontent-%COMP%]{margin-bottom:16px}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;left:12px;color:#6b7280;font-size:18px;z-index:1}.search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:40px;width:100%}.loading-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:16px;color:#6b7280;font-size:14px}.loading-indicator[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.loading-indicator[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px;text-align:center}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#4f46e5}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#6b7280;margin:0}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%]{padding:12px;background:#fef2f2;color:#dc2626;border-radius:6px;font-size:14px;margin-bottom:16px}.productos-disponibles[_ngcontent-%COMP%]{margin-bottom:24px}.productos-disponibles[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:16px;color:#374151}.productos-list[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto;border:1px solid #E5E7EB;border-radius:6px}.producto-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid #F3F4F6;cursor:pointer;transition:background-color .2s}.producto-item[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.producto-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.producto-item.sin-stock[_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed}.producto-item.sin-stock[_ngcontent-%COMP%]:hover{background-color:transparent}.producto-item.stock-bajo[_ngcontent-%COMP%]{border-left:3px solid #F59E0B}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]{flex:1;min-width:0}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]   .producto-codigo[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]   .producto-stock[_ngcontent-%COMP%]{font-size:12px;color:#059669;font-weight:500}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]   .producto-stock.stock-bajo[_ngcontent-%COMP%]{color:#f59e0b;font-weight:600}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-header[_ngcontent-%COMP%]   .producto-stock.sin-stock[_ngcontent-%COMP%]{color:#ef4444;font-weight:600}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-nombre[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#111827;margin-bottom:2px}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-descripcion[_ngcontent-%COMP%]{display:block;font-size:12px;color:#6b7280;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.producto-item[_ngcontent-%COMP%]   .producto-info[_ngcontent-%COMP%]   .producto-precio[_ngcontent-%COMP%]{font-size:14px;color:#059669;font-weight:600}.producto-item[_ngcontent-%COMP%]   .add-producto-btn[_ngcontent-%COMP%]{background:#4f46e5;color:#fff;border:none;border-radius:50%;width:32px;height:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:background-color .2s}.producto-item[_ngcontent-%COMP%]   .add-producto-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#3730a3}.producto-item[_ngcontent-%COMP%]   .add-producto-btn[_ngcontent-%COMP%]:disabled{background:#9ca3af;cursor:not-allowed}.producto-item[_ngcontent-%COMP%]   .add-producto-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.repuestos-list[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;color:#374151;font-weight:500}.repuesto-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;background-color:#fff;border-radius:6px;border:1px solid #e5e7eb;margin-bottom:8px}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]{flex:1;min-width:0}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-header[_ngcontent-%COMP%]   .repuesto-codigo[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-header[_ngcontent-%COMP%]   .repuesto-precio[_ngcontent-%COMP%]{font-size:14px;color:#059669;font-weight:600}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-nombre[_ngcontent-%COMP%]{display:block;font-size:14px;color:#374151;font-weight:500;margin-bottom:8px}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   .cantidad-input[_ngcontent-%COMP%]{width:60px;padding:4px 8px;border:1px solid #D1D5DB;border-radius:4px;font-size:12px;text-align:center;background-color:#fafafb;color:#111827}.repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   .unidad[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.repuesto-item[_ngcontent-%COMP%]   .remove-repuesto[_ngcontent-%COMP%]{background:none;border:none;padding:8px;color:#dc2626;cursor:pointer;display:flex;align-items:center;justify-content:center}.repuesto-item[_ngcontent-%COMP%]   .remove-repuesto[_ngcontent-%COMP%]:hover{color:#b91c1c}.repuesto-item[_ngcontent-%COMP%]   .remove-repuesto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.costo-total[_ngcontent-%COMP%]{margin-top:16px;padding:12px;background-color:#f0f9ff;border:1px solid #BAE6FD;border-radius:6px;text-align:center}.costo-total[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#0369a1;font-size:14px}.no-repuestos[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.no-repuestos[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#d1d5db;margin-bottom:16px}.no-repuestos[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;color:#374151}.no-repuestos[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;color:#6b7280}.modal-footer[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e5e7eb;background:#fff;flex-shrink:0;z-index:10;position:sticky;bottom:0;left:0;right:0}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:6px;font-size:14px;font-weight:500;display:flex;align-items:center;gap:8px;cursor:pointer;transition:all .2s}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{background:none;border:1px solid #d1d5db;color:#374151}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f8fafc;border-color:#9ca3af}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#2563eb;border:1px solid #2563eb;color:#fff}.modal-footer[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#1d4ed8;border-color:#1d4ed8}@media (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:100vh;max-height:none}.modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-content[_ngcontent-%COMP%]{height:auto;overflow:auto}.modal-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto auto;height:auto;overflow:visible}.form-section[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e5e7eb;height:auto;max-height:none;overflow:visible;padding-bottom:30px}.images-section[_ngcontent-%COMP%]{height:auto;max-height:none;overflow:visible;min-height:300px;padding-bottom:80px}.form-control[_ngcontent-%COMP%]{font-size:16px;padding:12px}textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{font-size:14px!important;padding:12px}.add-repuesto[_ngcontent-%COMP%]{flex-direction:column}.add-repuesto[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]{width:100%;justify-content:center}}@media (display-mode: standalone) and (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px));max-height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px))}.modal-header[_ngcontent-%COMP%]{padding-top:calc(16px + var(--safe-area-top, 0px))}.modal-footer[_ngcontent-%COMP%]{padding-bottom:calc(16px + var(--safe-area-bottom, 0px))}}@supports (-webkit-touch-callout: none){@media (display-mode: standalone) and (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px));max-height:calc(100vh - var(--safe-area-top, 0px) - var(--safe-area-bottom, 0px))}.modal-header[_ngcontent-%COMP%]{padding-top:calc(16px + var(--safe-area-top, 0px))}.modal-footer[_ngcontent-%COMP%]{padding-bottom:calc(16px + var(--safe-area-bottom, 0px))}}}@supports not (padding-top: env(safe-area-inset-top)){@media (display-mode: standalone) and (max-width: 768px){.modal-container[_ngcontent-%COMP%]{height:calc(100vh - 40px);max-height:calc(100vh - 40px)}.modal-header[_ngcontent-%COMP%]{padding-top:36px}.modal-footer[_ngcontent-%COMP%]{padding-bottom:36px}}}.info-message[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;padding:12px;background-color:#eff6ff;border:1px solid #BFDBFE;border-radius:6px;margin-bottom:16px}.info-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:18px;margin-top:2px;flex-shrink:0}.info-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#1e40af;line-height:1.4}`]});let c=l;return c})();var Kt=(()=>{let l=class l{constructor(o){this.supabaseClientService=o,this.supabase=this.supabaseClientService.getClient()}crearAlbaran(o){return N(this.supabase.from("albaranes").insert([o]).select().single()).pipe(H(({data:i,error:t})=>{if(t)throw t;return i}),q(i=>{throw console.error("Error al crear albar\xE1n:",i),i}))}getAlbaran(o){return N(this.supabase.from("albaranes").select(`
          *,
          trabajo:trabajos_realizados(*),
          aviso:avisos(*)
        `).eq("id",o).single()).pipe(H(({data:i,error:t})=>{if(t)throw t;return i}),q(i=>{throw console.error("Error al obtener albar\xE1n:",i),i}))}getAlbaranesAviso(o){return N(this.supabase.from("albaranes").select(`
          *,
          trabajo:trabajos_realizados(*)
        `).eq("aviso_id",o).order("fecha_cierre",{ascending:!1})).pipe(H(({data:i,error:t})=>{if(t)throw t;return i}),q(i=>{throw console.error("Error al obtener albaranes del aviso:",i),i}))}getAlbaranesTrabajo(o){return N(this.supabase.from("albaranes").select("*").eq("trabajo_id",o).order("fecha_cierre",{ascending:!1})).pipe(H(({data:i,error:t})=>{if(t)throw t;return i}),q(i=>{throw console.error("Error al obtener albaranes del trabajo:",i),i}))}actualizarAlbaran(o,i){return N(this.supabase.from("albaranes").update(ge(pe({},i),{fecha_actualizacion:new Date})).eq("id",o).select().single()).pipe(H(({data:t,error:p})=>{if(p)throw p;return t}),q(t=>{throw console.error("Error al actualizar albar\xE1n:",t),t}))}eliminarAlbaran(o){return N(this.supabase.from("albaranes").delete().eq("id",o)).pipe(H(({error:i})=>{if(i)throw i}),q(i=>{throw console.error("Error al eliminar albar\xE1n:",i),i}))}getEstadisticasAlbaranes(o){return N(this.supabase.from("albaranes").select("estado_cierre").eq("aviso_id",o)).pipe(H(({data:i,error:t})=>{if(t)throw t;let p=i;return{total:p.length,finalizados:p.filter(M=>M.estado_cierre==="Finalizado").length,presupuestoPendiente:p.filter(M=>M.estado_cierre==="Presupuesto pendiente").length,otraVisita:p.filter(M=>M.estado_cierre==="Otra visita").length}}),q(i=>{throw console.error("Error al obtener estad\xEDsticas de albaranes:",i),i}))}};l.\u0275fac=function(i){return new(i||l)(Le(bt))},l.\u0275prov=Ue({token:l,factory:l.\u0275fac,providedIn:"root"});let c=l;return c})();var xn=["signaturePad"];function Mn(c,l){if(c&1){let a=O();e(0,"div",53),u("click",function(){let i=C(a).$implicit,t=g(2);return b(t.agregarRepuesto(i))}),e(1,"div",54)(2,"div",55)(3,"span",56),r(4),n(),e(5,"span",57),r(6),v(7,"currency"),n()(),e(8,"span",58),r(9),n(),e(10,"div",59)(11,"span",60),r(12),n(),e(13,"span",61),r(14),n()()(),m(15,"ion-icon",62),n()}if(c&2){let a=l.$implicit;s(4),_(a.codigo),s(2),_(y(7,6,a.precio_neto,"EUR","symbol","1.2-2")),s(3),_(a.nombre),s(3),I("Stock: ",a.cantidad_disponible," ",a.unidad,""),s(2),_(a.descripcion)}}function On(c,l){if(c&1){let a=O();e(0,"div",45)(1,"div",46)(2,"h4"),r(3,"Seleccionar Repuestos"),n(),e(4,"button",47),u("click",function(){C(a);let i=g();return b(i.cerrarSelectorRepuestos())}),m(5,"ion-icon",3),n()(),e(6,"div",48)(7,"ion-input",49),se("ngModelChange",function(i){C(a);let t=g();return ce(t.busquedaRepuesto,i)||(t.busquedaRepuesto=i),b(i)}),u("ionInput",function(i){C(a);let t=g();return b(t.filtrarProductos(i))}),n(),m(8,"ion-icon",50),n(),e(9,"div",51),f(10,Mn,16,11,"div",52),n()()}if(c&2){let a=g();s(7),re("ngModel",a.busquedaRepuesto),s(3),d("ngForOf",a.productosFiltrados)}}function Pn(c,l){if(c&1&&(e(0,"div",66)(1,"strong"),r(2),v(3,"currency"),n()()),c&2){let a=g(2);s(2),h("Precio Total: ",y(3,1,a.calcularPrecioTotalRepuestos(),"EUR","symbol","1.2-2"),"")}}function vn(c,l){if(c&1){let a=O();e(0,"div",67)(1,"div",68)(2,"span",69),r(3),n(),e(4,"div",70)(5,"label"),r(6,"Cantidad:"),n(),e(7,"input",71),u("change",function(i){let t=C(a).$implicit,p=g(2);return b(p.actualizarCantidadRepuesto(t,i.target.value))}),n(),e(8,"span",72),r(9),n()(),e(10,"div",73)(11,"span",74),r(12),v(13,"number"),n(),e(14,"span",75),r(15),v(16,"currency"),n()()(),e(17,"button",76),u("click",function(){let i=C(a).$implicit,t=g(2);return b(t.eliminarRepuesto(i))}),m(18,"ion-icon",77),n()()}if(c&2){let a=l.$implicit;s(3),_(a.nombre),s(4),d("value",a.cantidad)("min",1),s(2),_(a.unidad),s(3),I("\u20AC",B(13,7,a.precio_pvp,"1.2-2"),"/",a.unidad,""),s(3),_(y(16,10,a.precio_pvp*a.cantidad,"EUR","symbol","1.2-2"))}}function hn(c,l){if(c&1&&(e(0,"div",63)(1,"h4"),r(2,"Repuestos Seleccionados:"),n(),f(3,Pn,4,6,"div",64)(4,vn,19,15,"div",65),n()),c&2){let a=g();s(3),d("ngIf",a.repuestosSeleccionados.length>0),s(),d("ngForOf",a.repuestosSeleccionados)}}function yn(c,l){c&1&&(e(0,"div",78),m(1,"ion-icon",21),e(2,"p"),r(3,"No hay repuestos seleccionados"),n(),e(4,"small"),r(5,"Selecciona repuestos del inventario o agrega manualmente"),n()())}function En(c,l){c&1&&m(0,"ion-icon",82)}function wn(c,l){if(c&1){let a=O();e(0,"div",79),u("click",function(){let i=C(a).$implicit,t=g();return b(t.albaranForm.patchValue({estado_cierre:i.valor}))}),e(1,"div",80)(2,"h4"),r(3),n(),e(4,"p"),r(5),n()(),f(6,En,1,0,"ion-icon",81),n()}if(c&2){let a,o,i=l.$implicit,t=g();J("selected",((a=t.albaranForm.get("estado_cierre"))==null?null:a.value)===i.valor),s(3),_(i.label),s(2),_(i.descripcion),s(),d("ngIf",((o=t.albaranForm.get("estado_cierre"))==null?null:o.value)===i.valor)}}function kn(c,l){c&1&&(e(0,"div",8)(1,"h3"),r(2,"Presupuesto Necesario"),n(),e(3,"div",10),m(4,"ion-input",83),n()())}function Sn(c,l){if(c&1){let a=O();e(0,"div",84),m(1,"canvas",85,0),e(3,"div",86)(4,"button",87),u("click",function(){C(a);let i=g();return b(i.limpiarFirma())}),m(5,"ion-icon",77),r(6," Limpiar "),n(),e(7,"button",88),u("click",function(){C(a);let i=g();return b(i.guardarFirma())}),m(8,"ion-icon",89),r(9," Guardar Firma "),n()()()}}function zn(c,l){if(c&1){let a=O();e(0,"div",90),m(1,"img",91),e(2,"div",92)(3,"button",93),u("click",function(){C(a);let i=g();return b(i.editarFirma())}),m(4,"ion-icon",94),r(5," Editar "),n(),e(6,"button",76),u("click",function(){C(a);let i=g();return b(i.eliminarFirma())}),m(7,"ion-icon",77),r(8," Eliminar "),n()()()}if(c&2){let a=g();s(),d("src",a.firmaDataUrl,Z)}}function jn(c,l){if(c&1){let a=O();e(0,"div",95)(1,"span"),r(2,"\xC1rea de firma digital"),n(),e(3,"small"),r(4,"Haz clic para comenzar a firmar"),n(),e(5,"button",96),u("click",function(){C(a);let i=g();return b(i.iniciarFirma())}),m(6,"ion-icon",94),r(7," Comenzar Firma "),n()()}}function In(c,l){if(c&1){let a=O();e(0,"div",53),u("click",function(){let i=C(a).$implicit,t=g(2);return b(t.agregarRepuesto(i))}),e(1,"div",54)(2,"div",55)(3,"span",56),r(4),n(),e(5,"span",57),r(6),v(7,"currency"),n()(),e(8,"span",58),r(9),n(),e(10,"div",59)(11,"span",60),r(12),n(),e(13,"span",61),r(14),n()()(),m(15,"ion-icon",62),n()}if(c&2){let a=l.$implicit;s(4),_(a.codigo),s(2),_(y(7,6,a.precio_neto,"EUR","symbol","1.2-2")),s(3),_(a.nombre),s(3),I("Stock: ",a.cantidad_disponible," ",a.unidad,""),s(2),_(a.descripcion)}}function An(c,l){if(c&1){let a=O();e(0,"div",45)(1,"div",46)(2,"h4"),r(3,"Seleccionar Repuestos"),n(),e(4,"button",47),u("click",function(){C(a);let i=g();return b(i.cerrarSelectorRepuestos())}),m(5,"ion-icon",3),n()(),e(6,"div",48)(7,"ion-input",49),se("ngModelChange",function(i){C(a);let t=g();return ce(t.busquedaRepuesto,i)||(t.busquedaRepuesto=i),b(i)}),u("ionInput",function(i){C(a);let t=g();return b(t.filtrarProductos(i))}),n(),m(8,"ion-icon",50),n(),e(9,"div",51),f(10,In,16,11,"div",52),n()()}if(c&2){let a=g();s(7),re("ngModel",a.busquedaRepuesto),s(3),d("ngForOf",a.productosFiltrados)}}function Fn(c,l){if(c&1&&(e(0,"div",66)(1,"strong"),r(2),v(3,"currency"),n()()),c&2){let a=g(2);s(2),h("Precio Total: ",y(3,1,a.calcularPrecioTotalRepuestos(),"EUR","symbol","1.2-2"),"")}}function Tn(c,l){if(c&1){let a=O();e(0,"div",67)(1,"div",68)(2,"span",69),r(3),n(),e(4,"div",70)(5,"label"),r(6,"Cantidad:"),n(),e(7,"input",71),u("change",function(i){let t=C(a).$implicit,p=g(2);return b(p.actualizarCantidadRepuesto(t,i.target.value))}),n(),e(8,"span",72),r(9),n()(),e(10,"div",73)(11,"span",74),r(12),v(13,"number"),n(),e(14,"span",75),r(15),v(16,"currency"),n()()(),e(17,"button",76),u("click",function(){let i=C(a).$implicit,t=g(2);return b(t.eliminarRepuesto(i))}),m(18,"ion-icon",77),n()()}if(c&2){let a=l.$implicit;s(3),_(a.nombre),s(4),d("value",a.cantidad)("min",1),s(2),_(a.unidad),s(3),I("\u20AC",B(13,7,a.precio_pvp,"1.2-2"),"/",a.unidad,""),s(3),_(y(16,10,a.precio_pvp*a.cantidad,"EUR","symbol","1.2-2"))}}function Vn(c,l){if(c&1&&(e(0,"div",63)(1,"h4"),r(2,"Repuestos Seleccionados:"),n(),f(3,Fn,4,6,"div",64)(4,Tn,19,15,"div",65),n()),c&2){let a=g();s(3),d("ngIf",a.repuestosSeleccionados.length>0),s(),d("ngForOf",a.repuestosSeleccionados)}}function Rn(c,l){c&1&&(e(0,"div",78),m(1,"ion-icon",21),e(2,"p"),r(3,"No hay repuestos seleccionados"),n(),e(4,"small"),r(5,"Selecciona repuestos del inventario o agrega manualmente"),n()())}function Dn(c,l){if(c&1&&(e(0,"div",97),m(1,"ion-icon",98),e(2,"span"),r(3),n()()),c&2){let a=g();s(3),_(a.error)}}function Bn(c,l){c&1&&m(0,"ion-icon",99)}function $n(c,l){c&1&&m(0,"ion-icon",100)}var Zt=(()=>{let l=class l{constructor(o,i,t,p,x,M){this.fb=o,this.modalController=i,this.inventarioService=t,this.albaranesService=p,this.trabajosService=x,this.avisosService=M,this.loading=!1,this.error=null,this.productosInventario=[],this.productosFiltrados=[],this.busquedaRepuesto="",this.mostrarSelectorRepuestos=!1,this.repuestosSeleccionados=[],this.firmaCapturada=!1,this.firmaDataUrl="",this.mostrarCanvas=!1,this.estadosCierre=[{valor:"Finalizado",label:"Finalizado",descripcion:"Trabajo completado, listo para facturar"},{valor:"Presupuesto pendiente",label:"Presupuesto pendiente",descripcion:"Se requiere presupuesto adicional"},{valor:"Otra visita",label:"Otra visita",descripcion:"Se necesita realizar otra visita"}],console.log("HacerAlbaranComponent constructor called"),z({close:K,timeOutline:Y,cubeOutline:ke,addCircleOutline:ht,searchOutline:je,trashOutline:ne,checkmarkCircleOutline:G,checkmarkOutline:zt,createOutline:we,warningOutline:oe,saveOutline:ze,refreshOutline:Q,calendarOutline:te,personOutline:W,pencilOutline:le,documentTextOutline:V}),this.albaranForm=this.fb.group({fecha_cierre:[new Date,k.required],hora_entrada:["",k.required],hora_salida:["",k.required],descripcion_trabajo_realizado:["",k.required],repuestos_utilizados:[[]],estado_cierre:["",k.required],presupuesto_necesario:[0,[k.min(0)]],dni_cliente:[""],nombre_firma:[""],firma_cliente:[""],observaciones:[""]})}ngOnInit(){return E(this,null,function*(){console.log("\u{1F3AF} HacerAlbaranComponent ngOnInit - Trabajo:",this.trabajo),console.log("\u{1F3AF} HacerAlbaranComponent ngOnInit - Aviso:",this.aviso),console.log("\u{1F3AF} Formulario inicializado:",this.albaranForm);try{yield this.cargarProductosInventario(),this.inicializarFormulario()}catch(o){console.error("Error al inicializar componente:",o)}})}ngAfterViewInit(){setTimeout(()=>{this.inicializarSignaturePad()},100)}inicializarFormulario(){this.trabajo&&(this.albaranForm.patchValue({hora_entrada:this.trabajo.hora_inicio,hora_salida:this.trabajo.hora_fin,repuestos_utilizados:this.trabajo.repuestos||[]}),this.trabajo.repuestos&&this.trabajo.repuestos.length>0&&(console.log("\u{1F50D} inicializarFormulario - Repuestos existentes encontrados:",this.trabajo.repuestos),console.log("\u{1F50D} inicializarFormulario - Materiales del trabajo:",this.trabajo.materiales),this.repuestosSeleccionados=this.trabajo.repuestos.map(o=>{var M;let i=this.productosInventario.find(S=>S.nombre===o),t=(M=this.trabajo.materiales)==null?void 0:M.find(S=>{var R;return((R=S.material)==null?void 0:R.nombre)===o}),p=(t==null?void 0:t.cantidad_utilizada)||1;console.log("\u{1F50D} Buscando material:",o,"Material encontrado:",t,"Cantidad real:",p);let x={nombre:o,cantidad:p,precio_neto:(i==null?void 0:i.precio_neto)||0,precio_pvp:(i==null?void 0:i.pvp)||(i==null?void 0:i.precio_neto)||0,unidad:(i==null?void 0:i.unidad)||"unidad",codigo:(i==null?void 0:i.codigo)||""};return console.log("\u{1F50D} inicializarFormulario - Repuesto convertido:",x),x}),this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados})))}cargarProductosInventario(){return new Promise((o,i)=>{this.inventarioService.getInventario(1,1e3,"","nombre","asc",!1).subscribe({next:t=>{this.productosInventario=t.inventario,this.productosFiltrados=[...this.productosInventario],console.log(" Inventario cargado:",this.productosInventario.length,"productos"),o()},error:t=>{console.error("Error al cargar productos del inventario:",t),i(t)}})})}filtrarProductos(o){var t;let i=((t=o==null?void 0:o.target)==null?void 0:t.value)||o||"";this.busquedaRepuesto=i,i.trim()?this.productosFiltrados=this.productosInventario.filter(p=>{var x;return p.nombre.toLowerCase().includes(i.toLowerCase())||p.codigo.toLowerCase().includes(i.toLowerCase())||(((x=p.descripcion)==null?void 0:x.toLowerCase())||"").includes(i.toLowerCase())}):this.productosFiltrados=[...this.productosInventario]}abrirSelectorRepuestos(){this.mostrarSelectorRepuestos=!0,this.productosFiltrados=[...this.productosInventario],this.busquedaRepuesto=""}cerrarSelectorRepuestos(){this.mostrarSelectorRepuestos=!1}agregarRepuesto(o){console.log("\u{1F50D} agregarRepuesto - Producto recibido:",o);let i=this.repuestosSeleccionados.find(t=>t.nombre===o.nombre);if(i)i.cantidad+=1,console.log("\u{1F50D} agregarRepuesto - Repuesto existente, cantidad aumentada a:",i.cantidad);else{let t={nombre:o.nombre,cantidad:1,precio_neto:o.precio_neto||0,precio_pvp:o.pvp||o.precio_neto||0,unidad:o.unidad||"unidad",codigo:o.codigo||""};console.log("\u{1F50D} agregarRepuesto - Nuevo repuesto creado:",t),this.repuestosSeleccionados.push(t)}this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados}),console.log("\u{1F50D} agregarRepuesto - Repuestos seleccionados actualizados:",this.repuestosSeleccionados),this.cerrarSelectorRepuestos()}eliminarRepuesto(o){this.repuestosSeleccionados=this.repuestosSeleccionados.filter(i=>i!==o),this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados})}actualizarCantidadRepuesto(o,i){i>0&&(o.cantidad=i,this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados}))}agregarRepuestoManual(){let o=prompt("Introduce el nombre del repuesto:");if(o&&o.trim()){let i=prompt("Introduce la cantidad utilizada:"),t=parseInt(i||"1");if(t>0){let p=prompt("Introduce el precio por unidad (\u20AC):"),x=parseFloat(p||"0"),M=prompt("Introduce la unidad (unidad, kg, m, etc.):")||"unidad",S={nombre:o.trim(),cantidad:t,precio_neto:x,precio_pvp:x,unidad:M,codigo:""};console.log("\u{1F50D} agregarRepuestoManual - Repuesto manual creado:",S),this.repuestosSeleccionados.push(S),this.albaranForm.patchValue({repuestos_utilizados:this.repuestosSeleccionados})}}}generarHoraActual(){let o=new Date;return`${o.getHours().toString().padStart(2,"0")}:${o.getMinutes().toString().padStart(2,"0")}`}establecerHoraActual(){let o=this.generarHoraActual();this.albaranForm.patchValue({hora_salida:o})}establecerFechaActual(){this.albaranForm.patchValue({fecha_cierre:new Date})}guardarAlbaran(){if(this.albaranForm.valid){this.loading=!0,this.error=null;let o={trabajo_id:this.trabajo.id,aviso_id:this.aviso.id,fecha_cierre:this.albaranForm.value.fecha_cierre,hora_entrada:this.albaranForm.value.hora_entrada,hora_salida:this.albaranForm.value.hora_salida,descripcion_trabajo_realizado:this.albaranForm.value.descripcion_trabajo_realizado,repuestos_utilizados:this.albaranForm.value.repuestos_utilizados,estado_cierre:this.albaranForm.value.estado_cierre,presupuesto_necesario:this.albaranForm.value.presupuesto_necesario,dni_cliente:this.albaranForm.value.dni_cliente,nombre_firma:this.albaranForm.value.nombre_firma,firma_cliente:this.albaranForm.value.firma_cliente,observaciones:this.albaranForm.value.observaciones};console.log("Datos del albar\xE1n:",o),this.albaranesService.crearAlbaran(o).subscribe({next:i=>{console.log("Albar\xE1n guardado exitosamente:",i);let t;switch(i.estado_cierre){case"Finalizado":t="Finalizado";break;case"Presupuesto pendiente":t="Presupuesto pendiente";break;case"Otra visita":t="Otra visita";break;default:t="Finalizado"}console.log("\u{1F504} Actualizando estado del trabajo:",{trabajoId:this.trabajo.id,estadoAnterior:this.trabajo.estado,nuevoEstado:t,albaranId:i.id,estadoAlbaran:i.estado_cierre}),this.trabajosService.actualizarEstadoTrabajo(this.trabajo.id,t,i.id).subscribe({next:p=>{console.log("\u2705 Trabajo actualizado exitosamente:",{id:p.id,estadoAnterior:this.trabajo.estado,estadoNuevo:p.estado,albaranId:p.albaran_id}),this.avisosService.actualizarEstadoAutomatico(this.aviso.id).subscribe({next:x=>{this.loading=!1,console.log("Estado del aviso actualizado autom\xE1ticamente:",x),this.modalController.dismiss({success:!0,albaran:i,trabajo:p,aviso:x,mensaje:"Albar\xE1n guardado exitosamente"},"confirm")},error:x=>{console.error("Error al actualizar estado del aviso:",x),this.loading=!1,this.modalController.dismiss({success:!0,albaran:i,trabajo:p,mensaje:"Albar\xE1n guardado exitosamente"},"confirm")}})},error:p=>{this.loading=!1,this.error="Error al actualizar el trabajo: "+(p.message||"Error desconocido"),console.error("Error al actualizar trabajo:",p)}})},error:i=>{this.loading=!1,this.error="Error al guardar el albar\xE1n: "+(i.message||"Error desconocido"),console.error("Error al guardar albar\xE1n:",i)}})}else this.error="Por favor, complete todos los campos requeridos",this.marcarCamposComoTocados()}marcarCamposComoTocados(){Object.keys(this.albaranForm.controls).forEach(o=>{let i=this.albaranForm.get(o);i==null||i.markAsTouched()})}cancelar(){this.modalController.dismiss()}requierePresupuesto(){var o;return((o=this.albaranForm.get("estado_cierre"))==null?void 0:o.value)==="Presupuesto pendiente"}requiereOtraVisita(){var o;return((o=this.albaranForm.get("estado_cierre"))==null?void 0:o.value)==="Otra visita"}calcularPrecioTotalRepuestos(){return this.repuestosSeleccionados.reduce((o,i)=>o+i.precio_pvp*i.cantidad,0)}debugTrabajo(o){console.log("Trabajo:",o),console.log("Repuestos:",o.repuestos),console.log("Repuestos con cantidades:",o.materiales),console.log("Precio total repuestos:",this.calcularPrecioTotalRepuestos())}iniciarFirma(){this.mostrarCanvas=!0,this.firmaCapturada=!1,this.firmaDataUrl=""}inicializarSignaturePad(){var i;if(!((i=this.signaturePadElement)!=null&&i.nativeElement)){console.warn("Canvas no encontrado");return}let o=this.signaturePadElement.nativeElement;import("./chunk-PGY3UNFJ.js").then(({default:t})=>{this.signaturePad=new t(o,{backgroundColor:"white",penColor:"black",minWidth:1,maxWidth:2.5,throttle:16,velocityFilterWeight:.7,dotSize:1}),this.ajustarCanvas(),window.addEventListener("resize",()=>this.ajustarCanvas())})}ajustarCanvas(){var M;if(!((M=this.signaturePadElement)!=null&&M.nativeElement)||!this.signaturePad)return;let o=this.signaturePadElement.nativeElement,i=o.parentElement;if(!i)return;let t=i.getBoundingClientRect(),p=Math.max(t.width-40,200),x=150;o.width=p,o.height=x,this.signaturePad.resizeCanvas()}limpiarFirma(){this.signaturePad&&this.signaturePad.clear()}guardarFirma(){this.signaturePad&&!this.signaturePad.isEmpty()?(this.firmaDataUrl=this.signaturePad.toDataURL(),this.firmaCapturada=!0,this.mostrarCanvas=!1,this.albaranForm.patchValue({firma_cliente:this.firmaDataUrl}),console.log("Firma guardada exitosamente")):console.warn("No hay firma para guardar")}editarFirma(){this.mostrarCanvas=!0,this.firmaCapturada=!1,this.signaturePad&&this.signaturePad.clear()}eliminarFirma(){this.firmaCapturada=!1,this.firmaDataUrl="",this.mostrarCanvas=!1,this.signaturePad&&this.signaturePad.clear(),this.albaranForm.patchValue({firma_cliente:""}),console.log("Firma eliminada")}};l.\u0275fac=function(i){return new(i||l)(P(ve),P(ee),P(Ae),P(Kt),P(ie),P(Ie))},l.\u0275cmp=j({type:l,selectors:[["app-hacer-albaran"]],viewQuery:function(i,t){if(i&1&&me(xn,5),i&2){let p;_e(p=ue())&&(t.signaturePadElement=p.first)}},inputs:{trabajo:"trabajo",aviso:"aviso"},decls:105,vars:17,consts:[["signaturePad",""],["slot","end"],[3,"click"],["name","close"],[1,"albaran-container"],[3,"ngSubmit","formGroup"],[1,"form-layout"],[1,"form-main"],[1,"form-section"],[1,"form-row"],[1,"form-group"],["type","date","formControlName","fecha_cierre",3,"click"],[1,"help-text"],["type","time","formControlName","hora_entrada","step","900"],["type","time","formControlName","hora_salida","step","900",3,"click"],["type","button",1,"btn-now",3,"click"],["name","time-outline"],["formControlName","descripcion_trabajo_realizado","placeholder","Describe detalladamente el trabajo realizado...","rows","3"],[1,"form-section","repuestos-section","mobile-only"],[1,"repuestos-actions"],["type","button",1,"btn-select-inventory",3,"click"],["name","cube-outline"],["type","button",1,"btn-add-manual",3,"click"],["name","add-circle-outline"],["class","inventory-selector",4,"ngIf"],["class","repuestos-list",4,"ngIf"],["class","repuestos-empty",4,"ngIf"],[1,"estados-grid"],["class","estado-option",3,"selected","click",4,"ngFor","ngForOf"],["class","form-section",4,"ngIf"],["formControlName","observaciones","placeholder","Observaciones adicionales...","rows","2"],["type","text","formControlName","dni_cliente","placeholder","DNI del cliente"],["type","text","formControlName","nombre_firma","placeholder","Nombre de la persona que firma"],[1,"signature-area"],["class","signature-canvas-container",4,"ngIf"],["class","signature-preview",4,"ngIf"],["class","signature-placeholder",4,"ngIf"],[1,"form-sidebar"],[1,"form-section","repuestos-section","desktop-only"],["class","error-message",4,"ngIf"],[1,"form-actions"],["type","button","fill","outline",3,"click"],["type","submit",3,"disabled"],["name","save-outline",4,"ngIf"],["name","refresh-outline","class","spinning",4,"ngIf"],[1,"inventory-selector"],[1,"selector-header"],["type","button",1,"btn-close",3,"click"],[1,"search-container"],["type","text","placeholder","Buscar repuestos...",1,"search-input",3,"ngModelChange","ionInput","ngModel"],["name","search-outline"],[1,"products-list"],["class","product-item",3,"click",4,"ngFor","ngForOf"],[1,"product-item",3,"click"],[1,"product-info"],[1,"product-header"],[1,"product-code"],[1,"product-price"],[1,"product-name"],[1,"product-details"],[1,"product-stock"],[1,"product-description"],["name","add-circle-outline",1,"add-icon"],[1,"repuestos-list"],["class","precio-total",4,"ngIf"],["class","repuesto-item",4,"ngFor","ngForOf"],[1,"precio-total"],[1,"repuesto-item"],[1,"repuesto-info"],[1,"repuesto-nombre"],[1,"repuesto-cantidad"],["type","number",1,"cantidad-input",3,"change","value","min"],[1,"unidad"],[1,"repuesto-precio-info"],[1,"precio-unitario"],[1,"precio-total-item"],["type","button",1,"btn-remove",3,"click"],["name","trash-outline"],[1,"repuestos-empty"],[1,"estado-option",3,"click"],[1,"estado-content"],["name","checkmark-circle-outline",4,"ngIf"],["name","checkmark-circle-outline"],["type","number","formControlName","presupuesto_necesario","placeholder","0.00","step","0.01"],[1,"signature-canvas-container"],[1,"signature-canvas"],[1,"signature-controls"],["type","button",1,"btn-clear",3,"click"],["type","button",1,"btn-save",3,"click"],["name","checkmark-outline"],[1,"signature-preview"],["alt","Firma del cliente",1,"firma-image",3,"src"],[1,"signature-actions"],["type","button",1,"btn-edit",3,"click"],["name","create-outline"],[1,"signature-placeholder"],["type","button",1,"btn-start-signature",3,"click"],[1,"error-message"],["name","warning-outline"],["name","save-outline"],["name","refresh-outline",1,"spinning"]],template:function(i,t){i&1&&(e(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),r(3,"VISTA CIERRE ALBAR\xC1N"),n(),e(4,"ion-buttons",1)(5,"ion-button",2),u("click",function(){return t.cancelar()}),m(6,"ion-icon",3),n()()()(),e(7,"ion-content")(8,"div",4)(9,"form",5),u("ngSubmit",function(){return t.guardarAlbaran()}),e(10,"div",6)(11,"div",7)(12,"div",8)(13,"h3"),r(14,"Fecha y Horarios"),n(),e(15,"div",9)(16,"div",10)(17,"ion-label"),r(18,"FECHA"),n(),e(19,"ion-input",11),u("click",function(){return t.establecerFechaActual()}),n(),e(20,"small",12),r(21,"Autom\xE1tica d\xEDa actual"),n()(),e(22,"div",10)(23,"ion-label"),r(24,"HORA ENTRADA"),n(),m(25,"ion-input",13),e(26,"small",12),r(27,"Men\xFA interactivo 15 en 15 min"),n()(),e(28,"div",10)(29,"ion-label"),r(30,"HORA SALIDA"),n(),e(31,"ion-input",14),u("click",function(){return t.establecerHoraActual()}),n(),e(32,"button",15),u("click",function(){return t.establecerHoraActual()}),m(33,"ion-icon",16),r(34," Ahora "),n()()()(),e(35,"div",8)(36,"h3"),r(37,"Descripci\xF3n del Trabajo Realizado"),n(),e(38,"div",10),m(39,"ion-textarea",17),n()(),e(40,"div",18)(41,"h3"),r(42,"Repuestos Utilizados"),n(),e(43,"div",19)(44,"button",20),u("click",function(){return t.abrirSelectorRepuestos()}),m(45,"ion-icon",21),r(46," Seleccionar del Inventario "),n(),e(47,"button",22),u("click",function(){return t.agregarRepuestoManual()}),m(48,"ion-icon",23),r(49," Agregar Manualmente "),n()(),f(50,On,11,2,"div",24)(51,hn,5,2,"div",25)(52,yn,6,0,"div",26),n(),e(53,"div",8)(54,"h3"),r(55,"Estado de Cierre"),n(),e(56,"div",27),f(57,wn,7,5,"div",28),n()(),f(58,kn,5,0,"div",29),e(59,"div",8)(60,"h3"),r(61,"Observaciones Adicionales"),n(),e(62,"div",10),m(63,"ion-textarea",30),n()(),e(64,"div",8)(65,"h3"),r(66,"Identificaci\xF3n y Firma"),n(),e(67,"div",9)(68,"div",10)(69,"ion-label"),r(70,"DNI"),n(),m(71,"ion-input",31),n(),e(72,"div",10)(73,"ion-label"),r(74,"NOMBRE FIRMA"),n(),m(75,"ion-input",32),n()(),e(76,"div",10)(77,"ion-label"),r(78,"FIRMA"),n(),e(79,"div",33),f(80,Sn,10,0,"div",34)(81,zn,9,1,"div",35)(82,jn,8,0,"div",36),n()()()(),e(83,"div",37)(84,"div",38)(85,"h3"),r(86,"Repuestos Utilizados"),n(),e(87,"div",19)(88,"button",20),u("click",function(){return t.abrirSelectorRepuestos()}),m(89,"ion-icon",21),r(90," Seleccionar del Inventario "),n(),e(91,"button",22),u("click",function(){return t.agregarRepuestoManual()}),m(92,"ion-icon",23),r(93," Agregar Manualmente "),n()(),f(94,An,11,2,"div",24)(95,Vn,5,2,"div",25)(96,Rn,6,0,"div",26),n()()(),f(97,Dn,4,1,"div",39),e(98,"div",40)(99,"ion-button",41),u("click",function(){return t.cancelar()}),r(100," Cancelar "),n(),e(101,"ion-button",42),f(102,Bn,1,0,"ion-icon",43)(103,$n,1,0,"ion-icon",44),r(104),n()()()()()),i&2&&(s(9),d("formGroup",t.albaranForm),s(41),d("ngIf",t.mostrarSelectorRepuestos),s(),d("ngIf",t.repuestosSeleccionados.length>0),s(),d("ngIf",t.repuestosSeleccionados.length===0&&!t.mostrarSelectorRepuestos),s(5),d("ngForOf",t.estadosCierre),s(),d("ngIf",t.requierePresupuesto()),s(22),d("ngIf",!t.firmaCapturada),s(),d("ngIf",t.firmaCapturada),s(),d("ngIf",!t.firmaCapturada&&!t.mostrarCanvas),s(12),d("ngIf",t.mostrarSelectorRepuestos),s(),d("ngIf",t.repuestosSeleccionados.length>0),s(),d("ngIf",t.repuestosSeleccionados.length===0&&!t.mostrarSelectorRepuestos),s(),d("ngIf",t.error),s(4),d("disabled",!t.albaranForm.valid||t.loading),s(),d("ngIf",!t.loading),s(),d("ngIf",t.loading),s(),h(" ",t.loading?"Guardando...":"Guardar Albar\xE1n"," "))},dependencies:[T,A,F,fe,U,ye,Me,Ce,be,Oe,Pe,he,xe,L,lt,ft,Ct,mt,pt,gt,ut,_t,dt],styles:["ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #fff;--border-color: #e5e7eb;--color: #111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#111827}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--color: #6b7280}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:hover{--color: #111827}.albaran-container[_ngcontent-%COMP%]{padding:24px;height:100%;display:flex;flex-direction:column;overflow:hidden;background:#fff}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;gap:20px;overflow-y:auto;padding-right:4px;padding-bottom:120px}form[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}form[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}form[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}form[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}.form-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:24px;flex:1}@media (min-width: 1200px){.form-layout[_ngcontent-%COMP%]{grid-template-columns:2fr 1fr;gap:32px}}.form-main[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;order:1}.form-sidebar[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;order:2}.form-section[_ngcontent-%COMP%]{background:#fff;border:1px solid #E2E8F0;border-radius:12px;padding:24px;box-shadow:0 1px 3px #0000001a;flex-shrink:0}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;font-size:18px;font-weight:600;color:#1f2937;border-bottom:2px solid #4F46E5;padding-bottom:8px}.repuestos-section[_ngcontent-%COMP%]{position:sticky;top:20px}.repuestos-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{border-bottom-color:#10b981}@media (max-width: 1199px){.repuestos-section[_ngcontent-%COMP%]{position:static;top:auto}}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px}@media (min-width: 1200px){.form-row[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr);gap:24px}}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.form-group[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:8px;text-transform:none;letter-spacing:normal}.form-group[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{--background: #FAFAFB;--border-radius: 6px;--border-width: 1px;--border-color: transparent;--padding-start: 12px;--padding-end: 12px;--padding-top: 10px;--padding-bottom: 10px;--color: #111827;--placeholder-color: #9CA3AF;font-size:14px;transition:border-color .2s}.form-group[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]:focus-within, .form-group[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]:focus-within, .form-group[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]:focus-within{--border-color: #2563eb;--background: #fff;box-shadow:0 0 0 2px #2563eb1a}.form-group[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{--min-height: 80px;resize:vertical}.help-text[_ngcontent-%COMP%]{display:block;font-size:11px;color:#6b7280;margin-top:4px;font-style:italic;line-height:1.4}.btn-now[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 12px;background:#2563eb;color:#fff;border:none;border-radius:6px;font-size:12px;font-weight:500;cursor:pointer;margin-top:8px;transition:all .2s ease}.btn-now[_ngcontent-%COMP%]:hover{background:#1d4ed8}.btn-now[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.estados-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}@media (min-width: 1200px){.estados-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr);gap:20px}}.estado-option[_ngcontent-%COMP%]{border:2px solid #E5E7EB;border-radius:8px;padding:20px;cursor:pointer;transition:all .2s ease;position:relative;background:#fff}.estado-option[_ngcontent-%COMP%]:hover{border-color:#2563eb;transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.estado-option.selected[_ngcontent-%COMP%]{border-color:#2563eb;background:#eff6ff}.estado-option.selected[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#2563eb}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;font-weight:600;color:#111827}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:13px;color:#6b7280;line-height:1.4}.estado-option[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px;font-size:20px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]{border:2px dashed #D1D5DB;border-radius:8px;padding:20px;text-align:center;background:#f9fafb;transition:all .2s ease;min-height:200px;display:flex;align-items:center;justify-content:center;position:relative}.signature-area[_ngcontent-%COMP%]:hover{border-color:#2563eb;background:#eff6ff}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;gap:16px}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-canvas[_ngcontent-%COMP%]{border:1px solid #E5E7EB;border-radius:6px;background:#fff;cursor:crosshair;touch-action:none}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-clear[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-clear[_ngcontent-%COMP%]:hover{background:#fecaca}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]{background:#10b981;color:#fff}.signature-area[_ngcontent-%COMP%]   .signature-canvas-container[_ngcontent-%COMP%]   .signature-controls[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]:hover{background:#059669}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;gap:16px}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .firma-image[_ngcontent-%COMP%]{max-width:100%;max-height:120px;border:1px solid #E5E7EB;border-radius:6px;background:#fff}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]{background:#dbeafe;color:#1d4ed8}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]:hover{background:#bfdbfe}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.signature-area[_ngcontent-%COMP%]   .signature-preview[_ngcontent-%COMP%]   .signature-actions[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]:hover{background:#fecaca}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;color:#6b7280;margin-top:15px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;font-weight:500}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 20px;background:#2563eb;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s;margin-top:8px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]:hover{background:#1d4ed8}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   .btn-start-signature[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#fef2f2;border:1px solid #FECACA;border-radius:6px;color:#dc2626;margin-bottom:20px;font-size:14px}.error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;color:#dc2626;flex-shrink:0}.error-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end;margin-top:auto;padding:16px 24px;border-top:1px solid #E5E7EB;flex-shrink:0;background:#fff;position:fixed;bottom:0;left:0;right:0;z-index:1000;box-shadow:0 -2px 10px #0000001a}.form-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;--padding-top: 8px;--padding-bottom: 8px;font-weight:500;font-size:14px;min-width:140px;border-radius:6px;transition:all .2s}.form-actions[_ngcontent-%COMP%]   ion-button[fill=outline][_ngcontent-%COMP%]{--border-color: #d1d5db;--color: #374151}.form-actions[_ngcontent-%COMP%]   ion-button[fill=outline][_ngcontent-%COMP%]:hover{--background: #f8fafc;--border-color: #9ca3af}.form-actions[_ngcontent-%COMP%]   ion-button[type=submit][_ngcontent-%COMP%]{--background: #2563eb;--border-color: #2563eb;--color: #fff}.form-actions[_ngcontent-%COMP%]   ion-button[type=submit][_ngcontent-%COMP%]:hover{--background: #1d4ed8;--border-color: #1d4ed8}.repuestos-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:24px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;padding:10px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;width:100%}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.repuestos-actions[_ngcontent-%COMP%]   .btn-select-inventory[_ngcontent-%COMP%]{background:#2563eb;color:#fff}.repuestos-actions[_ngcontent-%COMP%]   .btn-select-inventory[_ngcontent-%COMP%]:hover{background:#1d4ed8}.repuestos-actions[_ngcontent-%COMP%]   .btn-add-manual[_ngcontent-%COMP%]{background:#10b981;color:#fff}.repuestos-actions[_ngcontent-%COMP%]   .btn-add-manual[_ngcontent-%COMP%]:hover{background:#059669}.repuestos-empty[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#9ca3af}.repuestos-empty[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:16px;opacity:.5}.repuestos-empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;font-weight:500;color:#6b7280}.repuestos-empty[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:13px;color:#9ca3af;line-height:1.4}.inventory-selector[_ngcontent-%COMP%]{background:#fff;border:1px solid #E2E8F0;border-radius:8px;padding:20px;margin-bottom:20px;box-shadow:0 1px 3px #0000001a;max-height:400px;overflow:hidden;display:flex;flex-direction:column}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#1f2937;font-size:16px;font-weight:600}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;font-size:20px;cursor:pointer;padding:4px;border-radius:4px;transition:all .2s}.inventory-selector[_ngcontent-%COMP%]   .selector-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{position:relative;margin-bottom:16px}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{--background: #FAFAFB;--border-radius: 6px;--border-width: 1px;--border-color: transparent;--padding-start: 40px 12px 12px;--padding-end: 12px;--padding-top: 10px;--padding-bottom: 10px;--color: #111827;--placeholder-color: #9CA3AF;font-size:14px;transition:border-color .2s}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus-within{--border-color: #2563eb;--background: #fff;box-shadow:0 0 0 2px #2563eb1a}.inventory-selector[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#9ca3af;font-size:18px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]{flex:1;max-height:250px;overflow-y:auto;border:1px solid #E5E7EB;border-radius:6px;background:#f9fafb}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid #E5E7EB;cursor:pointer;transition:all .2s}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]{flex:1}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]   .product-code[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;background:#e5e7eb;padding:2px 6px;border-radius:4px;font-weight:500}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]   .product-price[_ngcontent-%COMP%]{font-weight:600;color:#059669;font-size:13px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;font-size:13px;margin-bottom:4px;display:block}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-stock[_ngcontent-%COMP%]{font-size:11px;color:#6b7280}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-description[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.inventory-selector[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .product-item[_ngcontent-%COMP%]   .add-icon[_ngcontent-%COMP%]{color:#3b82f6;font-size:18px;margin-left:8px}.repuestos-list[_ngcontent-%COMP%]{margin-top:20px}.repuestos-list[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:#1f2937;font-size:16px;font-weight:600}.repuestos-list[_ngcontent-%COMP%]   .precio-total[_ngcontent-%COMP%]{background:#f0fdf4;border:1px solid #BBF7D0;border-radius:6px;padding:12px 16px;margin-bottom:16px;text-align:center}.repuestos-list[_ngcontent-%COMP%]   .precio-total[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#059669;font-size:16px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:#f0f9ff;border:1px solid #BAE6FD;border-radius:6px;margin-bottom:8px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:16px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-nombre[_ngcontent-%COMP%]{font-weight:500;color:#0369a1;font-size:14px;min-width:120px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   .cantidad-input[_ngcontent-%COMP%]{width:60px;padding:4px 8px;border:1px solid #D1D5DB;border-radius:4px;font-size:12px;text-align:center;background-color:#fafafb;color:#111827}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-cantidad[_ngcontent-%COMP%]   .unidad[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;font-weight:500}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-precio-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:4px;min-width:100px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-precio-info[_ngcontent-%COMP%]   .precio-unitario[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;font-weight:500}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .repuesto-info[_ngcontent-%COMP%]   .repuesto-precio-info[_ngcontent-%COMP%]   .precio-total-item[_ngcontent-%COMP%]{font-weight:600;color:#059669;font-size:13px}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626;border:none;padding:6px;border-radius:6px;cursor:pointer;transition:all .2s}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]:hover{background:#fecaca}.repuestos-list[_ngcontent-%COMP%]   .repuesto-item[_ngcontent-%COMP%]   .btn-remove[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}ion-button[type=submit][disabled][_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}ion-button[type=submit][_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{margin-right:8px}.mobile-only[_ngcontent-%COMP%]{display:block}.desktop-only[_ngcontent-%COMP%]{display:none}@media (min-width: 1200px){.mobile-only[_ngcontent-%COMP%]{display:none}.desktop-only[_ngcontent-%COMP%]{display:block}}@media (max-width: 768px){.albaran-container[_ngcontent-%COMP%]{padding:16px}.form-main[_ngcontent-%COMP%]{order:1}.form-sidebar[_ngcontent-%COMP%]{order:2}.form-section[_ngcontent-%COMP%]{padding:20px;margin-bottom:20px}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;margin-bottom:16px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.estados-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.estado-option[_ngcontent-%COMP%]{padding:16px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:15px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}.estado-option[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;top:12px;right:12px}.repuestos-actions[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.form-actions[_ngcontent-%COMP%]{gap:12px;padding:16px 20px}.form-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%;justify-content:center}.signature-area[_ngcontent-%COMP%]{padding:30px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:11px}}@media (min-width: 769px) and (max-width: 1199px){.albaran-container[_ngcontent-%COMP%]{padding:24px}.form-main[_ngcontent-%COMP%]{order:1}.form-sidebar[_ngcontent-%COMP%]{order:2}.form-row[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:20px}.estados-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:16px}.repuestos-actions[_ngcontent-%COMP%]{flex-direction:row;gap:12px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;min-width:0}}@media (min-width: 1200px){.albaran-container[_ngcontent-%COMP%]{padding:32px}.form-main[_ngcontent-%COMP%]{order:1}.form-sidebar[_ngcontent-%COMP%]{order:2}.form-section[_ngcontent-%COMP%]{padding:28px}.form-row[_ngcontent-%COMP%]{gap:28px}.estados-grid[_ngcontent-%COMP%]{gap:24px}.repuestos-actions[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.repuestos-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:14px 20px;font-size:15px}.form-actions[_ngcontent-%COMP%]{gap:20px;padding:20px 32px}.form-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{min-width:160px;--padding-start: 28px;--padding-end: 28px;--padding-top: 14px;--padding-bottom: 14px;font-size:15px}}@media (max-width: 480px){.albaran-container[_ngcontent-%COMP%]{padding:12px}.form-main[_ngcontent-%COMP%]{order:1}.form-sidebar[_ngcontent-%COMP%]{order:2}.form-section[_ngcontent-%COMP%]{padding:16px;margin-bottom:16px}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px;margin-bottom:12px}.form-group[_ngcontent-%COMP%]{margin-bottom:16px}.form-group[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:13px;margin-bottom:6px}.estado-option[_ngcontent-%COMP%]{padding:12px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:14px}.estado-option[_ngcontent-%COMP%]   .estado-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px}.estado-option[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;top:8px;right:8px}.signature-area[_ngcontent-%COMP%]{padding:15px 0;border-color:#2563eb;background:#eff6ff;display:flex;flex-direction:column}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px}.signature-area[_ngcontent-%COMP%]   .signature-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .help-text[_ngcontent-%COMP%]{font-size:10px}.btn-now[_ngcontent-%COMP%]{padding:4px 8px;font-size:11px}.btn-now[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.form-actions[_ngcontent-%COMP%]{padding:12px 16px}}"]});let c=l;return c})();function Hn(c,l){c&1&&(e(0,"div",4),m(1,"ion-icon",5),e(2,"span",6),r(3,"Cargando estado del flujo..."),n(),e(4,"span",7),r(5,"Cargando..."),n()())}function qn(c,l){if(c&1){let a=O();e(0,"div",8),m(1,"ion-icon",9),e(2,"span",10),r(3),n(),e(4,"button",11),u("click",function(){C(a);let i=g();return b(i.recargar())}),m(5,"ion-icon",12),e(6,"span",6),r(7,"Reintentar"),n(),e(8,"span",7),r(9,"Reintentar"),n()()()}if(c&2){let a=g();s(3),_(a.error)}}function Un(c,l){if(c&1){let a=O();e(0,"button",26),u("click",function(){let i=C(a).$implicit,t=g(3);return b(t.ejecutarAccion(i))}),m(1,"ion-icon",17),e(2,"span",27),r(3),n()()}if(c&2){let a=l.$implicit,o=g(3);d("disabled",o.loading)("title",o.getAccionTexto(a)),s(),d("name",o.getAccionIcon(a)),s(2),_(o.getAccionTexto(a))}}function Ln(c,l){if(c&1&&(e(0,"div",22)(1,"h4",23),r(2,"Acciones disponibles:"),n(),e(3,"div",24),f(4,Un,4,4,"button",25),n()()),c&2){let a=g(2);s(4),d("ngForOf",a.accionesDisponibles)}}function Gn(c,l){c&1&&(e(0,"div",30),m(1,"ion-icon",31),e(2,"span",32),r(3,"No hay acciones pendientes"),n()())}function Wn(c,l){if(c&1&&(e(0,"div",28),f(1,Gn,4,0,"div",29),n()),c&2){let a=g(2);s(),d("ngIf",a.accionesDisponibles.length===0&&!a.estadoFlujo.puedeCrearPresupuesto)}}function Qn(c,l){if(c&1){let a=O();e(0,"div",13)(1,"div",14)(2,"div",15)(3,"div",16),m(4,"ion-icon",17),e(5,"span",18),r(6),n()(),e(7,"button",19),u("click",function(){C(a);let i=g();return b(i.recargar())}),m(8,"ion-icon",12),n()()(),f(9,Ln,5,1,"div",20)(10,Wn,2,1,"div",21),n()}if(c&2){let a=g();s(3),d("ngClass",a.getEstadoClass()),s(),d("name",a.getEstadoIcon()),s(2),_(a.estadoFlujo.estadoActual),s(3),d("ngIf",a.accionesDisponibles.length>0),s(),d("ngIf",a.estadoFlujo.estadoActual==="No visitado"||a.estadoFlujo.estadoActual==="Visitado pendiente")}}var en=(()=>{let l=class l{constructor(o){this.flujoService=o,this.accionEjecutada=new Ge,this.estadoFlujo=null,this.accionesDisponibles=[],this.loading=!1,this.error=null,this.destroy$=new X,z({documentTextOutline:V,checkmarkCircleOutline:G,timeOutline:Y,receiptOutline:Ut,createOutline:we,eyeOutline:Se,arrowForwardOutline:kt,warningOutline:oe,refreshOutline:Q})}ngOnInit(){this.avisoId&&this.cargarEstadoFlujo()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarEstadoFlujo(){this.loading=!0,this.error=null,this.flujoService.obtenerEstadoFlujo(this.avisoId).pipe(w(this.destroy$)).subscribe({next:o=>{this.estadoFlujo=o,this.cargarAccionesDisponibles(),this.loading=!1},error:o=>{console.error("Error al cargar estado del flujo:",o),this.error="Error al cargar el estado del flujo",this.loading=!1}})}cargarAccionesDisponibles(){this.flujoService.obtenerAccionesDisponibles(this.avisoId).pipe(w(this.destroy$)).subscribe({next:o=>{this.accionesDisponibles=o},error:o=>{console.error("Error al cargar acciones:",o)}})}ejecutarAccion(o){var t,p,x,M,S,R;this.loading=!0,this.error=null;let i;switch(o){case"crear_presupuesto":i=this.flujoService.ejecutarFlujoCompleto(this.avisoId,!0);break;case"aprobar_presupuesto":let $=(x=(p=(t=this.estadoFlujo)==null?void 0:t.resumen)==null?void 0:p.presupuesto)==null?void 0:x.id;$&&(i=this.flujoService.aprobarPresupuesto($));break;case"facturar_presupuesto":let qe=(R=(S=(M=this.estadoFlujo)==null?void 0:M.resumen)==null?void 0:S.presupuesto)==null?void 0:R.id;qe&&(i=this.flujoService.facturarPresupuesto(qe));break;case"facturar_trabajos":i=this.flujoService.facturarTrabajos(this.avisoId);break;case"completar_aviso":this.completarAviso();break;default:this.loading=!1;return}i&&i.pipe(w(this.destroy$)).subscribe({next:$=>{console.log("Acci\xF3n ejecutada:",$),this.accionEjecutada.emit($),this.cargarEstadoFlujo(),this.loading=!1},error:$=>{console.error("Error al ejecutar acci\xF3n:",$),this.error=`Error al ejecutar ${o}: ${$.message}`,this.loading=!1}})}iniciarFlujoDirecto(){this.loading=!0,this.flujoService.ejecutarFlujoCompleto(this.avisoId,!1).pipe(w(this.destroy$)).subscribe({next:o=>{console.log("Flujo directo iniciado:",o),this.accionEjecutada.emit(o),this.cargarEstadoFlujo(),this.loading=!1},error:o=>{console.error("Error al iniciar flujo directo:",o),this.error=`Error al iniciar flujo directo: ${o.message}`,this.loading=!1}})}completarAviso(){if(!this.avisoId){console.error("No hay aviso seleccionado para completar");return}console.log("\u{1F504} Completando aviso:",this.avisoId),this.loading=!0,this.flujoService.completarAviso(this.avisoId).subscribe({next:o=>{console.log("\u2705 Aviso completado exitosamente:",o),this.loading=!1,this.mostrarMensaje("Aviso completado exitosamente","success"),this.cargarEstadoFlujo()},error:o=>{console.error("\u274C Error al completar aviso:",o),this.loading=!1,this.mostrarMensaje(o.message||"Error al completar el aviso. Verifica que haya trabajos realizados y facturas generadas.","error")}})}mostrarMensaje(o,i="info"){console.log(`[${i.toUpperCase()}] ${o}`)}getEstadoIcon(){if(!this.estadoFlujo)return"time-outline";switch(this.estadoFlujo.estadoActual){case"No visitado":return"time-outline";case"Visitado pendiente":return"eye-outline";case"Pendiente de presupuesto":return"document-text-outline";case"En curso":return"create-outline";case"Completado":return"checkmark-circle-outline";default:return"time-outline"}}getEstadoClass(){if(!this.estadoFlujo)return"pendiente";switch(this.estadoFlujo.estadoActual){case"No visitado":case"Visitado pendiente":return"pendiente";case"Pendiente de presupuesto":return"presupuesto";case"En curso":return"en-curso";case"Completado":return"completado";default:return"pendiente"}}getAccionTexto(o){switch(o){case"crear_presupuesto":return"Crear Presupuesto";case"aprobar_presupuesto":return"Aprobar Presupuesto";case"facturar_presupuesto":return"Generar Factura desde Presupuesto";case"facturar_trabajos":return"Facturar Trabajos Realizados";case"completar_aviso":return"Completar Aviso";default:return o}}getAccionIcon(o){switch(o){case"crear_presupuesto":return"document-text-outline";case"aprobar_presupuesto":return"checkmark-circle-outline";case"facturar_presupuesto":case"facturar_trabajos":return"receipt-outline";case"completar_aviso":return"checkmark-circle-outline";default:return"arrow-forward-outline"}}recargar(){this.cargarEstadoFlujo()}};l.\u0275fac=function(i){return new(i||l)(P(Fe))},l.\u0275cmp=j({type:l,selectors:[["app-flujo-estado"]],inputs:{avisoId:"avisoId"},outputs:{accionEjecutada:"accionEjecutada"},decls:4,vars:3,consts:[[1,"flujo-estado-container"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","flujo-content",4,"ngIf"],[1,"loading-state"],["name","refresh-outline",1,"spinning"],[1,"desktop-only"],[1,"mobile-only"],[1,"error-state"],["name","warning-outline"],[1,"error-text"],[1,"btn-retry",3,"click"],["name","refresh-outline"],[1,"flujo-content"],[1,"estado-actual"],[1,"estado-header"],[1,"estado-badge",3,"ngClass"],[3,"name"],[1,"estado-text"],["title","Actualizar estado",1,"btn-refresh",3,"click"],["class","acciones-disponibles",4,"ngIf"],["class","flujo-inicial",4,"ngIf"],[1,"acciones-disponibles"],[1,"section-title"],[1,"acciones-grid"],["class","btn-accion",3,"disabled","title","click",4,"ngFor","ngForOf"],[1,"btn-accion",3,"click","disabled","title"],[1,"accion-text"],[1,"flujo-inicial"],["class","sin-acciones",4,"ngIf"],[1,"sin-acciones"],["name","checkmark-circle-outline",1,"complete-icon"],[1,"complete-text"]],template:function(i,t){i&1&&(e(0,"div",0),f(1,Hn,6,0,"div",1)(2,qn,10,1,"div",2)(3,Qn,11,5,"div",3),n()),i&2&&(s(),d("ngIf",t.loading),s(),d("ngIf",t.error&&!t.loading),s(),d("ngIf",t.estadoFlujo&&!t.loading&&!t.error))},dependencies:[T,et,A,F,L],styles:[".flujo-estado-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;border:1px solid #E2E8F0;overflow:hidden;box-shadow:0 1px 3px #0000001a}.desktop-only[_ngcontent-%COMP%]{display:inline}.mobile-only[_ngcontent-%COMP%]{display:none}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;padding:24px;text-align:center;color:#64748b;font-size:14px}.loading-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#4f46e5}.loading-state.error-state[_ngcontent-%COMP%], .error-state.error-state[_ngcontent-%COMP%]{color:#dc2626}.loading-state.error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state.error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#dc2626}.error-text[_ngcontent-%COMP%]{word-break:break-word;line-height:1.4}.btn-retry[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:#f1f5f9;border:1px solid #CBD5E1;border-radius:8px;font-size:12px;color:#475569;cursor:pointer;transition:all .2s ease}.btn-retry[_ngcontent-%COMP%]:hover{background:#e2e8f0;border-color:#94a3b8}.btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.flujo-content[_ngcontent-%COMP%]{padding:20px}.estado-actual[_ngcontent-%COMP%]{margin-bottom:24px}.estado-actual[_ngcontent-%COMP%]   .estado-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;border-radius:20px;font-size:14px;font-weight:500}.estado-actual[_ngcontent-%COMP%]   .estado-badge.pendiente[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.estado-actual[_ngcontent-%COMP%]   .estado-badge.pendiente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#d97706}.estado-actual[_ngcontent-%COMP%]   .estado-badge.presupuesto[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.estado-actual[_ngcontent-%COMP%]   .estado-badge.presupuesto[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#3b82f6}.estado-actual[_ngcontent-%COMP%]   .estado-badge.en-curso[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.estado-actual[_ngcontent-%COMP%]   .estado-badge.en-curso[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#22c55e}.estado-actual[_ngcontent-%COMP%]   .estado-badge.completado[_ngcontent-%COMP%]{background:#ecfdf5;color:#14532d}.estado-actual[_ngcontent-%COMP%]   .estado-badge.completado[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#10b981}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.estado-actual[_ngcontent-%COMP%]   .estado-text[_ngcontent-%COMP%]{font-weight:500}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:#f8fafc;border:1px solid #E2E8F0;border-radius:8px;cursor:pointer;transition:all .2s ease}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;color:#64748b}.resumen-info[_ngcontent-%COMP%]{background:#f8fafc;border-radius:8px;padding:16px}.resumen-info[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:13px;color:#64748b;font-weight:500}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:13px;color:#1e293b;font-weight:600}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value.si[_ngcontent-%COMP%]{color:#059669}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value.no[_ngcontent-%COMP%]{color:#dc2626}.acciones-disponibles[_ngcontent-%COMP%]{margin-bottom:24px}.acciones-disponibles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0 0 12px;font-size:16px;color:#1e293b;font-weight:600}.acciones-disponibles[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:12px 16px;background:#4f46e5;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;text-align:left}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]:hover:not(:disabled){background:#4338ca;transform:translateY(-1px);box-shadow:0 4px 8px #4f46e54d}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;flex-shrink:0}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   .accion-text[_ngcontent-%COMP%]{flex:1}.flujo-inicial[_ngcontent-%COMP%]{margin-bottom:24px}.flujo-inicial[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;color:#1e293b;font-weight:600}.flujo-inicial[_ngcontent-%COMP%]   .flujo-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:20px;background:#f8fafc;border:1px solid #E2E8F0;border-radius:12px;transition:all .2s ease}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]:hover{background:#f0f9ff;border-color:#4f46e5;transform:translateY(-1px);box-shadow:0 4px 12px #0000001a}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:28px;color:#4f46e5;flex-shrink:0;background:#eef2ff;padding:12px;border-radius:50%}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;flex:1}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1e293b}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-description[_ngcontent-%COMP%]{font-size:14px;color:#64748b;line-height:1.4}.sin-acciones[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;padding:20px;color:#64748b;font-size:14px;text-align:center}.sin-acciones[_ngcontent-%COMP%]   .complete-icon[_ngcontent-%COMP%]{font-size:20px;color:#10b981}.sin-acciones[_ngcontent-%COMP%]   .complete-text[_ngcontent-%COMP%]{font-weight:500}@media (max-width: 768px){.desktop-only[_ngcontent-%COMP%]{display:none}.mobile-only[_ngcontent-%COMP%]{display:inline}.flujo-content[_ngcontent-%COMP%]{padding:16px}.estado-actual[_ngcontent-%COMP%]{margin-bottom:20px}.estado-actual[_ngcontent-%COMP%]   .estado-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;margin-bottom:12px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{width:28px;height:28px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.resumen-info[_ngcontent-%COMP%]{padding:12px}.resumen-info[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:12px}.acciones-disponibles[_ngcontent-%COMP%]{margin-bottom:20px}.acciones-disponibles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:15px;margin-bottom:10px}.acciones-disponibles[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{padding:10px 12px;font-size:13px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.flujo-inicial[_ngcontent-%COMP%]{margin-bottom:20px}.flujo-inicial[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:15px;margin-bottom:10px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-info[_ngcontent-%COMP%]{gap:12px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]{padding:16px;gap:12px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;padding:10px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:14px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-description[_ngcontent-%COMP%]{font-size:12px}.sin-acciones[_ngcontent-%COMP%]{padding:16px}.sin-acciones[_ngcontent-%COMP%]   .complete-icon[_ngcontent-%COMP%]{font-size:18px}.sin-acciones[_ngcontent-%COMP%]   .complete-text[_ngcontent-%COMP%]{font-size:13px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{padding:20px;font-size:13px}.loading-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.btn-retry[_ngcontent-%COMP%]{padding:6px 12px;font-size:11px}.btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}}@media (max-width: 480px){.flujo-content[_ngcontent-%COMP%]{padding:12px}.estado-actual[_ngcontent-%COMP%]{margin-bottom:16px}.estado-actual[_ngcontent-%COMP%]   .estado-header[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between;gap:8px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{justify-content:center;padding:4px 10px;font-size:12px}.estado-actual[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{align-self:center;width:24px;height:24px}.estado-actual[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.resumen-info[_ngcontent-%COMP%]{padding:10px}.resumen-info[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{gap:6px}.resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .resumen-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:11px}.acciones-disponibles[_ngcontent-%COMP%]{margin-bottom:16px}.acciones-disponibles[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:14px;margin-bottom:8px}.acciones-disponibles[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{gap:6px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]{padding:8px 10px;font-size:12px}.acciones-disponibles[_ngcontent-%COMP%]   .btn-accion[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.flujo-inicial[_ngcontent-%COMP%]{margin-bottom:16px}.flujo-inicial[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:14px;margin-bottom:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-info[_ngcontent-%COMP%]{gap:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]{padding:12px;gap:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;padding:8px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:13px}.flujo-inicial[_ngcontent-%COMP%]   .flujo-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-description[_ngcontent-%COMP%]{font-size:11px}.sin-acciones[_ngcontent-%COMP%]{padding:12px;gap:8px}.sin-acciones[_ngcontent-%COMP%]   .complete-icon[_ngcontent-%COMP%]{font-size:16px}.sin-acciones[_ngcontent-%COMP%]   .complete-text[_ngcontent-%COMP%]{font-size:12px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{padding:16px;font-size:12px;gap:8px}.loading-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.btn-retry[_ngcontent-%COMP%]{padding:4px 8px;font-size:10px}.btn-retry[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:10px}}"]});let c=l;return c})();function Yn(c,l){if(c&1&&(e(0,"tr")(1,"td"),r(2),n(),e(3,"td"),r(4),n(),e(5,"td"),r(6),n(),e(7,"td"),r(8),n(),e(9,"td"),r(10),v(11,"currency"),n(),e(12,"td"),r(13),v(14,"currency"),n()()),c&2){let a=l.$implicit,o=g(2);s(2),_(o.getMaterialAsRepuesto(a).codigo),s(2),_(o.getMaterialAsRepuesto(a).nombre),s(2),_(o.getMaterialAsRepuesto(a).cantidad),s(2),_(o.getMaterialAsRepuesto(a).unidad),s(2),_(y(11,6,o.getMaterialAsRepuesto(a).precio_pvp,"EUR","symbol","1.2-2")),s(3),_(y(14,11,o.getMaterialAsRepuesto(a).precio_pvp*o.getMaterialAsRepuesto(a).cantidad,"EUR","symbol","1.2-2"))}}function Jn(c,l){if(c&1&&(e(0,"div",28)(1,"table",29)(2,"thead")(3,"tr")(4,"th"),r(5,"C\xF3digo"),n(),e(6,"th"),r(7,"Material"),n(),e(8,"th"),r(9,"Cantidad"),n(),e(10,"th"),r(11,"Unidad"),n(),e(12,"th"),r(13,"Precio Unit."),n(),e(14,"th"),r(15,"Total"),n()()(),e(16,"tbody"),f(17,Yn,15,16,"tr",30),n(),e(18,"tfoot")(19,"tr",31)(20,"td",32)(21,"strong"),r(22,"Total Materiales:"),n()(),e(23,"td")(24,"strong"),r(25),v(26,"currency"),n()()()()()()),c&2){let a=g();s(17),d("ngForOf",a.albaran.repuestos_utilizados),s(8),_(y(26,2,a.calcularTotalMateriales(),"EUR","symbol","1.2-2"))}}function Kn(c,l){if(c&1&&(e(0,"li"),r(1),n()),c&2){let a=l.$implicit;s(),_(a)}}function Xn(c,l){if(c&1&&(e(0,"div",33)(1,"ul",34),f(2,Kn,2,1,"li",30),n()()),c&2){let a=g();s(2),d("ngForOf",a.albaran.repuestos_utilizados)}}function Zn(c,l){c&1&&(e(0,"div",35)(1,"p"),r(2,"No se utilizaron materiales en este trabajo"),n()())}function eo(c,l){if(c&1&&(e(0,"div",15)(1,"h3"),r(2,"Presupuesto Adicional"),n(),e(3,"div",36)(4,"div",37)(5,"span",38),r(6,"Monto:"),n(),e(7,"span",39),r(8),v(9,"currency"),n()()()()),c&2){let a=g();s(8),_(y(9,1,a.albaran.presupuesto_necesario,"EUR","symbol","1.2-2"))}}function to(c,l){if(c&1&&(e(0,"div",17)(1,"label"),r(2,"DNI:"),n(),e(3,"span"),r(4),n()()),c&2){let a=g(2);s(4),_(a.albaran.dni_cliente)}}function no(c,l){if(c&1&&(e(0,"div",17)(1,"label"),r(2,"Firmado por:"),n(),e(3,"span"),r(4),n()()),c&2){let a=g(2);s(4),_(a.albaran.nombre_firma)}}function oo(c,l){if(c&1&&(e(0,"div",15)(1,"h3"),r(2,"Informaci\xF3n del Cliente"),n(),e(3,"div",16),f(4,to,5,1,"div",24)(5,no,5,1,"div",24),n()()),c&2){let a=g();s(4),d("ngIf",a.albaran.dni_cliente),s(),d("ngIf",a.albaran.nombre_firma)}}function io(c,l){if(c&1&&(e(0,"div",43),m(1,"img",44),e(2,"p",45),r(3,"Firma digital del cliente"),n()()),c&2){let a=g(2);s(),d("src",a.albaran.firma_url,Z)}}function ao(c,l){if(c&1&&(e(0,"div",46)(1,"p"),r(2,"El cliente ha firmado este albar\xE1n"),n(),e(3,"div",47),m(4,"ion-icon",48),e(5,"span"),r(6),n()()()),c&2){let a=g(2);s(6),_(a.albaran.nombre_firma)}}function ro(c,l){if(c&1&&(e(0,"div",15)(1,"h3"),r(2,"Firma del Cliente"),n(),e(3,"div",40),f(4,io,4,1,"div",41)(5,ao,7,1,"div",42),n()()),c&2){let a=g();s(4),d("ngIf",a.albaran.firma_url),s(),d("ngIf",!a.albaran.firma_url&&a.albaran.nombre_firma)}}function co(c,l){if(c&1&&(e(0,"div",15)(1,"h3"),r(2,"Observaciones"),n(),e(3,"div",49)(4,"p"),r(5),n()()()),c&2){let a=g();s(5),_(a.albaran.observaciones)}}function so(c,l){if(c&1&&(e(0,"div",17)(1,"label"),r(2,"Fecha de creaci\xF3n:"),n(),e(3,"span"),r(4),n()()),c&2){let a=g();s(4),_(a.formatearFecha(a.albaran.fecha_creacion))}}var tn=(()=>{let l=class l{constructor(o){this.modalController=o,z({close:K,documentTextOutline:V,personOutline:W,timeOutline:Y,calendarOutline:te,cubeOutline:ke,checkmarkCircleOutline:G,warningOutline:oe,refreshOutline:Q,downloadOutline:Tt,printOutline:qt})}ngOnInit(){console.log("Modal de albar\xE1n cargado:",this.albaran)}cerrarModal(){this.modalController.dismiss()}descargarPDF(){console.log("Descargando albar\xE1n como PDF..."),alert("Funcionalidad de descarga de PDF en desarrollo")}imprimirAlbaran(){console.log("Imprimiendo albar\xE1n..."),window.print()}tieneFirma(){return!!(this.albaran.firma_url||this.albaran.nombre_firma)}getEstadoClass(o){return"badge-"+o.toLowerCase().replace(/ /g,"-")}repuestosCompletos(){return this.albaran.repuestos_utilizados.length>0&&typeof this.albaran.repuestos_utilizados[0]=="object"}calcularTotalMateriales(){return this.repuestosCompletos()?this.albaran.repuestos_utilizados.reduce((o,i)=>o+i.precio_pvp*i.cantidad,0):0}formatearFecha(o){return o?new Date(o).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"No especificada"}formatearHora(o){return o||"No especificada"}getEstadoColor(o){switch(o){case"Finalizado":return"#10B981";case"Presupuesto pendiente":return"#F59E0B";case"Otra visita":return"#EF4444";default:return"#6B7280"}}getMaterialAsRepuesto(o){return o}};l.\u0275fac=function(i){return new(i||l)(P(ee))},l.\u0275cmp=j({type:l,selectors:[["app-ver-albaran-modal"]],inputs:{albaran:"albaran",aviso:"aviso"},decls:97,vars:21,consts:[[1,"modal-header"],[1,"header-content"],["name","document-text-outline"],[1,"header-actions"],["title","Descargar PDF",1,"btn-secondary",3,"click"],["name","download-outline"],[1,"desktop-only"],["title","Imprimir",1,"btn-secondary",3,"click"],["name","print-outline"],["title","Cerrar",1,"btn-close",3,"click"],["name","close"],[1,"modal-content"],[1,"estado-section"],[1,"estado-badge"],["name","checkmark-circle-outline"],[1,"info-section"],[1,"info-grid"],[1,"info-item"],[1,"descripcion-content"],[1,"materiales-content"],["class","materiales-tabla",4,"ngIf"],["class","materiales-lista",4,"ngIf"],["class","no-materiales",4,"ngIf"],["class","info-section",4,"ngIf"],["class","info-item",4,"ngIf"],[1,"modal-footer"],[1,"btn-primary",3,"click"],[1,"btn-secondary",3,"click"],[1,"materiales-tabla"],[1,"materiales-table"],[4,"ngFor","ngForOf"],[1,"total-row"],["colspan","5"],[1,"materiales-lista"],[1,"repuestos-list"],[1,"no-materiales"],[1,"presupuesto-content"],[1,"presupuesto-amount"],[1,"amount-label"],[1,"amount-value"],[1,"firma-content"],["class","firma-imagen",4,"ngIf"],["class","firma-texto",4,"ngIf"],[1,"firma-imagen"],["alt","Firma del cliente",1,"firma-img",3,"src"],[1,"firma-caption"],[1,"firma-texto"],[1,"firma-nombre"],["name","person-outline"],[1,"observaciones-content"]],template:function(i,t){i&1&&(e(0,"div",0)(1,"div",1)(2,"h2"),m(3,"ion-icon",2),r(4),n(),e(5,"div",3)(6,"button",4),u("click",function(){return t.descargarPDF()}),m(7,"ion-icon",5),e(8,"span",6),r(9,"PDF"),n()(),e(10,"button",7),u("click",function(){return t.imprimirAlbaran()}),m(11,"ion-icon",8),e(12,"span",6),r(13,"Imprimir"),n()(),e(14,"button",9),u("click",function(){return t.cerrarModal()}),m(15,"ion-icon",10),n()()()(),e(16,"div",11)(17,"div",12)(18,"div",13),m(19,"ion-icon",14),r(20),n()(),e(21,"div",15)(22,"h3"),r(23,"Informaci\xF3n del Aviso"),n(),e(24,"div",16)(25,"div",17)(26,"label"),r(27,"Cliente:"),n(),e(28,"span"),r(29),n()(),e(30,"div",17)(31,"label"),r(32,"Direcci\xF3n:"),n(),e(33,"span"),r(34),n()(),e(35,"div",17)(36,"label"),r(37,"Fecha de creaci\xF3n:"),n(),e(38,"span"),r(39),n()()()(),e(40,"div",15)(41,"h3"),r(42,"Fechas y Horarios"),n(),e(43,"div",16)(44,"div",17)(45,"label"),r(46,"Fecha de cierre:"),n(),e(47,"span"),r(48),n()(),e(49,"div",17)(50,"label"),r(51,"Hora de entrada:"),n(),e(52,"span"),r(53),n()(),e(54,"div",17)(55,"label"),r(56,"Hora de salida:"),n(),e(57,"span"),r(58),n()()()(),e(59,"div",15)(60,"h3"),r(61,"Descripci\xF3n del Trabajo Realizado"),n(),e(62,"div",18)(63,"p"),r(64),n()()(),e(65,"div",15)(66,"h3"),r(67,"Materiales Utilizados"),n(),e(68,"div",19),f(69,Jn,27,7,"div",20)(70,Xn,3,1,"div",21)(71,Zn,3,0,"div",22),n()(),f(72,eo,10,6,"div",23)(73,oo,6,2,"div",23)(74,ro,6,2,"div",23)(75,co,6,1,"div",23),e(76,"div",15)(77,"h3"),r(78,"Informaci\xF3n Adicional"),n(),e(79,"div",16)(80,"div",17)(81,"label"),r(82,"ID del trabajo:"),n(),e(83,"span"),r(84),n()(),e(85,"div",17)(86,"label"),r(87,"ID del aviso:"),n(),e(88,"span"),r(89),n()(),f(90,so,5,1,"div",24),n()()(),e(91,"div",25)(92,"button",26),u("click",function(){return t.imprimirAlbaran()}),m(93,"ion-icon",8),r(94," Imprimir Albar\xE1n "),n(),e(95,"button",27),u("click",function(){return t.cerrarModal()}),r(96," Cerrar "),n()()),i&2&&(s(4),h(" Albar\xE1n #",t.albaran.id==null?null:t.albaran.id.substring(0,8)," "),s(14),Qe("background-color",t.getEstadoColor(t.albaran.estado_cierre)),s(2),h(" ",t.albaran.estado_cierre," "),s(9),_((t.aviso==null?null:t.aviso.nombre_cliente_aviso)||"No especificado"),s(5),_((t.aviso==null?null:t.aviso.direccion_cliente_aviso)||"No especificada"),s(5),_(t.formatearFecha(t.aviso==null?null:t.aviso.fecha_creacion)),s(9),_(t.formatearFecha(t.albaran.fecha_cierre)),s(5),_(t.formatearHora(t.albaran.hora_entrada)),s(5),_(t.formatearHora(t.albaran.hora_salida)),s(6),_(t.albaran.descripcion_trabajo_realizado),s(5),d("ngIf",t.repuestosCompletos()&&t.albaran.repuestos_utilizados.length>0),s(),d("ngIf",!t.repuestosCompletos()&&t.albaran.repuestos_utilizados.length>0),s(),d("ngIf",t.albaran.repuestos_utilizados.length===0),s(),d("ngIf",t.albaran.presupuesto_necesario>0),s(),d("ngIf",t.albaran.dni_cliente||t.albaran.nombre_firma),s(),d("ngIf",t.tieneFirma()),s(),d("ngIf",t.albaran.observaciones),s(9),_(t.albaran.trabajo_id==null?null:t.albaran.trabajo_id.substring(0,8)),s(5),_(t.albaran.aviso_id==null?null:t.albaran.aviso_id.substring(0,8)),s(),d("ngIf",t.albaran.fecha_creacion))},dependencies:[T,A,F,U,L],styles:["[_nghost-%COMP%]{display:block;max-width:800px;margin:0 auto;background:#fff;border-radius:12px;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a}.modal-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4f46e5,#7c3aed);color:#fff;padding:24px;border-radius:12px 12px 0 0;position:relative}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:20px}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:600;display:flex;align-items:center;gap:12px}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:28px}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3);padding:8px 16px;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s ease;display:flex;align-items:center;gap:8px}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{background:#ffffff4d;border-color:#ffffff80}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{background:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3);padding:8px;border-radius:50%;cursor:pointer;transition:all .2s ease;width:40px;height:40px;display:flex;align-items:center;justify-content:center}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#ffffff4d;border-color:#ffffff80}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.modal-content[_ngcontent-%COMP%]{padding:32px 24px;max-height:70vh;overflow-y:auto}.modal-content[_ngcontent-%COMP%]   .estado-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px}.modal-content[_ngcontent-%COMP%]   .estado-section[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border-radius:50px;color:#fff;font-size:16px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;box-shadow:0 4px 12px #00000026}.modal-content[_ngcontent-%COMP%]   .estado-section[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]{margin-bottom:32px;padding:24px;background:#f9fafb;border-radius:12px;border:1px solid #E5E7EB}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;font-size:18px;font-weight:600;color:#1f2937;display:flex;align-items:center;gap:8px;padding-bottom:12px;border-bottom:2px solid #E5E7EB}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.5px}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;color:#1f2937;font-weight:500}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px;line-height:1.6;color:#374151;background:#fff;padding:16px;border-radius:8px;border:1px solid #E5E7EB}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]{overflow-x:auto}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 1px 3px #0000001a}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;text-align:left;border-bottom:1px solid #E5E7EB}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f3f4f6;font-weight:600;color:#374151;font-size:14px;text-transform:uppercase;letter-spacing:.5px}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:14px;color:#1f2937}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{background:#f0f9ff;font-weight:600}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#1e40af}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-lista[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;display:flex;flex-wrap:wrap;gap:8px}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-lista[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background:#e0f2fe;color:#0c4a6e;padding:8px 16px;border-radius:20px;font-size:14px;font-weight:500;border:1px solid #BAE6FD}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .no-materiales[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#6b7280;font-style:italic}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-amount[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;background:#fff;padding:16px;border-radius:8px;border:1px solid #E5E7EB}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-amount[_ngcontent-%COMP%]   .amount-label[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#374151}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .presupuesto-content[_ngcontent-%COMP%]   .presupuesto-amount[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#059669}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-imagen[_ngcontent-%COMP%]{text-align:center}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-imagen[_ngcontent-%COMP%]   .firma-img[_ngcontent-%COMP%]{max-width:100%;max-height:200px;border:2px solid #E5E7EB;border-radius:8px;box-shadow:0 4px 12px #0000001a}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-imagen[_ngcontent-%COMP%]   .firma-caption[_ngcontent-%COMP%]{margin-top:12px;font-size:14px;color:#6b7280;font-style:italic}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-texto[_ngcontent-%COMP%]{text-align:center;padding:20px;background:#fff;border-radius:8px;border:1px solid #E5E7EB}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-texto[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;color:#374151}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-texto[_ngcontent-%COMP%]   .firma-nombre[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;font-size:18px;font-weight:600;color:#059669}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .firma-content[_ngcontent-%COMP%]   .firma-texto[_ngcontent-%COMP%]   .firma-nombre[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .observaciones-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px;line-height:1.6;color:#374151;background:#fff;padding:16px;border-radius:8px;border:1px solid #E5E7EB;font-style:italic}.modal-footer[_ngcontent-%COMP%]{padding:24px;background:#f9fafb;border-top:1px solid #E5E7EB;border-radius:0 0 12px 12px;display:flex;gap:16px;justify-content:flex-end}.modal-footer[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:#4f46e5;color:#fff;border:none;padding:12px 24px;border-radius:8px;cursor:pointer;font-size:16px;font-weight:600;transition:background-color .2s ease;display:flex;align-items:center;gap:8px}.modal-footer[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{background:#4338ca}.modal-footer[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.modal-footer[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#374151;border:1px solid #D1D5DB;padding:12px 24px;border-radius:8px;cursor:pointer;font-size:16px;font-weight:500;transition:all .2s ease}.modal-footer[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#9ca3af}@media (max-width: 768px){[_nghost-%COMP%]{margin:0;border-radius:0;max-height:100vh;overflow-y:auto}.modal-header[_ngcontent-%COMP%]{border-radius:0;padding:20px}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%;justify-content:center}.modal-content[_ngcontent-%COMP%]{padding:20px 16px}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]{padding:16px;margin-bottom:24px}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;margin-bottom:16px}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.modal-content[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]{font-size:12px}.modal-content[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .modal-content[_ngcontent-%COMP%]   .materiales-content[_ngcontent-%COMP%]   .materiales-tabla[_ngcontent-%COMP%]   .materiales-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 12px}.modal-footer[_ngcontent-%COMP%]{padding:20px 16px;flex-direction:column}.modal-footer[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%], .modal-footer[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{width:100%;justify-content:center}}@media (max-width: 480px){.modal-header[_ngcontent-%COMP%]{padding:16px}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px}.modal-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.modal-content[_ngcontent-%COMP%]{padding:16px 12px}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]{padding:12px;margin-bottom:20px}.modal-content[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px}.modal-footer[_ngcontent-%COMP%]{padding:16px 12px}}@media print{[_nghost-%COMP%]{box-shadow:none;border-radius:0}.modal-header[_ngcontent-%COMP%]{background:#fff!important;color:#000!important;border-bottom:2px solid black}.modal-footer[_ngcontent-%COMP%], .btn-close[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-primary[_ngcontent-%COMP%]{display:none}}"]});let c=l;return c})();var lo=["fileInput"];function po(c,l){c&1&&(e(0,"div",38)(1,"div",39),m(2,"ion-icon",40),e(3,"p"),r(4,"Cargando aviso..."),n()()())}function go(c,l){if(c&1){let a=O();e(0,"div",41)(1,"div",42),m(2,"ion-icon",43),e(3,"p"),r(4),n(),e(5,"button",44),u("click",function(){C(a);let i=g();return b(i.cargarAviso())}),m(6,"ion-icon",27),r(7," Reintentar "),n()()()}if(c&2){let a=g();s(4),_(a.error)}}function mo(c,l){if(c&1){let a=O();e(0,"button",72),u("click",function(){C(a);let i=g(2);return b(i.completarAviso())}),m(1,"ion-icon",73),e(2,"span",17),r(3,"Completar Aviso"),n(),e(4,"span",18),r(5,"Completar"),n()()}}function _o(c,l){if(c&1){let a=O();e(0,"button",15),u("click",function(){C(a);let i=g(2);return b(i.editarAviso())}),m(1,"ion-icon",74),e(2,"span",17),r(3,"Editar aviso"),n(),e(4,"span",18),r(5,"Editar"),n()()}}function uo(c,l){c&1&&(e(0,"div",75),m(1,"ion-icon",76),e(2,"span"),r(3,"Aviso completado"),n()())}function fo(c,l){if(c&1&&(e(0,"div",77),m(1,"ion-icon",78),e(2,"span"),r(3),n()()),c&2){let a=g(2);s(3),_(a.aviso.nombre_contacto)}}function Co(c,l){if(c&1&&(e(0,"div",79),m(1,"ion-icon",80),e(2,"span"),r(3),n()()),c&2){let a=g(2);s(3),_(a.aviso.telefono_cliente_aviso)}}function bo(c,l){if(c&1&&(e(0,"div",79),m(1,"ion-icon",81),e(2,"span"),r(3),n()()),c&2){let a=g(2);s(3),_(a.aviso.cliente==null?null:a.aviso.cliente.email)}}function xo(c,l){if(c&1){let a=O();e(0,"div",5)(1,"div",12)(2,"div",45)(3,"div",46)(4,"button",47),u("click",function(){C(a);let i=g();return b(i.volverALista())}),m(5,"ion-icon",48),e(6,"span",17),r(7,"Volver"),n(),e(8,"span",18),r(9,"Volver"),n()()()(),e(10,"div",24)(11,"button",49),u("click",function(){C(a);let i=g();return b(i.forzarRecargaDatos())}),m(12,"ion-icon",27),e(13,"span",17),r(14,"Recargar"),n(),e(15,"span",18),r(16,"Recargar"),n()(),f(17,mo,6,0,"button",50)(18,_o,6,0,"button",51)(19,uo,4,0,"div",52),n(),e(20,"span",53),r(21),n()(),e(22,"h2",54)(23,"span",17),r(24),n()(),e(25,"div",55)(26,"div",56)(27,"div",9)(28,"label"),r(29,"Estado"),n(),e(30,"span",57),r(31),n()(),e(32,"div",9)(33,"label"),r(34,"Urgente"),n(),e(35,"span",58),r(36),n()(),e(37,"div",9)(38,"label"),r(39,"Fecha de creaci\xF3n"),n(),e(40,"span"),r(41),v(42,"date"),n()()(),e(43,"div",59)(44,"label"),r(45,"Cliente"),n(),e(46,"div",60)(47,"span",61),r(48),n(),e(49,"a",62),u("click",function(){C(a);let i=g();return b(i.verCliente())}),e(50,"span",17),r(51,"Ver cliente"),n()()()(),e(52,"div",63)(53,"label"),r(54,"Direcci\xF3n"),n(),e(55,"div",64)(56,"span",65),r(57),n(),e(58,"button",66),u("click",function(){C(a);let i=g();return b(i.verMapa())}),m(59,"ion-icon",67),n()()(),e(60,"div",68)(61,"label"),r(62,"Contacto Cliente"),n(),e(63,"div",69),f(64,fo,4,1,"div",70)(65,Co,4,1,"div",71)(66,bo,4,1,"div",71),n()()()()}if(c&2){let a=g();s(17),d("ngIf",(a.aviso==null?null:a.aviso.estado)!=="Completado"),s(),d("ngIf",(a.aviso==null?null:a.aviso.estado)!=="Completado"),s(),d("ngIf",(a.aviso==null?null:a.aviso.estado)==="Completado"),s(2),h("Aviso #",a.aviso.id==null?null:a.aviso.id.substring(0,8),""),s(3),h("Informaci\xF3n general del Aviso - #",a.aviso.id==null?null:a.aviso.id.substring(0,8),""),s(7),_(a.aviso.estado),s(4),J("urgent",a.aviso.urgencia==="Alta"||a.aviso.es_urgente),s(),h(" ",a.aviso.urgencia==="Alta"||a.aviso.es_urgente?"S\xED":"No"," "),s(5),_(B(42,15,a.aviso.fecha_creacion,"dd/MM/yyyy")),s(7),_(a.aviso.nombre_cliente_aviso),s(9),_(a.aviso.direccion_cliente_aviso),s(7),d("ngIf",a.aviso.nombre_contacto),s(),d("ngIf",a.aviso.telefono_cliente_aviso),s(),d("ngIf",a.aviso.cliente==null?null:a.aviso.cliente.email)}}function Mo(c,l){if(c&1){let a=O();e(0,"div",82)(1,"div",83)(2,"app-flujo-estado",84),u("accionEjecutada",function(i){C(a);let t=g();return b(t.onAccionFlujoEjecutada(i))}),n()()()}if(c&2){let a=g();s(2),d("avisoId",(a.aviso==null?null:a.aviso.id)||"")}}function Oo(c,l){c&1&&(e(0,"div",38)(1,"div",39),m(2,"ion-icon",40),e(3,"p"),r(4,"Cargando trabajos..."),n()()())}function Po(c,l){c&1&&(e(0,"div",85)(1,"div",86),m(2,"ion-icon",87),e(3,"p"),r(4,"No hay trabajos realizados para este aviso"),n(),e(5,"small"),r(6,"Crea el primer parte de trabajo para comenzar"),n()()())}function vo(c,l){if(c&1&&(e(0,"li"),r(1),n()),c&2){let a=l.$implicit;s(),Ve(" ",(a.material==null?null:a.material.nombre)||"Material",": ",a.cantidad_utilizada," ",(a.material==null?null:a.material.unidad)||"unidad"," ")}}function ho(c,l){if(c&1&&(e(0,"ul",107),f(1,vo,2,3,"li",89),n()),c&2){let a=g().$implicit;s(),d("ngForOf",a.materiales)}}function yo(c,l){if(c&1&&(e(0,"li"),r(1),n()),c&2){let a=l.$implicit;s(),_(a)}}function Eo(c,l){if(c&1&&(e(0,"ul",107),f(1,yo,2,1,"li",89),n()),c&2){let a=g().$implicit;s(),d("ngForOf",a.repuestos)}}function wo(c,l){c&1&&(e(0,"span",108),r(1," Sin materiales "),n())}function ko(c,l){if(c&1){let a=O();e(0,"button",109),u("click",function(){C(a);let i=g().$implicit,t=g(2);return b(t.hacerAlbaran(i))}),m(1,"ion-icon",110),e(2,"span",17),r(3,"Crear Albar\xE1n"),n(),e(4,"span",18),r(5,"Albar\xE1n"),n()()}}function So(c,l){if(c&1&&(e(0,"div",111)(1,"span",112),m(2,"ion-icon",76),r(3," Albar\xE1n Cerrado "),n()()),c&2){let a=g().$implicit,o=g(2);s(),ae("badge-"+o.getAlbaranEstado(a))}}function zo(c,l){if(c&1){let a=O();e(0,"button",113),u("click",function(){C(a);let i=g().$implicit,t=g(2);return b(t.editarTrabajo(i))}),m(1,"ion-icon",74),e(2,"span",17),r(3,"Editar"),n(),e(4,"span",18),r(5,"Editar"),n()()}}function jo(c,l){if(c&1){let a=O();e(0,"button",114),u("click",function(){C(a);let i=g().$implicit,t=g(2);return b(t.eliminarTrabajo(i))}),m(1,"ion-icon",115),e(2,"span",17),r(3,"Eliminar"),n(),e(4,"span",18),r(5,"Eliminar"),n()()}}function Io(c,l){if(c&1&&(e(0,"tr")(1,"td",90),r(2),n(),e(3,"td",91),r(4),v(5,"date"),n(),e(6,"td",92),r(7),v(8,"number"),n(),e(9,"td",93)(10,"div",94)(11,"p"),r(12),n(),e(13,"small"),r(14),n()()(),e(15,"td",95)(16,"div",96),f(17,ho,2,1,"ul",97)(18,Eo,2,1,"ul",97)(19,wo,2,0,"span",98),n()(),e(20,"td",99)(21,"span",100),r(22),n()(),e(23,"td",101)(24,"div",102),f(25,ko,6,0,"button",103)(26,So,4,2,"div",104)(27,zo,6,0,"button",105)(28,jo,6,0,"button",106),n()()()),c&2){let a=l.$implicit,o=l.index,i=g(2);s(2),h("#",o+1,""),s(2),_(B(5,16,a.fecha_trabajo,"dd/MM/yyyy")),s(3),h("",B(8,19,i.calcularHorasTrabajo(a),"1.1-1"),"h"),s(5),_(a.descripcion),s(2),I("",a.hora_inicio," - ",a.hora_fin,""),s(3),d("ngIf",a.materiales&&a.materiales.length>0),s(),d("ngIf",(!a.materiales||a.materiales.length===0)&&a.repuestos&&a.repuestos.length>0),s(),d("ngIf",(!a.materiales||a.materiales.length===0)&&(!a.repuestos||a.repuestos.length===0)),s(2),ae("badge-"+a.estado.toLowerCase().replace(" ","-")),s(),h(" ",a.estado," "),s(3),d("ngIf",i.puedeCrearAlbaran(a)),s(),d("ngIf",a.albaran_id),s(),d("ngIf",a.estado!=="Cerrado"&&a.estado!=="Finalizado"),s(),d("ngIf",a.estado!=="Cerrado"&&a.estado!=="Finalizado")}}function Ao(c,l){if(c&1&&(e(0,"table",88)(1,"thead")(2,"tr")(3,"th"),r(4,"N\xFAmero"),n(),e(5,"th"),r(6,"Fecha trabajo"),n(),e(7,"th"),r(8,"Horas"),n(),e(9,"th"),r(10,"Descripci\xF3n"),n(),e(11,"th"),r(12,"Materiales"),n(),e(13,"th"),r(14,"Estado"),n(),e(15,"th"),r(16,"Acciones"),n()()(),e(17,"tbody"),f(18,Io,29,22,"tr",89),n()()),c&2){let a=g();s(18),d("ngForOf",a.trabajosRealizados)}}function Fo(c,l){if(c&1&&(e(0,"span",116),r(1),n()),c&2){let a=g();s(),h("Total: ",a.aviso.albaranes.length,"")}}function To(c,l){c&1&&(e(0,"span",116),r(1,"Sin albaranes"),n())}function Vo(c,l){c&1&&(e(0,"div",117),m(1,"ion-icon",110),e(2,"p"),r(3,"No hay albaranes cerrados para este aviso"),n(),e(4,"p",118),r(5,"Los albaranes aparecer\xE1n aqu\xED una vez que se cierren los trabajos realizados"),n()())}function Ro(c,l){if(c&1&&(e(0,"div",128)(1,"label"),r(2,"Presupuesto:"),n(),e(3,"span"),r(4),v(5,"currency"),n()()),c&2){let a=g().$implicit;s(4),_(y(5,1,a.presupuesto_necesario,"EUR","symbol","1.2-2"))}}function Do(c,l){if(c&1&&(Ye(0),r(1),Je()),c&2){let a=g().$implicit;s(),Ve(" ",a.nombre,": ",a.cantidad," ",a.unidad||"unidad"," ")}}function Bo(c,l){if(c&1&&r(0),c&2){let a=g().$implicit;h(" ",a," ")}}function $o(c,l){if(c&1&&(e(0,"span",135),f(1,Do,2,3,"ng-container",136)(2,Bo,1,1,"ng-template",null,1,Ze),n()),c&2){let a=l.$implicit,o=Ke(3);s(),d("ngIf",a.cantidad)("ngIfElse",o)}}function No(c,l){if(c&1&&(e(0,"div",130)(1,"label"),r(2,"Repuestos utilizados:"),n(),e(3,"div",133),f(4,$o,4,2,"span",134),n()()),c&2){let a=g().$implicit;s(4),d("ngForOf",a.repuestos_utilizados)}}function Ho(c,l){if(c&1&&(e(0,"div",128)(1,"label"),r(2,"DNI Cliente:"),n(),e(3,"span"),r(4),n()()),c&2){let a=g(2).$implicit;s(4),_(a.dni_cliente)}}function qo(c,l){if(c&1&&(e(0,"div",128)(1,"label"),r(2,"Firmado por:"),n(),e(3,"span"),r(4),n()()),c&2){let a=g(2).$implicit;s(4),_(a.nombre_firma)}}function Uo(c,l){if(c&1&&(e(0,"div",127),f(1,Ho,5,1,"div",129)(2,qo,5,1,"div",129),n()),c&2){let a=g().$implicit;s(),d("ngIf",a.dni_cliente),s(),d("ngIf",a.nombre_firma)}}function Lo(c,l){if(c&1&&(e(0,"div",130)(1,"label"),r(2,"Observaciones:"),n(),e(3,"p"),r(4),n()()),c&2){let a=g().$implicit;s(4),_(a.observaciones)}}function Go(c,l){if(c&1){let a=O();e(0,"div",119)(1,"div",120)(2,"div",111)(3,"h4"),r(4),n(),e(5,"span",121),r(6),v(7,"date"),n()(),e(8,"div",122)(9,"span",100),r(10),n()(),e(11,"div",123)(12,"button",124),u("click",function(){let i=C(a).$implicit,t=g();return b(t.verAlbaran(i))}),m(13,"ion-icon",125),e(14,"span",17),r(15,"Ver Albar\xE1n"),n(),e(16,"span",18),r(17,"Ver"),n()()()(),e(18,"div",126)(19,"div",127)(20,"div",128)(21,"label"),r(22,"Horario:"),n(),e(23,"span"),r(24),n()(),f(25,Ro,6,6,"div",129),n(),e(26,"div",130)(27,"label"),r(28,"Descripci\xF3n del trabajo:"),n(),e(29,"p"),r(30),n()(),f(31,No,5,1,"div",131)(32,Uo,3,2,"div",132)(33,Lo,5,1,"div",131),n()()}if(c&2){let a=l.$implicit,o=l.index;s(4),h("Albar\xE1n #",o+1,""),s(2),_(B(7,12,a.fecha_cierre,"dd/MM/yyyy")),s(3),ae("badge-"+a.estado_cierre.toLowerCase().replace(" ","-")),s(),h(" ",a.estado_cierre," "),s(14),I("",a.hora_entrada," - ",a.hora_salida,""),s(),d("ngIf",a.presupuesto_necesario>0),s(5),_(a.descripcion_trabajo_realizado),s(),d("ngIf",a.repuestos_utilizados&&a.repuestos_utilizados.length>0),s(),d("ngIf",a.dni_cliente||a.nombre_firma),s(),d("ngIf",a.observaciones)}}function Wo(c,l){c&1&&(e(0,"div",137),m(1,"ion-icon",40),e(2,"p"),r(3,"Subiendo im\xE1genes..."),n()())}function Qo(c,l){c&1&&(e(0,"div",138),m(1,"ion-icon",139),e(2,"p"),r(3,"No hay im\xE1genes disponibles para este aviso"),n()())}function Yo(c,l){if(c&1){let a=O();e(0,"div",140),m(1,"img",141),e(2,"div",142)(3,"span",143),r(4),n(),e(5,"span",144),r(6),v(7,"date"),n()(),e(8,"button",145),u("click",function(){let i=C(a).$implicit,t=g();return b(t.eliminarFoto(i))}),m(9,"ion-icon",115),n()()}if(c&2){let a=l.$implicit;s(),d("src",a.url,Z)("alt",a.descripcion||"Imagen del aviso"),s(3),_(a.descripcion||"Imagen del aviso"),s(2),_(B(7,4,a.fecha_subida,"dd/MM/yyyy HH:mm"))}}z({close:K,pencilOutline:le,navigate:Ne,person:He,call:De,mail:Be,mapOutline:$e,arrowBackOutline:Re});var Ui=(()=>{let l=class l{constructor(o,i,t,p,x,M){this.route=o,this.router=i,this.avisosService=t,this.trabajosService=p,this.modalController=x,this.flujoAvisosService=M,this.vistaGaleria="grid",this.aviso=null,this.loading=!1,this.error=null,this.subiendoImagenes=!1,this.destroy$=new X,this.trabajosRealizados=[],this.loadingTrabajos=!1,z({refreshOutline:Q,alertCircleOutline:Et,arrowBackOutline:Re,close:K,pencilOutline:le,checkmarkCircleOutline:G,navigate:Ne,person:He,call:De,mail:Be,addCircle:vt,constructOutline:At,bugOutline:St,documentTextOutline:V,trashOutline:ne,imagesOutline:Bt,personOutline:W,gridOutline:Dt,listOutline:Nt,chevronDownOutline:Ee,eyeOutline:Se,ellipsisVerticalOutline:Rt,ellipsisVertical:Vt,add:Pt,mapOutline:$e})}ngOnInit(){this.cargarAviso()}cargarTrabajos(){var o;(o=this.aviso)!=null&&o.id&&(console.log("\u{1F504} cargarTrabajos() ejecut\xE1ndose para aviso:",this.aviso.id),this.loadingTrabajos=!0,this.error=null,this.trabajosService.getTrabajosAviso(this.aviso.id).pipe(w(this.destroy$)).subscribe({next:i=>{console.log("\u2705 Trabajos cargados exitosamente:",i.trabajos.length,"trabajos"),console.log("\u{1F4CA} Estados de los trabajos:",i.trabajos.map(t=>({id:t.id,estado:t.estado,albaran_id:t.albaran_id}))),this.trabajosRealizados=i.trabajos,this.loadingTrabajos=!1},error:i=>{console.error("\u274C Error al cargar trabajos:",i),this.loadingTrabajos=!1,this.error="Error al cargar los trabajos realizados"}}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarAviso(){console.log("\u{1F504} cargarAviso() ejecut\xE1ndose..."),this.loading=!0,this.error=null,this.route.params.pipe(w(this.destroy$)).subscribe(o=>{let i=o["id-aviso"];console.log("\u{1F50D} ID de aviso obtenido de la URL:",i),i?this.avisosService.getResumenCompletoAviso(i).pipe(w(this.destroy$)).subscribe({next:t=>{var p;console.log("\u2705 Aviso cargado exitosamente:",t.id,"Estado:",t.estado),console.log("\u{1F4CA} Albaranes cargados:",((p=t.albaranes)==null?void 0:p.length)||0),this.aviso=t,this.loading=!1,this.cargarTrabajos()},error:t=>{console.error("\u274C Error al cargar el aviso:",t),this.error="Error al cargar el aviso. Por favor, int\xE9ntalo de nuevo.",this.loading=!1}}):(this.error="ID de aviso no v\xE1lido",this.loading=!1)})}cambiarVistaGaleria(o){this.vistaGaleria=o.detail.value}forzarRecargaDatos(){this.error=null,this.cargarAviso()}recargarAlbaranes(){var o;(o=this.aviso)!=null&&o.id&&(console.log("\u{1F504} Recargando albaranes del aviso:",this.aviso.id),this.avisosService.getResumenCompletoAviso(this.aviso.id).pipe(w(this.destroy$)).subscribe({next:i=>{var t;console.log("\u2705 Albaranes recargados:",((t=i.albaranes)==null?void 0:t.length)||0),this.aviso=i},error:i=>{console.error("\u274C Error al recargar albaranes:",i)}}))}volverALista(){let o=document.referrer;o&&o.includes("/historial")?this.router.navigate(["/historial"]):this.router.navigate(["/avisos"])}verCliente(){var o,i;(i=(o=this.aviso)==null?void 0:o.cliente)!=null&&i.id&&console.log("Navegar al cliente:",this.aviso.cliente.id)}verMapa(){var o;if((o=this.aviso)!=null&&o.direccion_cliente_aviso){let i=encodeURIComponent(this.aviso.direccion_cliente_aviso);window.open(`https://www.google.com/maps/search/?api=1&query=${i}`,"_blank")}}editarAviso(){var o;(o=this.aviso)!=null&&o.id&&this.abrirModalEditarAviso()}abrirModalEditarAviso(){return E(this,null,function*(){var p;if(!((p=this.aviso)!=null&&p.id))return;let o=yield this.modalController.create({component:Qt,cssClass:"modal-crear-aviso",componentProps:{modoEdicion:!0,avisoExistente:this.aviso}});yield o.present();let{data:i,role:t}=yield o.onWillDismiss();if(t==="confirm"&&i)try{console.log("Datos del formulario de edici\xF3n:",i);let x={tipo:i.tipo,nombre_cliente_aviso:i.nombreContacto,direccion_cliente_aviso:i.direccionLocal,telefono_cliente_aviso:i.telefono,nombre_contacto:i.nombreContacto,descripcion_problema:i.descripcion,es_urgente:i.esUrgente,urgencia:i.esUrgente?"Alta":"Normal"};this.loading=!0,this.avisosService.actualizarAviso(this.aviso.id,x).pipe(w(this.destroy$)).subscribe({next:M=>{console.log("Aviso actualizado exitosamente:",M),this.loading=!1,this.mostrarMensaje("Aviso actualizado exitosamente","success"),this.cargarAviso()},error:M=>{console.error("Error al actualizar aviso:",M),this.loading=!1,this.mostrarMensaje(M.message||"Error al actualizar el aviso. Por favor, int\xE9ntalo de nuevo.","error")}})}catch(x){console.error("Error al procesar la edici\xF3n:",x),this.mostrarMensaje("Error al procesar la edici\xF3n. Por favor, int\xE9ntalo de nuevo.","error")}})}cerrarAlbaran(){var o;(o=this.aviso)!=null&&o.id&&console.log("Cerrar albar\xE1n para aviso:",this.aviso.id)}seleccionarImagenes(){this.fileInput&&this.fileInput.nativeElement.click()}onFileSelected(o){var t;let i=o.target.files;i.length>0&&((t=this.aviso)!=null&&t.id)&&this.subirImagenes(Array.from(i)),o.target.value=""}subirImagenes(o){return E(this,null,function*(){var i;if(!((i=this.aviso)!=null&&i.id)){console.error("No se puede subir im\xE1genes: aviso no v\xE1lido");return}this.subiendoImagenes=!0,this.error=null;try{yield new Promise(p=>{let x=0,M=o.length;o.forEach(S=>{this.avisosService.subirFoto(this.aviso.id,S).pipe(w(this.destroy$)).subscribe({next:R=>{console.log("Foto subida:",R),x++,x===M&&p()},error:R=>{console.error("Error al subir foto:",R),x++,x===M&&p()}})})}),this.cargarAviso()}catch(t){console.error("Error al subir im\xE1genes:",t),this.error="Error al subir las im\xE1genes. Por favor, int\xE9ntalo de nuevo."}finally{this.subiendoImagenes=!1}})}crearTrabajoRealizado(o){return E(this,null,function*(){var x;if(!((x=this.aviso)!=null&&x.id))return;let i=yield this.modalController.create({component:Jt,componentProps:{avisoId:this.aviso.id,trabajoExistente:o},cssClass:"modal-crear-trabajo"});yield i.present();let{data:t,role:p}=yield i.onWillDismiss();if(p==="confirm"&&t)try{if(o){let M=yield D(this.trabajosService.actualizarTrabajo(o.id,t));console.log("Trabajo actualizado exitosamente:",M),alert("Trabajo actualizado exitosamente.")}else{let M=yield D(this.trabajosService.crearTrabajo(t));console.log("Trabajo creado exitosamente:",M),alert("Trabajo creado exitosamente. Los materiales han sido descontados del inventario.")}this.cargarTrabajos()}catch(M){console.error("Error al procesar trabajo:",M),alert("Error al procesar el trabajo. Por favor, int\xE9ntalo de nuevo.")}})}editarTrabajo(o){return E(this,null,function*(){try{let i=yield D(this.trabajosService.getTrabajo(o.id));yield this.crearTrabajoRealizado(i.trabajo)}catch(i){console.error("Error al cargar el trabajo para editar:",i),alert("Error al cargar el trabajo para editar. Por favor, int\xE9ntalo de nuevo.")}})}eliminarTrabajo(o){return E(this,null,function*(){if(confirm(`\xBFEst\xE1s seguro de que quieres eliminar este trabajo?

Fecha: ${o.fecha_trabajo}
Descripci\xF3n: ${o.descripcion}

Esta acci\xF3n no se puede deshacer y los materiales ser\xE1n devueltos al inventario.`))try{yield D(this.trabajosService.eliminarTrabajo(o.id)),console.log("Trabajo eliminado exitosamente"),alert("Trabajo eliminado exitosamente. Los materiales han sido devueltos al inventario."),this.cargarTrabajos()}catch(t){console.error("Error al eliminar el trabajo:",t),alert("Error al eliminar el trabajo. Por favor, int\xE9ntalo de nuevo.")}})}hacerAlbaran(o){return E(this,null,function*(){var x;if(console.log("Abriendo modal de hacer albar\xE1n para trabajo:",o),!((x=this.aviso)!=null&&x.id))return;let i=yield this.modalController.create({component:Zt,componentProps:{trabajo:o,aviso:this.aviso},cssClass:"modal-hacer-albaran modal-fullscreen",backdropDismiss:!1,showBackdrop:!0,breakpoints:[0,1],initialBreakpoint:1,backdropBreakpoint:0,handle:!1,handleBehavior:"none"});console.log("Modal creado:",i),console.log("Presentando modal..."),yield i.present(),console.log("Modal presentado");let{data:t,role:p}=yield i.onWillDismiss();if(console.log("\u{1F50D} Modal cerrado con:",{role:p,data:t}),p==="confirm"&&(t!=null&&t.success))try{console.log("\u2705 Albar\xE1n creado exitosamente:",t.albaran),console.log("\u2705 Trabajo actualizado:",t.trabajo),console.log("\u2705 Aviso actualizado:",t.aviso),alert(t.mensaje||"Albar\xE1n creado exitosamente"),console.log("\u{1F504} Recargando datos..."),this.cargarTrabajos(),this.cargarAviso(),t.albaran.estado_cierre==="Finalizado"&&console.log("Trabajo finalizado, listo para facturar"),t.albaran.estado_cierre==="Presupuesto pendiente"&&console.log("Presupuesto pendiente, se puede crear presupuesto"),t.albaran.estado_cierre==="Otra visita"&&console.log("Otra visita requerida")}catch(M){console.error("Error al procesar albar\xE1n:",M),alert("Error al procesar el albar\xE1n. Por favor, int\xE9ntalo de nuevo.")}})}realizarOtraVisita(o){console.log("Realizar otra visita para el trabajo:",o)}eliminarFoto(o){return E(this,null,function*(){var t;if(!((t=this.aviso)!=null&&t.id)||!(o!=null&&o.id)){console.error("No se puede eliminar la foto: faltan datos");return}if(confirm(`\xBFEst\xE1s seguro de que quieres eliminar esta imagen?

Esta acci\xF3n no se puede deshacer.`))try{yield D(this.avisosService.eliminarFoto(o.id)),console.log("Foto eliminada exitosamente"),this.cargarAviso()}catch(p){console.error("Error al eliminar la foto:",p),alert("Error al eliminar la imagen. Por favor, int\xE9ntalo de nuevo.")}})}calcularHorasTrabajo(o){let i=new Date(`2000-01-01T${o.hora_inicio}`),p=(new Date(`2000-01-01T${o.hora_fin}`).getTime()-i.getTime())/(1e3*60*60);return Math.max(0,p)}getAlbaranEstado(o){var t;if(!o||!o.albaran_id||!((t=this.aviso)!=null&&t.albaranes))return"pendiente";let i=this.aviso.albaranes.find(p=>p.id===o.albaran_id);return!i||!i.estado_cierre?"pendiente":i.estado_cierre.toLowerCase().replace(/ /g,"-")}puedeCrearAlbaran(o){return!o||!o.estado||o.albaran_id?!1:["En curso","Abierto","Pendiente"].includes(o.estado)}getEstadoClass(o){return o?"badge-"+o.toLowerCase().replace(/ /g,"-"):"badge-pendiente"}onAccionFlujoEjecutada(o){console.log("Acci\xF3n de flujo ejecutada:",o),this.cargarAviso(),this.cargarTrabajos(),o.mensaje&&(console.log("Mensaje de \xE9xito:",o.mensaje),alert(o.mensaje)),o.facturaId&&confirm("Se ha generado una factura. \xBFDeseas ver la factura creada?")&&this.router.navigate(["/facturas",o.facturaId])}completarAviso(){var o;(o=this.aviso)!=null&&o.id?(console.log("\u{1F504} Completando aviso:",this.aviso.id),confirm("\xBFEst\xE1s seguro de que quieres marcar este aviso como completado? Esta acci\xF3n no se puede deshacer.")&&(this.loading=!0,this.error=null,this.flujoAvisosService.completarAviso(this.aviso.id).subscribe({next:i=>{console.log("\u2705 Aviso completado exitosamente:",i),this.loading=!1,this.mostrarMensaje("Aviso completado exitosamente","success"),this.cargarAviso()},error:i=>{console.error("\u274C Error al completar aviso:",i),this.loading=!1;let t=i.message||"Error al completar el aviso. Verifica que haya trabajos realizados y facturas generadas.";this.mostrarMensaje(t,"error"),this.error=t}}))):(console.error("No hay aviso seleccionado para completar"),this.mostrarMensaje("No hay aviso seleccionado para completar","error"))}verAlbaran(o){return E(this,null,function*(){if(!(o!=null&&o.id)){console.error("No se puede abrir el albar\xE1n: ID no v\xE1lido");return}try{console.log("Abriendo modal de albar\xE1n:",o);let i=yield this.modalController.create({component:tn,componentProps:{albaran:o,aviso:this.aviso},cssClass:"modal-ver-albaran modal-fullscreen",backdropDismiss:!0});yield i.present();let{data:t,role:p}=yield i.onWillDismiss();p==="confirm"&&t&&console.log("Modal de albar\xE1n cerrado con datos:",t)}catch(i){console.error("Error al abrir el modal del albar\xE1n:",i),this.mostrarMensaje("Error al abrir el albar\xE1n. Por favor, int\xE9ntalo de nuevo.","error")}})}mostrarMensaje(o,i="info"){console.log(`[${i.toUpperCase()}] ${o}`),i==="error"?alert(`ERROR: ${o}`):console.log(i==="success"?`\u2705 ${o}`:`\u2139\uFE0F ${o}`)}};l.\u0275fac=function(i){return new(i||l)(P(nt),P(ot),P(Ie),P(ie),P(ee),P(Fe))},l.\u0275cmp=j({type:l,selectors:[["app-ver-avisos"]],viewQuery:function(i,t){if(i&1&&me(lo,5),i&2){let p;_e(p=ue())&&(t.fileInput=p.first)}},decls:72,vars:22,consts:[["fileInput",""],["repuestoBasico",""],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","info-card",4,"ngIf"],[1,"info-card"],[1,"card-header",2,"justify-content","space-between!important"],[1,"badge-estado-aviso"],[1,"descripcion-content"],[1,"info-item"],[1,"tipo-aviso"],[1,"descripcion-texto"],[1,"card-header"],[2,"text-wrap","nowrap"],[1,"header-actions-jobs"],[1,"btn-primary",3,"click"],["name","add-circle"],[1,"desktop-only"],[1,"mobile-only"],["class","flujo-section",4,"ngIf"],[1,"section-divider"],[1,"table-container"],["class","no-trabajos",4,"ngIf"],["class","custom-mat-table",4,"ngIf"],[1,"header-actions"],["class","badge-info",4,"ngIf"],["title","Recargar albaranes",1,"btn-secondary","btn-small",3,"click"],["name","refresh-outline"],[1,"albaranes-container"],["class","no-albaranes",4,"ngIf"],["class","albaran-item",4,"ngFor","ngForOf"],[1,"gallery-actions"],[1,"btn-primary",3,"click","disabled"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"gallery-items"],["class","uploading-indicator",4,"ngIf"],["class","no-images",4,"ngIf"],["class","gallery-item",4,"ngFor","ngForOf"],[1,"loading-state"],[1,"loading-spinner"],["name","refresh-outline",1,"spinning"],[1,"error-state"],[1,"error-message"],["name","alert-circle-outline"],[1,"btn-retry",3,"click"],[1,"header-container"],[1,"back-button"],[1,"btn-back",3,"click"],["name","arrow-back-outline"],["title","Recargar datos",1,"btn-secondary",3,"click"],["class","btn-secondary",3,"click",4,"ngIf"],["class","btn-primary",3,"click",4,"ngIf"],["class","aviso-completado-message",4,"ngIf"],[1,"mobile-only","title"],[1,"title"],[1,"info-grid"],[1,"info-row"],[1,"estado-pendiente"],[1,"urgent-badge"],[1,"info-item","cliente-section"],[1,"cliente-info"],[1,"cliente-nombre"],[1,"ver-cliente",3,"click"],[1,"info-item","direccion-section"],[1,"direccion-info"],[1,"direccion-texto"],["title","Ver en mapa",1,"btn-map",3,"click"],["name","navigate"],[1,"contacto-section"],[1,"contacto-items"],["class","contacto-item nombre-contacto",4,"ngIf"],["class","contacto-item",4,"ngIf"],[1,"btn-secondary",3,"click"],["name","close"],["name","pencil-outline"],[1,"aviso-completado-message"],["name","checkmark-circle-outline"],[1,"contacto-item","nombre-contacto"],["name","person"],[1,"contacto-item"],["name","call"],["name","mail"],[1,"flujo-section"],[1,"flujo-container"],[3,"accionEjecutada","avisoId"],[1,"no-trabajos"],[1,"empty-state"],["name","construct-outline"],[1,"custom-mat-table"],[4,"ngFor","ngForOf"],["data-label","N\xFAmero"],["data-label","Fecha trabajo"],["data-label","Horas"],["data-label","Descripci\xF3n"],[1,"descripcion-trabajo"],["data-label","Materiales"],[1,"materiales-info"],["class","repuestos-list",4,"ngIf"],["class","no-repuestos",4,"ngIf"],["data-label","Estado"],[1,"badge-estado"],["data-label","Acciones"],[1,"estado-actions"],["class","btn-primary btn-small","title","Hacer albar\xE1n","style","background: #4CAF50;",3,"click",4,"ngIf"],["class","albaran-info",4,"ngIf"],["class","btn-secondary btn-small","title","Editar trabajo",3,"click",4,"ngIf"],["class","btn-danger btn-small","title","Eliminar trabajo",3,"click",4,"ngIf"],[1,"repuestos-list"],[1,"no-repuestos"],["title","Hacer albar\xE1n",1,"btn-primary","btn-small",2,"background","#4CAF50",3,"click"],["name","document-text-outline"],[1,"albaran-info"],[1,"badge-albaran"],["title","Editar trabajo",1,"btn-secondary","btn-small",3,"click"],["title","Eliminar trabajo",1,"btn-danger","btn-small",3,"click"],["name","trash-outline"],[1,"badge-info"],[1,"no-albaranes"],[1,"info-text"],[1,"albaran-item"],[1,"albaran-header"],[1,"fecha-albaran"],[1,"estado-albaran"],[1,"albaran-actions"],["title","Ver albar\xE1n completo",1,"btn-primary","btn-small",3,"click"],["name","eye-outline"],[1,"albaran-details"],[1,"detail-row"],[1,"detail-item"],["class","detail-item",4,"ngIf"],[1,"detail-item","full-width"],["class","detail-item full-width",4,"ngIf"],["class","detail-row",4,"ngIf"],[1,"repuestos-tags"],["class","repuesto-tag",4,"ngFor","ngForOf"],[1,"repuesto-tag"],[4,"ngIf","ngIfElse"],[1,"uploading-indicator"],[1,"no-images"],["name","images-outline"],[1,"gallery-item"],[3,"src","alt"],[1,"image-info"],[1,"image-title"],[1,"file-info"],["title","Eliminar imagen",1,"btn-delete",3,"click"]],template:function(i,t){if(i&1){let p=O();f(0,po,5,0,"div",2)(1,go,8,1,"div",3)(2,xo,67,18,"div",4),e(3,"div",5)(4,"div",6)(5,"h2"),r(6,"Descripci\xF3n del Aviso"),n(),e(7,"span",7),r(8),n()(),e(9,"div",8)(10,"div",9)(11,"label"),r(12,"Tipo de Aviso"),n(),e(13,"p",10),r(14),n()(),e(15,"div",9)(16,"label"),r(17,"Descripci\xF3n Detallada del Problema/Petici\xF3n"),n(),e(18,"p",11),r(19),n()()()(),e(20,"div",5)(21,"div",12)(22,"h2",13),r(23,"Gesti\xF3n de Albaranes"),n(),e(24,"div",14)(25,"button",15),u("click",function(){return C(p),b(t.crearTrabajoRealizado())}),m(26,"ion-icon",16),e(27,"span",17),r(28,"Crear parte de trabajo"),n(),e(29,"span",18),r(30,"Crear trabajo"),n()()()(),f(31,Mo,3,1,"div",19),e(32,"div",20)(33,"span"),r(34,"Lista de Trabajos Registrados"),n()(),e(35,"div",21),f(36,Oo,5,0,"div",2)(37,Po,7,0,"div",22)(38,Ao,19,1,"table",23),n()(),e(39,"div",5)(40,"div",12)(41,"h2"),r(42,"Albaranes Cerrados"),n(),e(43,"div",24),f(44,Fo,2,1,"span",25)(45,To,2,0,"span",25),e(46,"button",26),u("click",function(){return C(p),b(t.recargarAlbaranes())}),m(47,"ion-icon",27),e(48,"span",17),r(49,"Recargar"),n(),e(50,"span",18),r(51,"\u21BB"),n()()()(),e(52,"div",28),f(53,Vo,6,0,"div",29)(54,Go,34,15,"div",30),n()(),e(55,"div",5)(56,"div",6)(57,"h2"),r(58,"Galer\xEDa de im\xE1genes"),n(),e(59,"div",31)(60,"button",32),u("click",function(){return C(p),b(t.seleccionarImagenes())}),m(61,"ion-icon",16),e(62,"span",17),r(63),n(),e(64,"span",18),r(65),n()(),e(66,"input",33,0),u("change",function(M){return C(p),b(t.onFileSelected(M))}),n()()(),e(68,"div",34),f(69,Wo,4,0,"div",35)(70,Qo,4,0,"div",36)(71,Yo,10,7,"div",37),n()()}i&2&&(d("ngIf",t.loading),s(),d("ngIf",t.error&&!t.loading),s(),d("ngIf",t.aviso&&!t.loading),s(5),ae(t.getEstadoClass(t.aviso==null?null:t.aviso.estado)),s(),h(" ",(t.aviso==null?null:t.aviso.estado)||"Pendiente"," "),s(6),_((t.aviso==null?null:t.aviso.tipo)||"No especificado"),s(5),_(t.aviso==null?null:t.aviso.descripcion_problema),s(12),d("ngIf",t.aviso==null?null:t.aviso.id),s(5),d("ngIf",t.loadingTrabajos),s(),d("ngIf",!t.loadingTrabajos&&(!t.trabajosRealizados||t.trabajosRealizados.length===0)),s(),d("ngIf",!t.loadingTrabajos&&t.trabajosRealizados.length>0),s(6),d("ngIf",(t.aviso==null?null:t.aviso.albaranes)&&(t.aviso==null?null:t.aviso.albaranes.length)>0),s(),d("ngIf",!(t.aviso!=null&&t.aviso.albaranes)||(t.aviso==null||t.aviso.albaranes==null?null:t.aviso.albaranes.length)===0),s(8),d("ngIf",!(t.aviso!=null&&t.aviso.albaranes)||(t.aviso==null||t.aviso.albaranes==null?null:t.aviso.albaranes.length)===0),s(),d("ngForOf",t.aviso==null?null:t.aviso.albaranes),s(6),d("disabled",t.subiendoImagenes),s(3),_(t.subiendoImagenes?"Subiendo...":"A\xF1adir im\xE1genes"),s(2),_(t.subiendoImagenes?"Subiendo...":"A\xF1adir"),s(4),d("ngIf",t.subiendoImagenes),s(),d("ngIf",!(t.aviso!=null&&t.aviso.fotos)||(t.aviso==null||t.aviso.fotos==null?null:t.aviso.fotos.length)===0),s(),d("ngForOf",t.aviso==null?null:t.aviso.fotos))},dependencies:[T,A,F,fe,U,tt,L,en],styles:['[_nghost-%COMP%]{display:block;padding:24px}.back-button[_ngcontent-%COMP%]{margin-bottom:24px}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 16px;background-color:#fff;color:#4f46e5;border:1px solid #E5E7EB;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s ease}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]:hover{background-color:#f9fafb;border-color:#4f46e5}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px;text-align:center}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#4f46e5}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#6b7280;margin:0}.loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#ef4444}.loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 20px;background-color:#4f46e5;color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:background-color .2s ease}.loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]:hover, .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]:hover{background-color:#3a30e2}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.aviso-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.aviso-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#111827}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.btn-primary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:10px 15px;background-color:#4f46e5;color:#fff;border:none;border-radius:.5rem;cursor:pointer;font-size:15px;font-weight:500}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#3a30e2}.btn-secondary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:10px 15px;background-color:#fff;color:#26262a;border:none;border-radius:.5rem;cursor:pointer;font-size:15px;font-weight:500;border:1px solid rgba(125,131,152,.2431372549)}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.btn-danger[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:10px 15px;background-color:#ef4444;color:#fff;border:none;border-radius:.5rem;cursor:pointer;font-size:15px;font-weight:500}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#dc2626}.btn-danger.btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.info-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;box-shadow:0 2px 8px #e0e7ef33;margin-bottom:24px;overflow:hidden}.info-card[_ngcontent-%COMP%]   h2.title[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#111827;margin:0;padding:25px}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#111827;margin:0}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:25px 25px 0}.info-card[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.info-card[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-card[_ngcontent-%COMP%]   .descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#111827;font-size:16px}.badge-pendiente[_ngcontent-%COMP%]{background-color:#f59e0b1a;color:#f59e0b;padding:4px 12px;border-radius:16px;font-size:14px;font-weight:500}.badge-estado-aviso[_ngcontent-%COMP%]{padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.badge-estado-aviso.badge-en-curso[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.badge-estado-aviso.badge-pendiente[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.badge-estado-aviso.badge-completado[_ngcontent-%COMP%]{background:#10b981;color:#fff}.badge-estado-aviso.badge-pendiente-de-presupuesto[_ngcontent-%COMP%]{background:#fcd34d;color:#92400e}.badge-estado-aviso.badge-listo-para-facturar[_ngcontent-%COMP%]{background:#d1fae5;color:#059669}.info-grid[_ngcontent-%COMP%]{padding:25px;padding-top:0!important;display:grid;gap:24px}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#111827;font-size:16px}.info-grid[_ngcontent-%COMP%]   .direccion-section[_ngcontent-%COMP%]   .btn-map[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:none;border:none;padding:8px;cursor:pointer;color:#fff;background-color:#4f46e5;font-size:16px;border-radius:50%}.info-grid[_ngcontent-%COMP%]   .contacto-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:14px;margin-bottom:4px}.info-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:24px}.cliente-info[_ngcontent-%COMP%], .direccion-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.cliente-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%], .direccion-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%]{color:#4f46e5;text-decoration:none;font-size:14px;cursor:pointer}.cliente-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%]:hover, .direccion-info[_ngcontent-%COMP%]   .ver-cliente[_ngcontent-%COMP%]:hover{text-decoration:underline}.contacto-items[_ngcontent-%COMP%]{display:flex;gap:24px;margin-top:8px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background-color:#eef2ff;color:#4f46e5;padding:6px 15px;border-radius:10px;font-size:14px;font-weight:500}.estado-pendiente[_ngcontent-%COMP%]{color:#f59e0b!important;font-weight:500}.descripcion-content[_ngcontent-%COMP%]{padding:24px}.descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;line-height:1.5}.gallery-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{background:#f3f4f6;border-radius:30px;width:auto;height:auto;padding:2px 4px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]::part(indicator){background:none}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--background: transparent;--background-checked: white;--background-hover: rgba(255,255,255,.1);--background-focused: rgba(255,255,255,.2);--border-radius: 50%;--border-width: 0;--indicator-color: transparent;--color: #6B7280;--color-checked: #4F46E5;--margin-top: 0;--margin-bottom: 0;--margin-start: 0;--margin-end: 0;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0;min-height:30px;min-width:30px;transition:all .2s ease;position:relative}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]::part(native){margin:0;padding:0 6px;height:100%}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]::part(indicator){display:none}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button.segment-button-checked[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a}.gallery-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{margin-left:auto}.gallery-items[_ngcontent-%COMP%]{padding:24px;display:grid;gap:16px}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;color:#4f46e5}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px;margin-bottom:12px}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]   ion-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.gallery-items[_ngcontent-%COMP%]   .uploading-indicator[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:500}.gallery-items[_ngcontent-%COMP%]   .no-images[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.gallery-items[_ngcontent-%COMP%]   .no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px;border:1px solid #E5E7EB;border-radius:6px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:48px;height:48px;object-fit:cover;border-radius:4px;margin-right:16px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]{flex:1}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#26262a}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span.file-info[_ngcontent-%COMP%]{color:#6b7280;font-size:14px;margin-top:4px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#ef4444;border-radius:4px;transition:all .2s ease}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]:hover{background-color:#ef44441a;color:#eb1515}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.table-container[_ngcontent-%COMP%]{padding:0 24px 24px}.table-search[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:center}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:8px;padding:7px 14px;font-size:1rem;border:none;background:#f9fbff;color:#26262a}.table-search[_ngcontent-%COMP%]   .order-by[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#26262a;font-size:14px}.table-search[_ngcontent-%COMP%]   .order-by[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#4f46e5;font-weight:500}.table-search[_ngcontent-%COMP%]   .order-by[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#4f46e5;font-size:16px}.custom-mat-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0 8px;margin-bottom:12px}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#64748b;font-size:14px;font-weight:400;text-align:left;padding:8px 16px;background:transparent}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#f9fafb}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;color:#26262a;font-size:14px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{border-top-left-radius:8px;border-bottom-left-radius:8px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-top-right-radius:8px;border-bottom-right-radius:8px}.descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px;font-size:14px;line-height:1.4}.descripcion-trabajo[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#6b7280;font-size:12px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:13px;color:#4b5563;padding:2px 6px;background-color:#f3f4f6;border-radius:4px;display:inline-block;margin-right:4px;margin-bottom:4px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.badge-estado[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.badge-estado.badge-pendiente[_ngcontent-%COMP%]{background-color:var(--estado-pendiente-bg);color:var(--estado-pendiente-color)}.badge-estado.badge-en-curso[_ngcontent-%COMP%]{background-color:var(--estado-en-curso-bg);color:var(--estado-en-curso-color)}.badge-estado.badge-completado[_ngcontent-%COMP%]{background-color:var(--estado-completado-bg);color:var(--estado-completado-color)}.badge-estado.badge-cancelado[_ngcontent-%COMP%]{background-color:var(--estado-cancelado-bg);color:var(--estado-cancelado-color)}.repuestos-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:14px;color:#4b5563;margin-bottom:4px}.repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.estado-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.estado-actions[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:11px;font-weight:500;text-transform:uppercase;letter-spacing:.5px;margin-left:auto}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-pendiente[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-en-curso[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-abierto[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1e40af}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-cerrado[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151}.estado-actions[_ngcontent-%COMP%]   .estado-badge.estado-finalizado[_ngcontent-%COMP%]{background-color:#ecfdf5;color:#14532d}.albaran-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px;margin:8px 0}.albaran-info[_ngcontent-%COMP%]   .badge-albaran[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:6px 10px;border-radius:16px;font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;white-space:nowrap;background:#10b981;color:#fff}.albaran-info[_ngcontent-%COMP%]   .badge-albaran[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.albaran-info[_ngcontent-%COMP%]   .badge-albaran.badge-finalizado[_ngcontent-%COMP%]{background:#10b981;color:#fff}.albaran-info[_ngcontent-%COMP%]   .badge-albaran.badge-presupuesto-pendiente[_ngcontent-%COMP%]{background:#f59e0b;color:#fff}.albaran-info[_ngcontent-%COMP%]   .badge-albaran.badge-otra-visita[_ngcontent-%COMP%]{background:#ef4444;color:#fff}.albaran-info[_ngcontent-%COMP%]   .albaran-details[_ngcontent-%COMP%]{font-size:10px;color:#6b7280;text-transform:capitalize}.no-trabajos[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#6b7280}.no-trabajos[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.no-repuestos[_ngcontent-%COMP%]{color:#6b7280;font-style:italic;font-size:14px}.flujo-container[_ngcontent-%COMP%]{padding:0 25px}.flujo-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;font-weight:400;margin-left:12px}.card-header[_ngcontent-%COMP%]   .flujo-subtitle[_ngcontent-%COMP%]{display:block;margin-top:4px;margin-left:0}.flujo-section[_ngcontent-%COMP%]{margin-top:25px;margin-bottom:5px}.flujo-section[_ngcontent-%COMP%]   .flujo-header[_ngcontent-%COMP%]{margin-bottom:16px}.flujo-section[_ngcontent-%COMP%]   .flujo-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#1a202c;margin:0 0 4px}.flujo-section[_ngcontent-%COMP%]   .flujo-header[_ngcontent-%COMP%]   .flujo-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:400}.section-divider[_ngcontent-%COMP%]{display:flex;align-items:center;margin:24px 0 20px}.section-divider[_ngcontent-%COMP%]:before, .section-divider[_ngcontent-%COMP%]:after{content:"";flex:1;height:1px;background:#e2e8f0}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0 16px;font-size:14px;font-weight:500;color:#64748b;background:#fff}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#64748b}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#cbd5e0;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:500;margin:0 0 8px;color:#4a5568}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:14px;color:#a0aec0}.desktop-only[_ngcontent-%COMP%]{display:inline}.mobile-only[_ngcontent-%COMP%]{display:none}.urgent-badge[_ngcontent-%COMP%]{padding:2px 8px;border-radius:12px;font-size:12px;font-weight:500}.urgent-badge.urgent[_ngcontent-%COMP%]{background-color:#fef2f2;color:#dc2626}.urgent-badge[_ngcontent-%COMP%]:not(.urgent){background-color:#f3f4f6;color:#6b7280}.cliente-nombre[_ngcontent-%COMP%]{font-weight:500;color:#111827}.direccion-texto[_ngcontent-%COMP%]{word-break:break-word;line-height:1.4}.tipo-aviso[_ngcontent-%COMP%]{font-weight:500;color:#4f46e5}.descripcion-texto[_ngcontent-%COMP%]{line-height:1.6;color:#111827}.image-title[_ngcontent-%COMP%]{font-weight:500;color:#111827}.ver-cliente[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;color:#4f46e5;text-decoration:none;font-size:14px;cursor:pointer;transition:color .2s ease}.ver-cliente[_ngcontent-%COMP%]:hover{color:#291fd9}.ver-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.no-images[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.no-images[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#cbd5e0;margin-bottom:16px}.no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}@media (max-width: 768px){[_nghost-%COMP%]{padding:16px}.desktop-only[_ngcontent-%COMP%]{display:none}.mobile-only[_ngcontent-%COMP%]{display:inline}.info-card[_ngcontent-%COMP%]{margin-bottom:16px;border-radius:12px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:20px;flex-direction:row;align-items:center;justify-content:start;gap:25px!important}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .mobile-only.title[_ngcontent-%COMP%]{display:block;font-size:18px;font-weight:500;color:#111827;margin:0}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{width:auto;justify-content:space-between;gap:12px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:none;width:100%;flex-direction:column;gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions-jobs[_ngcontent-%COMP%]{display:flex;width:100%;flex-direction:column;gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions-jobs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.info-card[_ngcontent-%COMP%]   h2.title[_ngcontent-%COMP%]{font-size:16px;padding:20px}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px}.info-grid[_ngcontent-%COMP%]{padding:15px;gap:16px}.info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]{gap:20px}.info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{width:auto}.info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:max-content}.info-grid[_ngcontent-%COMP%]   .cliente-info[_ngcontent-%COMP%], .info-grid[_ngcontent-%COMP%]   .direccion-info[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between;gap:8px}.info-grid[_ngcontent-%COMP%]   .contacto-items[_ngcontent-%COMP%]{flex-direction:row;gap:8px}.info-grid[_ngcontent-%COMP%]   .contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{width:100%;justify-content:flex-start}.info-grid[_ngcontent-%COMP%]   .contacto-items[_ngcontent-%COMP%]   .contacto-item.nombre-contacto[_ngcontent-%COMP%]{display:none}.descripcion-content[_ngcontent-%COMP%]{padding:20px;gap:16px}.gallery-actions[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:stretch}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{align-self:center}.gallery-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{margin-left:0;width:100%;justify-content:center}.gallery-items[_ngcontent-%COMP%]{padding:20px;gap:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:200px;object-fit:cover;border-radius:8px;margin-right:0}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]{width:100%}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{align-self:flex-end}.table-container[_ngcontent-%COMP%]{padding:0 20px 20px}.custom-mat-table[_ngcontent-%COMP%]{font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:11px;padding:8px 12px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 12px;font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:10px}.estado-actions[_ngcontent-%COMP%]{flex-direction:column;gap:6px}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{width:100%;justify-content:center;padding:8px 12px;font-size:12px}.flujo-container[_ngcontent-%COMP%]{padding:0 20px 20px}.flujo-section[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:0}.section-divider[_ngcontent-%COMP%]{margin:20px 0 16px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;padding:0 12px}.back-button[_ngcontent-%COMP%]{margin-bottom:16px}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}.badge-pendiente[_ngcontent-%COMP%]{font-size:12px;padding:3px 8px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:11px;padding:2px 4px}.no-repuestos[_ngcontent-%COMP%]{font-size:12px}.empty-state[_ngcontent-%COMP%]{padding:30px 16px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px}.urgent-badge[_ngcontent-%COMP%]{font-size:11px;padding:2px 6px}.ver-cliente[_ngcontent-%COMP%]{font-size:12px}.ver-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.no-images[_ngcontent-%COMP%]{padding:30px 16px}.no-images[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px}.no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 480px){[_nghost-%COMP%]{padding:0}.info-card[_ngcontent-%COMP%]{margin-bottom:12px;border-radius:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:16px;gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{gap:8px}.info-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{gap:6px}.info-card[_ngcontent-%COMP%]   h2.title[_ngcontent-%COMP%]{font-size:15px;padding:16px;display:none}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:15px!important}.descripcion-content[_ngcontent-%COMP%]{padding:16px;gap:12px}.descripcion-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px}.descripcion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.gallery-actions[_ngcontent-%COMP%]{gap:8px}.gallery-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}.gallery-items[_ngcontent-%COMP%]{padding:16px;gap:8px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{gap:8px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:150px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span.file-info[_ngcontent-%COMP%]{font-size:11px}.table-container[_ngcontent-%COMP%]{padding:0 16px 16px}.custom-mat-table[_ngcontent-%COMP%]{font-size:11px}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:10px;padding:6px 8px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;font-size:11px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .descripcion-trabajo[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:9px}.estado-actions[_ngcontent-%COMP%]{gap:4px}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{padding:6px 8px;font-size:11px}.flujo-container[_ngcontent-%COMP%]{padding:0 16px 16px}.flujo-section[_ngcontent-%COMP%]{margin-top:16px}.section-divider[_ngcontent-%COMP%]{margin:16px 0 12px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:0 8px}.back-button[_ngcontent-%COMP%]{margin-bottom:12px}.back-button[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{padding:6px 10px;font-size:12px}.badge-pendiente[_ngcontent-%COMP%]{font-size:11px;padding:2px 6px}.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:10px;padding:1px 3px}.no-repuestos[_ngcontent-%COMP%]{font-size:11px}.empty-state[_ngcontent-%COMP%]{padding:24px 12px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:11px}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}ion-icon[_ngcontent-%COMP%]{font-size:16px}.urgent-badge[_ngcontent-%COMP%]{font-size:10px;padding:1px 4px}.ver-cliente[_ngcontent-%COMP%]{font-size:11px}.ver-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:11px}.no-images[_ngcontent-%COMP%]{padding:24px 12px}.no-images[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}}@media (max-width: 768px){.custom-mat-table[_ngcontent-%COMP%]{display:block;overflow-x:auto;white-space:nowrap}.custom-mat-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{display:block}.custom-mat-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.custom-mat-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:8px;border-radius:8px;background:#f9fafb;padding:12px}.custom-mat-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:block;text-align:left;padding:4px 0;border:none;white-space:normal}.custom-mat-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:before, .custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label) ": ";font-weight:600;color:#6b7280;font-size:11px;text-transform:uppercase;letter-spacing:.5px}.custom-mat-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{display:none}.custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:13px;line-height:1.4}.custom-mat-table[_ngcontent-%COMP%]   td.descripcion-trabajo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px}.custom-mat-table[_ngcontent-%COMP%]   td.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]{margin-top:4px}.custom-mat-table[_ngcontent-%COMP%]   td.materiales-info[_ngcontent-%COMP%]   .repuestos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-block;margin:2px 4px 2px 0}.custom-mat-table[_ngcontent-%COMP%]   td.estado-actions[_ngcontent-%COMP%]{margin-top:8px;padding-top:8px;border-top:1px solid #E5E7EB}.custom-mat-table[_ngcontent-%COMP%]   td.estado-actions[_ngcontent-%COMP%]:before{content:"Acciones: "}.estado-actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{flex:1;min-width:80px;max-width:120px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{border:1px solid #E5E7EB;border-radius:8px;padding:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:6px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]{margin:8px 0}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;margin-bottom:2px}.badge-estado[_ngcontent-%COMP%]{display:inline-block;margin:2px 0}.btn-map[_ngcontent-%COMP%]{min-width:36px;height:36px}.btn-map[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{border-radius:6px;padding:6px 10px;font-size:13px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.empty-state[_ngcontent-%COMP%]{background:#f9fafb;border-radius:8px;margin:16px 0}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{min-height:150px}.error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{background:#fef2f2;border:1px solid #FECACA;border-radius:8px;padding:20px}.error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#dc2626}.header-container[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{margin-bottom:0}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{--background: #F3F4F6;--background-checked: white;--color: #6B7280;--color-checked: #4F46E5}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--background: transparent;--background-checked: white;--color: #6B7280;--color-checked: #4F46E5;--indicator-color: transparent;--border-radius: 50%;--margin: 0;--padding: 0;min-height:32px;min-width:32px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.flujo-section[_ngcontent-%COMP%]   .flujo-container[_ngcontent-%COMP%]{padding:0 16px 16px}.section-divider[_ngcontent-%COMP%]{margin:16px 0 12px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:0 10px;background:#fff;color:#6b7280}.cliente-info[_ngcontent-%COMP%]   .cliente-nombre[_ngcontent-%COMP%]{font-size:14px;line-height:1.3}.direccion-info[_ngcontent-%COMP%]   .direccion-texto[_ngcontent-%COMP%]{font-size:13px;line-height:1.4}.descripcion-content[_ngcontent-%COMP%]   .tipo-aviso[_ngcontent-%COMP%]{font-size:14px}.descripcion-content[_ngcontent-%COMP%]   .descripcion-texto[_ngcontent-%COMP%]{font-size:13px}}@media (max-width: 480px){.custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.custom-mat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{font-size:10px}.custom-mat-table[_ngcontent-%COMP%]   .estado-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:end;gap:20px}.custom-mat-table[_ngcontent-%COMP%]   .estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{min-width:70px;max-width:100px;font-size:11px;padding:6px 8px}.custom-mat-table[_ngcontent-%COMP%]   .estado-actions[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]{padding:8px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:120px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px}.gallery-items[_ngcontent-%COMP%]   .gallery-item[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   span.file-info[_ngcontent-%COMP%]{font-size:10px}.contacto-items[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between;gap:8px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]{padding:4px 8px;font-size:12px}.contacto-items[_ngcontent-%COMP%]   .contacto-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}.btn-map[_ngcontent-%COMP%]{min-width:32px;height:32px}.btn-map[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.empty-state[_ngcontent-%COMP%]{padding:20px 12px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:10px}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{min-height:120px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.loading-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{min-height:28px;min-width:28px}.gallery-actions[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px;min-height:40px}.flujo-section[_ngcontent-%COMP%]   .flujo-container[_ngcontent-%COMP%]{padding:0 12px 12px}.section-divider[_ngcontent-%COMP%]{margin:12px 0 8px}.section-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;padding:0 8px}.cliente-info[_ngcontent-%COMP%]   .cliente-nombre[_ngcontent-%COMP%]{font-size:13px}.direccion-info[_ngcontent-%COMP%]   .direccion-texto[_ngcontent-%COMP%]{font-size:12px}.descripcion-content[_ngcontent-%COMP%]   .tipo-aviso[_ngcontent-%COMP%]{font-size:13px}.descripcion-content[_ngcontent-%COMP%]   .descripcion-texto[_ngcontent-%COMP%]{font-size:12px}}.no-albaranes[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.no-albaranes[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:#d1d5db;margin-bottom:16px}.no-albaranes[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;font-size:16px}.no-albaranes[_ngcontent-%COMP%]   p.info-text[_ngcontent-%COMP%]{font-size:14px;color:#9ca3af;font-style:italic}.albaranes-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.albaran-item[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;transition:all .2s ease}.albaran-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid #E5E7EB}.albaran-header[_ngcontent-%COMP%]   .albaran-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:18px;font-weight:600;color:#1f2937}.albaran-header[_ngcontent-%COMP%]   .albaran-info[_ngcontent-%COMP%]   .fecha-albaran[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;font-weight:500}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado[_ngcontent-%COMP%]{padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado.badge-finalizado[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado.badge-presupuesto-pendiente[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]   .badge-estado.badge-otra-visita[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.albaran-header[_ngcontent-%COMP%]   .albaran-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.albaran-header[_ngcontent-%COMP%]   .albaran-actions[_ngcontent-%COMP%]   .btn-primary.btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px;background:#4f46e5;color:#fff;border:none;border-radius:6px;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;gap:4px}.albaran-header[_ngcontent-%COMP%]   .albaran-actions[_ngcontent-%COMP%]   .btn-primary.btn-small[_ngcontent-%COMP%]:hover{background:#4338ca}.albaran-header[_ngcontent-%COMP%]   .albaran-actions[_ngcontent-%COMP%]   .btn-primary.btn-small[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.header-actions[_ngcontent-%COMP%]   .btn-secondary.btn-small[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px;background:#6b7280;color:#fff;border:none;border-radius:6px;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;gap:4px}.header-actions[_ngcontent-%COMP%]   .btn-secondary.btn-small[_ngcontent-%COMP%]:hover{background:#4b5563}.header-actions[_ngcontent-%COMP%]   .btn-secondary.btn-small[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.albaran-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.albaran-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.albaran-details[_ngcontent-%COMP%]   .detail-item.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.5px}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#1f2937;margin:0}.albaran-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{line-height:1.5;background:#f9fafb;padding:8px 12px;border-radius:6px;border:1px solid #E5E7EB}.albaran-details[_ngcontent-%COMP%]   .repuestos-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.albaran-details[_ngcontent-%COMP%]   .repuestos-tags[_ngcontent-%COMP%]   .repuesto-tag[_ngcontent-%COMP%]{background:#e0f2fe;color:#0c4a6e;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;border:1px solid #BAE6FD}@media (max-width: 768px){.albaranes-container[_ngcontent-%COMP%]{gap:16px}.albaran-item[_ngcontent-%COMP%]{padding:16px}.albaran-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:flex-start}.albaran-header[_ngcontent-%COMP%]   .estado-albaran[_ngcontent-%COMP%]{align-self:flex-start}.albaran-header[_ngcontent-%COMP%]   .albaran-actions[_ngcontent-%COMP%]{align-self:flex-start;margin-top:8px}.no-albaranes[_ngcontent-%COMP%]{padding:20px 10px}.no-albaranes[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px}.no-albaranes[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.no-albaranes[_ngcontent-%COMP%]   p.info-text[_ngcontent-%COMP%]{font-size:12px}.albaran-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}}']});let c=l;return c})();export{Ui as VerAvisosComponent};
