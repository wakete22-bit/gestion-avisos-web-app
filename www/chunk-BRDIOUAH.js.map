{
  "version": 3,
  "sources": ["src/app/modules/clientes/components/crear-cliente-modal/crear-cliente-modal.component.ts", "src/app/modules/clientes/components/crear-cliente-modal/crear-cliente-modal.component.html"],
  "sourcesContent": ["import { Component, OnInit, AfterViewInit, ElementRef, Input } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators, ReactiveFormsModule } from '@angular/forms';\nimport { IonicModule, ModalController } from '@ionic/angular';\nimport { CommonModule } from '@angular/common';\nimport { addIcons } from 'ionicons';\nimport { closeOutline } from 'ionicons/icons';\nimport { ViewportService } from 'src/app/core/services/viewport.service';\nimport { Cliente } from '../../models/cliente.model';\n\n@Component({\n  selector: 'app-crear-cliente-modal',\n  templateUrl: './crear-cliente-modal.component.html',\n  styleUrls: ['./crear-cliente-modal.component.scss'],\n  standalone: true,\n  imports: [IonicModule, CommonModule, ReactiveFormsModule]\n})\nexport class CrearClienteModalComponent implements OnInit, AfterViewInit {\n  @Input() modo: 'crear' | 'editar' = 'crear';\n  @Input() cliente?: Cliente;\n  \n  clienteForm: FormGroup;\n\n  constructor(\n    private fb: FormBuilder,\n    private modalController: ModalController,\n    private viewportService: ViewportService,\n    private elementRef: ElementRef\n  ) {\n    this.clienteForm = this.fb.group({\n      nombreContacto: ['', Validators.required],\n      telefono: ['', Validators.required],\n      correoElectronico: ['', [Validators.required, Validators.email]],\n      // notasImportantes: ['', Validators.maxLength(200)], // Comentado temporalmente\n      direccionLocal: ['', Validators.required],\n      codigoPostal: ['', Validators.required],\n      localidad: ['', Validators.required],\n      esActivo: [true, Validators.required]\n    });\n  }\n\n  ngOnInit() {\n    addIcons({ closeOutline });\n    \n    // Si estamos en modo editar y tenemos datos del cliente, cargar los datos\n    if (this.modo === 'editar' && this.cliente) {\n      this.cargarDatosCliente();\n    }\n  }\n\n  ngAfterViewInit() {\n    // Aplicar safe areas al modal después de que se renderice\n    setTimeout(() => {\n      const modalContainer = this.elementRef.nativeElement.querySelector('.modal-container');\n      if (modalContainer) {\n        this.viewportService.applySafeAreaToModal(modalContainer);\n      }\n    }, 100);\n  }\n\n  private cargarDatosCliente() {\n    if (!this.cliente) return;\n\n    // Separar la dirección en sus componentes\n    const direccionCompleta = this.cliente.direccion || '';\n    const partes = direccionCompleta.split(', ');\n    \n    let direccionLocal = '';\n    let codigoPostal = '';\n    let localidad = '';\n    \n    if (partes.length >= 2) {\n      direccionLocal = partes[0];\n      const ultimaParte = partes[partes.length - 1];\n      const codigoLocalidad = ultimaParte.split(' ');\n      if (codigoLocalidad.length >= 2) {\n        codigoPostal = codigoLocalidad[0];\n        localidad = codigoLocalidad.slice(1).join(' ');\n      } else {\n        localidad = ultimaParte;\n      }\n    } else {\n      direccionLocal = direccionCompleta;\n    }\n\n    this.clienteForm.patchValue({\n      nombreContacto: this.cliente.nombre_completo || '',\n      telefono: this.cliente.telefono_contacto || '',\n      email: this.cliente.email || '',\n      // notasImportantes: this.cliente.notas_importantes || '', // Comentado temporalmente\n      direccionLocal: direccionLocal,\n      codigoPostal: codigoPostal,\n      localidad: localidad,\n      esActivo: this.cliente.es_activo ?? true\n    });\n  }\n\n  async guardarCliente() {\n    if (this.clienteForm.valid) {\n      // Deshabilitar el botón mientras se procesa\n      this.clienteForm.disable();\n      \n      const clienteData = {\n        nombre_completo: this.clienteForm.value.nombreContacto,\n        telefono_contacto: this.clienteForm.value.telefono,\n        email: this.clienteForm.value.correoElectronico,\n        direccion: `${this.clienteForm.value.direccionLocal}, ${this.clienteForm.value.codigoPostal} ${this.clienteForm.value.localidad}`,\n        nivel_urgencia_habitual: this.cliente?.nivel_urgencia_habitual || 'Media',\n        es_activo: this.clienteForm.value.esActivo,\n        // notas_importantes: this.clienteForm.value.notasImportantes // Comentado temporalmente\n      };\n      await this.modalController.dismiss(clienteData, 'confirm');\n    }\n  }\n\n  async cerrarModal() {\n    await this.modalController.dismiss(null, 'cancel');\n  }\n\n  get tituloModal(): string {\n    return this.modo === 'editar' ? 'Editar cliente' : 'Añadir nuevo cliente';\n  }\n\n  get subtituloModal(): string {\n    return this.modo === 'editar' ? 'Modifica los datos del cliente' : 'Añade un nuevo cliente';\n  }\n\n  get textoBotonGuardar(): string {\n    return this.modo === 'editar' ? 'Guardar cambios' : 'Guardar cliente';\n  }\n\n  get botonDeshabilitado(): boolean {\n    return !this.clienteForm.valid || this.clienteForm.disabled;\n  }\n}\n", "<div class=\"modal-container\">\n  <header class=\"modal-header\">\n    <div class=\"header-content\">\n      <h2>{{ tituloModal }}</h2>\n      <button class=\"close-button\" (click)=\"cerrarModal()\">\n        <ion-icon name=\"close-outline\"></ion-icon>\n      </button>\n    </div>\n    <p class=\"subtitle\">{{ subtituloModal }}</p>\n  </header>\n\n  <div class=\"modal-content\">\n    <form [formGroup]=\"clienteForm\" (ngSubmit)=\"guardarCliente()\">\n      <div class=\"form-section\">\n        <div class=\"form-group\">\n          <label>Nombre de contacto</label>\n          <input \n            type=\"text\" \n            formControlName=\"nombreContacto\" \n            class=\"form-control\"\n            placeholder=\"Ej: Luis Pérez\">\n        </div>\n\n        <div class=\"form-row\">\n          <div class=\"form-group half\">\n            <label>Teléfono</label>\n            <input \n              type=\"tel\" \n              formControlName=\"telefono\" \n              class=\"form-control\"\n              placeholder=\"Ej: +34 569 23 56 89\">\n          </div>\n          <div class=\"form-group half\">\n            <label>Correo electrónico</label>\n            <input \n              type=\"email\" \n              formControlName=\"correoElectronico\" \n              class=\"form-control\"\n              placeholder=\"Ej: ejemplo@dominio.es\">\n          </div>\n        </div>\n\n        <!-- Comentado temporalmente hasta que se ejecute la migración SQL\n        <div class=\"form-group\">\n          <label>Notas importantes</label>\n          <textarea \n            formControlName=\"notasImportantes\" \n            class=\"form-control\"\n            placeholder=\"Descripción más detallada del artículo\"\n            rows=\"3\"\n            maxlength=\"200\">\n          </textarea>\n          <div class=\"character-count\">{{clienteForm.get('notasImportantes')?.value?.length || 0}}/200</div>\n        </div>\n        -->\n\n        <div class=\"form-group\">\n          <label>Direccion local <span class=\"required\">*</span></label>\n          <input \n            type=\"text\" \n            formControlName=\"direccionLocal\" \n            class=\"form-control\"\n            placeholder=\"Ej: Calle Azorin\">\n        </div>\n\n                  <div class=\"form-row\">\n            <div class=\"form-group half\">\n              <label>Código Postal <span class=\"required\">*</span></label>\n              <input \n                type=\"text\" \n                formControlName=\"codigoPostal\" \n                class=\"form-control\"\n                placeholder=\"28004\">\n            </div>\n            <div class=\"form-group half\">\n              <label>Localidad <span class=\"required\">*</span></label>\n              <input \n                type=\"text\" \n                formControlName=\"localidad\" \n                class=\"form-control\"\n                placeholder=\"Ej: Madrid\">\n            </div>\n          </div>\n\n          <div class=\"form-group\">\n            <label class=\"checkbox-label\">\n              <input \n                type=\"checkbox\" \n                formControlName=\"esActivo\"\n                class=\"form-checkbox\">\n              <span class=\"checkmark\"></span>\n              Cliente activo\n            </label>\n            <small class=\"form-help\">Los clientes inactivos no aparecerán en las búsquedas principales</small>\n          </div>\n      </div>\n    </form>\n  </div>\n\n  <footer class=\"modal-footer\">\n    <div class=\"button-group\">\n      <button type=\"button\" class=\"btn btn-outline\" (click)=\"cerrarModal()\">\n        Cancelar\n      </button>\n      <button \n        type=\"button\" \n        class=\"btn btn-primary\" \n        (click)=\"guardarCliente()\"\n        [disabled]=\"botonDeshabilitado\">\n        {{ textoBotonGuardar }}\n      </button>\n    </div>\n  </footer>\n</div>\n"],
  "mappings": "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",
  "names": []
}
