// ============================================================================
// SAFE AREAS UTILITIES
// ============================================================================
// Utilidades para manejar zonas seguras en dispositivos móviles
// Compatible con Android (navigation bar) e iOS (notch, home indicator)

// Variables CSS para zonas seguras
:root {
  // Valores por defecto para navegadores que no soportan env()
  --safe-area-top: 0px;
  --safe-area-bottom: 0px;
  --safe-area-left: 0px;
  --safe-area-right: 0px;
  
  // Valores dinámicos usando env() cuando esté disponible
  --safe-area-top: env(safe-area-inset-top, 0px);
  --safe-area-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-left: env(safe-area-inset-left, 0px);
  --safe-area-right: env(safe-area-inset-right, 0px);
  
  // Márgenes adicionales para mejor UX
  --safe-margin-top: calc(var(--safe-area-top) + 12px);
  --safe-margin-bottom: calc(var(--safe-area-bottom) + 16px);
  --safe-margin-left: calc(var(--safe-area-left) + 16px);
  --safe-margin-right: calc(var(--safe-area-right) + 16px);
}

// ============================================================================
// CLASES UTILITARIAS PARA ZONAS SEGURAS
// ============================================================================

// Contenido principal con zona segura superior
.content-safe-top {
  padding-top: var(--safe-area-top);
}

// Contenido principal con zona segura inferior
.content-safe-bottom {
  padding-bottom: var(--safe-area-bottom);
}

// Contenido principal con zonas seguras verticales
.content-safe-vertical {
  padding-top: var(--safe-area-top);
  padding-bottom: var(--safe-area-bottom);
}

// Contenido principal con todas las zonas seguras
.content-safe-all {
  padding-top: var(--safe-area-top);
  padding-bottom: var(--safe-area-bottom);
  padding-left: var(--safe-area-left);
  padding-right: var(--safe-area-right);
}

// Footer con zona segura
.footer-safe {
  padding-bottom: var(--safe-margin-bottom);
}

// Header con zona segura
.header-safe {
  padding-top: var(--safe-margin-top);
}

// Contenedor de botones con zona segura
.button-container-safe {
  padding-bottom: var(--safe-margin-bottom);
}

// FAB con zona segura
.fab-container-safe {
  bottom: var(--safe-margin-bottom);
}

// Modal con zonas seguras
.modal-safe {
  ion-header {
    padding-top: var(--safe-area-top);
  }
  
  ion-footer {
    padding-bottom: var(--safe-area-bottom);
  }
}

// Overlay con zonas seguras
.overlay-safe {
  padding-top: var(--safe-area-top);
  padding-bottom: var(--safe-area-bottom);
}

// ============================================================================
// CONFIGURACIÓN ESPECÍFICA PARA PLATAFORMAS
// ============================================================================

// Configuración específica para iOS
.ios {
  :root {
    // En iOS, necesitamos márgenes adicionales para el notch/Dynamic Island
    --safe-margin-top: calc(var(--safe-area-top) + 16px);
    --safe-margin-bottom: calc(var(--safe-area-bottom) + 20px);
  }
  
  // Headers en iOS necesitan más espacio
  .header-safe {
    padding-top: calc(var(--safe-area-top) + 16px);
  }
  
  // Footers en iOS necesitan más espacio
  .footer-safe {
    padding-bottom: calc(var(--safe-area-bottom) + 20px);
  }
  
  // Toolbars en iOS necesitan altura adicional
  ion-toolbar {
    --min-height: calc(56px + var(--safe-area-top));
    --height: calc(56px + var(--safe-area-top));
  }
  
  // Headers en iOS necesitan padding adicional
  ion-header {
    padding-top: calc(var(--safe-area-top) + 8px);
  }
  
  // Footers en iOS necesitan padding adicional
  ion-footer {
    padding-bottom: calc(var(--safe-area-bottom) + 8px);
  }
}

// Configuración específica para Android
.android {
  :root {
    // En Android, márgenes más conservadores
    --safe-margin-top: calc(var(--safe-area-top) + 8px);
    --safe-margin-bottom: calc(var(--safe-area-bottom) + 12px);
  }
  
  // Headers en Android
  .header-safe {
    padding-top: calc(var(--safe-area-top) + 8px);
  }
  
  // Footers en Android
  .footer-safe {
    padding-bottom: calc(var(--safe-area-bottom) + 12px);
  }
  
  // Toolbars en Android
  ion-toolbar {
    --min-height: calc(56px + var(--safe-area-top));
  }
}

// ============================================================================
// CONFIGURACIÓN PARA PWA STANDALONE
// ============================================================================

@media all and (display-mode: standalone) {
  :root {
    // En modo standalone, márgenes más generosos
    --safe-margin-top: calc(var(--safe-area-top) + 20px);
    --safe-margin-bottom: calc(var(--safe-area-bottom) + 24px);
  }
  
  // Headers en modo standalone
  .header-safe {
    padding-top: calc(var(--safe-area-top) + 20px);
  }
  
  // Footers en modo standalone
  .footer-safe {
    padding-bottom: calc(var(--safe-area-bottom) + 24px);
  }
  
  // Toolbars en modo standalone
  ion-toolbar {
    --min-height: calc(56px + var(--safe-area-top));
    --height: calc(56px + var(--safe-area-top));
  }
}

// ============================================================================
// CONFIGURACIÓN ESPECÍFICA PARA ORIENTACIÓN
// ============================================================================

// Orientación landscape
@media (orientation: landscape) {
  :root {
    // En landscape, las zonas seguras laterales son más importantes
    --safe-margin-left: calc(var(--safe-area-left) + 20px);
    --safe-margin-right: calc(var(--safe-area-right) + 20px);
  }
  
  // Contenido en landscape
  .content-safe-all {
    padding-left: var(--safe-margin-left);
    padding-right: var(--safe-margin-right);
  }
}

// Orientación portrait
@media (orientation: portrait) {
  :root {
    // En portrait, las zonas seguras verticales son más importantes
    --safe-margin-top: calc(var(--safe-area-top) + 16px);
    --safe-margin-bottom: calc(var(--safe-area-bottom) + 20px);
  }
}

// ============================================================================
// FALLBACKS PARA NAVEGADORES ANTIGUOS
// ============================================================================

// Fallback para navegadores que no soportan env()
@supports not (padding-top: env(safe-area-inset-top)) {
  :root {
    --safe-area-top: 20px;
    --safe-area-bottom: 20px;
    --safe-area-left: 0px;
    --safe-area-right: 0px;
  }
  
  // Aplicar fallbacks en modo standalone
  @media all and (display-mode: standalone) {
    :root {
      --safe-area-top: 24px;
      --safe-area-bottom: 24px;
    }
    
    .header-safe {
      padding-top: 36px;
    }
    
    .footer-safe {
      padding-bottom: 36px;
    }
  }
  
  // Aplicar fallbacks en iOS
  .ios {
    :root {
      --safe-area-top: 28px;
      --safe-area-bottom: 28px;
    }
    
    .header-safe {
      padding-top: 44px;
    }
    
    .footer-safe {
      padding-bottom: 44px;
    }
  }
  
  // Aplicar fallbacks en Android
  .android {
    :root {
      --safe-area-top: 24px;
      --safe-area-bottom: 24px;
    }
    
    .header-safe {
      padding-top: 32px;
    }
    
    .footer-safe {
      padding-bottom: 32px;
    }
  }
}

// ============================================================================
// UTILIDADES ADICIONALES
// ============================================================================

// Clase para elementos que deben estar siempre visibles
.always-visible {
  position: relative;
  z-index: 1000;
}

// Clase para elementos que deben respetar zonas seguras
.safe-area-respect {
  padding-top: var(--safe-area-top);
  padding-bottom: var(--safe-area-bottom);
  padding-left: var(--safe-area-left);
  padding-right: var(--safe-area-right);
}

// Clase para elementos que deben estar en la parte superior segura
.safe-top {
  top: var(--safe-area-top);
}

// Clase para elementos que deben estar en la parte inferior segura
.safe-bottom {
  bottom: var(--safe-area-bottom);
}

// Clase para elementos que deben estar en la parte izquierda segura
.safe-left {
  left: var(--safe-area-left);
}

// Clase para elementos que deben estar en la parte derecha segura
.safe-right {
  right: var(--safe-area-right);
}
