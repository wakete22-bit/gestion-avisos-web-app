<!-- Botón de flujo principal -->
<div class="flujo-boton-container" [ngClass]="size">
  
  <!-- Estado sin acciones -->
  <div *ngIf="!tieneAcciones && !loading && !error" class="sin-acciones">
    <ion-icon name="checkmark-circle-outline" class="complete-icon"></ion-icon>
    <span *ngIf="showText" class="complete-text">
      <span class="desktop-only">Completo</span>
      <span class="mobile-only">✓</span>
    </span>
  </div>

  <!-- Estado de carga -->
  <div *ngIf="loading" class="loading-state">
    <ion-icon name="ellipsis-horizontal-outline" class="loading-icon"></ion-icon>
  </div>

  <!-- Estado de error -->
  <div *ngIf="error && !loading" class="error-state" [title]="error">
    <ion-icon name="warning-outline" class="error-icon"></ion-icon>
  </div>

  <!-- Botón de acción principal -->
  <ion-button 
    *ngIf="accionPrimaria && !loading && !error"
    [fill]="size === 'small' ? 'clear' : 'solid'"
    [size]="size"
    [color]="getAccionColor(accionPrimaria)"
    (click)="ejecutarAccionPrimaria()"
    [disabled]="loading"
    class="accion-primaria"
    [title]="getAccionTexto(accionPrimaria)">
    
    <ion-icon [name]="getAccionIcon(accionPrimaria)" slot="icon-only" *ngIf="!showText"></ion-icon>
    
    <ng-container *ngIf="showText">
      <ion-icon [name]="getAccionIcon(accionPrimaria)" slot="start"></ion-icon>
      <span class="accion-text">{{ getAccionTexto(accionPrimaria) }}</span>
    </ng-container>
  </ion-button>

  <!-- Botón de más acciones (si hay múltiples) -->
  <ion-button 
    *ngIf="accionesDisponibles.length > 1 && !loading && !error"
    fill="clear"
    size="small"
    color="medium"
    class="mas-acciones"
    title="Más acciones disponibles">
    <ion-icon name="ellipsis-horizontal-outline" slot="icon-only"></ion-icon>
  </ion-button>

</div> 