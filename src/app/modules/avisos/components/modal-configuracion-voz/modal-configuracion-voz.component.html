<div class="modal-container">
  <div class="modal-header">
    <h2>Configuración de Voz</h2>
    <button class="btn-cerrar" (click)="cerrar()">
      <ion-icon name="close-outline"></ion-icon>
    </button>
  </div>

  <div class="modal-body">
    <p class="descripcion">
      Configura las notificaciones de voz para la navegación. 
      <br>
      <span class="voice-info">Las instrucciones se reproducirán automáticamente durante la navegación.</span>
    </p>

    <!-- Toggle principal -->
    <div class="voice-toggle-section">
      <div class="toggle-item">
        <div class="toggle-content">
          <h3>Notificaciones de Voz</h3>
          <p>Activar instrucciones de navegación por voz</p>
        </div>
        <label class="toggle-switch">
          <input 
            type="checkbox" 
            [(ngModel)]="voiceEnabled" 
            (change)="onVoiceEnabledChange()">
          <span class="toggle-slider"></span>
        </label>
      </div>
    </div>

    <!-- Configuración de voz -->
    <div class="voice-settings" [class.disabled]="!voiceEnabled">
      
      <!-- Volumen -->
      <div class="setting-item">
        <div class="setting-icon">
          <ion-icon name="volume-high-outline"></ion-icon>
        </div>
        <div class="setting-content">
          <h4>Volumen</h4>
          <div class="range-container">
            <input 
              type="range" 
              [(ngModel)]="volume" 
              (input)="onVolumeChange($event)"
              min="0" 
              max="100" 
              step="5"
              [disabled]="!voiceEnabled"
              class="range-slider">
            <span class="range-value">{{ formatRangeValue(volume, 'volume') }}</span>
          </div>
        </div>
      </div>

      <!-- Velocidad -->
      <div class="setting-item">
        <div class="setting-icon">
          <ion-icon name="speedometer-outline"></ion-icon>
        </div>
        <div class="setting-content">
          <h4>Velocidad</h4>
          <div class="range-container">
            <input 
              type="range" 
              [(ngModel)]="rate" 
              (input)="onRateChange($event)"
              min="10" 
              max="200" 
              step="10"
              [disabled]="!voiceEnabled"
              class="range-slider">
            <span class="range-value">{{ formatRangeValue(rate, 'rate') }}</span>
          </div>
        </div>
      </div>

      <!-- Tono -->
      <div class="setting-item">
        <div class="setting-icon">
          <ion-icon name="musical-notes-outline"></ion-icon>
        </div>
        <div class="setting-content">
          <h4>Tono</h4>
          <div class="range-container">
            <input 
              type="range" 
              [(ngModel)]="pitch" 
              (input)="onPitchChange($event)"
              min="50" 
              max="200" 
              step="10"
              [disabled]="!voiceEnabled"
              class="range-slider">
            <span class="range-value">{{ formatRangeValue(pitch, 'pitch') }}</span>
          </div>
        </div>
      </div>

      <!-- Voz -->
      <div class="setting-item">
        <div class="setting-icon">
          <ion-icon name="person-outline"></ion-icon>
        </div>
        <div class="setting-content">
          <h4>Voz</h4>
          <select 
            [(ngModel)]="selectedVoice" 
            (change)="onVoiceChange($event)"
            [disabled]="!voiceEnabled"
            class="voice-select">
            <option 
              *ngFor="let voice of availableVoices" 
              [value]="voice"
              [selected]="selectedVoice === voice">
              {{ getVoiceDisplayName(voice) }}
            </option>
          </select>
        </div>
      </div>

    </div>

    <!-- Prueba de voz -->
    <div class="test-section" [class.disabled]="!voiceEnabled">
      <h3>Prueba de Voz</h3>
      <p class="test-text">{{ testText }}</p>
      
      <div class="test-controls">
        <button 
          class="btn-test btn-play" 
          (click)="playTest()" 
          [disabled]="!voiceEnabled">
          <ion-icon [name]="isPlaying ? 'pause-outline' : 'play-outline'"></ion-icon>
          {{ isPlaying ? 'Pausar' : 'Reproducir' }}
        </button>
        
        <button 
          class="btn-test btn-stop" 
          (click)="stopTest()" 
          [disabled]="!voiceEnabled || !isPlaying">
          <ion-icon name="stop-outline"></ion-icon>
          Detener
        </button>
      </div>
    </div>

    <!-- Botones de acción -->
    <div class="action-buttons">
      <button class="btn-action btn-cancel" (click)="cerrar()">
        Cancelar
      </button>
      
      <button class="btn-action btn-save" (click)="guardar()">
        Guardar
      </button>
    </div>

  </div>
</div>
