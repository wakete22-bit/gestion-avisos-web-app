<!-- Información General -->
<div class="info-card">
  <div class="card-header">
    <h2>Información general del Aviso - #{{aviso.numero}}</h2>
    <div class="header-actions">
      <button class="btn-secondary" (click)="cerrarAlbaran()">
        <ion-icon name="close"></ion-icon>
        Cerrar Albarán
      </button>
      <button class="btn-primary" (click)="editarAviso()">
        <ion-icon name="pencil-outline"></ion-icon>
        Editar aviso
      </button>
    </div>
  </div>

  <div class="info-grid">
    <div class="info-row">
      <div class="info-item">
        <label>Estado</label>
        <span class="estado-pendiente">{{aviso.estado}}</span>
      </div>
      <div class="info-item">
        <label>Urgente</label>
        <span>{{aviso.urgente}}</span>
      </div>
      <div class="info-item">
        <label>Fecha de creación</label>
        <span>{{aviso.fechaCreacion}}</span>
      </div>
    </div>

    <div class="info-item cliente-section">
      <label>Cliente</label>
      <div class="cliente-info">
        <span>{{aviso.cliente.nombre}}</span>
        <a class="ver-cliente" (click)="verCliente()">Ver cliente</a>
      </div>
    </div>

    <div class="info-item direccion-section">
      <label>Dirección</label>
      <div class="direccion-info">
        <span>{{aviso.cliente.direccion}}</span>
        <button class="btn-map" (click)="verMapa()">
          <ion-icon name="navigate"></ion-icon>
        </button>
      </div>
    </div>

    <div class="contacto-section">
      <label>Contacto Cliente</label>
      <div class="contacto-items">
        <div class="contacto-item">
          <ion-icon name="person"></ion-icon>
          <span>{{aviso.cliente.contacto.nombre}}</span>
        </div>
        <div class="contacto-item">
          <ion-icon name="call"></ion-icon>
          <span>{{aviso.cliente.contacto.telefono}}</span>
        </div>
        <div class="contacto-item">
          <ion-icon name="mail"></ion-icon>
          <span>{{aviso.cliente.contacto.email}}</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Descripción del Aviso -->
<div class="info-card">
  <div class="card-header">
    <h2>Descripción del Aviso</h2>
    <span class="badge-pendiente">{{aviso.estado}}</span>
  </div>

  <div class="descripcion-content">
    <div class="info-item">
      <label>Título del Aviso</label>
      <p>{{aviso.titulo}}</p>
    </div>

    <div class="info-item">
      <label>Descripción Detallada del Problema/Petición</label>
      <p>{{aviso.descripcion}}</p>
    </div>
  </div>
</div>

<!-- Galería de imágenes -->
<div class="info-card">
  <div class="card-header">
    <h2>Galería de imágenes</h2>
    <div class="gallery-actions">
      <ion-segment [value]="vistaGaleria" (ionChange)="cambiarVistaGaleria($event)" mode="ios">
        <ion-segment-button value="grid">
          <ion-icon name="grid-outline"></ion-icon>
        </ion-segment-button>
        <ion-segment-button value="list">
          <ion-icon name="list-outline"></ion-icon>
        </ion-segment-button>
      </ion-segment>
      <button class="btn-primary" (click)="addImagenes()">
        <ion-icon name="add-circle"></ion-icon>
        Añadir imágenes
      </button>
    </div>
  </div>

  <div class="gallery-items">
    <div class="gallery-item" *ngFor="let imagen of aviso.imagenes">
      <img [src]="imagen.nombre" [alt]="imagen.nombre">
      <div class="image-info">
        <span>{{imagen.nombre}}</span>
        <span class="file-info">{{imagen.tiempo}} · {{imagen.tamano}}</span>
      </div>
      <button class="btn-more">
        <i class="fas fa-ellipsis-v"></i>
      </button>
    </div>
  </div>
</div>

<!-- Tabla de trabajos realizados -->
<div class="info-card">
  <div class="card-header">
    <h2>Lista de trabajos realizados</h2>
    <div class="table-search">
      <input type="text" placeholder="Buscar...">
      <div class="order-by">
        Ordenar por: <span>Recientes</span>
        <ion-icon name="chevron-down-outline"></ion-icon>
      </div>
    </div>
  </div>

  <div class="table-container">
    <table class="custom-mat-table">
      <thead>
        <tr>
          <th>Número</th>
          <th>Fecha trabajo</th>
          <th>Entrada/Salida</th>
          <th>Descripción</th>
          <th>Repuestos usados</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let trabajo of trabajosRealizados">
          <td>{{trabajo.numero}}</td>
          <td>{{trabajo.fechaTrabajo}}</td>
          <td>{{trabajo.horario}}</td>
          <td>{{trabajo.descripcion}}</td>
          <td>
            <ul class="repuestos-list">
              <li *ngFor="let repuesto of trabajo.repuestos">{{repuesto}}</li>
            </ul>
          </td>
          <td>
            <div class="estado-actions">
              <span class="badge-pendiente">{{trabajo.estado}}</span>
              <button class="btn-secondary btn-small" (click)="realizarOtraVisita(trabajo)">
                <ion-icon name="eye-outline"></ion-icon>
                Realizar otra visita
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
